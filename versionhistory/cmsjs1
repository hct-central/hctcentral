(()=>{(window.vevr||(window.vevr=[])).push(function(eC,Au,ca){Au.register("scrollyteller",["react","vev","animejs"],function(Ds){"use strict";var hn,Hn,kn,Sr,dr,Da,Tr,ar,Os,ps,Ns,Oa,ms;return{setters:[function(sn){hn=sn.default,Hn=sn.useRef,kn=sn.useEffect,Sr=sn.useLayoutEffect,dr=sn.Fragment,Da=sn.useState},function(sn){Tr=sn.View,ar=sn.useEditorState,Os=sn.useHover,ps=sn.Tracking,Ns=sn.raf,Oa=sn.Icon},function(sn){ms=sn.default}],execute:function(){var Pr,sr;Ds({"wQwq0xf-9u":bo,wUNTsB8PHK:Ru,"wgT9kyli-m":Pn});const sn=location.hash.includes("debug");var Hr;(function(bn){bn[bn.hidden=0]="hidden",bn[bn.active=1]="active",bn[bn.showing=2]="showing"})(Hr||(Hr={}));class kr{constructor(rt){this.isPinned=!1,this.isOverlayPinned=!1,this.isShowing=!1,this.isActive=!1,this.top=0,this.height=0,this.bottom=0,this.offset=[null,null],this.completed=!1,this.scrollBg=!1,this.handleComplete=()=>{this.completed=!0,this.complete&&this.complete(this)},this.container=rt.container,this.content=rt.content,this.overlay=rt.overlay,this.scrollBg=rt.scrollBg||!1,this.active=rt.active,this.ani=ms({targets:[this.content,this.overlay],opacity:[0,1],duration:rt.duration||350,easing:rt.easing||"linear",autoplay:!1})}state(){return this.isShowing&&this.isActive?Hr.showing:this.isActive?Hr.active:Hr.hidden}emitState(){this.active&&this.active(this.state())}debug(){this.debugging=!0,this.debugEl||(this.debugEl=document.createElement("div"),this.debugEl.setAttribute("style","position:fixed;bottom:0;left:0;background:white;z-index:10000;padding:3px;font-size:10px")),this.container.append(this.debugEl),this.debugEl.style.width=this.content.clientWidth+"px",this.debugEl.style.left=this.content.offsetLeft+"px",this.debugEl.innerHTML=`State: ${this.state()}`}setActive(rt){this.isActive!==rt&&(this.debugging&&this.debug(),sn&&console.log("Set active",this.container.id,"isActive:",rt),this.isActive=rt,this.emitState())}setContentHeight(rt){if(this.scrollBg){let It=this.container.getBoundingClientRect().height;this.contentHeight=It}else rt!==this.contentHeight&&(this.contentHeight=rt,this.content.style.height=Tr.zoom===1?"100vh":rt+"px")}setOffset(rt,It){(this.offset[0]!==rt||this.offset[1]!==It&&this.isActive)&&(sn&&console.log("Update offset",this.container.id,`top:${rt};bottom:${It}`),this.offset=[rt,It],this.content.style.top=rt?rt==="auto"?rt:`${rt}px`:null,this.content.style.bottom=It?It==="auto"?It:`${It}px`:null)}inView(rt){return this.top-rt<=0&&this.bottom-rt>=window.innerHeight}show(rt){this.isShowing||(sn&&console.log("Show item",this.container.id),this.isShowing=!0,this.animate(!1,rt),this.emitState()),rt&&this.setActive(!0)}hide(rt){this.isShowing&&(sn&&console.log("Hide item",this.container.id,"instant",rt),this.isShowing=!1,this.animate(!0,rt)),rt&&this.setActive(!1)}animate(rt,It=!1){this.ani.pause(),sn&&console.log("Pin overly",this.container.id,`reverse:${rt};instant:${It}`),rt!==this.ani.reversed&&this.ani.reverse(),this.ani.began=!1,this.ani.completed=!1,It&&this.ani.seek(this.ani.duration-10),this.ani.play(),this.completed=!1,clearTimeout(this.timeout),this.timeout=setTimeout(this.handleComplete,It?1:this.ani.duration)}setPin(rt,It){rt!==this.isPinned&&(this.isPinned||this.isActive)&&(sn&&console.log("Pin item",this.container.id,`Pin top:${rt};bottom:${It}`),this.isPinned=rt,this.content.style.position=rt?"fixed":"absolute",this.content.style.bottom=rt||It?"0":"auto",this.content.style.top=!rt&&It?"auto":null)}setOverlayPin(rt,It){const ln=Boolean(rt||It);ln!==this.isOverlayPinned&&(this.isOverlayPinned||this.isActive)&&(sn&&console.log("Pin overly",this.container.id,`Pin top:${rt};bottom:${It}`),this.isOverlayPinned=ln,this.overlay.style.position=ln?"fixed":"absolute",ln?(this.overlay.style.height=this.height+"px",this.overlay.style.top=`${It?-(this.height-window.innerHeight):0}px`):(this.overlay.style.top="0px",this.overlay.style.height="auto"))}update(){const rt=(Tr.rootNodeOffsetTop+this.container.offsetTop)*(Tr.zoom||1),It=this.scrollBg?this.container.clientHeight*(Tr.zoom||1):this.container.clientHeight*(Tr.zoom||1);return this.debugging&&this.debug(),this.top!==rt||this.height!==It?(sn&&console.log("Item has changes",this.container),this.top=rt,this.height=It,this.bottom=rt+It,!0):!1}}function ta(bn){const rt=bn.split("/");return rt[rt.length-1].split(".")[0]}const yo=()=>{var rt;if(/iP(hone|od|ad)/.test(navigator==null?void 0:navigator.platform)){var bn=((rt=navigator.appVersion)==null?void 0:rt.match(/OS (\d+)_(\d+)_?(\d+)?/))||["14","1"];return parseInt(bn[1],10)===15&&parseInt(bn[2],10)>=5}return!1},_o=hn.forwardRef((bn,rt)=>{const It=yo(),{video:ln,autoPlay:cn,loop:Gi=!0,mute:pi=!0,controls:$i,startVisible:Di=!0,noTracking:Ir=!1,thumbnail:Ai=null,lazy:Xn=!1}=bn,Li=Hn({current:0,maxProgress:0}),zi=!0,{disabled:or}=ar(),[tn,Nn]=Os();let Wi=1;if(kn(()=>{const jn=rt.current;if(Ir||!jn||!ln)return;const si=["play","pause","ended","timeupdate"],Jt=Yr=>{const ua=rt.current;if(!ua)return;const Ar=ln.name||ta(ln.sources[0].url);switch(Yr.type){case"timeupdate":const Fa=Math.round(100*ua.currentTime/ua.duration),gs={current:Fa,maxProgress:Math.max(Fa,Li.current.maxProgress)};Fa>Li.current.maxProgress&&Er("Video Progress",Ar,Li.current.maxProgress),ua.currentTime>Wi*ua.duration/5&&(Er(`Video Progress ${Wi*20}`,Ar),Wi++),Li.current.current=gs.current,Li.current.maxProgress=gs.maxProgress;break;case"play":return Er("Play",Ar);case"pause":return Er("Pause",Ar,Li.current.current);case"ended":return Er("Finished",Ar)}};return si.forEach(Yr=>jn.addEventListener(Yr,Jt,!1)),()=>si.forEach(Yr=>jn.removeEventListener(Yr,Jt))},[ln,Ir,zi]),kn(()=>{const jn=rt.current;!jn||(or?(jn.load(),jn.pause()):jn.readyState>=3&&Di&&cn&&jn.play())},[zi,Di,or]),Sr(()=>{rt.current&&(rt.current.setAttribute("autobuffer","true"),pi?rt.current.setAttribute("muted","true"):rt.current.removeAttribute("muted"))},[pi]),Xn&&!zi)return null;const mi={};return Gi&&(mi.loop=!0),mi.autoPlay=!0,$i&&(mi.controls=!0),ln&&ln.name&&!tn&&(mi.title=ln.name),(Tr.isIE||Tr.isEdge)&&(mi.className="ie"),hn.createElement(dr,null,!ln&&hn.createElement("div",{className:"fill row v-center h-center",style:{color:"white"}},hn.createElement("h3",null,"Double click to select video")),hn.createElement("video",Object.assign({ref:rt,playsInline:!0,controls:$i,muted:pi,autobuffer:!0,onLoadedData:jn=>{var Jt;const si=jn.currentTarget;si.readyState>=3&&zi&&Di&&cn&&!or&&((Jt=si.play)==null||Jt.call(si),It&&setTimeout(()=>{si!=null&&si.style&&(si.style.opacity="1")},400))},onPlaying:jn=>{if(It){const si=jn.currentTarget;setTimeout(()=>{si!=null&&si.style&&(si.style.opacity="1")},400)}},preload:"auto",style:{backgroundColor:"black",opacity:It?0:null}},mi,Nn),ln&&ln.sources&&ln.sources.sort(jn=>jn.format==="video/webm"?-1:1).map(jn=>hn.createElement("source",{key:jn.url,src:jn.url,type:jn.format||"video/mp4"})),"Your browser does not support this video"))});function Er(bn,rt,It,ln){ps.send("video","HTML5 Video",bn,rt,It,ln)}const ei=(sr=(Pr=location.hash)==null?void 0:Pr.includes)==null?void 0:sr.call(Pr,"debug");class Fl{constructor(rt){this.items=rt,this.handleComplete=It=>{let ln=this.items.indexOf(It);if(It.isShowing)for(;ln--;)this.items[ln].setActive(!1);It.isShowing||It.setActive(!1)},this.first=this.items[0],this.last=this.items[rt.length-1],this.updateSize();for(const It of this.items)It.complete=this.handleComplete;this.showFirstOrLast(Tr.scrollTop)}debug(){for(let rt=0;rt<this.items.length;rt++)this.items[rt].debug(),this.items[rt].content.style.width=100/this.items.length+"vw",this.items[rt].content.style.marginLeft=rt/this.items.length*100+"vw"}inView(rt){return this.top-rt<=0&&this.bottom-rt>=window.innerHeight}updateSize(){this.first&&this.last&&(this.first.update(),this.last.update(),this.top=this.first.top,this.bottom=this.last.bottom,this.height=this.bottom-this.top);const rt=this.height<window.innerHeight?this.height+"px":null;for(const It of this.items)It.content.style.maxHeight=rt,It.content.style.minHeight=rt}update(rt){ei&&console.time("Group update");const It=window.innerHeight;if(this.top>rt+It||this.bottom<rt){this.items.forEach(cn=>{cn.setPin(!1),cn.setOverlayPin(!1,!1),cn.setActive(!1)});return}let ln=rt>this.top&&rt<this.bottom-It;this.items.forEach((cn,Gi)=>{let pi=!1;if(Gi===0?pi=cn.top<rt+It:pi=cn.top<rt+It/2,pi){let $i=!1;(Gi===0&&this.top>=rt||Gi===this.items.length-1&&this.bottom<=rt)&&($i=!0),cn.show($i)}else cn.hide();cn.setPin(ln),cn.setOverlayPin(ln&&cn.top>=rt,cn.bottom<=rt+It&&this.bottom>rt+It),ln?cn.setOffset(null,null):this.height>It&&rt>=this.bottom-It?cn.setOffset("auto",cn.bottom-this.bottom):cn.setOffset(this.top-cn.top,"auto")}),this.items.forEach((cn,Gi)=>{const pi=this.items[Gi+1];(pi==null?void 0:pi.isShowing)&&pi.completed&&cn.completed&&cn.bottom<rt?cn.setActive(!1):cn.isShowing&&cn.setActive(!0)}),ei&&console.timeEnd("Group update")}showFirstOrLast(rt){rt>this.bottom?this.last.show(!0):this.first.show(!0)}}const Ya=500,Fs=20,ti=[],jr=[];let $o=-1e3,Za=-1,Na,Ic=-1e3;const Lu=(bn,rt)=>bn.top<rt.top?-1:1;function xo(bn){let rt=!1;if(bn-$o>Ya){$o=bn;for(const It of ti)It.update()&&(rt=!0);if(rt){ti.sort(Lu),jr.length=0;const It=ti.filter(ln=>ln.height);for(let ln=0;ln<It.length;ln++){let cn=It[ln];const Gi=[cn];for(ln=ln+1;ln<It.length;ln++){const pi=It[ln];if(pi.top-cn.bottom>5){ln--;break}cn=pi,Gi.push(pi)}jr.push(new Fl(Gi))}}}if(bn-Ic>Fs&&Za!==Tr.scrollTop||rt){Ic=bn,Za=Tr.scrollTop;for(const It of jr)It.update(Za)}}function Dc(bn){const rt=new kr(bn);return ti.push(rt),Na||(Na=Ns(xo,!0)),()=>{const It=ti.indexOf(rt);It!==-1&&ti.splice(It,1),ti.length||(Na(),Na=null)}}window.debugStory=()=>{for(const bn of jr)bn.debug()},window.storyGroups=jr,window.storyItems=ti;function bo({hostRef:bn,duration:rt,mediaType:It,noTracking:ln,video:cn,videoControls:Gi,embedUrl:pi,noLoop:$i,controlsPlacement:Di,easing:Ir="linear"}){Di||(Di="top-right");const[Ai,Xn]=Da(Hr.hidden),Li=Hn(null),zi=Hn(null),[or,tn]=Da(!0),Nn=Hn(null),{disabled:Wi}=ar();kn(()=>Dc({container:bn.current,content:Li.current,overlay:zi.current,active:Xn,duration:rt,easing:Ir}),[rt,Ir]),kn(()=>{Ai||tn(!0)},[Ai]);const mi=Jt=>{Jt.stopPropagation(),Nn.current&&(Nn.current.currentTime=0),si()},jn=Jt=>{Jt.stopPropagation(),tn(!or),si()},si=()=>{const Jt=Nn.current;Jt&&Jt.play()};return hn.createElement(dr,null,hn.createElement("div",{ref:Li,className:["fixedWrapper fill"].join(" ")},Wi||Ai?hn.createElement("div",{className:["contents fill"].join(" ")},hn.createElement(dr,null,Gi&&hn.createElement(dr,null,hn.createElement("div",{className:"media-controls",style:{top:Di.includes("top")?"5%":"auto",bottom:Di.includes("bottom")?"5%":"auto",right:Di.includes("right")?"5%":"auto",left:Di.includes("left")?"5%":"auto"}},hn.createElement(Oa,{d:or?"mute_icon":"audio_100_icon",onClick:jn,className:"mediaIcon audioButton"}),hn.createElement(Oa,{d:"media_restart",onClick:mi,className:"mediaIcon restartButton"}))),cn&&hn.createElement(_o,{video:cn,mute:or,loop:!$i,autoPlay:Ai===Hr.showing,controls:!1,noTracking:ln,ref:Nn}),!cn&&hn.createElement("div",{className:"no-image fill row center-center"},hn.createElement("h3",null,"Please select a video")))):hn.createElement(dr,null)),hn.createElement("div",{className:"fill overlay",ref:zi}))}function Ru({hostRef:bn,duration:rt,zoom:It,scrollBg:ln=!1,speed:cn,easing:Gi="linear"}){const[pi,$i]=Da(Hr.hidden),Di=Hn(null),Ir=Hn(null),Ai=Hn(null),{disabled:Xn}=ar();return kn(()=>Dc({container:bn.current,content:Di.current,overlay:Ai.current,active:$i,duration:rt,easing:Gi,scrollBg:ln}),[rt,Gi]),hn.createElement(dr,null,hn.createElement("div",{ref:Di,className:["fixedWrapper fill"].join(" ")},Xn||pi?hn.createElement("div",{ref:Ir,className:["contents fill",It?"zoom":""].join(" ")}):hn.createElement(dr,null)),hn.createElement("div",{className:"fill overlay",ref:Ai}))}const En=hn.forwardRef((bn,rt)=>{const{embedUrl:It,stretch:ln,mute:cn,autoplay:Gi=!0,controls:pi,repeat:$i,displayTitle:Di,displayDescription:Ir,trackingName:Ai}=bn,Xn=Hn(null);let Li,zi=It&&It.replace(/(^\w+:|^)\/\//,"").replace(/(\.html|\.js)/,"").split("/"),or=zi&&zi[zi.length-1];or&&or.indexOf("-")&&(Li=or.split("-"));const tn=Li?Li[0]:null,Nn=Li?Li[1]:null,Wi=(Jt,Yr)=>{ps.send("video","JW player",Jt,Ai||It,Yr)};let mi=!1,jn=1;const si=[{event:"setupError",callback:({message:Jt})=>Wi("setupError",Jt)},{event:"autostartNotAllowed",callback:()=>Wi("autostartNotAllowed")},{event:"firstFrame",callback:()=>Wi("Play")},{event:"time",callback:({currentTime:Jt,duration:Yr})=>{Jt>10&&!mi&&(mi=!0,Wi("atTenSeconds")),Jt>jn*Yr/5&&(Wi("videoProgress",jn*20),jn++)}},{event:"pause",callback:()=>Wi("Pause")},{event:"complete",callback:()=>Wi("Finished")}];return kn(()=>(Au.import(`https://cdn.jwplayer.com/libraries/${Nn}.js`).then(()=>{let Jt=jwDefaults.key,Yr={autostart:!0,cast:{appid:"00000000"},controls:!1,displaydescription:Ir,displaytitle:Di,flashplayer:"//ssl.p.jwpcdn.com/player/v/8.8.4/jwplayer.flash.swf",height:"100%",key:Jt,mute:cn,ph:3,pid:Nn,playbackRateControls:!1,playlist:`//cdn.jwplayer.com/v2/media/${tn}?recommendations_playlist_id=irwrDqTZ`,preload:"auto",repeat:$i,stagevideo:!1,stretching:ln||"fill",width:"100%"},ua=jwplayer(Xn.current).setup(Yr);rt.current=ua;for(const Ar of si)jwplayer().on(Ar.event,Ar.callback)}),()=>{jwplayer(Xn.current).remove(),rt.current=null}),[Nn,tn,ln,cn,Gi,pi,$i,Di,Ir]),It?hn.createElement("div",{ref:Xn,dangerouslySetInnerHTML:{__html:""}}):hn.createElement("div",{className:"fill placeholder"},"Please add an embedURL")});function Pn({hostRef:bn,duration:rt,cover:It,stretch:ln,embedUrl:cn,autoplay:Gi,trackingName:pi,videoControls:$i,easing:Di="linear",playerScript:Ir,mediaId:Ai}){const[Xn,Li]=Da(Hr.hidden),zi=Hn(null),or=Hn(null),[tn,Nn]=Da(!0),{disabled:Wi}=ar(),mi=Hn(null);kn(()=>Dc({container:bn.current,content:zi.current,overlay:or.current,active:Li,duration:rt,easing:Di}),[rt,Di]),kn(()=>{Xn||(Nn(!0),mi.current=null)},[Xn]);const jn=Jt=>{Jt.stopPropagation(),mi.current&&mi.current.seek(0)},si=Jt=>{mi.current&&(Jt.stopPropagation(),mi.current.setMute(),Nn(!tn))};return kn(()=>{!mi.current||(Xn===Hr.showing?mi.current.play():mi.current.pause())},[Xn]),hn.createElement(dr,null,hn.createElement("div",{ref:zi,className:["fixedWrapper fill"].join(" ")},Wi||Xn?hn.createElement("div",{className:["contents fill"].join(" ")},hn.createElement(dr,null,$i&&hn.createElement(dr,null,hn.createElement("div",{className:"media-controls"},hn.createElement(Oa,{d:tn?"mute_icon":"audio_100_icon",onClick:si,className:"mediaIcon audioButton"}),hn.createElement(Oa,{d:"media_restart",onClick:jn,className:"mediaIcon restartButton"}),!1)),cn&&hn.createElement("div",{className:`${It?"fill":""} jw-wrapper`},hn.createElement("div",{className:"jw-container"},hn.createElement(En,{ref:mi,embedUrl:cn,stretch:ln,autoplay:!0,mute:!0}))),!cn&&hn.createElement("div",{className:"no-image fill row center-center"},hn.createElement("h3",null,"Please select a video")))):hn.createElement(dr,null)),hn.createElement("div",{className:"fill overlay",ref:or}))}}}}),Au.register("basic",["react","vev","animejs"],function(Ds){"use strict";var hn,Hn,kn,Sr,dr,Da,Tr,ar,Os,ps,Ns,Oa,ms,sn,Hr,kr,ta,yo,_o,Er;return{setters:[function(ei){hn=ei.useCallback,Hn=ei.useRef,kn=ei.useEffect,Sr=ei.default,dr=ei.Fragment,Da=ei.useState},function(ei){Tr=ei.useGlobalStore,ar=ei.Tracking,Os=ei.Link,ps=ei.Image,Ns=ei.Icon,Oa=ei.useHover,ms=ei.useVisible,sn=ei.useEditorState,Hr=ei.View,kr=ei.useRoute,ta=ei.useScrollTop,yo=ei.useViewport,_o=ei.useDevice},function(ei){Er=ei.default}],execute:function(){Ds({"external-link":Ya,frame:Fs,image:ti,shape:Za,w74dqar7:Lu,w75y8u1c:bo});var ei=Ds("circle",()=>!1);function Fl(En){var Pr,sr,bn;let Pn="";switch(En.mode){case 0:En.page!==""?Pn=((Pr=En==null?void 0:En.page)==null?void 0:Pr.title)||En.page:Pn="Unlinked page";break;case 1:if(En.widget){const{key:rt,name:It,page:ln,pageName:cn}=En.widget;Pn=It+", "+cn}else Pn="Unlinked page";break;case 2:Pn=(En==null?void 0:En.href)||"empty link";break;case 3:En.email!==""?Pn=En.email+"?subject"+En.subject:Pn="empty email: ";break;case 4:Pn=En.phone||"empty phone";break;case 5:((sr=En==null?void 0:En.file)==null?void 0:sr.url)!==""?Pn=(bn=En==null?void 0:En.file)==null?void 0:bn.url:Pn="empty phone: ";break}return Pn}function Ya({link:En,children:Pn,className:Pr}){const sr=Tr(rt=>rt.pages),bn=hn(rt=>{ar.send("vev","link-button","click",Fl(En))},[En,sr]);return ca.createElement(Os,{onClick:bn,className:Pr,to:En},Pn)}function Fs(){return null}function ti(En){return En.section&&(En.className="section"),ca.createElement(ps,Object.assign({},En))}var jr=Ds("rectangle",()=>null),$o=Ds("section",()=>ca.createElement("div",{className:"children __sc"}));function Za({shapeId:En,stretch:Pn}){return ca.createElement(Ns,{d:En,stretch:Pn})}var Na=Ds("text",({text:En})=>ca.createElement("div",{className:"__stagger",id:"",dangerouslySetInnerHTML:{__html:En}}));function Ic(En){const Pn=En.split("/");return Pn[Pn.length-1].split(".")[0]}function Lu({hostRef:En,video:Pn,loop:Pr,infiniteLoop:sr,loopAmount:bn,mute:rt,controls:It,fill:ln,playOnHover:cn=!1,startVisible:Gi,noContextMenu:pi,noTracking:$i,thumbnail:Di,preload:Ir,section:Ai}){const Xn=Hn(),Li=Hn({current:0,maxProgress:0}),[zi,or]=Oa(),tn=ms(Xn),{disabled:Nn}=sn(),Wi=Hn(1);let mi=1;kn(()=>{const Jt=Xn.current;if(console.log("visible: ",tn),$i||!Jt||!Pn)return;const Yr=["play","pause","ended","timeupdate"],ua=Ar=>{const Fa=Xn.current;if(!Fa)return;const gs=(Pn==null?void 0:Pn.name)||Ic(Pn.sources[0].url)||"";switch(Ar.type){case"timeupdate":const Bl=Math.round(100*Fa.currentTime/Fa.duration),wo={current:Bl,maxProgress:Math.max(Bl,Li.current.maxProgress)};Bl>Li.current.maxProgress&&xo("Video Progress",gs,Li.current.maxProgress),Fa.currentTime>mi*Fa.duration/5&&(xo(`Video Progress ${mi*20}`,gs),mi++),Li.current.current=wo.current,Li.current.maxProgress=wo.maxProgress;break;case"play":return xo("Play",gs);case"pause":return xo("Pause",gs,Li.current.current);case"ended":return xo("Finished",gs)}};return Yr.forEach(Ar=>Jt&&Jt.addEventListener(Ar,ua,!1)),()=>Yr.forEach(Ar=>Jt&&Jt.removeEventListener(Ar,ua))},[Pn,$i,tn]),kn(()=>{const Jt=Xn.current;!Jt||(Nn?(Wi.current=1,Jt.load(),Jt.pause()):Jt.readyState>=3&&(tn?tn&&Gi&&(Jt.muted=!0,Jt.play(),setTimeout(()=>Jt.play(),100)):(Jt.pause(),Wi.current=1)))},[tn,Gi,Nn,Pn]);const jn={};sr&&Pr&&(jn.loop=!0),Gi&&(jn.autoPlay=!0),rt&&(jn.muted=!0),It&&(jn.controls=!0),Hr.isIE&&(jn.className="ie"),kn(()=>{const Jt=Xn.current;cn&&Jt&&(zi?Jt.play():Jt.pause())},[cn,zi]),kn(()=>{const Jt=Xn.current;!Jt||(Jt.style.objectFit=ln?"cover":"contain")},[ln,Xn.current]);const si=()=>{Wi.current<bn&&(Xn.current.currentTime=0,Xn.current.play(),Wi.current++)};return kn(()=>{if(Xn.current)return Xn.current.addEventListener("ended",si),()=>{Xn.current&&Xn.current.removeEventListener("ended",si)}},[Xn.current,bn]),Ai&&(jn.className=(jn.className||"")+" section"),Sr.createElement(dr,null,!Pn&&Sr.createElement("div",{className:"fill row v-center h-center",style:{color:"white"}},Sr.createElement("h3",null,"Double-click to select video")),Sr.createElement("video",Object.assign({},or,{ref:Xn,onContextMenu:Jt=>pi&&Jt.preventDefault(),"aria-label":(Pn==null?void 0:Pn.name)||"",full:!0,playsInline:!0,disableRemotePlayback:!0,poster:Di&&Di.url?Di.url:Pn&&Pn.thumbnail,preload:Ir},jn),Pn&&Pn.sources&&Pn.sources.sort(Jt=>Jt.format==="video/webm"?-1:1).map(Jt=>Sr.createElement("source",{key:Jt.url,src:Jt.url,type:Jt.format||"video/mp4"})),"Your browser does not support this video"),Sr.createElement("div",{className:"overlay"}))}function xo(En,Pn,Pr,sr){ar.send("video","HTML5 Video",En,Pn,Pr,sr)}const Dc={opacity:0};function bo({className:En,children:Pn,cont:Pr,hostRef:sr}){const bn=ms(sr),rt=Hn(null),It=Hn(null),ln=Hn(null),cn=Hn(null),[Gi,pi]=Oa(),[$i,Di]=Da(!1),{pageKey:Ir}=kr(),{disabled:Ai,selected:Xn}=sn(),Li=ta(),{height:zi}=yo(),or=_o(),tn=Pr&&Pr[or]&&Pr[or].params||{},Nn=Hn({ClickAnimation:null,HoverAnimation:null,ScrollAnimation:null,LoadAnimation:null}),Wi=Hn(null),mi=Hn(Ir);kn(()=>{rt.current&&(rt.current.style.opacity=null)}),kn(()=>{Ai||wo(),Nn.current.ScrollAnimation&&tn.ScrollAnimation&&ua(tn.ScrollAnimation);const wt=Ul();return()=>{wt.widget&&Er.remove(wt.widget),wt.stagger&&Er.remove(wt.stagger),wt.animation&&Er.remove(wt.animation)}},[]),kn(()=>{!tn||Wi&&tn.updated&&Wi.current===tn.updated||(Wi.current=tn.updated,Object.keys(Nn.current).forEach(wt=>Jt(wt)),wo(),Ai&&Xn?si(tn.trigger+"Animation"):ln.current!==or&&(si(tn.trigger+"Animation"),ln.current=or))},[tn]),kn(()=>{!tn||(Object.keys(Nn.current).forEach(wt=>Jt(wt)),Ai||wo(),Nn.current.LoadAnimation&&bn&&si("LoadAnimation"),Nn.current.ScrollAnimation&&bn&&!Ai&&ua(tn.ScrollAnimation),Ai&&$i&&Di(!1))},[Ai,or]),kn(()=>{!tn||(Ai&&Xn?si(tn.trigger+["Animation"]):Ai&&!Xn&&Jt(tn.trigger+["Animation"]))},[Xn]),kn(()=>{!tn||!Nn.current.LoadAnimation||(bn?si("LoadAnimation"):tn.LoadAnimation.once||Jt("LoadAnimation"))},[bn]),kn(()=>{!tn||!Nn.current.HoverAnimation||si("HoverAnimation",!Gi)},[Gi]),kn(()=>{!tn||!Nn.current.ScrollAnimation||Ai||ua(tn.ScrollAnimation)},[Li]),kn(()=>{!tn||!Nn.current.ClickAnimation||si("ClickAnimation",!$i)},[$i]),kn(()=>{var wt;((wt=tn==null?void 0:tn.HoverAnimation)==null?void 0:wt.triggers)&&Ir!==mi.current&&(Ar("HoverAnimation",tn.HoverAnimation.triggers),mi.current=Ir)},[Ir,tn]);const jn=wt=>{if(!tn[wt])return;const Et=tn[wt],Vn=Er.timeline({autoplay:!1,delay:Gd(tn[wt])}),Oi=Ul();let Rn={targets:Et.stagger?Oi.stagger:Oi==null?void 0:Oi.animation,easing:Et.easing||"linear"},Dr={targets:Et.stagger?Oi.stagger:Oi==null?void 0:Oi.widget,easing:Et.easing||"linear"};Dr.duration=Rn.duration=Et.duration?Math.max(Et.duration,1e-4)*1e3:1e3,Et.opacity&&(Rn.opacity=Et.opacity),Et.scale&&(Rn.scale=Et.scale),Et.move&&Et.move[0]!=="0px"&&(Rn.translateY=Et.move[0]),Et.move&&Et.move[1]!=="0px"&&(Rn.translateX=Et.move[1]),Et.translateX&&(Rn.translateX=[Et.translateX[0],Et.translateX[1]]),Et.translateY&&(Rn.translateY=[Et.translateY[0],Et.translateY[1]]),Et.rotate&&(Rn.rotate=[0,Et.rotate]),Rn.rotate3d=[],Et.color&&(Dr.color=Ru(Et.color)),Et.background&&(Dr.backgroundColor=Ru(Et.background)),Et.border&&(Dr["border-radius"]=[Et.border[0],Et.border[1]]),(Et.color||Et.background||Et.border)&&Vn.add({...Dr}),Vn.add({...Rn}),Nn.current[wt]=Vn,Et.triggers&&Object.keys(Et.triggers).length&&setTimeout(()=>Ar(wt,Et.triggers),100),Ai&&!Xn&&Cu()},si=(wt,Et)=>{const Vn=Nn.current[wt];Ai&&!Xn||!Vn||Vn.began&&!Vn.complete&&Et===void 0||(tn[wt]&&tn[wt].loop&&(Vn.complete=()=>{Vn.reverse(),Vn.completed=!1,Vn.play()}),Gl(Vn,Et)&&(Vn.began&&Vn.pause(),Et!==void 0&&Vn.reversed!==Et&&(Vn.reverse(),Vn.completed=!1),Vn.play()))},Jt=wt=>{if(!!Nn.current[wt]){if(!tn[wt])return Yr(wt);Nn.current[wt].pause(),Nn.current[wt].reversed&&Nn.current[wt].reverse(),Nn.current[wt].seek(0),Nn.current[wt].complete=null,Nn.current[wt].began=!1,wt==="HoverAnimation"&&(It.current&&gs(),Qo(wt)&&Ar(wt,tn[wt].triggers)),wt==="ClickAnimation"&&(cn.current&&Bl(),Qo(wt)&&Ar(wt,tn[wt].triggers)),Ai&&Cu()}},Yr=wt=>{Nn.current[wt].pause(),Nn.current[wt].seek(0),Nn.current[wt]=null;const Et=Ul();Et!=null&&Et.widget&&Er.remove(Et==null?void 0:Et.widget),Et!=null&&Et.stagger&&Er.remove(Et==null?void 0:Et.stagger),Et!=null&&Et.animation&&Er.remove(Et==null?void 0:Et.animation),Cu()},ua=wt=>{if(!wt)return;const Et=Nn.current.ScrollAnimation,Vn=wt.scrollOffsetStart?wt.scrollOffsetStart:0,Oi=wt.scrollOffsetEnd?wt.scrollOffsetEnd:0;let Rn;sr.current.classList.contains("__f")||sr.current.classList.contains("__pp")?Rn=(Li+Vn)/(zi-Oi+Vn):(Rn=rf(wt.event,Vn,Oi),Rn=Et.duration/1e3-Rn);let Dr=Et.duration*Rn;Dr<0&&bn&&(Dr=.01),Et.seek(Dr)},Ar=hn((wt,Et)=>{const Vn=[],Oi=[];Object.values(Et).forEach(Rn=>{const Dr=sr.current.getRootNode().getElementById((Rn==null?void 0:Rn.key)||Rn);Dr&&(wt==="ClickAnimation"?(Dr.addEventListener("click",Fa),Dr.style.cursor="pointer",Oi.push(Dr)):wt==="HoverAnimation"&&(Dr.addEventListener("mouseenter",pi.onMouseEnter),Dr.addEventListener("mouseleave",pi.onMouseLeave),Vn.push(Dr)))}),It.current=Vn,cn.current=Oi},[sr,It,cn]),Fa=()=>{const wt=Nn.current.ClickAnimation;if(!wt.began)return wt.play();wt.reverse(),wt.completed=!1,wt.began=!1,wt.play()},gs=()=>{It.current&&It.current.forEach(wt=>{wt.removeEventListener("mouseleave",pi.onMouseLeave),wt.removeEventListener("mouseenter",pi.onMouseEnter)})},Bl=()=>{cn.current&&cn.current.forEach(wt=>{wt.removeEventListener("click",Fa),wt.style.cursor=null})},wo=()=>{!tn||Object.keys(Nn.current).forEach(wt=>tn[wt]&&jn(wt))},Qo=wt=>!(!tn||!tn[wt]||!tn[wt].triggers||!Object.keys(tn[wt].triggers).length),Cu=()=>{if(!sr.current)return;const wt=Ul();wt.animation&&wt.animation.removeAttribute("style"),wt.widget&&wt.widget.removeAttribute("style"),wt.stagger&&[].forEach.call(wt.stagger,Et=>Et&&Et.removeAttribute("style"))},Gd=wt=>{const Et=Math.max(wt.delay,0);return wt.stagger?Er.stagger(wt.stagger[0]*1e3,{start:Et*1e3,from:wt.stagger[1]}):Et*1e3},rf=(wt,Et,Vn)=>{const Oi=sr.current.getBoundingClientRect(),Rn=Math.abs(zi-Vn<Oi.height?Vn+(zi-Vn-Oi.height):Vn);if(wt==="bot")return(Oi.bottom-Oi.height-Rn)/(zi-Oi.height+Et-Rn);if(wt==="top")return(Oi.top-Vn)/(Oi.height+Et-Vn);if(wt==="mid")return(Oi.top-Vn)/((zi-Oi.height)/2+Et-Vn)},Ul=()=>{if(!sr.current)return;let wt,Et,Vn;if(wt=sr.current.querySelector(".__wc"),!!wt)return Et=wt&&wt.querySelector("w"),Vn=sr.current.classList.contains("__text")?wt.querySelectorAll("w div > *"):wt.querySelectorAll(".__c vev .__wc w:not(.frame)"),{animation:wt,widget:Et,stagger:Vn}},Gl=(wt,Et)=>!(Et&&wt.currentTime===0||Et===!1&&wt.currentTime===wt.duration);let na;return!Ai&&tn&&(tn.LoadAnimation||tn.ScrollAnimation)&&(na=Dc),ca.createElement("div",{className:En,style:na,onClick:!Qo("ClickAnimation")&&(()=>Di(!$i)),onMouseEnter:!Qo("HoverAnimation")&&pi.onMouseEnter,onMouseLeave:!Qo("HoverAnimation")&&pi.onMouseLeave,ref:rt},Pn)}const Ru=En=>`rgba(${[En.r,En.g,En.b,En.a].toString()}`}}}),Au.register("pvsV8E2ti0I",["react","vev"],function(Ds){"use strict";var hn,Hn,kn;return{setters:[function(Sr){hn=Sr.useRef,Hn=Sr.useEffect},function(Sr){kn=Sr.Tracking}],execute:function(){Ds("wc45KniHAN",Sr);function Sr({embedUrl:dr,hostRef:Da,mute:Tr,autoplay:ar,stretch:Os,controls:ps,displayTitle:Ns,displayDescription:Oa,repeat:ms,trackingName:sn}){const Hr=hn(null);let kr,ta=dr&&dr.replace(/(^\w+:|^)\/\//,"").replace(/(\.html|\.js)/,"").split("/"),yo=ta&&ta[ta.length-1];yo&&yo.indexOf("-")&&(kr=yo.split("-"));const _o=kr?kr[0]:null,Er=kr?kr[1]:null,ei=(ti,jr)=>{kn.send("video","JW player",ti,sn||dr,jr)};let Fl=!1,Ya=1;const Fs=[{event:"setupError",callback:({message:ti})=>ei("setupError",ti)},{event:"autostartNotAllowed",callback:()=>ei("autostartNotAllowed")},{event:"firstFrame",callback:()=>ei("Play")},{event:"time",callback:({currentTime:ti,duration:jr})=>{ti>10&&!Fl&&(Fl=!0,ei("atTenSeconds")),ti>Ya*jr/5&&(ei("videoProgress",Ya*20),Ya++)}},{event:"pause",callback:()=>ei("Pause")},{event:"complete",callback:()=>ei("Finished")}];return Hn(()=>{Au.import(`https://cdn.jwplayer.com/libraries/${Er}.js`).then(()=>{let ti=jwDefaults.key,jr={aspectratio:"16:9",autostart:ar&&"viewable",cast:{appid:"00000000"},controls:!!ps,displaydescription:Oa,displaytitle:Ns,flashplayer:"//ssl.p.jwpcdn.com/player/v/8.8.4/jwplayer.flash.swf",height:360,key:ti,mute:Tr,ph:3,pid:Er,playbackRateControls:!1,playlist:`//cdn.jwplayer.com/v2/media/${_o}?recommendations_playlist_id=irwrDqTZ`,preload:"metadata",repeat:ms,stagevideo:!1,stretching:Os,width:"100%"};Hr.current.innerHTML="";let $o=document.createElement("div");$o.className="jwcontainer fill",Hr.current.appendChild($o);let Za=Da.current.querySelector(".jwcontainer");jwplayer(Za).setup(jr);for(const Na of Fs)jwplayer().on(Na.event,Na.callback)})},[Er,_o,Os,Tr,ar,ps,ms,Ns,Oa]),dr?ca.createElement("div",{className:"fill video",ref:Hr,dangerouslySetInnerHTML:{__html:""}}):ca.createElement("div",{className:"fill placeholder"},"Please add an embedURL")}}}}),Au.register("DFkMApDq9I",["react","vev"],function(Ds){"use strict";var hn,Hn,kn,Sr,dr,Da,Tr;return{setters:[function(ar){hn=ar.useRef,Hn=ar.useState,kn=ar.useEffect,Sr=ar.useCallback,dr=ar.Fragment},function(ar){Da=ar.useEditorState,Tr=ar.useSize}],execute:function(){Ds("threeModel",pA);var ar=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Os(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ps(r,i){return i={exports:{}},r(i,i.exports),i.exports}var Ns=ps(function(r,i){(function(n,l){l(i)})(ar,function(n){function l(ae,v){ae.prototype=Object.create(v.prototype),ae.prototype.constructor=ae,ae.__proto__=v}function u(ae){if(ae===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae}/*!
 * GSAP 3.8.0
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var h={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},p={duration:.5,overwrite:!1,delay:0},g,_=1e8,b=1/_,A=Math.PI*2,S=A/4,R=0,E=Math.sqrt,N=Math.cos,W=Math.sin,V=function(v){return typeof v=="string"},B=function(v){return typeof v=="function"},O=function(v){return typeof v=="number"},pe=function(v){return typeof v>"u"},ge=function(v){return typeof v=="object"},ye=function(v){return v!==!1},$=function(){return typeof window<"u"},Ie=function(v){return B(v)||V(v)},tt=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},qe=Array.isArray,ft=/(?:-?\.?\d|\.)+/gi,je=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ne=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ue=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Le=/[+-]=-?[.\d]+/,Te=/[^,'"\[\]\s]+/gi,Ve=/[\d.+\-=]+(?:e[-+]\d*)*/i,We,at,Tt,nt,At={},nn={},Yt,K=function(v){return(nn=gn(v,At))&&Ha},H=function(v,x){return console.warn("Invalid property",v,"set to",x,"Missing plugin? gsap.registerPlugin()")},xe=function(v,x){return!x&&console.warn(v)},te=function(v,x){return v&&(At[v]=x)&&nn&&(nn[v]=x)||At},de=function(){return 0},be={},Re=[],we={},Se,Pe={},ze={},Ze=30,Xe=[],Q="",Y=function(v){var x=v[0],T,L;if(ge(x)||B(x)||(v=[v]),!(T=(x._gsap||{}).harness)){for(L=Xe.length;L--&&!Xe[L].targetTest(x););T=Xe[L]}for(L=v.length;L--;)v[L]&&(v[L]._gsap||(v[L]._gsap=new Kc(v[L],T)))||v.splice(L,1);return v},He=function(v){return v._gsap||Y(br(v))[0]._gsap},Ge=function(v,x,T){return(T=v[x])&&B(T)?v[x]():pe(T)&&v.getAttribute&&v.getAttribute(x)||T},ue=function(v,x){return(v=v.split(",")).forEach(x)||v},Je=function(v){return Math.round(v*1e5)/1e5||0},ct=function(v){return Math.round(v*1e7)/1e7||0},Ft=function(v,x){for(var T=x.length,L=0;v.indexOf(x[L])<0&&++L<T;);return L<T},ut=function(){var v=Re.length,x=Re.slice(0),T,L;for(we={},Re.length=0,T=0;T<v;T++)L=x[T],L&&L._lazy&&(L.render(L._lazy[0],L._lazy[1],!0)._lazy=0)},me=function(v,x,T,L){Re.length&&ut(),v.render(x,T,L),Re.length&&ut()},it=function(v){var x=parseFloat(v);return(x||x===0)&&(v+"").match(Te).length<2?x:V(v)?v.trim():v},Rt=function(v){return v},mt=function(v,x){for(var T in x)T in v||(v[T]=x[T]);return v},Nt=function(v,x){for(var T in x)T in v||T==="duration"||T==="ease"||(v[T]=x[T])},gn=function(v,x){for(var T in x)v[T]=x[T];return v},gi=function ae(v,x){for(var T in x)T!=="__proto__"&&T!=="constructor"&&T!=="prototype"&&(v[T]=ge(x[T])?ae(v[T]||(v[T]={}),x[T]):x[T]);return v},Or=function(v,x){var T={},L;for(L in v)L in x||(T[L]=v[L]);return T},er=function(v){var x=v.parent||We,T=v.keyframes?Nt:mt;if(ye(v.inherit))for(;x;)T(v,x.vars.defaults),x=x.parent||x._dp;return v},Vr=function(v,x){for(var T=v.length,L=T===x.length;L&&T--&&v[T]===x[T];);return T<0},Ys=function(v,x,T,L,U){T===void 0&&(T="_first"),L===void 0&&(L="_last");var z=v[L],k;if(U)for(k=x[U];z&&z[U]>k;)z=z._prev;return z?(x._next=z._next,z._next=x):(x._next=v[T],v[T]=x),x._next?x._next._prev=x:v[L]=x,x._prev=z,x.parent=x._dp=v,x},ma=function(v,x,T,L){T===void 0&&(T="_first"),L===void 0&&(L="_last");var U=x._prev,z=x._next;U?U._next=z:v[T]===x&&(v[T]=z),z?z._prev=U:v[L]===x&&(v[L]=U),x._next=x._prev=x.parent=null},ji=function(v,x){v.parent&&(!x||v.parent.autoRemoveChildren)&&v.parent.remove(v),v._act=0},Ci=function(v,x){if(v&&(!x||x._end>v._dur||x._start<0))for(var T=v;T;)T._dirty=1,T=T.parent;return v},ns=function(v){for(var x=v.parent;x&&x.parent;)x._dirty=1,x.totalDuration(),x=x.parent;return v},ga=function ae(v){return!v||v._ts&&ae(v.parent)},bs=function(v){return v._repeat?mr(v._tTime,v=v.duration()+v._rDelay)*v:0},mr=function(v,x){var T=Math.floor(v/=x);return v&&T===v?T-1:T},va=function(v,x){return(v-x._start)*x._ts+(x._ts>=0?0:x._dirty?x.totalDuration():x._tDur)},Ea=function(v){return v._end=ct(v._start+(v._tDur/Math.abs(v._ts||v._rts||b)||0))},is=function(v,x){var T=v._dp;return T&&T.smoothChildTiming&&v._ts&&(v._start=ct(T._time-(v._ts>0?x/v._ts:((v._dirty?v.totalDuration():v._tDur)-x)/-v._ts)),Ea(v),T._dirty||Ci(T,v)),v},re=function(v,x){var T;if((x._time||x._initted&&!x._dur)&&(T=va(v.rawTime(),x),(!x._dur||li(0,x.totalDuration(),T)-x._tTime>b)&&x.render(T,!0)),Ci(v,x)._dp&&v._initted&&v._time>=v._dur&&v._ts){if(v._dur<v.duration())for(T=v;T._dp;)T.rawTime()>=0&&T.totalTime(T._tTime),T=T._dp;v._zTime=-b}},$e=function(v,x,T,L){return x.parent&&ji(x),x._start=ct((O(T)?T:T||v!==We?on(v,T,x):v._time)+x._delay),x._end=ct(x._start+(x.totalDuration()/Math.abs(x.timeScale())||0)),Ys(v,x,"_first","_last",v._sort?"_start":0),Cn(x)||(v._recent=x),L||re(v,x),v},Ke=function(v,x){return(At.ScrollTrigger||H("scrollTrigger",x))&&At.ScrollTrigger.create(x,v)},ht=function(v,x,T,L){if(vl(v,x),!v._initted)return 1;if(!T&&v._pt&&(v._dur&&v.vars.lazy!==!1||!v._dur&&v.vars.lazy)&&Se!==La.frame)return Re.push(v),v._lazy=[x,L],1},Bt=function ae(v){var x=v.parent;return x&&x._ts&&x._initted&&!x._lock&&(x.rawTime()<0||ae(x))},Cn=function(v){var x=v.data;return x==="isFromStart"||x==="isStart"},In=function(v,x,T,L){var U=v.ratio,z=x<0||!x&&(!v._start&&Bt(v)&&!(!v._initted&&Cn(v))||(v._ts<0||v._dp._ts<0)&&!Cn(v))?0:1,k=v._rDelay,le=0,ve,fe,Ye;if(k&&v._repeat&&(le=li(0,v._tDur,x),fe=mr(le,k),Ye=mr(v._tTime,k),v._yoyo&&fe&1&&(z=1-z),fe!==Ye&&(U=1-z,v.vars.repeatRefresh&&v._initted&&v.invalidate())),z!==U||L||v._zTime===b||!x&&v._zTime){if(!v._initted&&ht(v,x,L,T))return;for(Ye=v._zTime,v._zTime=x||(T?b:0),T||(T=x&&!Ye),v.ratio=z,v._from&&(z=1-z),v._time=0,v._tTime=le,ve=v._pt;ve;)ve.r(z,ve.d),ve=ve._next;v._startAt&&x<0&&v._startAt.render(x,!0,!0),v._onUpdate&&!T&&Aa(v,"onUpdate"),le&&v._repeat&&!T&&v.parent&&Aa(v,"onRepeat"),(x>=v._tDur||x<0)&&v.ratio===z&&(z&&ji(v,1),T||(Aa(v,z?"onComplete":"onReverseComplete",!0),v._prom&&v._prom()))}else v._zTime||(v._zTime=x)},Yn=function(v,x,T){var L;if(T>x)for(L=v._first;L&&L._start<=T;){if(!L._dur&&L.data==="isPause"&&L._start>x)return L;L=L._next}else for(L=v._last;L&&L._start>=T;){if(!L._dur&&L.data==="isPause"&&L._start<x)return L;L=L._prev}},An=function(v,x,T,L){var U=v._repeat,z=ct(x)||0,k=v._tTime/v._tDur;return k&&!L&&(v._time*=z/v._dur),v._dur=z,v._tDur=U?U<0?1e10:ct(z*(U+1)+v._rDelay*U):z,k&&!L?is(v,v._tTime=v._tDur*k):v.parent&&Ea(v),T||Ci(v.parent,v),v},Yi=function(v){return v instanceof qr?Ci(v):An(v,v._dur)},Zi={_start:0,endTime:de,totalDuration:de},on=function ae(v,x,T){var L=v.labels,U=v._recent||Zi,z=v.duration()>=_?U.endTime(!1):v._dur,k,le,ve;return V(x)&&(isNaN(x)||x in L)?(le=x.charAt(0),ve=x.substr(-1)==="%",k=x.indexOf("="),le==="<"||le===">"?(k>=0&&(x=x.replace(/=/,"")),(le==="<"?U._start:U.endTime(U._repeat>=0))+(parseFloat(x.substr(1))||0)*(ve?(k<0?U:T).totalDuration()/100:1)):k<0?(x in L||(L[x]=z),L[x]):(le=parseFloat(x.charAt(k-1)+x.substr(k+1)),ve&&T&&(le=le/100*(qe(T)?T[0]:T).totalDuration()),k>1?ae(v,x.substr(0,k-1),T)+le:z+le)):x==null?z:+x},oi=function(v,x,T){var L=O(x[1]),U=(L?2:1)+(v<2?0:1),z=x[U],k,le;if(L&&(z.duration=x[1]),z.parent=T,v){for(k=z,le=T;le&&!("immediateRender"in k);)k=le.vars.defaults||{},le=ye(le.vars.inherit)&&le.parent;z.immediateRender=ye(k.immediateRender),v<2?z.runBackwards=1:z.startAt=x[U-1]}return new ki(x[0],z,x[U+1])},xr=function(v,x){return v||v===0?x(v):x},li=function(v,x,T){return T<v?v:T>x?x:T},tr=function(v){if(typeof v!="string")return"";var x=Ve.exec(v);return x?v.substr(x.index+x[0].length):""},cr=function(v,x,T){return xr(T,function(L){return li(v,x,L)})},Zs=[].slice,Lr=function(v,x){return v&&ge(v)&&"length"in v&&(!x&&!v.length||v.length-1 in v&&ge(v[0]))&&!v.nodeType&&v!==at},Js=function(v,x,T){return T===void 0&&(T=[]),v.forEach(function(L){var U;return V(L)&&!x||Lr(L,1)?(U=T).push.apply(U,br(L)):T.push(L)})||T},br=function(v,x,T){return V(v)&&!T&&(Tt||!pl())?Zs.call((x||nt).querySelectorAll(v),0):qe(v)?Js(v,T):Lr(v)?Zs.call(v,0):v?[v]:[]},Ks=function(v){return v=br(v)[0]||xe("Invalid scope")||{},function(x){var T=v.current||v.nativeElement||v;return br(x,T.querySelectorAll?T:T===v?xe("Invalid scope")||nt.createElement("div"):v)}},vh=function(v){return v.sort(function(){return .5-Math.random()})},Hf=function(v){if(B(v))return v;var x=ge(v)?v:{each:v},T=Qs(x.ease),L=x.from||0,U=parseFloat(x.base)||0,z={},k=L>0&&L<1,le=isNaN(L)||k,ve=x.axis,fe=L,Ye=L;return V(L)?fe=Ye={center:.5,edges:.5,end:1}[L]||0:!k&&le&&(fe=L[0],Ye=L[1]),function(ke,Ae,yt){var Fe=(yt||x).length,_t=z[Fe],Mt,Gt,Dt,jt,Pt,Ot,Vt,Zt,zt;if(!_t){if(zt=x.grid==="auto"?0:(x.grid||[1,_])[1],!zt){for(Vt=-_;Vt<(Vt=yt[zt++].getBoundingClientRect().left)&&zt<Fe;);zt--}for(_t=z[Fe]=[],Mt=le?Math.min(zt,Fe)*fe-.5:L%zt,Gt=le?Fe*Ye/zt-.5:L/zt|0,Vt=0,Zt=_,Ot=0;Ot<Fe;Ot++)Dt=Ot%zt-Mt,jt=Gt-(Ot/zt|0),_t[Ot]=Pt=ve?Math.abs(ve==="y"?jt:Dt):E(Dt*Dt+jt*jt),Pt>Vt&&(Vt=Pt),Pt<Zt&&(Zt=Pt);L==="random"&&vh(_t),_t.max=Vt-Zt,_t.min=Zt,_t.v=Fe=(parseFloat(x.amount)||parseFloat(x.each)*(zt>Fe?Fe-1:ve?ve==="y"?Fe/zt:zt:Math.max(zt,Fe/zt))||0)*(L==="edges"?-1:1),_t.b=Fe<0?U-Fe:U,_t.u=tr(x.amount||x.each)||0,T=T&&Fe<0?Do(T):T}return Fe=(_t[ke]-_t.min)/_t.max||0,ct(_t.b+(T?T(Fe):Fe)*_t.v)+_t.u}},yh=function(v){var x=Math.pow(10,((v+"").split(".")[1]||"").length);return function(T){var L=Math.round(parseFloat(T)/v)*v*x;return(L-L%1)/x+(O(T)?0:tr(T))}},kf=function(v,x){var T=qe(v),L,U;return!T&&ge(v)&&(L=T=v.radius||_,v.values?(v=br(v.values),(U=!O(v[0]))&&(L*=L)):v=yh(v.increment)),xr(x,T?B(v)?function(z){return U=v(z),Math.abs(U-z)<=L?U:z}:function(z){for(var k=parseFloat(U?z.x:z),le=parseFloat(U?z.y:0),ve=_,fe=0,Ye=v.length,ke,Ae;Ye--;)U?(ke=v[Ye].x-k,Ae=v[Ye].y-le,ke=ke*ke+Ae*Ae):ke=Math.abs(v[Ye]-k),ke<ve&&(ve=ke,fe=Ye);return fe=!L||ve<=L?v[fe]:z,U||fe===z||O(z)?fe:fe+tr(z)}:yh(v))},Vf=function(v,x,T,L){return xr(qe(v)?!x:T===!0?!!(T=0):!L,function(){return qe(v)?v[~~(Math.random()*v.length)]:(T=T||1e-5)&&(L=T<1?Math.pow(10,(T+"").length-2):1)&&Math.floor(Math.round((v-T/2+Math.random()*(x-v+T*.99))/T)*T*L)/L})},Up=function(){for(var v=arguments.length,x=new Array(v),T=0;T<v;T++)x[T]=arguments[T];return function(L){return x.reduce(function(U,z){return z(U)},L)}},Gp=function(v,x){return function(T){return v(parseFloat(T))+(x||tr(T))}},zp=function(v,x,T){return qf(v,x,0,1,T)},Wf=function(v,x,T){return xr(T,function(L){return v[~~x(L)]})},Hp=function ae(v,x,T){var L=x-v;return qe(v)?Wf(v,ae(0,v.length),x):xr(T,function(U){return(L+(U-v)%L)%L+v})},kp=function ae(v,x,T){var L=x-v,U=L*2;return qe(v)?Wf(v,ae(0,v.length-1),x):xr(T,function(z){return z=(U+(z-v)%U)%U||0,v+(z>L?U-z:z)})},nc=function(v){for(var x=0,T="",L,U,z,k;~(L=v.indexOf("random(",x));)z=v.indexOf(")",L),k=v.charAt(L+7)==="[",U=v.substr(L+7,z-L-7).match(k?Te:ft),T+=v.substr(x,L-x)+Vf(k?U:+U[0],k?0:+U[1],+U[2]||1e-5),x=z+1;return T+v.substr(x,v.length-x)},qf=function(v,x,T,L,U){var z=x-v,k=L-T;return xr(U,function(le){return T+((le-v)/z*k||0)})},Vp=function ae(v,x,T,L){var U=isNaN(v+x)?0:function(Ae){return(1-Ae)*v+Ae*x};if(!U){var z=V(v),k={},le,ve,fe,Ye,ke;if(T===!0&&(L=1)&&(T=null),z)v={p:v},x={p:x};else if(qe(v)&&!qe(x)){for(fe=[],Ye=v.length,ke=Ye-2,ve=1;ve<Ye;ve++)fe.push(ae(v[ve-1],v[ve]));Ye--,U=function(yt){yt*=Ye;var Fe=Math.min(ke,~~yt);return fe[Fe](yt-Fe)},T=x}else L||(v=gn(qe(v)?[]:{},v));if(!fe){for(le in x)$c.call(k,v,le,"get",x[le]);U=function(yt){return en(yt,k)||(z?v.p:v)}}}return xr(T,U)},Xf=function(v,x,T){var L=v.labels,U=_,z,k,le;for(z in L)k=L[z]-x,k<0==!!T&&k&&U>(k=Math.abs(k))&&(le=z,U=k);return le},Aa=function(v,x,T){var L=v.vars,U=L[x],z,k;if(!!U)return z=L[x+"Params"],k=L.callbackScope||v,T&&Re.length&&ut(),z?U.apply(k,z):U.call(k)},ic=function(v){return ji(v),v.scrollTrigger&&v.scrollTrigger.kill(!1),v.progress()<1&&Aa(v,"onInterrupt"),v},dl,Wp=function(v){v=!v.name&&v.default||v;var x=v.name,T=B(v),L=x&&!T&&v.init?function(){this._props=[]}:v,U={init:de,render:en,add:$c,kill:xt,modifier:oc,rawVars:0},z={targetTest:0,get:0,getSetter:sc,aliases:{},register:0};if(pl(),v!==L){if(Pe[x])return;mt(L,mt(Or(v,U),z)),gn(L.prototype,gn(U,Or(v,z))),Pe[L.prop=x]=L,v.targetTest&&(Xe.push(L),be[x]=1),x=(x==="css"?"CSS":x.charAt(0).toUpperCase()+x.substr(1))+"Plugin"}te(x,L),v.register&&v.register(Ha,L,gr)},Mi=255,rc={aqua:[0,Mi,Mi],lime:[0,Mi,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Mi],navy:[0,0,128],white:[Mi,Mi,Mi],olive:[128,128,0],yellow:[Mi,Mi,0],orange:[Mi,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Mi,0,0],pink:[Mi,192,203],cyan:[0,Mi,Mi],transparent:[Mi,Mi,Mi,0]},_h=function(v,x,T){return v=v<0?v+1:v>1?v-1:v,(v*6<1?x+(T-x)*v*6:v<.5?T:v*3<2?x+(T-x)*(2/3-v)*6:x)*Mi+.5|0},jf=function(v,x,T){var L=v?O(v)?[v>>16,v>>8&Mi,v&Mi]:0:rc.black,U,z,k,le,ve,fe,Ye,ke,Ae,yt;if(!L){if(v.substr(-1)===","&&(v=v.substr(0,v.length-1)),rc[v])L=rc[v];else if(v.charAt(0)==="#"){if(v.length<6&&(U=v.charAt(1),z=v.charAt(2),k=v.charAt(3),v="#"+U+U+z+z+k+k+(v.length===5?v.charAt(4)+v.charAt(4):"")),v.length===9)return L=parseInt(v.substr(1,6),16),[L>>16,L>>8&Mi,L&Mi,parseInt(v.substr(7),16)/255];v=parseInt(v.substr(1),16),L=[v>>16,v>>8&Mi,v&Mi]}else if(v.substr(0,3)==="hsl"){if(L=yt=v.match(ft),!x)le=+L[0]%360/360,ve=+L[1]/100,fe=+L[2]/100,z=fe<=.5?fe*(ve+1):fe+ve-fe*ve,U=fe*2-z,L.length>3&&(L[3]*=1),L[0]=_h(le+1/3,U,z),L[1]=_h(le,U,z),L[2]=_h(le-1/3,U,z);else if(~v.indexOf("="))return L=v.match(je),T&&L.length<4&&(L[3]=1),L}else L=v.match(ft)||rc.transparent;L=L.map(Number)}return x&&!yt&&(U=L[0]/Mi,z=L[1]/Mi,k=L[2]/Mi,Ye=Math.max(U,z,k),ke=Math.min(U,z,k),fe=(Ye+ke)/2,Ye===ke?le=ve=0:(Ae=Ye-ke,ve=fe>.5?Ae/(2-Ye-ke):Ae/(Ye+ke),le=Ye===U?(z-k)/Ae+(z<k?6:0):Ye===z?(k-U)/Ae+2:(U-z)/Ae+4,le*=60),L[0]=~~(le+.5),L[1]=~~(ve*100+.5),L[2]=~~(fe*100+.5)),T&&L.length<4&&(L[3]=1),L},Yf=function(v){var x=[],T=[],L=-1;return v.split($s).forEach(function(U){var z=U.match(Ne)||[];x.push.apply(x,z),T.push(L+=z.length+1)}),x.c=T,x},Zf=function(v,x,T){var L="",U=(v+L).match($s),z=x?"hsla(":"rgba(",k=0,le,ve,fe,Ye;if(!U)return v;if(U=U.map(function(ke){return(ke=jf(ke,x,1))&&z+(x?ke[0]+","+ke[1]+"%,"+ke[2]+"%,"+ke[3]:ke.join(","))+")"}),T&&(fe=Yf(v),le=T.c,le.join(L)!==fe.c.join(L)))for(ve=v.replace($s,"1").split(Ne),Ye=ve.length-1;k<Ye;k++)L+=ve[k]+(~le.indexOf(k)?U.shift()||z+"0,0,0,0)":(fe.length?fe:U.length?U:T).shift());if(!ve)for(ve=v.split($s),Ye=ve.length-1;k<Ye;k++)L+=ve[k]+U[k];return L+ve[Ye]},$s=function(){var ae="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",v;for(v in rc)ae+="|"+v+"\\b";return new RegExp(ae+")","gi")}(),qp=/hsl[a]?\(/,Jf=function(v){var x=v.join(" "),T;if($s.lastIndex=0,$s.test(x))return T=qp.test(x),v[1]=Zf(v[1],T),v[0]=Zf(v[0],T,Yf(v[1])),!0},Yc,La=function(){var ae=Date.now,v=500,x=33,T=ae(),L=T,U=1e3/240,z=U,k=[],le,ve,fe,Ye,ke,Ae,yt=function Fe(_t){var Mt=ae()-L,Gt=_t===!0,Dt,jt,Pt,Ot;if(Mt>v&&(T+=Mt-x),L+=Mt,Pt=L-T,Dt=Pt-z,(Dt>0||Gt)&&(Ot=++Ye.frame,ke=Pt-Ye.time*1e3,Ye.time=Pt=Pt/1e3,z+=Dt+(Dt>=U?4:U-Dt),jt=1),Gt||(le=ve(Fe)),jt)for(Ae=0;Ae<k.length;Ae++)k[Ae](Pt,ke,Ot,_t)};return Ye={time:0,frame:0,tick:function(){yt(!0)},deltaRatio:function(_t){return ke/(1e3/(_t||60))},wake:function(){Yt&&(!Tt&&$()&&(at=Tt=window,nt=at.document||{},At.gsap=Ha,(at.gsapVersions||(at.gsapVersions=[])).push(Ha.version),K(nn||at.GreenSockGlobals||!at.gsap&&at||{}),fe=at.requestAnimationFrame),le&&Ye.sleep(),ve=fe||function(_t){return setTimeout(_t,z-Ye.time*1e3+1|0)},Yc=1,yt(2))},sleep:function(){(fe?at.cancelAnimationFrame:clearTimeout)(le),Yc=0,ve=de},lagSmoothing:function(_t,Mt){v=_t||1/b,x=Math.min(Mt,v,0)},fps:function(_t){U=1e3/(_t||240),z=Ye.time*1e3+U},add:function(_t){k.indexOf(_t)<0&&k.push(_t),pl()},remove:function(_t){var Mt;~(Mt=k.indexOf(_t))&&k.splice(Mt,1)&&Ae>=Mt&&Ae--},_listeners:k},Ye}(),pl=function(){return!Yc&&La.wake()},ii={},Xp=/^[\d.\-M][\d.\-,\s]/,Zc=/["']/g,Jc=function(v){for(var x={},T=v.substr(1,v.length-3).split(":"),L=T[0],U=1,z=T.length,k,le,ve;U<z;U++)le=T[U],k=U!==z-1?le.lastIndexOf(","):le.length,ve=le.substr(0,k),x[L]=isNaN(ve)?ve.replace(Zc,"").trim():+ve,L=le.substr(k+1).trim();return x},xh=function(v){var x=v.indexOf("(")+1,T=v.indexOf(")"),L=v.indexOf("(",x);return v.substring(x,~L&&L<T?v.indexOf(")",T+1):T)},ml=function(v){var x=(v+"").split("("),T=ii[x[0]];return T&&x.length>1&&T.config?T.config.apply(null,~v.indexOf("{")?[Jc(x[1])]:xh(v).split(",").map(it)):ii._CE&&Xp.test(v)?ii._CE("",v):T},Do=function(v){return function(x){return 1-v(1-x)}},ac=function ae(v,x){for(var T=v._first,L;T;)T instanceof qr?ae(T,x):T.vars.yoyoEase&&(!T._yoyo||!T._repeat)&&T._yoyo!==x&&(T.timeline?ae(T.timeline,x):(L=T._ease,T._ease=T._yEase,T._yEase=L,T._yoyo=x)),T=T._next},Qs=function(v,x){return v&&(B(v)?v:ii[v]||ml(v))||x},eo=function(v,x,T,L){T===void 0&&(T=function(le){return 1-x(1-le)}),L===void 0&&(L=function(le){return le<.5?x(le*2)/2:1-x((1-le)*2)/2});var U={easeIn:x,easeOut:T,easeInOut:L},z;return ue(v,function(k){ii[k]=At[k]=U,ii[z=k.toLowerCase()]=T;for(var le in U)ii[z+(le==="easeIn"?".in":le==="easeOut"?".out":".inOut")]=ii[k+"."+le]=U[le]}),U},Kf=function(v){return function(x){return x<.5?(1-v(1-x*2))/2:.5+v((x-.5)*2)/2}},Wr=function ae(v,x,T){var L=x>=1?x:1,U=(T||(v?.3:.45))/(x<1?x:1),z=U/A*(Math.asin(1/L)||0),k=function(fe){return fe===1?1:L*Math.pow(2,-10*fe)*W((fe-z)*U)+1},le=v==="out"?k:v==="in"?function(ve){return 1-k(1-ve)}:Kf(k);return U=A/U,le.config=function(ve,fe){return ae(v,ve,fe)},le},gl=function ae(v,x){x===void 0&&(x=1.70158);var T=function(z){return z?--z*z*((x+1)*z+x)+1:0},L=v==="out"?T:v==="in"?function(U){return 1-T(1-U)}:Kf(T);return L.config=function(U){return ae(v,U)},L};ue("Linear,Quad,Cubic,Quart,Quint,Strong",function(ae,v){var x=v<5?v+1:v;eo(ae+",Power"+(x-1),v?function(T){return Math.pow(T,x)}:function(T){return T},function(T){return 1-Math.pow(1-T,x)},function(T){return T<.5?Math.pow(T*2,x)/2:1-Math.pow((1-T)*2,x)/2})}),ii.Linear.easeNone=ii.none=ii.Linear.easeIn,eo("Elastic",Wr("in"),Wr("out"),Wr()),function(ae,v){var x=1/v,T=2*x,L=2.5*x,U=function(k){return k<x?ae*k*k:k<T?ae*Math.pow(k-1.5/v,2)+.75:k<L?ae*(k-=2.25/v)*k+.9375:ae*Math.pow(k-2.625/v,2)+.984375};eo("Bounce",function(z){return 1-U(1-z)},U)}(7.5625,2.75),eo("Expo",function(ae){return ae?Math.pow(2,10*(ae-1)):0}),eo("Circ",function(ae){return-(E(1-ae*ae)-1)}),eo("Sine",function(ae){return ae===1?1:-N(ae*S)+1}),eo("Back",gl("in"),gl("out"),gl()),ii.SteppedEase=ii.steps=At.SteppedEase={config:function(v,x){v===void 0&&(v=1);var T=1/v,L=v+(x?0:1),U=x?1:0,z=1-b;return function(k){return((L*li(0,z,k)|0)+U)*T}}},p.ease=ii["quad.out"],ue("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(ae){return Q+=ae+","+ae+"Params,"});var Kc=function(v,x){this.id=R++,v._gsap=this,this.target=v,this.harness=x,this.get=x?x.get:Ge,this.set=x?x.getSetter:sc},Oo=function(){function ae(x){this.vars=x,this._delay=+x.delay||0,(this._repeat=x.repeat===1/0?-2:x.repeat||0)&&(this._rDelay=x.repeatDelay||0,this._yoyo=!!x.yoyo||!!x.yoyoEase),this._ts=1,An(this,+x.duration,1,1),this.data=x.data,Yc||La.wake()}var v=ae.prototype;return v.delay=function(T){return T||T===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+T-this._delay),this._delay=T,this):this._delay},v.duration=function(T){return arguments.length?this.totalDuration(this._repeat>0?T+(T+this._rDelay)*this._repeat:T):this.totalDuration()&&this._dur},v.totalDuration=function(T){return arguments.length?(this._dirty=0,An(this,this._repeat<0?T:(T-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},v.totalTime=function(T,L){if(pl(),!arguments.length)return this._tTime;var U=this._dp;if(U&&U.smoothChildTiming&&this._ts){for(is(this,T),!U._dp||U.parent||re(U,this);U&&U.parent;)U.parent._time!==U._start+(U._ts>=0?U._tTime/U._ts:(U.totalDuration()-U._tTime)/-U._ts)&&U.totalTime(U._tTime,!0),U=U.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&T<this._tDur||this._ts<0&&T>0||!this._tDur&&!T)&&$e(this._dp,this,this._start-this._delay)}return(this._tTime!==T||!this._dur&&!L||this._initted&&Math.abs(this._zTime)===b||!T&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=T),me(this,T,L)),this},v.time=function(T,L){return arguments.length?this.totalTime(Math.min(this.totalDuration(),T+bs(this))%(this._dur+this._rDelay)||(T?this._dur:0),L):this._time},v.totalProgress=function(T,L){return arguments.length?this.totalTime(this.totalDuration()*T,L):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},v.progress=function(T,L){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-T:T)+bs(this),L):this.duration()?Math.min(1,this._time/this._dur):this.ratio},v.iteration=function(T,L){var U=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(T-1)*U,L):this._repeat?mr(this._tTime,U)+1:1},v.timeScale=function(T){if(!arguments.length)return this._rts===-b?0:this._rts;if(this._rts===T)return this;var L=this.parent&&this._ts?va(this.parent._time,this):this._tTime;return this._rts=+T||0,this._ts=this._ps||T===-b?0:this._rts,ns(this.totalTime(li(-this._delay,this._tDur,L),!0)),Ea(this),this},v.paused=function(T){return arguments.length?(this._ps!==T&&(this._ps=T,T?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(pl(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==b&&(this._tTime-=b)))),this):this._ps},v.startTime=function(T){if(arguments.length){this._start=T;var L=this.parent||this._dp;return L&&(L._sort||!this.parent)&&$e(L,this,T-this._delay),this}return this._start},v.endTime=function(T){return this._start+(ye(T)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},v.rawTime=function(T){var L=this.parent||this._dp;return L?T&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?va(L.rawTime(T),this):this._tTime:this._tTime},v.globalTime=function(T){for(var L=this,U=arguments.length?T:L.rawTime();L;)U=L._start+U/(L._ts||1),L=L._dp;return U},v.repeat=function(T){return arguments.length?(this._repeat=T===1/0?-2:T,Yi(this)):this._repeat===-2?1/0:this._repeat},v.repeatDelay=function(T){if(arguments.length){var L=this._time;return this._rDelay=T,Yi(this),L?this.time(L):this}return this._rDelay},v.yoyo=function(T){return arguments.length?(this._yoyo=T,this):this._yoyo},v.seek=function(T,L){return this.totalTime(on(this,T),ye(L))},v.restart=function(T,L){return this.play().totalTime(T?-this._delay:0,ye(L))},v.play=function(T,L){return T!=null&&this.seek(T,L),this.reversed(!1).paused(!1)},v.reverse=function(T,L){return T!=null&&this.seek(T||this.totalDuration(),L),this.reversed(!0).paused(!1)},v.pause=function(T,L){return T!=null&&this.seek(T,L),this.paused(!0)},v.resume=function(){return this.paused(!1)},v.reversed=function(T){return arguments.length?(!!T!==this.reversed()&&this.timeScale(-this._rts||(T?-b:0)),this):this._rts<0},v.invalidate=function(){return this._initted=this._act=0,this._zTime=-b,this},v.isActive=function(){var T=this.parent||this._dp,L=this._start,U;return!!(!T||this._ts&&this._initted&&T.isActive()&&(U=T.rawTime(!0))>=L&&U<this.endTime(!0)-b)},v.eventCallback=function(T,L,U){var z=this.vars;return arguments.length>1?(L?(z[T]=L,U&&(z[T+"Params"]=U),T==="onUpdate"&&(this._onUpdate=L)):delete z[T],this):z[T]},v.then=function(T){var L=this;return new Promise(function(U){var z=B(T)?T:Rt,k=function(){var ve=L.then;L.then=null,B(z)&&(z=z(L))&&(z.then||z===L)&&(L.then=ve),U(z),L.then=ve};L._initted&&L.totalProgress()===1&&L._ts>=0||!L._tTime&&L._ts<0?k():L._prom=k})},v.kill=function(){ic(this)},ae}();mt(Oo.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-b,_prom:0,_ps:!1,_rts:1});var qr=function(ae){l(v,ae);function v(T,L){var U;return T===void 0&&(T={}),U=ae.call(this,T)||this,U.labels={},U.smoothChildTiming=!!T.smoothChildTiming,U.autoRemoveChildren=!!T.autoRemoveChildren,U._sort=ye(T.sortChildren),We&&$e(T.parent||We,u(U),L),T.reversed&&U.reverse(),T.paused&&U.paused(!0),T.scrollTrigger&&Ke(u(U),T.scrollTrigger),U}var x=v.prototype;return x.to=function(L,U,z){return oi(0,arguments,this),this},x.from=function(L,U,z){return oi(1,arguments,this),this},x.fromTo=function(L,U,z,k){return oi(2,arguments,this),this},x.set=function(L,U,z){return U.duration=0,U.parent=this,er(U).repeatDelay||(U.repeat=0),U.immediateRender=!!U.immediateRender,new ki(L,U,on(this,z),1),this},x.call=function(L,U,z){return $e(this,ki.delayedCall(0,L,U),z)},x.staggerTo=function(L,U,z,k,le,ve,fe){return z.duration=U,z.stagger=z.stagger||k,z.onComplete=ve,z.onCompleteParams=fe,z.parent=this,new ki(L,z,on(this,le)),this},x.staggerFrom=function(L,U,z,k,le,ve,fe){return z.runBackwards=1,er(z).immediateRender=ye(z.immediateRender),this.staggerTo(L,U,z,k,le,ve,fe)},x.staggerFromTo=function(L,U,z,k,le,ve,fe,Ye){return k.startAt=z,er(k).immediateRender=ye(k.immediateRender),this.staggerTo(L,U,k,le,ve,fe,Ye)},x.render=function(L,U,z){var k=this._time,le=this._dirty?this.totalDuration():this._tDur,ve=this._dur,fe=L<=0?0:ct(L),Ye=this._zTime<0!=L<0&&(this._initted||!ve),ke,Ae,yt,Fe,_t,Mt,Gt,Dt,jt,Pt,Ot,Vt;if(this!==We&&fe>le&&L>=0&&(fe=le),fe!==this._tTime||z||Ye){if(k!==this._time&&ve&&(fe+=this._time-k,L+=this._time-k),ke=fe,jt=this._start,Dt=this._ts,Mt=!Dt,Ye&&(ve||(k=this._zTime),(L||!U)&&(this._zTime=L)),this._repeat){if(Ot=this._yoyo,_t=ve+this._rDelay,this._repeat<-1&&L<0)return this.totalTime(_t*100+L,U,z);if(ke=ct(fe%_t),fe===le?(Fe=this._repeat,ke=ve):(Fe=~~(fe/_t),Fe&&Fe===fe/_t&&(ke=ve,Fe--),ke>ve&&(ke=ve)),Pt=mr(this._tTime,_t),!k&&this._tTime&&Pt!==Fe&&(Pt=Fe),Ot&&Fe&1&&(ke=ve-ke,Vt=1),Fe!==Pt&&!this._lock){var Zt=Ot&&Pt&1,zt=Zt===(Ot&&Fe&1);if(Fe<Pt&&(Zt=!Zt),k=Zt?0:ve,this._lock=1,this.render(k||(Vt?0:ct(Fe*_t)),U,!ve)._lock=0,this._tTime=fe,!U&&this.parent&&Aa(this,"onRepeat"),this.vars.repeatRefresh&&!Vt&&(this.invalidate()._lock=1),k&&k!==this._time||Mt!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(ve=this._dur,le=this._tDur,zt&&(this._lock=2,k=Zt?ve:-1e-4,this.render(k,!0),this.vars.repeatRefresh&&!Vt&&this.invalidate()),this._lock=0,!this._ts&&!Mt)return this;ac(this,Vt)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(Gt=Yn(this,ct(k),ct(ke)),Gt&&(fe-=ke-(ke=Gt._start))),this._tTime=fe,this._time=ke,this._act=!Dt,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=L,k=0),!k&&ke&&!U&&(Aa(this,"onStart"),this._tTime!==fe))return this;if(ke>=k&&L>=0)for(Ae=this._first;Ae;){if(yt=Ae._next,(Ae._act||ke>=Ae._start)&&Ae._ts&&Gt!==Ae){if(Ae.parent!==this)return this.render(L,U,z);if(Ae.render(Ae._ts>0?(ke-Ae._start)*Ae._ts:(Ae._dirty?Ae.totalDuration():Ae._tDur)+(ke-Ae._start)*Ae._ts,U,z),ke!==this._time||!this._ts&&!Mt){Gt=0,yt&&(fe+=this._zTime=-b);break}}Ae=yt}else{Ae=this._last;for(var Jn=L<0?L:ke;Ae;){if(yt=Ae._prev,(Ae._act||Jn<=Ae._end)&&Ae._ts&&Gt!==Ae){if(Ae.parent!==this)return this.render(L,U,z);if(Ae.render(Ae._ts>0?(Jn-Ae._start)*Ae._ts:(Ae._dirty?Ae.totalDuration():Ae._tDur)+(Jn-Ae._start)*Ae._ts,U,z),ke!==this._time||!this._ts&&!Mt){Gt=0,yt&&(fe+=this._zTime=Jn?-b:b);break}}Ae=yt}}if(Gt&&!U&&(this.pause(),Gt.render(ke>=k?0:-b)._zTime=ke>=k?1:-1,this._ts))return this._start=jt,Ea(this),this.render(L,U,z);this._onUpdate&&!U&&Aa(this,"onUpdate",!0),(fe===le&&le>=this.totalDuration()||!fe&&k)&&(jt===this._start||Math.abs(Dt)!==Math.abs(this._ts))&&(this._lock||((L||!ve)&&(fe===le&&this._ts>0||!fe&&this._ts<0)&&ji(this,1),!U&&!(L<0&&!k)&&(fe||k||!le)&&(Aa(this,fe===le&&L>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(fe<le&&this.timeScale()>0)&&this._prom())))}return this},x.add=function(L,U){var z=this;if(O(U)||(U=on(this,U,L)),!(L instanceof Oo)){if(qe(L))return L.forEach(function(k){return z.add(k,U)}),this;if(V(L))return this.addLabel(L,U);if(B(L))L=ki.delayedCall(0,L);else return this}return this!==L?$e(this,L,U):this},x.getChildren=function(L,U,z,k){L===void 0&&(L=!0),U===void 0&&(U=!0),z===void 0&&(z=!0),k===void 0&&(k=-_);for(var le=[],ve=this._first;ve;)ve._start>=k&&(ve instanceof ki?U&&le.push(ve):(z&&le.push(ve),L&&le.push.apply(le,ve.getChildren(!0,U,z)))),ve=ve._next;return le},x.getById=function(L){for(var U=this.getChildren(1,1,1),z=U.length;z--;)if(U[z].vars.id===L)return U[z]},x.remove=function(L){return V(L)?this.removeLabel(L):B(L)?this.killTweensOf(L):(ma(this,L),L===this._recent&&(this._recent=this._last),Ci(this))},x.totalTime=function(L,U){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ct(La.time-(this._ts>0?L/this._ts:(this.totalDuration()-L)/-this._ts))),ae.prototype.totalTime.call(this,L,U),this._forcing=0,this):this._tTime},x.addLabel=function(L,U){return this.labels[L]=on(this,U),this},x.removeLabel=function(L){return delete this.labels[L],this},x.addPause=function(L,U,z){var k=ki.delayedCall(0,U||de,z);return k.data="isPause",this._hasPause=1,$e(this,k,on(this,L))},x.removePause=function(L){var U=this._first;for(L=on(this,L);U;)U._start===L&&U.data==="isPause"&&ji(U),U=U._next},x.killTweensOf=function(L,U,z){for(var k=this.getTweensOf(L,z),le=k.length;le--;)to!==k[le]&&k[le].kill(L,U);return this},x.getTweensOf=function(L,U){for(var z=[],k=br(L),le=this._first,ve=O(U),fe;le;)le instanceof ki?Ft(le._targets,k)&&(ve?(!to||le._initted&&le._ts)&&le.globalTime(0)<=U&&le.globalTime(le.totalDuration())>U:!U||le.isActive())&&z.push(le):(fe=le.getTweensOf(k,U)).length&&z.push.apply(z,fe),le=le._next;return z},x.tweenTo=function(L,U){U=U||{};var z=this,k=on(z,L),le=U,ve=le.startAt,fe=le.onStart,Ye=le.onStartParams,ke=le.immediateRender,Ae,yt=ki.to(z,mt({ease:U.ease||"none",lazy:!1,immediateRender:!1,time:k,overwrite:"auto",duration:U.duration||Math.abs((k-(ve&&"time"in ve?ve.time:z._time))/z.timeScale())||b,onStart:function(){if(z.pause(),!Ae){var _t=U.duration||Math.abs((k-(ve&&"time"in ve?ve.time:z._time))/z.timeScale());yt._dur!==_t&&An(yt,_t,0,1).render(yt._time,!0,!0),Ae=1}fe&&fe.apply(yt,Ye||[])}},U));return ke?yt.render(0):yt},x.tweenFromTo=function(L,U,z){return this.tweenTo(U,mt({startAt:{time:on(this,L)}},z))},x.recent=function(){return this._recent},x.nextLabel=function(L){return L===void 0&&(L=this._time),Xf(this,on(this,L))},x.previousLabel=function(L){return L===void 0&&(L=this._time),Xf(this,on(this,L),1)},x.currentLabel=function(L){return arguments.length?this.seek(L,!0):this.previousLabel(this._time+b)},x.shiftChildren=function(L,U,z){z===void 0&&(z=0);for(var k=this._first,le=this.labels,ve;k;)k._start>=z&&(k._start+=L,k._end+=L),k=k._next;if(U)for(ve in le)le[ve]>=z&&(le[ve]+=L);return Ci(this)},x.invalidate=function(){var L=this._first;for(this._lock=0;L;)L.invalidate(),L=L._next;return ae.prototype.invalidate.call(this)},x.clear=function(L){L===void 0&&(L=!0);for(var U=this._first,z;U;)z=U._next,this.remove(U),U=z;return this._dp&&(this._time=this._tTime=this._pTime=0),L&&(this.labels={}),Ci(this)},x.totalDuration=function(L){var U=0,z=this,k=z._last,le=_,ve,fe,Ye;if(arguments.length)return z.timeScale((z._repeat<0?z.duration():z.totalDuration())/(z.reversed()?-L:L));if(z._dirty){for(Ye=z.parent;k;)ve=k._prev,k._dirty&&k.totalDuration(),fe=k._start,fe>le&&z._sort&&k._ts&&!z._lock?(z._lock=1,$e(z,k,fe-k._delay,1)._lock=0):le=fe,fe<0&&k._ts&&(U-=fe,(!Ye&&!z._dp||Ye&&Ye.smoothChildTiming)&&(z._start+=fe/z._ts,z._time-=fe,z._tTime-=fe),z.shiftChildren(-fe,!1,-1/0),le=0),k._end>U&&k._ts&&(U=k._end),k=ve;An(z,z===We&&z._time>U?z._time:U,1,1),z._dirty=0}return z._tDur},v.updateRoot=function(L){if(We._ts&&(me(We,va(L,We)),Se=La.frame),La.frame>=Ze){Ze+=h.autoSleep||120;var U=We._first;if((!U||!U._ts)&&h.autoSleep&&La._listeners.length<2){for(;U&&!U._ts;)U=U._next;U||La.sleep()}}},v}(Oo);mt(qr.prototype,{_lock:0,_hasPause:0,_forcing:0});var $f=function(v,x,T,L,U,z,k){var le=new gr(this._pt,v,x,0,1,nu,null,U),ve=0,fe=0,Ye,ke,Ae,yt,Fe,_t,Mt,Gt;for(le.b=T,le.e=L,T+="",L+="",(Mt=~L.indexOf("random("))&&(L=nc(L)),z&&(Gt=[T,L],z(Gt,v,x),T=Gt[0],L=Gt[1]),ke=T.match(Ue)||[];Ye=Ue.exec(L);)yt=Ye[0],Fe=L.substring(ve,Ye.index),Ae?Ae=(Ae+1)%5:Fe.substr(-5)==="rgba("&&(Ae=1),yt!==ke[fe++]&&(_t=parseFloat(ke[fe-1])||0,le._pt={_next:le._pt,p:Fe||fe===1?Fe:",",s:_t,c:yt.charAt(1)==="="?parseFloat(yt.substr(2))*(yt.charAt(0)==="-"?-1:1):parseFloat(yt)-_t,m:Ae&&Ae<4?Math.round:0},ve=Ue.lastIndex);return le.c=ve<L.length?L.substring(ve,L.length):"",le.fp=k,(Le.test(L)||Mt)&&(le.e=0),this._pt=le,le},$c=function(v,x,T,L,U,z,k,le,ve){B(L)&&(L=L(U||0,v,z));var fe=v[x],Ye=T!=="get"?T:B(fe)?ve?v[x.indexOf("set")||!B(v["get"+x.substr(3)])?x:"get"+x.substr(3)](ve):v[x]():fe,ke=B(fe)?ve?Xr:rs:eu,Ae;if(V(L)&&(~L.indexOf("random(")&&(L=nc(L)),L.charAt(1)==="="&&(Ae=parseFloat(Ye)+parseFloat(L.substr(2))*(L.charAt(0)==="-"?-1:1)+(tr(Ye)||0),(Ae||Ae===0)&&(L=Ae))),Ye!==L)return!isNaN(Ye*L)&&L!==""?(Ae=new gr(this._pt,v,x,+Ye||0,L-(Ye||0),typeof fe=="boolean"?Yp:Ln,0,ke),ve&&(Ae.fp=ve),k&&Ae.modifier(k,this,v),this._pt=Ae):(!fe&&!(x in v)&&H(x,L),$f.call(this,v,x,Ye,L,ke,le||h.stringFilter,ve))},Qf=function(v,x,T,L,U){if(B(v)&&(v=No(v,U,x,T,L)),!ge(v)||v.style&&v.nodeType||qe(v)||tt(v))return V(v)?No(v,U,x,T,L):v;var z={},k;for(k in v)z[k]=No(v[k],U,x,T,L);return z},ed=function(v,x,T,L,U,z){var k,le,ve,fe;if(Pe[v]&&(k=new Pe[v]).init(U,k.rawVars?x[v]:Qf(x[v],L,U,z,T),T,L,z)!==!1&&(T._pt=le=new gr(T._pt,U,v,0,1,k.render,k,0,k.priority),T!==dl))for(ve=T._ptLookup[T._targets.indexOf(U)],fe=k._props.length;fe--;)ve[k._props[fe]]=le;return k},to,vl=function ae(v,x){var T=v.vars,L=T.ease,U=T.startAt,z=T.immediateRender,k=T.lazy,le=T.onUpdate,ve=T.onUpdateParams,fe=T.callbackScope,Ye=T.runBackwards,ke=T.yoyoEase,Ae=T.keyframes,yt=T.autoRevert,Fe=v._dur,_t=v._startAt,Mt=v._targets,Gt=v.parent,Dt=Gt&&Gt.data==="nested"?Gt.parent._targets:Mt,jt=v._overwrite==="auto"&&!g,Pt=v.timeline,Ot,Vt,Zt,zt,Jn,xi,Ji,yr,nr,Bn,Br,oa,ls;if(Pt&&(!Ae||!L)&&(L="none"),v._ease=Qs(L,p.ease),v._yEase=ke?Do(Qs(ke===!0?L:ke,p.ease)):0,ke&&v._yoyo&&!v._repeat&&(ke=v._yEase,v._yEase=v._ease,v._ease=ke),v._from=!Pt&&!!T.runBackwards,!Pt){if(yr=Mt[0]?He(Mt[0]).harness:0,oa=yr&&T[yr.prop],Ot=Or(T,be),_t&&_t.render(-1,!0).kill(),U)if(ji(v._startAt=ki.set(Mt,mt({data:"isStart",overwrite:!1,parent:Gt,immediateRender:!0,lazy:ye(k),startAt:null,delay:0,onUpdate:le,onUpdateParams:ve,callbackScope:fe,stagger:0},U))),x<0&&!z&&!yt&&v._startAt.render(-1,!0),z){if(x>0&&!yt&&(v._startAt=0),Fe&&x<=0){x&&(v._zTime=x);return}}else yt===!1&&(v._startAt=0);else if(Ye&&Fe){if(_t)!yt&&(v._startAt=0);else if(x&&(z=!1),Zt=mt({overwrite:!1,data:"isFromStart",lazy:z&&ye(k),immediateRender:z,stagger:0,parent:Gt},Ot),oa&&(Zt[yr.prop]=oa),ji(v._startAt=ki.set(Mt,Zt)),x<0&&v._startAt.render(-1,!0),!z)ae(v._startAt,b);else if(!x)return}for(v._pt=0,k=Fe&&ye(k)||k&&!Fe,Vt=0;Vt<Mt.length;Vt++){if(Jn=Mt[Vt],Ji=Jn._gsap||Y(Mt)[Vt]._gsap,v._ptLookup[Vt]=Bn={},we[Ji.id]&&Re.length&&ut(),Br=Dt===Mt?Vt:Dt.indexOf(Jn),yr&&(nr=new yr).init(Jn,oa||Ot,v,Br,Dt)!==!1&&(v._pt=zt=new gr(v._pt,Jn,nr.name,0,1,nr.render,nr,0,nr.priority),nr._props.forEach(function(Wa){Bn[Wa]=zt}),nr.priority&&(xi=1)),!yr||oa)for(Zt in Ot)Pe[Zt]&&(nr=ed(Zt,Ot,v,Br,Jn,Dt))?nr.priority&&(xi=1):Bn[Zt]=zt=$c.call(v,Jn,Zt,"get",Ot[Zt],Br,Dt,0,T.stringFilter);v._op&&v._op[Vt]&&v.kill(Jn,v._op[Vt]),jt&&v._pt&&(to=v,We.killTweensOf(Jn,Bn,v.globalTime(x)),ls=!v.parent,to=0),v._pt&&k&&(we[Ji.id]=1)}xi&&yl(v),v._onInit&&v._onInit(v)}v._onUpdate=le,v._initted=(!v._op||v._pt)&&!ls},jp=function(v,x){var T=v[0]?He(v[0]).harness:0,L=T&&T.aliases,U,z,k,le;if(!L)return x;U=gn({},x);for(z in L)if(z in U)for(le=L[z].split(","),k=le.length;k--;)U[le[k]]=U[z];return U},No=function(v,x,T,L,U){return B(v)?v.call(x,T,L,U):V(v)&&~v.indexOf("random(")?nc(v):v},td=Q+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Qc=(td+",id,stagger,delay,duration,paused,scrollTrigger").split(","),ki=function(ae){l(v,ae);function v(T,L,U,z){var k;typeof L=="number"&&(U.duration=L,L=U,U=null),k=ae.call(this,z?L:er(L))||this;var le=k.vars,ve=le.duration,fe=le.delay,Ye=le.immediateRender,ke=le.stagger,Ae=le.overwrite,yt=le.keyframes,Fe=le.defaults,_t=le.scrollTrigger,Mt=le.yoyoEase,Gt=L.parent||We,Dt=(qe(T)||tt(T)?O(T[0]):"length"in L)?[T]:br(T),jt,Pt,Ot,Vt,Zt,zt,Jn,xi;if(k._targets=Dt.length?Y(Dt):xe("GSAP target "+T+" not found. https://greensock.com",!h.nullTargetWarn)||[],k._ptLookup=[],k._overwrite=Ae,yt||ke||Ie(ve)||Ie(fe)){if(L=k.vars,jt=k.timeline=new qr({data:"nested",defaults:Fe||{}}),jt.kill(),jt.parent=jt._dp=u(k),jt._start=0,yt)er(mt(jt.vars.defaults,{ease:"none"})),ke?Dt.forEach(function(Ji,yr){return yt.forEach(function(nr,Bn){return jt.to(Ji,nr,Bn?">":yr*ke)})}):yt.forEach(function(Ji){return jt.to(Dt,Ji,">")});else{if(Vt=Dt.length,Jn=ke?Hf(ke):de,ge(ke))for(Zt in ke)~td.indexOf(Zt)&&(xi||(xi={}),xi[Zt]=ke[Zt]);for(Pt=0;Pt<Vt;Pt++){Ot={};for(Zt in L)Qc.indexOf(Zt)<0&&(Ot[Zt]=L[Zt]);Ot.stagger=0,Mt&&(Ot.yoyoEase=Mt),xi&&gn(Ot,xi),zt=Dt[Pt],Ot.duration=+No(ve,u(k),Pt,zt,Dt),Ot.delay=(+No(fe,u(k),Pt,zt,Dt)||0)-k._delay,!ke&&Vt===1&&Ot.delay&&(k._delay=fe=Ot.delay,k._start+=fe,Ot.delay=0),jt.to(zt,Ot,Jn(Pt,zt,Dt))}jt.duration()?ve=fe=0:k.timeline=0}ve||k.duration(ve=jt.duration())}else k.timeline=0;return Ae===!0&&!g&&(to=u(k),We.killTweensOf(Dt),to=0),$e(Gt,u(k),U),L.reversed&&k.reverse(),L.paused&&k.paused(!0),(Ye||!ve&&!yt&&k._start===ct(Gt._time)&&ye(Ye)&&ga(u(k))&&Gt.data!=="nested")&&(k._tTime=-b,k.render(Math.max(0,-fe))),_t&&Ke(u(k),_t),k}var x=v.prototype;return x.render=function(L,U,z){var k=this._time,le=this._tDur,ve=this._dur,fe=L>le-b&&L>=0?le:L<b?0:L,Ye,ke,Ae,yt,Fe,_t,Mt,Gt,Dt;if(!ve)In(this,L,U,z);else if(fe!==this._tTime||!L||z||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=L<0){if(Ye=fe,Gt=this.timeline,this._repeat){if(yt=ve+this._rDelay,this._repeat<-1&&L<0)return this.totalTime(yt*100+L,U,z);if(Ye=ct(fe%yt),fe===le?(Ae=this._repeat,Ye=ve):(Ae=~~(fe/yt),Ae&&Ae===fe/yt&&(Ye=ve,Ae--),Ye>ve&&(Ye=ve)),_t=this._yoyo&&Ae&1,_t&&(Dt=this._yEase,Ye=ve-Ye),Fe=mr(this._tTime,yt),Ye===k&&!z&&this._initted)return this;Ae!==Fe&&(Gt&&this._yEase&&ac(Gt,_t),this.vars.repeatRefresh&&!_t&&!this._lock&&(this._lock=z=1,this.render(ct(yt*Ae),!0).invalidate()._lock=0))}if(!this._initted){if(ht(this,L<0?L:Ye,z,U))return this._tTime=0,this;if(ve!==this._dur)return this.render(L,U,z)}if(this._tTime=fe,this._time=Ye,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=Mt=(Dt||this._ease)(Ye/ve),this._from&&(this.ratio=Mt=1-Mt),Ye&&!k&&!U&&(Aa(this,"onStart"),this._tTime!==fe))return this;for(ke=this._pt;ke;)ke.r(Mt,ke.d),ke=ke._next;Gt&&Gt.render(L<0?L:!Ye&&_t?-b:Gt._dur*Mt,U,z)||this._startAt&&(this._zTime=L),this._onUpdate&&!U&&(L<0&&this._startAt&&this._startAt.render(L,!0,z),Aa(this,"onUpdate")),this._repeat&&Ae!==Fe&&this.vars.onRepeat&&!U&&this.parent&&Aa(this,"onRepeat"),(fe===this._tDur||!fe)&&this._tTime===fe&&(L<0&&this._startAt&&!this._onUpdate&&this._startAt.render(L,!0,!0),(L||!ve)&&(fe===this._tDur&&this._ts>0||!fe&&this._ts<0)&&ji(this,1),!U&&!(L<0&&!k)&&(fe||k)&&(Aa(this,fe===le?"onComplete":"onReverseComplete",!0),this._prom&&!(fe<le&&this.timeScale()>0)&&this._prom()))}return this},x.targets=function(){return this._targets},x.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),ae.prototype.invalidate.call(this)},x.kill=function(L,U){if(U===void 0&&(U="all"),!L&&(!U||U==="all"))return this._lazy=this._pt=0,this.parent?ic(this):this;if(this.timeline){var z=this.timeline.totalDuration();return this.timeline.killTweensOf(L,U,to&&to.vars.overwrite!==!0)._first||ic(this),this.parent&&z!==this.timeline.totalDuration()&&An(this,this._dur*this.timeline._tDur/z,0,1),this}var k=this._targets,le=L?br(L):k,ve=this._ptLookup,fe=this._pt,Ye,ke,Ae,yt,Fe,_t,Mt;if((!U||U==="all")&&Vr(k,le))return U==="all"&&(this._pt=0),ic(this);for(Ye=this._op=this._op||[],U!=="all"&&(V(U)&&(Fe={},ue(U,function(Gt){return Fe[Gt]=1}),U=Fe),U=jp(k,U)),Mt=k.length;Mt--;)if(~le.indexOf(k[Mt])){ke=ve[Mt],U==="all"?(Ye[Mt]=U,yt=ke,Ae={}):(Ae=Ye[Mt]=Ye[Mt]||{},yt=U);for(Fe in yt)_t=ke&&ke[Fe],_t&&((!("kill"in _t.d)||_t.d.kill(Fe)===!0)&&ma(this,_t,"_pt"),delete ke[Fe]),Ae!=="all"&&(Ae[Fe]=1)}return this._initted&&!this._pt&&fe&&ic(this),this},v.to=function(L,U){return new v(L,U,arguments[2])},v.from=function(L,U){return oi(1,arguments)},v.delayedCall=function(L,U,z,k){return new v(U,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:L,onComplete:U,onReverseComplete:U,onCompleteParams:z,onReverseCompleteParams:z,callbackScope:k})},v.fromTo=function(L,U,z){return oi(2,arguments)},v.set=function(L,U){return U.duration=0,U.repeatDelay||(U.repeat=0),new v(L,U)},v.killTweensOf=function(L,U,z){return We.killTweensOf(L,U,z)},v}(Oo);mt(ki.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),ue("staggerTo,staggerFrom,staggerFromTo",function(ae){ki[ae]=function(){var v=new qr,x=Zs.call(arguments,0);return x.splice(ae==="staggerFromTo"?5:4,0,0),v[ae].apply(v,x)}});var eu=function(v,x,T){return v[x]=T},rs=function(v,x,T){return v[x](T)},Xr=function(v,x,T,L){return v[x](L.fp,T)},tu=function(v,x,T){return v.setAttribute(x,T)},sc=function(v,x){return B(v[x])?rs:pe(v[x])&&v.setAttribute?tu:eu},Ln=function(v,x){return x.set(x.t,x.p,Math.round((x.s+x.c*v)*1e6)/1e6,x)},Yp=function(v,x){return x.set(x.t,x.p,!!(x.s+x.c*v),x)},nu=function(v,x){var T=x._pt,L="";if(!v&&x.b)L=x.b;else if(v===1&&x.e)L=x.e;else{for(;T;)L=T.p+(T.m?T.m(T.s+T.c*v):Math.round((T.s+T.c*v)*1e4)/1e4)+L,T=T._next;L+=x.c}x.set(x.t,x.p,L,x)},en=function(v,x){for(var T=x._pt;T;)T.r(v,T.d),T=T._next},oc=function(v,x,T,L){for(var U=this._pt,z;U;)z=U._next,U.p===L&&U.modifier(v,x,T),U=z},xt=function(v){for(var x=this._pt,T,L;x;)L=x._next,x.p===v&&!x.op||x.op===v?ma(this,x,"_pt"):x.dep||(T=1),x=L;return!T},aa=function(v,x,T,L){L.mSet(v,x,L.m.call(L.tween,T,L.mt),L)},yl=function(v){for(var x=v._pt,T,L,U,z;x;){for(T=x._next,L=U;L&&L.pr>x.pr;)L=L._next;(x._prev=L?L._prev:z)?x._prev._next=x:U=x,(x._next=L)?L._prev=x:z=x,x=T}v._pt=U},gr=function(){function ae(x,T,L,U,z,k,le,ve,fe){this.t=T,this.s=U,this.c=z,this.p=L,this.r=k||Ln,this.d=le||this,this.set=ve||eu,this.pr=fe||0,this._next=x,x&&(x._prev=this)}var v=ae.prototype;return v.modifier=function(T,L,U){this.mSet=this.mSet||this.set,this.set=aa,this.m=T,this.mt=U,this.tween=L},ae}();ue(Q+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(ae){return be[ae]=1}),At.TweenMax=At.TweenLite=ki,At.TimelineLite=At.TimelineMax=qr,We=new qr({sortChildren:!1,defaults:p,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),h.stringFilter=Jf;var bh={registerPlugin:function(){for(var v=arguments.length,x=new Array(v),T=0;T<v;T++)x[T]=arguments[T];x.forEach(function(L){return Wp(L)})},timeline:function(v){return new qr(v)},getTweensOf:function(v,x){return We.getTweensOf(v,x)},getProperty:function(v,x,T,L){V(v)&&(v=br(v)[0]);var U=He(v||{}).get,z=T?Rt:it;return T==="native"&&(T=""),v&&(x?z((Pe[x]&&Pe[x].get||U)(v,x,T,L)):function(k,le,ve){return z((Pe[k]&&Pe[k].get||U)(v,k,le,ve))})},quickSetter:function(v,x,T){if(v=br(v),v.length>1){var L=v.map(function(fe){return Ha.quickSetter(fe,x,T)}),U=L.length;return function(fe){for(var Ye=U;Ye--;)L[Ye](fe)}}v=v[0]||{};var z=Pe[x],k=He(v),le=k.harness&&(k.harness.aliases||{})[x]||x,ve=z?function(fe){var Ye=new z;dl._pt=0,Ye.init(v,T?fe+T:fe,dl,0,[v]),Ye.render(1,Ye),dl._pt&&en(1,dl)}:k.set(v,le);return z?ve:function(fe){return ve(v,le,T?fe+T:fe,k,1)}},isTweening:function(v){return We.getTweensOf(v,!0).length>0},defaults:function(v){return v&&v.ease&&(v.ease=Qs(v.ease,p.ease)),gi(p,v||{})},config:function(v){return gi(h,v||{})},registerEffect:function(v){var x=v.name,T=v.effect,L=v.plugins,U=v.defaults,z=v.extendTimeline;(L||"").split(",").forEach(function(k){return k&&!Pe[k]&&!At[k]&&xe(x+" effect requires "+k+" plugin.")}),ze[x]=function(k,le,ve){return T(br(k),mt(le||{},U),ve)},z&&(qr.prototype[x]=function(k,le,ve){return this.add(ze[x](k,ge(le)?le:(ve=le)&&{},this),ve)})},registerEase:function(v,x){ii[v]=Qs(x)},parseEase:function(v,x){return arguments.length?Qs(v,x):ii},getById:function(v){return We.getById(v)},exportRoot:function(v,x){v===void 0&&(v={});var T=new qr(v),L,U;for(T.smoothChildTiming=ye(v.smoothChildTiming),We.remove(T),T._dp=0,T._time=T._tTime=We._time,L=We._first;L;)U=L._next,(x||!(!L._dur&&L instanceof ki&&L.vars.onComplete===L._targets[0]))&&$e(T,L,L._start-L._delay),L=U;return $e(We,T,0),T},utils:{wrap:Hp,wrapYoyo:kp,distribute:Hf,random:Vf,snap:kf,normalize:zp,getUnit:tr,clamp:cr,splitColor:jf,toArray:br,selector:Ks,mapRange:qf,pipe:Up,unitize:Gp,interpolate:Vp,shuffle:vh},install:K,effects:ze,ticker:La,updateRoot:qr.updateRoot,plugins:Pe,globalTimeline:We,core:{PropTween:gr,globals:te,Tween:ki,Timeline:qr,Animation:Oo,getCache:He,_removeLinkedListItem:ma,suppressOverwrites:function(v){return g=v}}};ue("to,from,fromTo,delayedCall,set,killTweensOf",function(ae){return bh[ae]=ki[ae]}),La.add(qr.updateRoot),dl=bh.to({},{duration:0});var Si=function(v,x){for(var T=v._pt;T&&T.p!==x&&T.op!==x&&T.fp!==x;)T=T._next;return T},Ti=function(v,x){var T=v._targets,L,U,z;for(L in x)for(U=T.length;U--;)z=v._ptLookup[U][L],z&&(z=z.d)&&(z._pt&&(z=Si(z,L)),z&&z.modifier&&z.modifier(x[L],v,T[U],L))},sa=function(v,x){return{name:v,rawVars:1,init:function(L,U,z){z._onInit=function(k){var le,ve;if(V(U)&&(le={},ue(U,function(fe){return le[fe]=1}),U=le),x){le={};for(ve in U)le[ve]=x(U[ve]);U=le}Ti(k,U)}}}},Ha=bh.registerPlugin({name:"attr",init:function(v,x,T,L,U){var z,k;for(z in x)k=this.add(v,"setAttribute",(v.getAttribute(z)||0)+"",x[z],L,U,0,0,z),k&&(k.op=z),this._props.push(z)}},{name:"endArray",init:function(v,x){for(var T=x.length;T--;)this.add(v,T,v[T]||0,x[T])}},sa("roundProps",yh),sa("modifiers"),sa("snap",kf))||bh;ki.version=qr.version=Ha.version="3.8.0",Yt=1,$()&&pl();var Kr=ii.Power0,ee=ii.Power1,nd=ii.Power2,Zp=ii.Power3,ws=ii.Power4,id=ii.Linear,no=ii.Quad,iu=ii.Cubic,rd=ii.Quart,lc=ii.Quint,cc=ii.Strong,uc=ii.Elastic,Fo=ii.Back,Bo=ii.SteppedEase,_l=ii.Bounce,ru=ii.Sine,wh=ii.Expo,Mh=ii.Circ,Uo,Go,ya,as,io,au,zo=function(){return typeof window<"u"},Ms={},Ss=180/Math.PI,Ho=Math.PI/180,ss=Math.atan2,qn=1e8,xl=/([A-Z])/g,os=/(?:left|right|width|margin|padding|x)/i,Tv=/[\s,\(]\S/,ko={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ro=function(v,x){return x.set(x.t,x.p,Math.round((x.s+x.c*v)*1e4)/1e4+x.u,x)},Sh=function(v,x){return x.set(x.t,x.p,v===1?x.e:Math.round((x.s+x.c*v)*1e4)/1e4+x.u,x)},Ra=function(v,x){return x.set(x.t,x.p,v?Math.round((x.s+x.c*v)*1e4)/1e4+x.u:x.b,x)},Th=function(v,x){var T=x.s+x.c*v;x.set(x.t,x.p,~~(T+(T<0?-.5:.5))+x.u,x)},ad=function(v,x){return x.set(x.t,x.p,v?x.e:x.b,x)},sd=function(v,x){return x.set(x.t,x.p,v!==1?x.b:x.e,x)},od=function(v,x,T){return v.style[x]=T},Ev=function(v,x,T){return v.style.setProperty(x,T)},Jp=function(v,x,T){return v._gsap[x]=T},hc=function(v,x,T){return v._gsap.scaleX=v._gsap.scaleY=T},ao=function(v,x,T,L,U){var z=v._gsap;z.scaleX=z.scaleY=T,z.renderTransform(U,z)},Eh=function(v,x,T,L,U){var z=v._gsap;z[x]=T,z.renderTransform(U,z)},vr="transform",Vo=vr+"Origin",Kp,Ah=function(v,x){var T=Go.createElementNS?Go.createElementNS((x||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),v):Go.createElement(v);return T.style?T:Go.createElement(v)},Ts=function ae(v,x,T){var L=getComputedStyle(v);return L[x]||L.getPropertyValue(x.replace(xl,"-$1").toLowerCase())||L.getPropertyValue(x)||!T&&ae(v,fc(x)||x,1)||""},ld="O,Moz,ms,Ms,Webkit".split(","),fc=function(v,x,T){var L=x||io,U=L.style,z=5;if(v in U&&!T)return v;for(v=v.charAt(0).toUpperCase()+v.substr(1);z--&&!(ld[z]+v in U););return z<0?null:(z===3?"ms":z>=0?ld[z]:"")+v},cd=function(){zo()&&window.document&&(Uo=window,Go=Uo.document,ya=Go.documentElement,io=Ah("div")||{style:{}},Ah("div"),vr=fc(vr),Vo=vr+"Origin",io.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Kp=!!fc("perspective"),as=1)},$t=function ae(v){var x=Ah("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),T=this.parentNode,L=this.nextSibling,U=this.style.cssText,z;if(ya.appendChild(x),x.appendChild(this),this.style.display="block",v)try{z=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=ae}catch{}else this._gsapBBox&&(z=this._gsapBBox());return T&&(L?T.insertBefore(this,L):T.appendChild(this)),ya.removeChild(x),this.style.cssText=U,z},Lh=function(v,x){for(var T=x.length;T--;)if(v.hasAttribute(x[T]))return v.getAttribute(x[T])},$p=function(v){var x;try{x=v.getBBox()}catch{x=$t.call(v,!0)}return x&&(x.width||x.height)||v.getBBox===$t||(x=$t.call(v,!0)),x&&!x.width&&!x.x&&!x.y?{x:+Lh(v,["x","cx","x1"])||0,y:+Lh(v,["y","cy","y1"])||0,width:0,height:0}:x},Qp=function(v){return!!(v.getCTM&&(!v.parentNode||v.ownerSVGElement)&&$p(v))},_a=function(v,x){if(x){var T=v.style;x in Ms&&x!==Vo&&(x=vr),T.removeProperty?((x.substr(0,2)==="ms"||x.substr(0,6)==="webkit")&&(x="-"+x),T.removeProperty(x.replace(xl,"-$1").toLowerCase())):T.removeAttribute(x)}},Nr=function(v,x,T,L,U,z){var k=new gr(v._pt,x,T,0,1,z?sd:ad);return v._pt=k,k.b=L,k.e=U,v._props.push(T),k},Es={deg:1,rad:1,turn:1},As=function ae(v,x,T,L){var U=parseFloat(T)||0,z=(T+"").trim().substr((U+"").length)||"px",k=io.style,le=os.test(x),ve=v.tagName.toLowerCase()==="svg",fe=(ve?"client":"offset")+(le?"Width":"Height"),Ye=100,ke=L==="px",Ae=L==="%",yt,Fe,_t,Mt;return L===z||!U||Es[L]||Es[z]?U:(z!=="px"&&!ke&&(U=ae(v,x,T,"px")),Mt=v.getCTM&&Qp(v),(Ae||z==="%")&&(Ms[x]||~x.indexOf("adius"))?(yt=Mt?v.getBBox()[le?"width":"height"]:v[fe],Je(Ae?U/yt*Ye:U/100*yt)):(k[le?"width":"height"]=Ye+(ke?z:L),Fe=~x.indexOf("adius")||L==="em"&&v.appendChild&&!ve?v:v.parentNode,Mt&&(Fe=(v.ownerSVGElement||{}).parentNode),(!Fe||Fe===Go||!Fe.appendChild)&&(Fe=Go.body),_t=Fe._gsap,_t&&Ae&&_t.width&&le&&_t.time===La.time?Je(U/_t.width*Ye):((Ae||z==="%")&&(k.position=Ts(v,"position")),Fe===v&&(k.position="static"),Fe.appendChild(io),yt=io[fe],Fe.removeChild(io),k.position="absolute",le&&Ae&&(_t=He(Fe),_t.time=La.time,_t.width=Fe[fe]),Je(ke?yt*U/Ye:yt&&U?Ye/yt*U:0))))},xa=function(v,x,T,L){var U;return as||cd(),x in ko&&x!=="transform"&&(x=ko[x],~x.indexOf(",")&&(x=x.split(",")[0])),Ms[x]&&x!=="transform"?(U=Ml(v,L),U=x!=="transformOrigin"?U[x]:U.svg?U.origin:gc(Ts(v,Vo))+" "+U.zOrigin+"px"):(U=v.style[x],(!U||U==="auto"||L||~(U+"").indexOf("calc("))&&(U=pc[x]&&pc[x](v,x,T)||Ts(v,x)||Ge(v,x)||(x==="opacity"?1:0))),T&&!~(U+"").trim().indexOf(" ")?As(v,x,U,T)+T:U},dc=function(v,x,T,L){if(!T||T==="none"){var U=fc(x,v,1),z=U&&Ts(v,U,1);z&&z!==T?(x=U,T=z):x==="borderColor"&&(T=Ts(v,"borderTopColor"))}var k=new gr(this._pt,v.style,x,0,1,nu),le=0,ve=0,fe,Ye,ke,Ae,yt,Fe,_t,Mt,Gt,Dt,jt,Pt,Ot;if(k.b=T,k.e=L,T+="",L+="",L==="auto"&&(v.style[x]=L,L=Ts(v,x)||L,v.style[x]=T),fe=[T,L],Jf(fe),T=fe[0],L=fe[1],ke=T.match(Ne)||[],Ot=L.match(Ne)||[],Ot.length){for(;Ye=Ne.exec(L);)_t=Ye[0],Gt=L.substring(le,Ye.index),yt?yt=(yt+1)%5:(Gt.substr(-5)==="rgba("||Gt.substr(-5)==="hsla(")&&(yt=1),_t!==(Fe=ke[ve++]||"")&&(Ae=parseFloat(Fe)||0,jt=Fe.substr((Ae+"").length),Pt=_t.charAt(1)==="="?+(_t.charAt(0)+"1"):0,Pt&&(_t=_t.substr(2)),Mt=parseFloat(_t),Dt=_t.substr((Mt+"").length),le=Ne.lastIndex-Dt.length,Dt||(Dt=Dt||h.units[x]||jt,le===L.length&&(L+=Dt,k.e+=Dt)),jt!==Dt&&(Ae=As(v,x,Fe,Dt)||0),k._pt={_next:k._pt,p:Gt||ve===1?Gt:",",s:Ae,c:Pt?Pt*Mt:Mt-Ae,m:yt&&yt<4||x==="zIndex"?Math.round:0});k.c=le<L.length?L.substring(le,L.length):""}else k.r=x==="display"&&L==="none"?sd:ad;return Le.test(L)&&(k.e=0),this._pt=k,k},bl={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},em=function(v){var x=v.split(" "),T=x[0],L=x[1]||"50%";return(T==="top"||T==="bottom"||L==="left"||L==="right")&&(v=T,T=L,L=v),x[0]=bl[T]||T,x[1]=bl[L]||L,x.join(" ")},ud=function(v,x){if(x.tween&&x.tween._time===x.tween._dur){var T=x.t,L=T.style,U=x.u,z=T._gsap,k,le,ve;if(U==="all"||U===!0)L.cssText="",le=1;else for(U=U.split(","),ve=U.length;--ve>-1;)k=U[ve],Ms[k]&&(le=1,k=k==="transformOrigin"?Vo:vr),_a(T,k);le&&(_a(T,vr),z&&(z.svg&&T.removeAttribute("transform"),Ml(T,1),z.uncache=1))}},pc={clearProps:function(v,x,T,L,U){if(U.data!=="isFromStart"){var z=v._pt=new gr(v._pt,x,T,0,0,ud);return z.u=L,z.pr=-10,z.tween=U,v._props.push(T),1}}},wl=[1,0,0,1,0,0],ka={},hd=function(v){return v==="matrix(1, 0, 0, 1, 0, 0)"||v==="none"||!v},Va=function(v){var x=Ts(v,vr);return hd(x)?wl:x.substr(7).match(je).map(Je)},mc=function(v,x){var T=v._gsap||He(v),L=v.style,U=Va(v),z,k,le,ve;return T.svg&&v.getAttribute("transform")?(le=v.transform.baseVal.consolidate().matrix,U=[le.a,le.b,le.c,le.d,le.e,le.f],U.join(",")==="1,0,0,1,0,0"?wl:U):(U===wl&&!v.offsetParent&&v!==ya&&!T.svg&&(le=L.display,L.display="block",z=v.parentNode,(!z||!v.offsetParent)&&(ve=1,k=v.nextSibling,ya.appendChild(v)),U=Va(v),le?L.display=le:_a(v,"display"),ve&&(k?z.insertBefore(v,k):z?z.appendChild(v):ya.removeChild(v))),x&&U.length>6?[U[0],U[1],U[4],U[5],U[12],U[13]]:U)},su=function(v,x,T,L,U,z){var k=v._gsap,le=U||mc(v,!0),ve=k.xOrigin||0,fe=k.yOrigin||0,Ye=k.xOffset||0,ke=k.yOffset||0,Ae=le[0],yt=le[1],Fe=le[2],_t=le[3],Mt=le[4],Gt=le[5],Dt=x.split(" "),jt=parseFloat(Dt[0])||0,Pt=parseFloat(Dt[1])||0,Ot,Vt,Zt,zt;T?le!==wl&&(Vt=Ae*_t-yt*Fe)&&(Zt=jt*(_t/Vt)+Pt*(-Fe/Vt)+(Fe*Gt-_t*Mt)/Vt,zt=jt*(-yt/Vt)+Pt*(Ae/Vt)-(Ae*Gt-yt*Mt)/Vt,jt=Zt,Pt=zt):(Ot=$p(v),jt=Ot.x+(~Dt[0].indexOf("%")?jt/100*Ot.width:jt),Pt=Ot.y+(~(Dt[1]||Dt[0]).indexOf("%")?Pt/100*Ot.height:Pt)),L||L!==!1&&k.smooth?(Mt=jt-ve,Gt=Pt-fe,k.xOffset=Ye+(Mt*Ae+Gt*Fe)-Mt,k.yOffset=ke+(Mt*yt+Gt*_t)-Gt):k.xOffset=k.yOffset=0,k.xOrigin=jt,k.yOrigin=Pt,k.smooth=!!L,k.origin=x,k.originIsAbsolute=!!T,v.style[Vo]="0px 0px",z&&(Nr(z,k,"xOrigin",ve,jt),Nr(z,k,"yOrigin",fe,Pt),Nr(z,k,"xOffset",Ye,k.xOffset),Nr(z,k,"yOffset",ke,k.yOffset)),v.setAttribute("data-svg-origin",jt+" "+Pt)},Ml=function(v,x){var T=v._gsap||new Kc(v);if("x"in T&&!x&&!T.uncache)return T;var L=v.style,U=T.scaleX<0,z="px",k="deg",le=Ts(v,Vo)||"0",ve,fe,Ye,ke,Ae,yt,Fe,_t,Mt,Gt,Dt,jt,Pt,Ot,Vt,Zt,zt,Jn,xi,Ji,yr,nr,Bn,Br,oa,ls,Wa,wr,Wo,$r,Ur,Fi;return ve=fe=Ye=yt=Fe=_t=Mt=Gt=Dt=0,ke=Ae=1,T.svg=!!(v.getCTM&&Qp(v)),Ot=mc(v,T.svg),T.svg&&(Br=(!T.uncache||le==="0px 0px")&&!x&&v.getAttribute("data-svg-origin"),su(v,Br||le,!!Br||T.originIsAbsolute,T.smooth!==!1,Ot)),jt=T.xOrigin||0,Pt=T.yOrigin||0,Ot!==wl&&(Jn=Ot[0],xi=Ot[1],Ji=Ot[2],yr=Ot[3],ve=nr=Ot[4],fe=Bn=Ot[5],Ot.length===6?(ke=Math.sqrt(Jn*Jn+xi*xi),Ae=Math.sqrt(yr*yr+Ji*Ji),yt=Jn||xi?ss(xi,Jn)*Ss:0,Mt=Ji||yr?ss(Ji,yr)*Ss+yt:0,Mt&&(Ae*=Math.abs(Math.cos(Mt*Ho))),T.svg&&(ve-=jt-(jt*Jn+Pt*Ji),fe-=Pt-(jt*xi+Pt*yr))):(Fi=Ot[6],$r=Ot[7],Wa=Ot[8],wr=Ot[9],Wo=Ot[10],Ur=Ot[11],ve=Ot[12],fe=Ot[13],Ye=Ot[14],Vt=ss(Fi,Wo),Fe=Vt*Ss,Vt&&(Zt=Math.cos(-Vt),zt=Math.sin(-Vt),Br=nr*Zt+Wa*zt,oa=Bn*Zt+wr*zt,ls=Fi*Zt+Wo*zt,Wa=nr*-zt+Wa*Zt,wr=Bn*-zt+wr*Zt,Wo=Fi*-zt+Wo*Zt,Ur=$r*-zt+Ur*Zt,nr=Br,Bn=oa,Fi=ls),Vt=ss(-Ji,Wo),_t=Vt*Ss,Vt&&(Zt=Math.cos(-Vt),zt=Math.sin(-Vt),Br=Jn*Zt-Wa*zt,oa=xi*Zt-wr*zt,ls=Ji*Zt-Wo*zt,Ur=yr*zt+Ur*Zt,Jn=Br,xi=oa,Ji=ls),Vt=ss(xi,Jn),yt=Vt*Ss,Vt&&(Zt=Math.cos(Vt),zt=Math.sin(Vt),Br=Jn*Zt+xi*zt,oa=nr*Zt+Bn*zt,xi=xi*Zt-Jn*zt,Bn=Bn*Zt-nr*zt,Jn=Br,nr=oa),Fe&&Math.abs(Fe)+Math.abs(yt)>359.9&&(Fe=yt=0,_t=180-_t),ke=Je(Math.sqrt(Jn*Jn+xi*xi+Ji*Ji)),Ae=Je(Math.sqrt(Bn*Bn+Fi*Fi)),Vt=ss(nr,Bn),Mt=Math.abs(Vt)>2e-4?Vt*Ss:0,Dt=Ur?1/(Ur<0?-Ur:Ur):0),T.svg&&(Br=v.getAttribute("transform"),T.forceCSS=v.setAttribute("transform","")||!hd(Ts(v,vr)),Br&&v.setAttribute("transform",Br))),Math.abs(Mt)>90&&Math.abs(Mt)<270&&(U?(ke*=-1,Mt+=yt<=0?180:-180,yt+=yt<=0?180:-180):(Ae*=-1,Mt+=Mt<=0?180:-180)),T.x=ve-((T.xPercent=ve&&(T.xPercent||(Math.round(v.offsetWidth/2)===Math.round(-ve)?-50:0)))?v.offsetWidth*T.xPercent/100:0)+z,T.y=fe-((T.yPercent=fe&&(T.yPercent||(Math.round(v.offsetHeight/2)===Math.round(-fe)?-50:0)))?v.offsetHeight*T.yPercent/100:0)+z,T.z=Ye+z,T.scaleX=Je(ke),T.scaleY=Je(Ae),T.rotation=Je(yt)+k,T.rotationX=Je(Fe)+k,T.rotationY=Je(_t)+k,T.skewX=Mt+k,T.skewY=Gt+k,T.transformPerspective=Dt+z,(T.zOrigin=parseFloat(le.split(" ")[2])||0)&&(L[Vo]=gc(le)),T.xOffset=T.yOffset=0,T.force3D=h.force3D,T.renderTransform=T.svg?Rh:Kp?Pi:ou,T.uncache=0,T},gc=function(v){return(v=v.split(" "))[0]+" "+v[1]},Xt=function(v,x,T){var L=tr(x);return Je(parseFloat(x)+parseFloat(As(v,"x",T+"px",L)))+L},ou=function(v,x){x.z="0px",x.rotationY=x.rotationX="0deg",x.force3D=0,Pi(v,x)},Sl="0deg",fn="0px",Fr=") ",Pi=function(v,x){var T=x||this,L=T.xPercent,U=T.yPercent,z=T.x,k=T.y,le=T.z,ve=T.rotation,fe=T.rotationY,Ye=T.rotationX,ke=T.skewX,Ae=T.skewY,yt=T.scaleX,Fe=T.scaleY,_t=T.transformPerspective,Mt=T.force3D,Gt=T.target,Dt=T.zOrigin,jt="",Pt=Mt==="auto"&&v&&v!==1||Mt===!0;if(Dt&&(Ye!==Sl||fe!==Sl)){var Ot=parseFloat(fe)*Ho,Vt=Math.sin(Ot),Zt=Math.cos(Ot),zt;Ot=parseFloat(Ye)*Ho,zt=Math.cos(Ot),z=Xt(Gt,z,Vt*zt*-Dt),k=Xt(Gt,k,-Math.sin(Ot)*-Dt),le=Xt(Gt,le,Zt*zt*-Dt+Dt)}_t!==fn&&(jt+="perspective("+_t+Fr),(L||U)&&(jt+="translate("+L+"%, "+U+"%) "),(Pt||z!==fn||k!==fn||le!==fn)&&(jt+=le!==fn||Pt?"translate3d("+z+", "+k+", "+le+") ":"translate("+z+", "+k+Fr),ve!==Sl&&(jt+="rotate("+ve+Fr),fe!==Sl&&(jt+="rotateY("+fe+Fr),Ye!==Sl&&(jt+="rotateX("+Ye+Fr),(ke!==Sl||Ae!==Sl)&&(jt+="skew("+ke+", "+Ae+Fr),(yt!==1||Fe!==1)&&(jt+="scale("+yt+", "+Fe+Fr),Gt.style[vr]=jt||"translate(0, 0)"},Rh=function(v,x){var T=x||this,L=T.xPercent,U=T.yPercent,z=T.x,k=T.y,le=T.rotation,ve=T.skewX,fe=T.skewY,Ye=T.scaleX,ke=T.scaleY,Ae=T.target,yt=T.xOrigin,Fe=T.yOrigin,_t=T.xOffset,Mt=T.yOffset,Gt=T.forceCSS,Dt=parseFloat(z),jt=parseFloat(k),Pt,Ot,Vt,Zt,zt;le=parseFloat(le),ve=parseFloat(ve),fe=parseFloat(fe),fe&&(fe=parseFloat(fe),ve+=fe,le+=fe),le||ve?(le*=Ho,ve*=Ho,Pt=Math.cos(le)*Ye,Ot=Math.sin(le)*Ye,Vt=Math.sin(le-ve)*-ke,Zt=Math.cos(le-ve)*ke,ve&&(fe*=Ho,zt=Math.tan(ve-fe),zt=Math.sqrt(1+zt*zt),Vt*=zt,Zt*=zt,fe&&(zt=Math.tan(fe),zt=Math.sqrt(1+zt*zt),Pt*=zt,Ot*=zt)),Pt=Je(Pt),Ot=Je(Ot),Vt=Je(Vt),Zt=Je(Zt)):(Pt=Ye,Zt=ke,Ot=Vt=0),(Dt&&!~(z+"").indexOf("px")||jt&&!~(k+"").indexOf("px"))&&(Dt=As(Ae,"x",z,"px"),jt=As(Ae,"y",k,"px")),(yt||Fe||_t||Mt)&&(Dt=Je(Dt+yt-(yt*Pt+Fe*Vt)+_t),jt=Je(jt+Fe-(yt*Ot+Fe*Zt)+Mt)),(L||U)&&(zt=Ae.getBBox(),Dt=Je(Dt+L/100*zt.width),jt=Je(jt+U/100*zt.height)),zt="matrix("+Pt+","+Ot+","+Vt+","+Zt+","+Dt+","+jt+")",Ae.setAttribute("transform",zt),Gt&&(Ae.style[vr]=zt)},_n=function(v,x,T,L,U,z){var k=360,le=V(U),ve=parseFloat(U)*(le&&~U.indexOf("rad")?Ss:1),fe=z?ve*z:ve-L,Ye=L+fe+"deg",ke,Ae;return le&&(ke=U.split("_")[1],ke==="short"&&(fe%=k,fe!==fe%(k/2)&&(fe+=fe<0?k:-k)),ke==="cw"&&fe<0?fe=(fe+k*qn)%k-~~(fe/k)*k:ke==="ccw"&&fe>0&&(fe=(fe-k*qn)%k-~~(fe/k)*k)),v._pt=Ae=new gr(v._pt,x,T,L,fe,Sh),Ae.e=Ye,Ae.u="deg",v._props.push(T),Ae},vc=function(v,x){for(var T in x)v[T]=x[T];return v},lu=function(v,x,T){var L=vc({},T._gsap),U="perspective,force3D,transformOrigin,svgOrigin",z=T.style,k,le,ve,fe,Ye,ke,Ae,yt;L.svg?(ve=T.getAttribute("transform"),T.setAttribute("transform",""),z[vr]=x,k=Ml(T,1),_a(T,vr),T.setAttribute("transform",ve)):(ve=getComputedStyle(T)[vr],z[vr]=x,k=Ml(T,1),z[vr]=ve);for(le in Ms)ve=L[le],fe=k[le],ve!==fe&&U.indexOf(le)<0&&(Ae=tr(ve),yt=tr(fe),Ye=Ae!==yt?As(T,le,ve,yt):parseFloat(ve),ke=parseFloat(fe),v._pt=new gr(v._pt,k,le,Ye,ke-Ye,ro),v._pt.u=yt||0,v._props.push(le));vc(k,L)};ue("padding,margin,Width,Radius",function(ae,v){var x="Top",T="Right",L="Bottom",U="Left",z=(v<3?[x,T,L,U]:[x+U,x+T,L+T,L+U]).map(function(k){return v<2?ae+k:"border"+k+ae});pc[v>1?"border"+ae:ae]=function(k,le,ve,fe,Ye){var ke,Ae;if(arguments.length<4)return ke=z.map(function(yt){return xa(k,yt,ve)}),Ae=ke.join(" "),Ae.split(ke[0]).length===5?ke[0]:Ae;ke=(fe+"").split(" "),Ae={},z.forEach(function(yt,Fe){return Ae[yt]=ke[Fe]=ke[Fe]||ke[(Fe-1)/2|0]}),k.init(le,Ae,Ye)}});var Tl={name:"css",register:cd,targetTest:function(v){return v.style&&v.nodeType},init:function(v,x,T,L,U){var z=this._props,k=v.style,le=T.vars.startAt,ve,fe,Ye,ke,Ae,yt,Fe,_t,Mt,Gt,Dt,jt,Pt,Ot,Vt;as||cd();for(Fe in x)if(Fe!=="autoRound"&&(fe=x[Fe],!(Pe[Fe]&&ed(Fe,x,T,L,v,U)))){if(Ae=typeof fe,yt=pc[Fe],Ae==="function"&&(fe=fe.call(T,L,v,U),Ae=typeof fe),Ae==="string"&&~fe.indexOf("random(")&&(fe=nc(fe)),yt)yt(this,v,Fe,fe,T)&&(Vt=1);else if(Fe.substr(0,2)==="--")ve=(getComputedStyle(v).getPropertyValue(Fe)+"").trim(),fe+="",$s.lastIndex=0,$s.test(ve)||(_t=tr(ve),Mt=tr(fe)),Mt?_t!==Mt&&(ve=As(v,Fe,ve,Mt)+Mt):_t&&(fe+=_t),this.add(k,"setProperty",ve,fe,L,U,0,0,Fe),z.push(Fe);else if(Ae!=="undefined"){if(le&&Fe in le?(ve=typeof le[Fe]=="function"?le[Fe].call(T,L,v,U):le[Fe],Fe in h.units&&!tr(ve)&&(ve+=h.units[Fe]),V(ve)&&~ve.indexOf("random(")&&(ve=nc(ve)),(ve+"").charAt(1)==="="&&(ve=xa(v,Fe))):ve=xa(v,Fe),ke=parseFloat(ve),Gt=Ae==="string"&&fe.charAt(1)==="="?+(fe.charAt(0)+"1"):0,Gt&&(fe=fe.substr(2)),Ye=parseFloat(fe),Fe in ko&&(Fe==="autoAlpha"&&(ke===1&&xa(v,"visibility")==="hidden"&&Ye&&(ke=0),Nr(this,k,"visibility",ke?"inherit":"hidden",Ye?"inherit":"hidden",!Ye)),Fe!=="scale"&&Fe!=="transform"&&(Fe=ko[Fe],~Fe.indexOf(",")&&(Fe=Fe.split(",")[0]))),Dt=Fe in Ms,Dt){if(jt||(Pt=v._gsap,Pt.renderTransform&&!x.parseTransform||Ml(v,x.parseTransform),Ot=x.smoothOrigin!==!1&&Pt.smooth,jt=this._pt=new gr(this._pt,k,vr,0,1,Pt.renderTransform,Pt,0,-1),jt.dep=1),Fe==="scale")this._pt=new gr(this._pt,Pt,"scaleY",Pt.scaleY,(Gt?Gt*Ye:Ye-Pt.scaleY)||0),z.push("scaleY",Fe),Fe+="X";else if(Fe==="transformOrigin"){fe=em(fe),Pt.svg?su(v,fe,0,Ot,0,this):(Mt=parseFloat(fe.split(" ")[2])||0,Mt!==Pt.zOrigin&&Nr(this,Pt,"zOrigin",Pt.zOrigin,Mt),Nr(this,k,Fe,gc(ve),gc(fe)));continue}else if(Fe==="svgOrigin"){su(v,fe,1,Ot,0,this);continue}else if(Fe in ka){_n(this,Pt,Fe,ke,fe,Gt);continue}else if(Fe==="smoothOrigin"){Nr(this,Pt,"smooth",Pt.smooth,fe);continue}else if(Fe==="force3D"){Pt[Fe]=fe;continue}else if(Fe==="transform"){lu(this,fe,v);continue}}else Fe in k||(Fe=fc(Fe)||Fe);if(Dt||(Ye||Ye===0)&&(ke||ke===0)&&!Tv.test(fe)&&Fe in k)_t=(ve+"").substr((ke+"").length),Ye||(Ye=0),Mt=tr(fe)||(Fe in h.units?h.units[Fe]:_t),_t!==Mt&&(ke=As(v,Fe,ve,Mt)),this._pt=new gr(this._pt,Dt?Pt:k,Fe,ke,Gt?Gt*Ye:Ye-ke,!Dt&&(Mt==="px"||Fe==="zIndex")&&x.autoRound!==!1?Th:ro),this._pt.u=Mt||0,_t!==Mt&&Mt!=="%"&&(this._pt.b=ve,this._pt.r=Ra);else if(Fe in k)dc.call(this,v,Fe,ve,fe);else if(Fe in v)this.add(v,Fe,ve||v[Fe],fe,L,U);else{H(Fe,fe);continue}z.push(Fe)}}Vt&&yl(this)},get:xa,aliases:ko,getSetter:function(v,x,T){var L=ko[x];return L&&L.indexOf(",")<0&&(x=L),x in Ms&&x!==Vo&&(v._gsap.x||xa(v,"x"))?T&&au===T?x==="scale"?hc:Jp:(au=T||{})&&(x==="scale"?ao:Eh):v.style&&!pe(v.style[x])?od:~x.indexOf("-")?Ev:sc(v,x)},core:{_removeProperty:_a,_getMatrix:mc}};Ha.utils.checkPrefix=fc,function(ae,v,x,T){var L=ue(ae+","+v+","+x,function(U){Ms[U]=1});ue(v,function(U){h.units[U]="deg",ka[U]=1}),ko[L[13]]=ae+","+v,ue(T,function(U){var z=U.split(":");ko[z[1]]=L[z[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY"),ue("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(ae){h.units[ae]="px"}),Ha.registerPlugin(Tl);var El=Ha.registerPlugin(Tl)||Ha,Al=El.core.Tween;n.Back=Fo,n.Bounce=_l,n.CSSPlugin=Tl,n.Circ=Mh,n.Cubic=iu,n.Elastic=uc,n.Expo=wh,n.Linear=id,n.Power0=Kr,n.Power1=ee,n.Power2=nd,n.Power3=Zp,n.Power4=ws,n.Quad=no,n.Quart=rd,n.Quint=lc,n.Sine=ru,n.SteppedEase=Bo,n.Strong=cc,n.TimelineLite=qr,n.TimelineMax=qr,n.TweenLite=ki,n.TweenMax=Al,n.default=El,n.gsap=El,typeof window>"u"||window!==n?Object.defineProperty(n,"__esModule",{value:!0}):delete window.default})});Os(Ns);var Oa=Ns.TweenMax,ms=ps(function(r,i){(function(n,l){l(i)})(ar,function(n){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),t=1;t<arguments.length;t++){var a=arguments[t];if(a!=null)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s});var l="121",u=0,h=1,p=2,g=1,_=2,b=3,A=0,S=1,R=2,E=1,N=0,W=1,V=2,B=3,O=4,pe=5,ge=100,ye=101,$=102,Ie=103,tt=104,qe=200,ft=201,je=202,Ne=203,Ue=204,Le=205,Te=206,Ve=207,We=208,at=209,Tt=210,nt=0,At=1,nn=2,Yt=3,K=4,H=5,xe=6,te=7,de=0,be=1,Re=2,we=0,Se=1,Pe=2,ze=3,Ze=4,Xe=5,Q=300,Y=301,He=302,Ge=303,ue=304,Je=306,ct=307,Ft=1e3,ut=1001,me=1002,it=1003,Rt=1004,mt=1005,Nt=1006,gn=1007,gi=1008,Or=1009,er=1010,Vr=1011,Ys=1012,ma=1013,ji=1014,Ci=1015,ns=1016,ga=1017,bs=1018,mr=1019,va=1020,Ea=1021,is=1022,re=1023,$e=1024,Ke=1025,ht=re,Bt=1026,Cn=1027,In=1028,Yn=1029,An=1030,Yi=1031,Zi=1032,on=1033,oi=33776,xr=33777,li=33778,tr=33779,cr=35840,Zs=35841,Lr=35842,Js=35843,br=36196,Ks=37492,vh=37496,Hf=37808,yh=37809,kf=37810,Vf=37811,Up=37812,Gp=37813,zp=37814,Wf=37815,Hp=37816,kp=37817,nc=37818,qf=37819,Vp=37820,Xf=37821,Aa=36492,ic=37840,dl=37841,Wp=37842,Mi=37843,rc=37844,_h=37845,jf=37846,Yf=37847,Zf=37848,$s=37849,qp=37850,Jf=37851,Yc=37852,La=37853,pl=2200,ii=2201,Xp=2202,Zc=2300,Jc=2301,xh=2302,ml=2400,Do=2401,ac=2402,Qs=2500,eo=2501,Kf=0,Wr=3e3,gl=3001,Kc=3007,Oo=3002,qr=3003,$f=3004,$c=3005,Qf=3006,ed=3200,to=3201,vl=0,jp=1,No=7680,td=519,Qc=35044,ki=35048,eu="300 es";function rs(){}Object.assign(rs.prototype,{addEventListener:function(e,s){this._listeners===void 0&&(this._listeners={});var t=this._listeners;t[e]===void 0&&(t[e]=[]),t[e].indexOf(s)===-1&&t[e].push(s)},hasEventListener:function(e,s){if(this._listeners===void 0)return!1;var t=this._listeners;return t[e]!==void 0&&t[e].indexOf(s)!==-1},removeEventListener:function(e,s){if(this._listeners!==void 0){var t=this._listeners,a=t[e];if(a!==void 0){var o=a.indexOf(s);o!==-1&&a.splice(o,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var s=this._listeners,t=s[e.type];if(t!==void 0){e.target=this;for(var a=t.slice(0),o=0,c=a.length;o<c;o++)a[o].call(this,e)}}}});for(var Xr=[],tu=0;tu<256;tu++)Xr[tu]=(tu<16?"0":"")+tu.toString(16);var sc=1234567,Ln={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,t=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=Xr[e&255]+Xr[e>>8&255]+Xr[e>>16&255]+Xr[e>>24&255]+"-"+Xr[s&255]+Xr[s>>8&255]+"-"+Xr[s>>16&15|64]+Xr[s>>24&255]+"-"+Xr[t&63|128]+Xr[t>>8&255]+"-"+Xr[t>>16&255]+Xr[t>>24&255]+Xr[a&255]+Xr[a>>8&255]+Xr[a>>16&255]+Xr[a>>24&255];return o.toUpperCase()},clamp:function(e,s,t){return Math.max(s,Math.min(t,e))},euclideanModulo:function(e,s){return(e%s+s)%s},mapLinear:function(e,s,t,a,o){return a+(e-s)*(o-a)/(t-s)},lerp:function(e,s,t){return(1-t)*e+t*s},smoothstep:function(e,s,t){return e<=s?0:e>=t?1:(e=(e-s)/(t-s),e*e*(3-2*e))},smootherstep:function(e,s,t){return e<=s?0:e>=t?1:(e=(e-s)/(t-s),e*e*e*(e*(e*6-15)+10))},randInt:function(e,s){return e+Math.floor(Math.random()*(s-e+1))},randFloat:function(e,s){return e+Math.random()*(s-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return e!==void 0&&(sc=e%2147483647),sc=sc*16807%2147483647,(sc-1)/2147483646},degToRad:function(e){return e*Ln.DEG2RAD},radToDeg:function(e){return e*Ln.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,s,t,a,o){var c=Math.cos,f=Math.sin,d=c(t/2),m=f(t/2),y=c((s+a)/2),w=f((s+a)/2),M=c((s-a)/2),D=f((s-a)/2),P=c((a-s)/2),F=f((a-s)/2);switch(o){case"XYX":e.set(d*w,m*M,m*D,d*y);break;case"YZY":e.set(m*D,d*w,m*M,d*y);break;case"ZXZ":e.set(m*M,m*D,d*w,d*y);break;case"XZX":e.set(d*w,m*F,m*P,d*y);break;case"YXY":e.set(m*P,d*w,m*F,d*y);break;case"ZYZ":e.set(m*F,m*P,d*w,d*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}};function Yp(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function nu(e,s,t){return s&&Yp(e.prototype,s),t&&Yp(e,t),e}function en(e,s){e.prototype=Object.create(s.prototype),e.prototype.constructor=e,e.__proto__=s}function oc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xt=function(){function e(t,a){t===void 0&&(t=0),a===void 0&&(a=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=a}var s=e.prototype;return s.set=function(t,a){return this.x=t,this.y=a,this},s.setScalar=function(t){return this.x=t,this.y=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y)},s.copy=function(t){return this.x=t.x,this.y=t.y,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this},s.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},s.divide=function(t){return this.x/=t.x,this.y/=t.y,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.applyMatrix3=function(t){var a=this.x,o=this.y,c=t.elements;return this.x=c[0]*a+c[3]*o+c[6],this.y=c[1]*a+c[4]*o+c[7],this},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this},s.dot=function(t){return this.x*t.x+this.y*t.y},s.cross=function(t){return this.x*t.y-this.y*t.x},s.lengthSq=function(){return this.x*this.x+this.y*this.y},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.angle=function(){var a=Math.atan2(-this.y,-this.x)+Math.PI;return a},s.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},s.distanceToSquared=function(t){var a=this.x-t.x,o=this.y-t.y;return a*a+o*o},s.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this},s.equals=function(t){return t.x===this.x&&t.y===this.y},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this},s.rotateAround=function(t,a){var o=Math.cos(a),c=Math.sin(a),f=this.x-t.x,d=this.y-t.y;return this.x=f*o-d*c+t.x,this.y=f*c+d*o+t.y,this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this},nu(e,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),e}(),aa=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var s=e.prototype;return s.set=function(t,a,o,c,f,d,m,y,w){var M=this.elements;return M[0]=t,M[1]=c,M[2]=m,M[3]=a,M[4]=f,M[5]=y,M[6]=o,M[7]=d,M[8]=w,this},s.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},s.clone=function(){return new this.constructor().fromArray(this.elements)},s.copy=function(t){var a=this.elements,o=t.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],this},s.extractBasis=function(t,a,o){return t.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this},s.setFromMatrix4=function(t){var a=t.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this},s.multiply=function(t){return this.multiplyMatrices(this,t)},s.premultiply=function(t){return this.multiplyMatrices(t,this)},s.multiplyMatrices=function(t,a){var o=t.elements,c=a.elements,f=this.elements,d=o[0],m=o[3],y=o[6],w=o[1],M=o[4],D=o[7],P=o[2],F=o[5],C=o[8],I=c[0],q=c[3],J=c[6],Z=c[1],G=c[4],j=c[7],ne=c[2],se=c[5],Ee=c[8];return f[0]=d*I+m*Z+y*ne,f[3]=d*q+m*G+y*se,f[6]=d*J+m*j+y*Ee,f[1]=w*I+M*Z+D*ne,f[4]=w*q+M*G+D*se,f[7]=w*J+M*j+D*Ee,f[2]=P*I+F*Z+C*ne,f[5]=P*q+F*G+C*se,f[8]=P*J+F*j+C*Ee,this},s.multiplyScalar=function(t){var a=this.elements;return a[0]*=t,a[3]*=t,a[6]*=t,a[1]*=t,a[4]*=t,a[7]*=t,a[2]*=t,a[5]*=t,a[8]*=t,this},s.determinant=function(){var t=this.elements,a=t[0],o=t[1],c=t[2],f=t[3],d=t[4],m=t[5],y=t[6],w=t[7],M=t[8];return a*d*M-a*m*w-o*f*M+o*m*y+c*f*w-c*d*y},s.getInverse=function(t,a){a!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var o=t.elements,c=this.elements,f=o[0],d=o[1],m=o[2],y=o[3],w=o[4],M=o[5],D=o[6],P=o[7],F=o[8],C=F*w-M*P,I=M*D-F*y,q=P*y-w*D,J=f*C+d*I+m*q;if(J===0)return this.set(0,0,0,0,0,0,0,0,0);var Z=1/J;return c[0]=C*Z,c[1]=(m*P-F*d)*Z,c[2]=(M*d-m*w)*Z,c[3]=I*Z,c[4]=(F*f-m*D)*Z,c[5]=(m*y-M*f)*Z,c[6]=q*Z,c[7]=(d*D-P*f)*Z,c[8]=(w*f-d*y)*Z,this},s.transpose=function(){var t,a=this.elements;return t=a[1],a[1]=a[3],a[3]=t,t=a[2],a[2]=a[6],a[6]=t,t=a[5],a[5]=a[7],a[7]=t,this},s.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},s.transposeIntoArray=function(t){var a=this.elements;return t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8],this},s.setUvTransform=function(t,a,o,c,f,d,m){var y=Math.cos(f),w=Math.sin(f);this.set(o*y,o*w,-o*(y*d+w*m)+d+t,-c*w,c*y,-c*(-w*d+y*m)+m+a,0,0,1)},s.scale=function(t,a){var o=this.elements;return o[0]*=t,o[3]*=t,o[6]*=t,o[1]*=a,o[4]*=a,o[7]*=a,this},s.rotate=function(t){var a=Math.cos(t),o=Math.sin(t),c=this.elements,f=c[0],d=c[3],m=c[6],y=c[1],w=c[4],M=c[7];return c[0]=a*f+o*y,c[3]=a*d+o*w,c[6]=a*m+o*M,c[1]=-o*f+a*y,c[4]=-o*d+a*w,c[7]=-o*m+a*M,this},s.translate=function(t,a){var o=this.elements;return o[0]+=t*o[2],o[3]+=t*o[5],o[6]+=t*o[8],o[1]+=a*o[2],o[4]+=a*o[5],o[7]+=a*o[8],this},s.equals=function(t){for(var a=this.elements,o=t.elements,c=0;c<9;c++)if(a[c]!==o[c])return!1;return!0},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=0;o<9;o++)this.elements[o]=t[o+a];return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);var o=this.elements;return t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3],t[a+4]=o[4],t[a+5]=o[5],t[a+6]=o[6],t[a+7]=o[7],t[a+8]=o[8],t},e}(),yl,gr={getDataURL:function(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;var s;if(e instanceof HTMLCanvasElement)s=e;else{yl===void 0&&(yl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),yl.width=e.width,yl.height=e.height;var t=yl.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),s=yl}return s.width>2048||s.height>2048?s.toDataURL("image/jpeg",.6):s.toDataURL("image/png")}},bh=0;function Si(e,s,t,a,o,c,f,d,m,y){Object.defineProperty(this,"id",{value:bh++}),this.uuid=Ln.generateUUID(),this.name="",this.image=e!==void 0?e:Si.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=s!==void 0?s:Si.DEFAULT_MAPPING,this.wrapS=t!==void 0?t:ut,this.wrapT=a!==void 0?a:ut,this.magFilter=o!==void 0?o:Nt,this.minFilter=c!==void 0?c:gi,this.anisotropy=m!==void 0?m:1,this.format=f!==void 0?f:re,this.internalFormat=null,this.type=d!==void 0?d:Or,this.offset=new xt(0,0),this.repeat=new xt(1,1),this.center=new xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new aa,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=y!==void 0?y:Wr,this.version=0,this.onUpdate=null}Si.DEFAULT_IMAGE=void 0,Si.DEFAULT_MAPPING=Q,Si.prototype=Object.assign(Object.create(rs.prototype),{constructor:Si,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var s=e===void 0||typeof e=="string";if(!s&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var a=this.image;if(a.uuid===void 0&&(a.uuid=Ln.generateUUID()),!s&&e.images[a.uuid]===void 0){var o;if(Array.isArray(a)){o=[];for(var c=0,f=a.length;c<f;c++)o.push(gr.getDataURL(a[c]))}else o=gr.getDataURL(a);e.images[a.uuid]={uuid:a.uuid,url:o}}t.image=a.uuid}return s||(e.textures[this.uuid]=t),t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==Q)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ft:e.x=e.x-Math.floor(e.x);break;case ut:e.x=e.x<0?0:1;break;case me:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ft:e.y=e.y-Math.floor(e.y);break;case ut:e.y=e.y<0?0:1;break;case me:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Si.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});var Ti=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=a,this.z=o,this.w=c}var s=e.prototype;return s.set=function(t,a,o,c){return this.x=t,this.y=a,this.z=o,this.w=c,this},s.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setZ=function(t){return this.z=t,this},s.setW=function(t){return this.w=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},s.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this.z=t.z+a.z,this.w=t.w+a.w,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this.z+=t.z*a,this.w+=t.w*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this.z=t.z-a.z,this.w=t.w-a.w,this},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},s.applyMatrix4=function(t){var a=this.x,o=this.y,c=this.z,f=this.w,d=t.elements;return this.x=d[0]*a+d[4]*o+d[8]*c+d[12]*f,this.y=d[1]*a+d[5]*o+d[9]*c+d[13]*f,this.z=d[2]*a+d[6]*o+d[10]*c+d[14]*f,this.w=d[3]*a+d[7]*o+d[11]*c+d[15]*f,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var a=Math.sqrt(1-t.w*t.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/a,this.y=t.y/a,this.z=t.z/a),this},s.setAxisAngleFromRotationMatrix=function(t){var a,o,c,f,d=.01,m=.1,y=t.elements,w=y[0],M=y[4],D=y[8],P=y[1],F=y[5],C=y[9],I=y[2],q=y[6],J=y[10];if(Math.abs(M-P)<d&&Math.abs(D-I)<d&&Math.abs(C-q)<d){if(Math.abs(M+P)<m&&Math.abs(D+I)<m&&Math.abs(C+q)<m&&Math.abs(w+F+J-3)<m)return this.set(1,0,0,0),this;a=Math.PI;var Z=(w+1)/2,G=(F+1)/2,j=(J+1)/2,ne=(M+P)/4,se=(D+I)/4,Ee=(C+q)/4;return Z>G&&Z>j?Z<d?(o=0,c=.707106781,f=.707106781):(o=Math.sqrt(Z),c=ne/o,f=se/o):G>j?G<d?(o=.707106781,c=0,f=.707106781):(c=Math.sqrt(G),o=ne/c,f=Ee/c):j<d?(o=.707106781,c=.707106781,f=0):(f=Math.sqrt(j),o=se/f,c=Ee/f),this.set(o,c,f,a),this}var Be=Math.sqrt((q-C)*(q-C)+(D-I)*(D-I)+(P-M)*(P-M));return Math.abs(Be)<.001&&(Be=1),this.x=(q-C)/Be,this.y=(D-I)/Be,this.z=(P-M)/Be,this.w=Math.acos((w+F+J-1)/2),this},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this.z=Math.max(t.z,Math.min(a.z,this.z)),this.w=Math.max(t.w,Math.min(a.w,this.w)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this.z=Math.max(t,Math.min(a,this.z)),this.w=Math.max(t,Math.min(a,this.w)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},s.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},s.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this.z+=(t.z-this.z)*a,this.w+=(t.w-this.w)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this.z=t.z+(a.z-t.z)*o,this.w=t.w+(a.w-t.w)*o,this},s.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this.z=t[a+2],this.w=t[a+3],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t[a+2]=this.z,t[a+3]=this.w,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this.z=t.getZ(a),this.w=t.getW(a),this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},nu(e,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),e}();function sa(e,s,t){this.width=e,this.height=s,this.scissor=new Ti(0,0,e,s),this.scissorTest=!1,this.viewport=new Ti(0,0,e,s),t=t||{},this.texture=new Si(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=s,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Nt,this.depthBuffer=t.depthBuffer!==void 0?t.depthBuffer:!0,this.stencilBuffer=t.stencilBuffer!==void 0?t.stencilBuffer:!1,this.depthTexture=t.depthTexture!==void 0?t.depthTexture:null}sa.prototype=Object.assign(Object.create(rs.prototype),{constructor:sa,isWebGLRenderTarget:!0,setSize:function(e,s){(this.width!==e||this.height!==s)&&(this.width=e,this.height=s,this.texture.image.width=e,this.texture.image.height=s,this.dispose()),this.viewport.set(0,0,e,s),this.scissor.set(0,0,e,s)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Ha(e,s,t){sa.call(this,e,s,t),this.samples=4}Ha.prototype=Object.assign(Object.create(sa.prototype),{constructor:Ha,isWebGLMultisampleRenderTarget:!0,copy:function(e){return sa.prototype.copy.call(this,e),this.samples=e.samples,this}});var Kr=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=a,this._z=o,this._w=c}e.slerp=function(t,a,o,c){return o.copy(t).slerp(a,c)},e.slerpFlat=function(t,a,o,c,f,d,m){var y=o[c+0],w=o[c+1],M=o[c+2],D=o[c+3],P=f[d+0],F=f[d+1],C=f[d+2],I=f[d+3];if(D!==I||y!==P||w!==F||M!==C){var q=1-m,J=y*P+w*F+M*C+D*I,Z=J>=0?1:-1,G=1-J*J;if(G>Number.EPSILON){var j=Math.sqrt(G),ne=Math.atan2(j,J*Z);q=Math.sin(q*ne)/j,m=Math.sin(m*ne)/j}var se=m*Z;if(y=y*q+P*se,w=w*q+F*se,M=M*q+C*se,D=D*q+I*se,q===1-m){var Ee=1/Math.sqrt(y*y+w*w+M*M+D*D);y*=Ee,w*=Ee,M*=Ee,D*=Ee}}t[a]=y,t[a+1]=w,t[a+2]=M,t[a+3]=D},e.multiplyQuaternionsFlat=function(t,a,o,c,f,d){var m=o[c],y=o[c+1],w=o[c+2],M=o[c+3],D=f[d],P=f[d+1],F=f[d+2],C=f[d+3];return t[a]=m*C+M*D+y*F-w*P,t[a+1]=y*C+M*P+w*D-m*F,t[a+2]=w*C+M*F+m*P-y*D,t[a+3]=M*C-m*D-y*P-w*F,t};var s=e.prototype;return s.set=function(t,a,o,c){return this._x=t,this._y=a,this._z=o,this._w=c,this._onChangeCallback(),this},s.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},s.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},s.setFromEuler=function(t,a){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=t._x,c=t._y,f=t._z,d=t._order,m=Math.cos,y=Math.sin,w=m(o/2),M=m(c/2),D=m(f/2),P=y(o/2),F=y(c/2),C=y(f/2);switch(d){case"XYZ":this._x=P*M*D+w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D-P*F*C;break;case"YXZ":this._x=P*M*D+w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D+P*F*C;break;case"ZXY":this._x=P*M*D-w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D-P*F*C;break;case"ZYX":this._x=P*M*D-w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D+P*F*C;break;case"YZX":this._x=P*M*D+w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D-P*F*C;break;case"XZY":this._x=P*M*D-w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D+P*F*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return a!==!1&&this._onChangeCallback(),this},s.setFromAxisAngle=function(t,a){var o=a/2,c=Math.sin(o);return this._x=t.x*c,this._y=t.y*c,this._z=t.z*c,this._w=Math.cos(o),this._onChangeCallback(),this},s.setFromRotationMatrix=function(t){var a=t.elements,o=a[0],c=a[4],f=a[8],d=a[1],m=a[5],y=a[9],w=a[2],M=a[6],D=a[10],P=o+m+D;if(P>0){var F=.5/Math.sqrt(P+1);this._w=.25/F,this._x=(M-y)*F,this._y=(f-w)*F,this._z=(d-c)*F}else if(o>m&&o>D){var C=2*Math.sqrt(1+o-m-D);this._w=(M-y)/C,this._x=.25*C,this._y=(c+d)/C,this._z=(f+w)/C}else if(m>D){var I=2*Math.sqrt(1+m-o-D);this._w=(f-w)/I,this._x=(c+d)/I,this._y=.25*I,this._z=(y+M)/I}else{var q=2*Math.sqrt(1+D-o-m);this._w=(d-c)/q,this._x=(f+w)/q,this._y=(y+M)/q,this._z=.25*q}return this._onChangeCallback(),this},s.setFromUnitVectors=function(t,a){var o=t.dot(a)+1;return o<1e-6?(o=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=o):(this._x=0,this._y=-t.z,this._z=t.y,this._w=o)):(this._x=t.y*a.z-t.z*a.y,this._y=t.z*a.x-t.x*a.z,this._z=t.x*a.y-t.y*a.x,this._w=o),this.normalize()},s.angleTo=function(t){return 2*Math.acos(Math.abs(Ln.clamp(this.dot(t),-1,1)))},s.rotateTowards=function(t,a){var o=this.angleTo(t);if(o===0)return this;var c=Math.min(1,a/o);return this.slerp(t,c),this},s.identity=function(){return this.set(0,0,0,1)},s.inverse=function(){return this.conjugate()},s.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},s.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},s.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},s.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},s.normalize=function(){var t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,a)):this.multiplyQuaternions(this,t)},s.premultiply=function(t){return this.multiplyQuaternions(t,this)},s.multiplyQuaternions=function(t,a){var o=t._x,c=t._y,f=t._z,d=t._w,m=a._x,y=a._y,w=a._z,M=a._w;return this._x=o*M+d*m+c*w-f*y,this._y=c*M+d*y+f*m-o*w,this._z=f*M+d*w+o*y-c*m,this._w=d*M-o*m-c*y-f*w,this._onChangeCallback(),this},s.slerp=function(t,a){if(a===0)return this;if(a===1)return this.copy(t);var o=this._x,c=this._y,f=this._z,d=this._w,m=d*t._w+o*t._x+c*t._y+f*t._z;if(m<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,m=-m):this.copy(t),m>=1)return this._w=d,this._x=o,this._y=c,this._z=f,this;var y=1-m*m;if(y<=Number.EPSILON){var w=1-a;return this._w=w*d+a*this._w,this._x=w*o+a*this._x,this._y=w*c+a*this._y,this._z=w*f+a*this._z,this.normalize(),this._onChangeCallback(),this}var M=Math.sqrt(y),D=Math.atan2(M,m),P=Math.sin((1-a)*D)/M,F=Math.sin(a*D)/M;return this._w=d*P+this._w*F,this._x=o*P+this._x*F,this._y=c*P+this._y*F,this._z=f*P+this._z*F,this._onChangeCallback(),this},s.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},s.fromArray=function(t,a){return a===void 0&&(a=0),this._x=t[a],this._y=t[a+1],this._z=t[a+2],this._w=t[a+3],this._onChangeCallback(),this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this._x,t[a+1]=this._y,t[a+2]=this._z,t[a+3]=this._w,t},s.fromBufferAttribute=function(t,a){return this._x=t.getX(a),this._y=t.getY(a),this._z=t.getZ(a),this._w=t.getW(a),this},s._onChange=function(t){return this._onChangeCallback=t,this},s._onChangeCallback=function(){},nu(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),e}(),ee=function(){function e(t,a,o){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=a,this.z=o}var s=e.prototype;return s.set=function(t,a,o){return o===void 0&&(o=this.z),this.x=t,this.y=a,this.z=o,this},s.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setZ=function(t){return this.z=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y,this.z)},s.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this.z=t.z+a.z,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this.z+=t.z*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this.z=t.z-a.z,this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,a)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},s.multiplyVectors=function(t,a){return this.x=t.x*a.x,this.y=t.y*a.y,this.z=t.z*a.z,this},s.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Zp.setFromEuler(t))},s.applyAxisAngle=function(t,a){return this.applyQuaternion(Zp.setFromAxisAngle(t,a))},s.applyMatrix3=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements;return this.x=f[0]*a+f[3]*o+f[6]*c,this.y=f[1]*a+f[4]*o+f[7]*c,this.z=f[2]*a+f[5]*o+f[8]*c,this},s.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},s.applyMatrix4=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements,d=1/(f[3]*a+f[7]*o+f[11]*c+f[15]);return this.x=(f[0]*a+f[4]*o+f[8]*c+f[12])*d,this.y=(f[1]*a+f[5]*o+f[9]*c+f[13])*d,this.z=(f[2]*a+f[6]*o+f[10]*c+f[14])*d,this},s.applyQuaternion=function(t){var a=this.x,o=this.y,c=this.z,f=t.x,d=t.y,m=t.z,y=t.w,w=y*a+d*c-m*o,M=y*o+m*a-f*c,D=y*c+f*o-d*a,P=-f*a-d*o-m*c;return this.x=w*y+P*-f+M*-m-D*-d,this.y=M*y+P*-d+D*-f-w*-m,this.z=D*y+P*-m+w*-d-M*-f,this},s.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},s.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},s.transformDirection=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements;return this.x=f[0]*a+f[4]*o+f[8]*c,this.y=f[1]*a+f[5]*o+f[9]*c,this.z=f[2]*a+f[6]*o+f[10]*c,this.normalize()},s.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this.z=Math.max(t.z,Math.min(a.z,this.z)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this.z=Math.max(t,Math.min(a,this.z)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},s.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},s.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this.z+=(t.z-this.z)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this.z=t.z+(a.z-t.z)*o,this},s.cross=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,a)):this.crossVectors(this,t)},s.crossVectors=function(t,a){var o=t.x,c=t.y,f=t.z,d=a.x,m=a.y,y=a.z;return this.x=c*y-f*m,this.y=f*d-o*y,this.z=o*m-c*d,this},s.projectOnVector=function(t){var a=t.lengthSq();if(a===0)return this.set(0,0,0);var o=t.dot(this)/a;return this.copy(t).multiplyScalar(o)},s.projectOnPlane=function(t){return nd.copy(this).projectOnVector(t),this.sub(nd)},s.reflect=function(t){return this.sub(nd.copy(t).multiplyScalar(2*this.dot(t)))},s.angleTo=function(t){var a=Math.sqrt(this.lengthSq()*t.lengthSq());if(a===0)return Math.PI/2;var o=this.dot(t)/a;return Math.acos(Ln.clamp(o,-1,1))},s.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},s.distanceToSquared=function(t){var a=this.x-t.x,o=this.y-t.y,c=this.z-t.z;return a*a+o*o+c*c},s.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},s.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},s.setFromSphericalCoords=function(t,a,o){var c=Math.sin(a)*t;return this.x=c*Math.sin(o),this.y=Math.cos(a)*t,this.z=c*Math.cos(o),this},s.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},s.setFromCylindricalCoords=function(t,a,o){return this.x=t*Math.sin(a),this.y=o,this.z=t*Math.cos(a),this},s.setFromMatrixPosition=function(t){var a=t.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this},s.setFromMatrixScale=function(t){var a=this.setFromMatrixColumn(t,0).length(),o=this.setFromMatrixColumn(t,1).length(),c=this.setFromMatrixColumn(t,2).length();return this.x=a,this.y=o,this.z=c,this},s.setFromMatrixColumn=function(t,a){return this.fromArray(t.elements,a*4)},s.setFromMatrix3Column=function(t,a){return this.fromArray(t.elements,a*3)},s.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this.z=t[a+2],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t[a+2]=this.z,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this.z=t.getZ(a),this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),nd=new ee,Zp=new Kr,ws=function(){function e(t,a){Object.defineProperty(this,"isBox3",{value:!0}),this.min=t!==void 0?t:new ee(1/0,1/0,1/0),this.max=a!==void 0?a:new ee(-1/0,-1/0,-1/0)}var s=e.prototype;return s.set=function(t,a){return this.min.copy(t),this.max.copy(a),this},s.setFromArray=function(t){for(var a=1/0,o=1/0,c=1/0,f=-1/0,d=-1/0,m=-1/0,y=0,w=t.length;y<w;y+=3){var M=t[y],D=t[y+1],P=t[y+2];M<a&&(a=M),D<o&&(o=D),P<c&&(c=P),M>f&&(f=M),D>d&&(d=D),P>m&&(m=P)}return this.min.set(a,o,c),this.max.set(f,d,m),this},s.setFromBufferAttribute=function(t){for(var a=1/0,o=1/0,c=1/0,f=-1/0,d=-1/0,m=-1/0,y=0,w=t.count;y<w;y++){var M=t.getX(y),D=t.getY(y),P=t.getZ(y);M<a&&(a=M),D<o&&(o=D),P<c&&(c=P),M>f&&(f=M),D>d&&(d=D),P>m&&(m=P)}return this.min.set(a,o,c),this.max.set(f,d,m),this},s.setFromPoints=function(t){this.makeEmpty();for(var a=0,o=t.length;a<o;a++)this.expandByPoint(t[a]);return this},s.setFromCenterAndSize=function(t,a){var o=iu.copy(a).multiplyScalar(.5);return this.min.copy(t).sub(o),this.max.copy(t).add(o),this},s.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},s.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},s.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ee),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},s.getSize=function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ee),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},s.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},s.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},s.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},s.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var a=t.geometry;a!==void 0&&(a.boundingBox===null&&a.computeBoundingBox(),rd.copy(a.boundingBox),rd.applyMatrix4(t.matrixWorld),this.union(rd));for(var o=t.children,c=0,f=o.length;c<f;c++)this.expandByObject(o[c]);return this},s.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},s.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},s.getParameter=function(t,a){return a===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),a=new ee),a.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},s.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},s.intersectsSphere=function(t){return this.clampPoint(t.center,iu),iu.distanceToSquared(t.center)<=t.radius*t.radius},s.intersectsPlane=function(t){var a,o;return t.normal.x>0?(a=t.normal.x*this.min.x,o=t.normal.x*this.max.x):(a=t.normal.x*this.max.x,o=t.normal.x*this.min.x),t.normal.y>0?(a+=t.normal.y*this.min.y,o+=t.normal.y*this.max.y):(a+=t.normal.y*this.max.y,o+=t.normal.y*this.min.y),t.normal.z>0?(a+=t.normal.z*this.min.z,o+=t.normal.z*this.max.z):(a+=t.normal.z*this.max.z,o+=t.normal.z*this.min.z),a<=-t.constant&&o>=-t.constant},s.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(ru),wh.subVectors(this.max,ru),lc.subVectors(t.a,ru),cc.subVectors(t.b,ru),uc.subVectors(t.c,ru),Fo.subVectors(cc,lc),Bo.subVectors(uc,cc),_l.subVectors(lc,uc);var a=[0,-Fo.z,Fo.y,0,-Bo.z,Bo.y,0,-_l.z,_l.y,Fo.z,0,-Fo.x,Bo.z,0,-Bo.x,_l.z,0,-_l.x,-Fo.y,Fo.x,0,-Bo.y,Bo.x,0,-_l.y,_l.x,0];return!id(a,lc,cc,uc,wh)||(a=[1,0,0,0,1,0,0,0,1],!id(a,lc,cc,uc,wh))?!1:(Mh.crossVectors(Fo,Bo),a=[Mh.x,Mh.y,Mh.z],id(a,lc,cc,uc,wh))},s.clampPoint=function(t,a){return a===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),a=new ee),a.copy(t).clamp(this.min,this.max)},s.distanceToPoint=function(t){var a=iu.copy(t).clamp(this.min,this.max);return a.sub(t).length()},s.getBoundingSphere=function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(iu).length()*.5,t},s.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},s.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},s.applyMatrix4=function(t){return this.isEmpty()?this:(no[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),no[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),no[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),no[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),no[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),no[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),no[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),no[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(no),this)},s.translate=function(t){return this.min.add(t),this.max.add(t),this},s.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}();function id(e,s,t,a,o){for(var c=0,f=e.length-3;c<=f;c+=3){Uo.fromArray(e,c);var d=o.x*Math.abs(Uo.x)+o.y*Math.abs(Uo.y)+o.z*Math.abs(Uo.z),m=s.dot(Uo),y=t.dot(Uo),w=a.dot(Uo);if(Math.max(-Math.max(m,y,w),Math.min(m,y,w))>d)return!1}return!0}var no=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee],iu=new ee,rd=new ws,lc=new ee,cc=new ee,uc=new ee,Fo=new ee,Bo=new ee,_l=new ee,ru=new ee,wh=new ee,Mh=new ee,Uo=new ee,Go=new ws,ya=function(){function e(t,a){this.center=t!==void 0?t:new ee,this.radius=a!==void 0?a:-1}var s=e.prototype;return s.set=function(t,a){return this.center.copy(t),this.radius=a,this},s.setFromPoints=function(t,a){var o=this.center;a!==void 0?o.copy(a):Go.setFromPoints(t).getCenter(o);for(var c=0,f=0,d=t.length;f<d;f++)c=Math.max(c,o.distanceToSquared(t[f]));return this.radius=Math.sqrt(c),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},s.isEmpty=function(){return this.radius<0},s.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},s.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},s.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},s.intersectsSphere=function(t){var a=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=a*a},s.intersectsBox=function(t){return t.intersectsSphere(this)},s.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},s.clampPoint=function(t,a){var o=this.center.distanceToSquared(t);return a===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),a=new ee),a.copy(t),o>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a},s.getBoundingBox=function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new ws),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},s.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},s.translate=function(t){return this.center.add(t),this},s.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},e}(),as=new ee,io=new ee,au=new ee,zo=new ee,Ms=new ee,Ss=new ee,Ho=new ee,ss=function(){function e(t,a){this.origin=t!==void 0?t:new ee,this.direction=a!==void 0?a:new ee(0,0,-1)}var s=e.prototype;return s.set=function(t,a){return this.origin.copy(t),this.direction.copy(a),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},s.at=function(t,a){return a===void 0&&(console.warn("THREE.Ray: .at() target is now required"),a=new ee),a.copy(this.direction).multiplyScalar(t).add(this.origin)},s.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},s.recast=function(t){return this.origin.copy(this.at(t,as)),this},s.closestPointToPoint=function(t,a){a===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),a=new ee),a.subVectors(t,this.origin);var o=a.dot(this.direction);return o<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(o).add(this.origin)},s.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},s.distanceSqToPoint=function(t){var a=as.subVectors(t,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(t):(as.copy(this.direction).multiplyScalar(a).add(this.origin),as.distanceToSquared(t))},s.distanceSqToSegment=function(t,a,o,c){io.copy(t).add(a).multiplyScalar(.5),au.copy(a).sub(t).normalize(),zo.copy(this.origin).sub(io);var f=t.distanceTo(a)*.5,d=-this.direction.dot(au),m=zo.dot(this.direction),y=-zo.dot(au),w=zo.lengthSq(),M=Math.abs(1-d*d),D,P,F,C;if(M>0)if(D=d*y-m,P=d*m-y,C=f*M,D>=0)if(P>=-C)if(P<=C){var I=1/M;D*=I,P*=I,F=D*(D+d*P+2*m)+P*(d*D+P+2*y)+w}else P=f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;else P=-f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;else P<=-C?(D=Math.max(0,-(-d*f+m)),P=D>0?-f:Math.min(Math.max(-f,-y),f),F=-D*D+P*(P+2*y)+w):P<=C?(D=0,P=Math.min(Math.max(-f,-y),f),F=P*(P+2*y)+w):(D=Math.max(0,-(d*f+m)),P=D>0?f:Math.min(Math.max(-f,-y),f),F=-D*D+P*(P+2*y)+w);else P=d>0?-f:f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;return o&&o.copy(this.direction).multiplyScalar(D).add(this.origin),c&&c.copy(au).multiplyScalar(P).add(io),F},s.intersectSphere=function(t,a){as.subVectors(t.center,this.origin);var o=as.dot(this.direction),c=as.dot(as)-o*o,f=t.radius*t.radius;if(c>f)return null;var d=Math.sqrt(f-c),m=o-d,y=o+d;return m<0&&y<0?null:m<0?this.at(y,a):this.at(m,a)},s.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},s.distanceToPlane=function(t){var a=t.normal.dot(this.direction);if(a===0)return t.distanceToPoint(this.origin)===0?0:null;var o=-(this.origin.dot(t.normal)+t.constant)/a;return o>=0?o:null},s.intersectPlane=function(t,a){var o=this.distanceToPlane(t);return o===null?null:this.at(o,a)},s.intersectsPlane=function(t){var a=t.distanceToPoint(this.origin);if(a===0)return!0;var o=t.normal.dot(this.direction);return o*a<0},s.intersectBox=function(t,a){var o,c,f,d,m,y,w=1/this.direction.x,M=1/this.direction.y,D=1/this.direction.z,P=this.origin;return w>=0?(o=(t.min.x-P.x)*w,c=(t.max.x-P.x)*w):(o=(t.max.x-P.x)*w,c=(t.min.x-P.x)*w),M>=0?(f=(t.min.y-P.y)*M,d=(t.max.y-P.y)*M):(f=(t.max.y-P.y)*M,d=(t.min.y-P.y)*M),o>d||f>c||((f>o||o!==o)&&(o=f),(d<c||c!==c)&&(c=d),D>=0?(m=(t.min.z-P.z)*D,y=(t.max.z-P.z)*D):(m=(t.max.z-P.z)*D,y=(t.min.z-P.z)*D),o>y||m>c)||((m>o||o!==o)&&(o=m),(y<c||c!==c)&&(c=y),c<0)?null:this.at(o>=0?o:c,a)},s.intersectsBox=function(t){return this.intersectBox(t,as)!==null},s.intersectTriangle=function(t,a,o,c,f){Ms.subVectors(a,t),Ss.subVectors(o,t),Ho.crossVectors(Ms,Ss);var d=this.direction.dot(Ho),m;if(d>0){if(c)return null;m=1}else if(d<0)m=-1,d=-d;else return null;zo.subVectors(this.origin,t);var y=m*this.direction.dot(Ss.crossVectors(zo,Ss));if(y<0)return null;var w=m*this.direction.dot(Ms.cross(zo));if(w<0||y+w>d)return null;var M=-m*zo.dot(Ho);return M<0?null:this.at(M/d,f)},s.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},s.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},e}(),qn=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var s=e.prototype;return s.set=function(t,a,o,c,f,d,m,y,w,M,D,P,F,C,I,q){var J=this.elements;return J[0]=t,J[4]=a,J[8]=o,J[12]=c,J[1]=f,J[5]=d,J[9]=m,J[13]=y,J[2]=w,J[6]=M,J[10]=D,J[14]=P,J[3]=F,J[7]=C,J[11]=I,J[15]=q,this},s.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},s.clone=function(){return new e().fromArray(this.elements)},s.copy=function(t){var a=this.elements,o=t.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],this},s.copyPosition=function(t){var a=this.elements,o=t.elements;return a[12]=o[12],a[13]=o[13],a[14]=o[14],this},s.extractBasis=function(t,a,o){return t.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},s.makeBasis=function(t,a,o){return this.set(t.x,a.x,o.x,0,t.y,a.y,o.y,0,t.z,a.z,o.z,0,0,0,0,1),this},s.extractRotation=function(t){var a=this.elements,o=t.elements,c=1/xl.setFromMatrixColumn(t,0).length(),f=1/xl.setFromMatrixColumn(t,1).length(),d=1/xl.setFromMatrixColumn(t,2).length();return a[0]=o[0]*c,a[1]=o[1]*c,a[2]=o[2]*c,a[3]=0,a[4]=o[4]*f,a[5]=o[5]*f,a[6]=o[6]*f,a[7]=0,a[8]=o[8]*d,a[9]=o[9]*d,a[10]=o[10]*d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},s.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var a=this.elements,o=t.x,c=t.y,f=t.z,d=Math.cos(o),m=Math.sin(o),y=Math.cos(c),w=Math.sin(c),M=Math.cos(f),D=Math.sin(f);if(t.order==="XYZ"){var P=d*M,F=d*D,C=m*M,I=m*D;a[0]=y*M,a[4]=-y*D,a[8]=w,a[1]=F+C*w,a[5]=P-I*w,a[9]=-m*y,a[2]=I-P*w,a[6]=C+F*w,a[10]=d*y}else if(t.order==="YXZ"){var q=y*M,J=y*D,Z=w*M,G=w*D;a[0]=q+G*m,a[4]=Z*m-J,a[8]=d*w,a[1]=d*D,a[5]=d*M,a[9]=-m,a[2]=J*m-Z,a[6]=G+q*m,a[10]=d*y}else if(t.order==="ZXY"){var j=y*M,ne=y*D,se=w*M,Ee=w*D;a[0]=j-Ee*m,a[4]=-d*D,a[8]=se+ne*m,a[1]=ne+se*m,a[5]=d*M,a[9]=Ee-j*m,a[2]=-d*w,a[6]=m,a[10]=d*y}else if(t.order==="ZYX"){var Be=d*M,ce=d*D,oe=m*M,ie=m*D;a[0]=y*M,a[4]=oe*w-ce,a[8]=Be*w+ie,a[1]=y*D,a[5]=ie*w+Be,a[9]=ce*w-oe,a[2]=-w,a[6]=m*y,a[10]=d*y}else if(t.order==="YZX"){var Ce=d*y,De=d*w,Oe=m*y,et=m*w;a[0]=y*M,a[4]=et-Ce*D,a[8]=Oe*D+De,a[1]=D,a[5]=d*M,a[9]=-m*M,a[2]=-w*M,a[6]=De*D+Oe,a[10]=Ce-et*D}else if(t.order==="XZY"){var gt=d*y,pt=d*w,lt=m*y,St=m*w;a[0]=y*M,a[4]=-D,a[8]=w*M,a[1]=gt*D+St,a[5]=d*M,a[9]=pt*D-lt,a[2]=lt*D-pt,a[6]=m*M,a[10]=St*D+gt}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},s.makeRotationFromQuaternion=function(t){return this.compose(Tv,t,ko)},s.lookAt=function(t,a,o){var c=this.elements;return Ra.subVectors(t,a),Ra.lengthSq()===0&&(Ra.z=1),Ra.normalize(),ro.crossVectors(o,Ra),ro.lengthSq()===0&&(Math.abs(o.z)===1?Ra.x+=1e-4:Ra.z+=1e-4,Ra.normalize(),ro.crossVectors(o,Ra)),ro.normalize(),Sh.crossVectors(Ra,ro),c[0]=ro.x,c[4]=Sh.x,c[8]=Ra.x,c[1]=ro.y,c[5]=Sh.y,c[9]=Ra.y,c[2]=ro.z,c[6]=Sh.z,c[10]=Ra.z,this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,a)):this.multiplyMatrices(this,t)},s.premultiply=function(t){return this.multiplyMatrices(t,this)},s.multiplyMatrices=function(t,a){var o=t.elements,c=a.elements,f=this.elements,d=o[0],m=o[4],y=o[8],w=o[12],M=o[1],D=o[5],P=o[9],F=o[13],C=o[2],I=o[6],q=o[10],J=o[14],Z=o[3],G=o[7],j=o[11],ne=o[15],se=c[0],Ee=c[4],Be=c[8],ce=c[12],oe=c[1],ie=c[5],Ce=c[9],De=c[13],Oe=c[2],et=c[6],gt=c[10],pt=c[14],lt=c[3],St=c[7],Ht=c[11],Ut=c[15];return f[0]=d*se+m*oe+y*Oe+w*lt,f[4]=d*Ee+m*ie+y*et+w*St,f[8]=d*Be+m*Ce+y*gt+w*Ht,f[12]=d*ce+m*De+y*pt+w*Ut,f[1]=M*se+D*oe+P*Oe+F*lt,f[5]=M*Ee+D*ie+P*et+F*St,f[9]=M*Be+D*Ce+P*gt+F*Ht,f[13]=M*ce+D*De+P*pt+F*Ut,f[2]=C*se+I*oe+q*Oe+J*lt,f[6]=C*Ee+I*ie+q*et+J*St,f[10]=C*Be+I*Ce+q*gt+J*Ht,f[14]=C*ce+I*De+q*pt+J*Ut,f[3]=Z*se+G*oe+j*Oe+ne*lt,f[7]=Z*Ee+G*ie+j*et+ne*St,f[11]=Z*Be+G*Ce+j*gt+ne*Ht,f[15]=Z*ce+G*De+j*pt+ne*Ut,this},s.multiplyScalar=function(t){var a=this.elements;return a[0]*=t,a[4]*=t,a[8]*=t,a[12]*=t,a[1]*=t,a[5]*=t,a[9]*=t,a[13]*=t,a[2]*=t,a[6]*=t,a[10]*=t,a[14]*=t,a[3]*=t,a[7]*=t,a[11]*=t,a[15]*=t,this},s.determinant=function(){var t=this.elements,a=t[0],o=t[4],c=t[8],f=t[12],d=t[1],m=t[5],y=t[9],w=t[13],M=t[2],D=t[6],P=t[10],F=t[14],C=t[3],I=t[7],q=t[11],J=t[15];return C*(+f*y*D-c*w*D-f*m*P+o*w*P+c*m*F-o*y*F)+I*(+a*y*F-a*w*P+f*d*P-c*d*F+c*w*M-f*y*M)+q*(+a*w*D-a*m*F-f*d*D+o*d*F+f*m*M-o*w*M)+J*(-c*m*M-a*y*D+a*m*P+c*d*D-o*d*P+o*y*M)},s.transpose=function(){var t=this.elements,a=t[1];return t[1]=t[4],t[4]=a,a=t[2],t[2]=t[8],t[8]=a,a=t[6],t[6]=t[9],t[9]=a,a=t[3],t[3]=t[12],t[12]=a,a=t[7],t[7]=t[13],t[13]=a,a=t[11],t[11]=t[14],t[14]=a,this},s.setPosition=function(t,a,o){var c=this.elements;return t.isVector3?(c[12]=t.x,c[13]=t.y,c[14]=t.z):(c[12]=t,c[13]=a,c[14]=o),this},s.getInverse=function(t,a){a!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var o=this.elements,c=t.elements,f=c[0],d=c[1],m=c[2],y=c[3],w=c[4],M=c[5],D=c[6],P=c[7],F=c[8],C=c[9],I=c[10],q=c[11],J=c[12],Z=c[13],G=c[14],j=c[15],ne=C*G*P-Z*I*P+Z*D*q-M*G*q-C*D*j+M*I*j,se=J*I*P-F*G*P-J*D*q+w*G*q+F*D*j-w*I*j,Ee=F*Z*P-J*C*P+J*M*q-w*Z*q-F*M*j+w*C*j,Be=J*C*D-F*Z*D-J*M*I+w*Z*I+F*M*G-w*C*G,ce=f*ne+d*se+m*Ee+y*Be;if(ce===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var oe=1/ce;return o[0]=ne*oe,o[1]=(Z*I*y-C*G*y-Z*m*q+d*G*q+C*m*j-d*I*j)*oe,o[2]=(M*G*y-Z*D*y+Z*m*P-d*G*P-M*m*j+d*D*j)*oe,o[3]=(C*D*y-M*I*y-C*m*P+d*I*P+M*m*q-d*D*q)*oe,o[4]=se*oe,o[5]=(F*G*y-J*I*y+J*m*q-f*G*q-F*m*j+f*I*j)*oe,o[6]=(J*D*y-w*G*y-J*m*P+f*G*P+w*m*j-f*D*j)*oe,o[7]=(w*I*y-F*D*y+F*m*P-f*I*P-w*m*q+f*D*q)*oe,o[8]=Ee*oe,o[9]=(J*C*y-F*Z*y-J*d*q+f*Z*q+F*d*j-f*C*j)*oe,o[10]=(w*Z*y-J*M*y+J*d*P-f*Z*P-w*d*j+f*M*j)*oe,o[11]=(F*M*y-w*C*y-F*d*P+f*C*P+w*d*q-f*M*q)*oe,o[12]=Be*oe,o[13]=(F*Z*m-J*C*m+J*d*I-f*Z*I-F*d*G+f*C*G)*oe,o[14]=(J*M*m-w*Z*m-J*d*D+f*Z*D+w*d*G-f*M*G)*oe,o[15]=(w*C*m-F*M*m+F*d*D-f*C*D-w*d*I+f*M*I)*oe,this},s.scale=function(t){var a=this.elements,o=t.x,c=t.y,f=t.z;return a[0]*=o,a[4]*=c,a[8]*=f,a[1]*=o,a[5]*=c,a[9]*=f,a[2]*=o,a[6]*=c,a[10]*=f,a[3]*=o,a[7]*=c,a[11]*=f,this},s.getMaxScaleOnAxis=function(){var t=this.elements,a=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],o=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],c=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(a,o,c))},s.makeTranslation=function(t,a,o){return this.set(1,0,0,t,0,1,0,a,0,0,1,o,0,0,0,1),this},s.makeRotationX=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(1,0,0,0,0,a,-o,0,0,o,a,0,0,0,0,1),this},s.makeRotationY=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(a,0,o,0,0,1,0,0,-o,0,a,0,0,0,0,1),this},s.makeRotationZ=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(a,-o,0,0,o,a,0,0,0,0,1,0,0,0,0,1),this},s.makeRotationAxis=function(t,a){var o=Math.cos(a),c=Math.sin(a),f=1-o,d=t.x,m=t.y,y=t.z,w=f*d,M=f*m;return this.set(w*d+o,w*m-c*y,w*y+c*m,0,w*m+c*y,M*m+o,M*y-c*d,0,w*y-c*m,M*y+c*d,f*y*y+o,0,0,0,0,1),this},s.makeScale=function(t,a,o){return this.set(t,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1),this},s.makeShear=function(t,a,o){return this.set(1,a,o,0,t,1,o,0,t,a,1,0,0,0,0,1),this},s.compose=function(t,a,o){var c=this.elements,f=a._x,d=a._y,m=a._z,y=a._w,w=f+f,M=d+d,D=m+m,P=f*w,F=f*M,C=f*D,I=d*M,q=d*D,J=m*D,Z=y*w,G=y*M,j=y*D,ne=o.x,se=o.y,Ee=o.z;return c[0]=(1-(I+J))*ne,c[1]=(F+j)*ne,c[2]=(C-G)*ne,c[3]=0,c[4]=(F-j)*se,c[5]=(1-(P+J))*se,c[6]=(q+Z)*se,c[7]=0,c[8]=(C+G)*Ee,c[9]=(q-Z)*Ee,c[10]=(1-(P+I))*Ee,c[11]=0,c[12]=t.x,c[13]=t.y,c[14]=t.z,c[15]=1,this},s.decompose=function(t,a,o){var c=this.elements,f=xl.set(c[0],c[1],c[2]).length(),d=xl.set(c[4],c[5],c[6]).length(),m=xl.set(c[8],c[9],c[10]).length(),y=this.determinant();y<0&&(f=-f),t.x=c[12],t.y=c[13],t.z=c[14],os.copy(this);var w=1/f,M=1/d,D=1/m;return os.elements[0]*=w,os.elements[1]*=w,os.elements[2]*=w,os.elements[4]*=M,os.elements[5]*=M,os.elements[6]*=M,os.elements[8]*=D,os.elements[9]*=D,os.elements[10]*=D,a.setFromRotationMatrix(os),o.x=f,o.y=d,o.z=m,this},s.makePerspective=function(t,a,o,c,f,d){d===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var m=this.elements;return m[0]=2*f/(a-t),m[4]=0,m[8]=(a+t)/(a-t),m[12]=0,m[1]=0,m[5]=2*f/(o-c),m[9]=(o+c)/(o-c),m[13]=0,m[2]=0,m[6]=0,m[10]=-(d+f)/(d-f),m[14]=-2*d*f/(d-f),m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this},s.makeOrthographic=function(t,a,o,c,f,d){var m=this.elements,y=1/(a-t),w=1/(o-c),M=1/(d-f);return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-((a+t)*y),m[1]=0,m[5]=2*w,m[9]=0,m[13]=-((o+c)*w),m[2]=0,m[6]=0,m[10]=-2*M,m[14]=-((d+f)*M),m[3]=0,m[7]=0,m[11]=0,m[15]=1,this},s.equals=function(t){for(var a=this.elements,o=t.elements,c=0;c<16;c++)if(a[c]!==o[c])return!1;return!0},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=0;o<16;o++)this.elements[o]=t[o+a];return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);var o=this.elements;return t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3],t[a+4]=o[4],t[a+5]=o[5],t[a+6]=o[6],t[a+7]=o[7],t[a+8]=o[8],t[a+9]=o[9],t[a+10]=o[10],t[a+11]=o[11],t[a+12]=o[12],t[a+13]=o[13],t[a+14]=o[14],t[a+15]=o[15],t},e}(),xl=new ee,os=new qn,Tv=new ee(0,0,0),ko=new ee(1,1,1),ro=new ee,Sh=new ee,Ra=new ee,Th=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=a,this._z=o,this._order=c}var s=e.prototype;return s.set=function(t,a,o,c){return this._x=t,this._y=a,this._z=o,this._order=c||this._order,this._onChangeCallback(),this},s.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},s.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},s.setFromRotationMatrix=function(t,a,o){var c=Ln.clamp,f=t.elements,d=f[0],m=f[4],y=f[8],w=f[1],M=f[5],D=f[9],P=f[2],F=f[6],C=f[10];switch(a=a||this._order,a){case"XYZ":this._y=Math.asin(c(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-D,C),this._z=Math.atan2(-m,d)):(this._x=Math.atan2(F,M),this._z=0);break;case"YXZ":this._x=Math.asin(-c(D,-1,1)),Math.abs(D)<.9999999?(this._y=Math.atan2(y,C),this._z=Math.atan2(w,M)):(this._y=Math.atan2(-P,d),this._z=0);break;case"ZXY":this._x=Math.asin(c(F,-1,1)),Math.abs(F)<.9999999?(this._y=Math.atan2(-P,C),this._z=Math.atan2(-m,M)):(this._y=0,this._z=Math.atan2(w,d));break;case"ZYX":this._y=Math.asin(-c(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(F,C),this._z=Math.atan2(w,d)):(this._x=0,this._z=Math.atan2(-m,M));break;case"YZX":this._z=Math.asin(c(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(-D,M),this._y=Math.atan2(-P,d)):(this._x=0,this._y=Math.atan2(y,C));break;case"XZY":this._z=Math.asin(-c(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(F,M),this._y=Math.atan2(y,d)):(this._x=Math.atan2(-D,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,o!==!1&&this._onChangeCallback(),this},s.setFromQuaternion=function(t,a,o){return ad.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ad,a,o)},s.setFromVector3=function(t,a){return this.set(t.x,t.y,t.z,a||this._order)},s.reorder=function(t){return sd.setFromEuler(this),this.setFromQuaternion(sd,t)},s.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},s.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this._x,t[a+1]=this._y,t[a+2]=this._z,t[a+3]=this._order,t},s.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new ee(this._x,this._y,this._z)},s._onChange=function(t){return this._onChangeCallback=t,this},s._onChangeCallback=function(){},nu(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),e}();Th.DefaultOrder="XYZ",Th.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var ad=new qn,sd=new Kr,od=function(){function e(){this.mask=1}var s=e.prototype;return s.set=function(t){this.mask=1<<t|0},s.enable=function(t){this.mask|=1<<t|0},s.enableAll=function(){this.mask=-1},s.toggle=function(t){this.mask^=1<<t|0},s.disable=function(t){this.mask&=~(1<<t|0)},s.disableAll=function(){this.mask=0},s.test=function(t){return(this.mask&t.mask)!==0},e}(),Ev=0,Jp=new ee,hc=new Kr,ao=new qn,Eh=new ee,vr=new ee,Vo=new ee,Kp=new Kr,Ah=new ee(1,0,0),Ts=new ee(0,1,0),ld=new ee(0,0,1),fc={type:"added"},cd={type:"removed"};function $t(){Object.defineProperty(this,"id",{value:Ev++}),this.uuid=Ln.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$t.DefaultUp.clone();var e=new ee,s=new Th,t=new Kr,a=new ee(1,1,1);s._onChange(function(){t.setFromEuler(s,!1)}),t._onChange(function(){s.setFromQuaternion(t,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new qn},normalMatrix:{value:new aa}}),this.matrix=new qn,this.matrixWorld=new qn,this.matrixAutoUpdate=$t.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new od,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}$t.DefaultUp=new ee(0,1,0),$t.DefaultMatrixAutoUpdate=!0,$t.prototype=Object.assign(Object.create(rs.prototype),{constructor:$t,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,s){this.quaternion.setFromAxisAngle(e,s)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,s){return hc.setFromAxisAngle(e,s),this.quaternion.multiply(hc),this},rotateOnWorldAxis:function(e,s){return hc.setFromAxisAngle(e,s),this.quaternion.premultiply(hc),this},rotateX:function(e){return this.rotateOnAxis(Ah,e)},rotateY:function(e){return this.rotateOnAxis(Ts,e)},rotateZ:function(e){return this.rotateOnAxis(ld,e)},translateOnAxis:function(e,s){return Jp.copy(e).applyQuaternion(this.quaternion),this.position.add(Jp.multiplyScalar(s)),this},translateX:function(e){return this.translateOnAxis(Ah,e)},translateY:function(e){return this.translateOnAxis(Ts,e)},translateZ:function(e){return this.translateOnAxis(ld,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ao.getInverse(this.matrixWorld))},lookAt:function(e,s,t){e.isVector3?Eh.copy(e):Eh.set(e,s,t);var a=this.parent;this.updateWorldMatrix(!0,!1),vr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ao.lookAt(vr,Eh,this.up):ao.lookAt(Eh,vr,this.up),this.quaternion.setFromRotationMatrix(ao),a&&(ao.extractRotation(a.matrixWorld),hc.setFromRotationMatrix(ao),this.quaternion.premultiply(hc.inverse()))},add:function(e){if(arguments.length>1){for(var s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(fc)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}var t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(cd)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),ao.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ao.multiply(e.parent.matrixWorld)),e.applyMatrix4(ao),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,s){if(this[e]===s)return this;for(var t=0,a=this.children.length;t<a;t++){var o=this.children[t],c=o.getObjectByProperty(e,s);if(c!==void 0)return c}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Kr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vr,e,Vo),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vr,Kp,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1);var s=this.matrixWorld.elements;return e.set(s[8],s[9],s[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].traverseVisible(e)}},traverseAncestors:function(e){var s=this.parent;s!==null&&(e(s),s.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].updateMatrixWorld(e)},updateWorldMatrix:function(e,s){var t=this.parent;if(e===!0&&t!==null&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),s===!0)for(var a=this.children,o=0,c=a.length;o<c;o++)a[o].updateWorldMatrix(!1,!0)},toJSON:function(e){var s=e===void 0||typeof e=="string",t={};s&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON());function o(G,j){return G[j.uuid]===void 0&&(G[j.uuid]=j.toJSON(e)),j.uuid}if(this.isMesh||this.isLine||this.isPoints){a.geometry=o(e.geometries,this.geometry);var c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){var f=c.shapes;if(Array.isArray(f))for(var d=0,m=f.length;d<m;d++){var y=f[d];o(e.shapes,y)}else o(e.shapes,f)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var w=[],M=0,D=this.material.length;M<D;M++)w.push(o(e.materials,this.material[M]));a.material=w}else a.material=o(e.materials,this.material);if(this.children.length>0){a.children=[];for(var P=0;P<this.children.length;P++)a.children.push(this.children[P].toJSON(e).object)}if(s){var F=Z(e.geometries),C=Z(e.materials),I=Z(e.textures),q=Z(e.images),J=Z(e.shapes);F.length>0&&(t.geometries=F),C.length>0&&(t.materials=C),I.length>0&&(t.textures=I),q.length>0&&(t.images=q),J.length>0&&(t.shapes=J)}return t.object=a,t;function Z(G){var j=[];for(var ne in G){var se=G[ne];delete se.metadata,j.push(se)}return j}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,s){if(s===void 0&&(s=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),s===!0)for(var t=0;t<e.children.length;t++){var a=e.children[t];this.add(a.clone())}return this}});var Lh=new ee,$p=new ee,Qp=new aa,_a=function(){function e(t,a){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=t!==void 0?t:new ee(1,0,0),this.constant=a!==void 0?a:0}var s=e.prototype;return s.set=function(t,a){return this.normal.copy(t),this.constant=a,this},s.setComponents=function(t,a,o,c){return this.normal.set(t,a,o),this.constant=c,this},s.setFromNormalAndCoplanarPoint=function(t,a){return this.normal.copy(t),this.constant=-a.dot(this.normal),this},s.setFromCoplanarPoints=function(t,a,o){var c=Lh.subVectors(o,a).cross($p.subVectors(t,a)).normalize();return this.setFromNormalAndCoplanarPoint(c,t),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},s.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},s.negate=function(){return this.constant*=-1,this.normal.negate(),this},s.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},s.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},s.projectPoint=function(t,a){return a===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),a=new ee),a.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},s.intersectLine=function(t,a){a===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),a=new ee);var o=t.delta(Lh),c=this.normal.dot(o);if(c===0)return this.distanceToPoint(t.start)===0?a.copy(t.start):void 0;var f=-(t.start.dot(this.normal)+this.constant)/c;if(!(f<0||f>1))return a.copy(o).multiplyScalar(f).add(t.start)},s.intersectsLine=function(t){var a=this.distanceToPoint(t.start),o=this.distanceToPoint(t.end);return a<0&&o>0||o<0&&a>0},s.intersectsBox=function(t){return t.intersectsPlane(this)},s.intersectsSphere=function(t){return t.intersectsPlane(this)},s.coplanarPoint=function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ee),t.copy(this.normal).multiplyScalar(-this.constant)},s.applyMatrix4=function(t,a){var o=a||Qp.getNormalMatrix(t),c=this.coplanarPoint(Lh).applyMatrix4(t),f=this.normal.applyMatrix3(o).normalize();return this.constant=-c.dot(f),this},s.translate=function(t){return this.constant-=t.dot(this.normal),this},s.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},e}(),Nr=new ee,Es=new ee,As=new ee,xa=new ee,dc=new ee,bl=new ee,em=new ee,ud=new ee,pc=new ee,wl=new ee,ka=function(){function e(t,a,o){this.a=t!==void 0?t:new ee,this.b=a!==void 0?a:new ee,this.c=o!==void 0?o:new ee}e.getNormal=function(t,a,o,c){c===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),c=new ee),c.subVectors(o,a),Nr.subVectors(t,a),c.cross(Nr);var f=c.lengthSq();return f>0?c.multiplyScalar(1/Math.sqrt(f)):c.set(0,0,0)},e.getBarycoord=function(t,a,o,c,f){Nr.subVectors(c,a),Es.subVectors(o,a),As.subVectors(t,a);var d=Nr.dot(Nr),m=Nr.dot(Es),y=Nr.dot(As),w=Es.dot(Es),M=Es.dot(As),D=d*w-m*m;if(f===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),f=new ee),D===0)return f.set(-2,-1,-1);var P=1/D,F=(w*y-m*M)*P,C=(d*M-m*y)*P;return f.set(1-F-C,C,F)},e.containsPoint=function(t,a,o,c){return this.getBarycoord(t,a,o,c,xa),xa.x>=0&&xa.y>=0&&xa.x+xa.y<=1},e.getUV=function(t,a,o,c,f,d,m,y){return this.getBarycoord(t,a,o,c,xa),y.set(0,0),y.addScaledVector(f,xa.x),y.addScaledVector(d,xa.y),y.addScaledVector(m,xa.z),y},e.isFrontFacing=function(t,a,o,c){return Nr.subVectors(o,a),Es.subVectors(t,a),Nr.cross(Es).dot(c)<0};var s=e.prototype;return s.set=function(t,a,o){return this.a.copy(t),this.b.copy(a),this.c.copy(o),this},s.setFromPointsAndIndices=function(t,a,o,c){return this.a.copy(t[a]),this.b.copy(t[o]),this.c.copy(t[c]),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},s.getArea=function(){return Nr.subVectors(this.c,this.b),Es.subVectors(this.a,this.b),Nr.cross(Es).length()*.5},s.getMidpoint=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ee),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},s.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},s.getPlane=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new _a),t.setFromCoplanarPoints(this.a,this.b,this.c)},s.getBarycoord=function(t,a){return e.getBarycoord(t,this.a,this.b,this.c,a)},s.getUV=function(t,a,o,c,f){return e.getUV(t,this.a,this.b,this.c,a,o,c,f)},s.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},s.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},s.intersectsBox=function(t){return t.intersectsTriangle(this)},s.closestPointToPoint=function(t,a){a===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),a=new ee);var o=this.a,c=this.b,f=this.c,d,m;dc.subVectors(c,o),bl.subVectors(f,o),ud.subVectors(t,o);var y=dc.dot(ud),w=bl.dot(ud);if(y<=0&&w<=0)return a.copy(o);pc.subVectors(t,c);var M=dc.dot(pc),D=bl.dot(pc);if(M>=0&&D<=M)return a.copy(c);var P=y*D-M*w;if(P<=0&&y>=0&&M<=0)return d=y/(y-M),a.copy(o).addScaledVector(dc,d);wl.subVectors(t,f);var F=dc.dot(wl),C=bl.dot(wl);if(C>=0&&F<=C)return a.copy(f);var I=F*w-y*C;if(I<=0&&w>=0&&C<=0)return m=w/(w-C),a.copy(o).addScaledVector(bl,m);var q=M*C-F*D;if(q<=0&&D-M>=0&&F-C>=0)return em.subVectors(f,c),m=(D-M)/(D-M+(F-C)),a.copy(c).addScaledVector(em,m);var J=1/(q+I+P);return d=I*J,m=P*J,a.copy(o).addScaledVector(dc,d).addScaledVector(bl,m)},s.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},e}(),hd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Va={h:0,s:0,l:0},mc={h:0,s:0,l:0};function su(e,s,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(s-e)*6*t:t<1/2?s:t<2/3?e+(s-e)*6*(2/3-t):e}function Ml(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function gc(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var Xt=function(){function e(t,a,o){return Object.defineProperty(this,"isColor",{value:!0}),a===void 0&&o===void 0?this.set(t):this.setRGB(t,a,o)}var s=e.prototype;return s.set=function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},s.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},s.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},s.setRGB=function(t,a,o){return this.r=t,this.g=a,this.b=o,this},s.setHSL=function(t,a,o){if(t=Ln.euclideanModulo(t,1),a=Ln.clamp(a,0,1),o=Ln.clamp(o,0,1),a===0)this.r=this.g=this.b=o;else{var c=o<=.5?o*(1+a):o+a-o*a,f=2*o-c;this.r=su(f,c,t+1/3),this.g=su(f,c,t),this.b=su(f,c,t-1/3)}return this},s.setStyle=function(t){function a(P){P!==void 0&&parseFloat(P)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var c,f=o[1],d=o[2];switch(f){case"rgb":case"rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,a(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,a(c[5]),this;break;case"hsl":case"hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var m=parseFloat(c[1])/360,y=parseInt(c[2],10)/100,w=parseInt(c[3],10)/100;return a(c[5]),this.setHSL(m,y,w)}break}}else if(o=/^\#([A-Fa-f0-9]+)$/.exec(t)){var M=o[1],D=M.length;if(D===3)return this.r=parseInt(M.charAt(0)+M.charAt(0),16)/255,this.g=parseInt(M.charAt(1)+M.charAt(1),16)/255,this.b=parseInt(M.charAt(2)+M.charAt(2),16)/255,this;if(D===6)return this.r=parseInt(M.charAt(0)+M.charAt(1),16)/255,this.g=parseInt(M.charAt(2)+M.charAt(3),16)/255,this.b=parseInt(M.charAt(4)+M.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},s.setColorName=function(t){var a=hd[t];return a!==void 0?this.setHex(a):console.warn("THREE.Color: Unknown color "+t),this},s.clone=function(){return new this.constructor(this.r,this.g,this.b)},s.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},s.copyGammaToLinear=function(t,a){return a===void 0&&(a=2),this.r=Math.pow(t.r,a),this.g=Math.pow(t.g,a),this.b=Math.pow(t.b,a),this},s.copyLinearToGamma=function(t,a){a===void 0&&(a=2);var o=a>0?1/a:1;return this.r=Math.pow(t.r,o),this.g=Math.pow(t.g,o),this.b=Math.pow(t.b,o),this},s.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},s.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},s.copySRGBToLinear=function(t){return this.r=Ml(t.r),this.g=Ml(t.g),this.b=Ml(t.b),this},s.copyLinearToSRGB=function(t){return this.r=gc(t.r),this.g=gc(t.g),this.b=gc(t.b),this},s.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},s.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},s.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},s.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},s.getHSL=function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var a=this.r,o=this.g,c=this.b,f=Math.max(a,o,c),d=Math.min(a,o,c),m,y,w=(d+f)/2;if(d===f)m=0,y=0;else{var M=f-d;switch(y=w<=.5?M/(f+d):M/(2-f-d),f){case a:m=(o-c)/M+(o<c?6:0);break;case o:m=(c-a)/M+2;break;case c:m=(a-o)/M+4;break}m/=6}return t.h=m,t.s=y,t.l=w,t},s.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},s.offsetHSL=function(t,a,o){return this.getHSL(Va),Va.h+=t,Va.s+=a,Va.l+=o,this.setHSL(Va.h,Va.s,Va.l),this},s.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},s.addColors=function(t,a){return this.r=t.r+a.r,this.g=t.g+a.g,this.b=t.b+a.b,this},s.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},s.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},s.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},s.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},s.lerp=function(t,a){return this.r+=(t.r-this.r)*a,this.g+=(t.g-this.g)*a,this.b+=(t.b-this.b)*a,this},s.lerpHSL=function(t,a){this.getHSL(Va),t.getHSL(mc);var o=Ln.lerp(Va.h,mc.h,a),c=Ln.lerp(Va.s,mc.s,a),f=Ln.lerp(Va.l,mc.l,a);return this.setHSL(o,c,f),this},s.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},s.fromArray=function(t,a){return a===void 0&&(a=0),this.r=t[a],this.g=t[a+1],this.b=t[a+2],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.r,t[a+1]=this.g,t[a+2]=this.b,t},s.fromBufferAttribute=function(t,a){return this.r=t.getX(a),this.g=t.getY(a),this.b=t.getZ(a),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},s.toJSON=function(){return this.getHex()},e}();Xt.NAMES=hd,Xt.prototype.r=1,Xt.prototype.g=1,Xt.prototype.b=1;var ou=function(){function e(t,a,o,c,f,d){this.a=t,this.b=a,this.c=o,this.normal=c&&c.isVector3?c:new ee,this.vertexNormals=Array.isArray(c)?c:[],this.color=f&&f.isColor?f:new Xt,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=d!==void 0?d:0}var s=e.prototype;return s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var a=0,o=t.vertexNormals.length;a<o;a++)this.vertexNormals[a]=t.vertexNormals[a].clone();for(var c=0,f=t.vertexColors.length;c<f;c++)this.vertexColors[c]=t.vertexColors[c].clone();return this},e}(),Sl=0;function fn(){Object.defineProperty(this,"id",{value:Sl++}),this.uuid=Ln.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=W,this.side=A,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ue,this.blendDst=Le,this.blendEquation=ge,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Yt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=td,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=No,this.stencilZFail=No,this.stencilZPass=No,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}fn.prototype=Object.assign(Object.create(rs.prototype),{constructor:fn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(e!==void 0)for(var s in e){var t=e[s];if(t===void 0){console.warn("THREE.Material: '"+s+"' parameter is undefined.");continue}if(s==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===E;continue}var a=this[s];if(a===void 0){console.warn("THREE."+this.type+": '"+s+"' is not a property of this material.");continue}a&&a.isColor?a.set(t):a&&a.isVector3&&t&&t.isVector3?a.copy(t):this[s]=t}},toJSON:function(e){var s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{}});var t={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),this.roughness!==void 0&&(t.roughness=this.roughness),this.metalness!==void 0&&(t.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(t.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),this.shininess!==void 0&&(t.shininess=this.shininess),this.clearcoat!==void 0&&(t.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(t.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(t.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(t.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(t.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,t.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(t.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(t.aoMap=this.aoMap.toJSON(e).uuid,t.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(e).uuid,t.normalMapType=this.normalMapType,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,this.combine!==void 0&&(t.combine=this.combine),this.envMapIntensity!==void 0&&(t.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(t.size=this.size),this.sizeAttenuation!==void 0&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==W&&(t.blending=this.blending),this.flatShading===!0&&(t.flatShading=this.flatShading),this.side!==A&&(t.side=this.side),this.vertexColors&&(t.vertexColors=!0),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.stencilWrite=this.stencilWrite,t.stencilWriteMask=this.stencilWriteMask,t.stencilFunc=this.stencilFunc,t.stencilRef=this.stencilRef,t.stencilFuncMask=this.stencilFuncMask,t.stencilFail=this.stencilFail,t.stencilZFail=this.stencilZFail,t.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(t.rotation=this.rotation),this.polygonOffset===!0&&(t.polygonOffset=!0),this.polygonOffsetFactor!==0&&(t.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(t.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(t.linewidth=this.linewidth),this.dashSize!==void 0&&(t.dashSize=this.dashSize),this.gapSize!==void 0&&(t.gapSize=this.gapSize),this.scale!==void 0&&(t.scale=this.scale),this.dithering===!0&&(t.dithering=!0),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(t.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(t.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(t.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(t.morphTargets=!0),this.morphNormals===!0&&(t.morphNormals=!0),this.skinning===!0&&(t.skinning=!0),this.visible===!1&&(t.visible=!1),this.toneMapped===!1&&(t.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(t.userData=this.userData);function a(f){var d=[];for(var m in f){var y=f[m];delete y.metadata,d.push(y)}return d}if(s){var o=a(e.textures),c=a(e.images);o.length>0&&(t.textures=o),c.length>0&&(t.images=c)}return t},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var s=e.clippingPlanes,t=null;if(s!==null){var a=s.length;t=new Array(a);for(var o=0;o!==a;++o)t[o]=s[o].clone()}return this.clippingPlanes=t,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(fn.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function Fr(e){fn.call(this),this.type="MeshBasicMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}Fr.prototype=Object.create(fn.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isMeshBasicMaterial=!0,Fr.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Pi=new ee,Rh=new xt;function _n(e,s,t){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=s,this.count=e!==void 0?e.length/s:0,this.normalized=t===!0,this.usage=Qc,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(_n.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(_n.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,s,t){e*=this.itemSize,t*=s.itemSize;for(var a=0,o=this.itemSize;a<o;a++)this.array[e+a]=s.array[t+a];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",a),c=new Xt),s[t++]=c.r,s[t++]=c.g,s[t++]=c.b}return this},copyVector2sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",a),c=new xt),s[t++]=c.x,s[t++]=c.y}return this},copyVector3sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",a),c=new ee),s[t++]=c.x,s[t++]=c.y,s[t++]=c.z}return this},copyVector4sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",a),c=new Ti),s[t++]=c.x,s[t++]=c.y,s[t++]=c.z,s[t++]=c.w}return this},applyMatrix3:function(e){if(this.itemSize===2)for(var s=0,t=this.count;s<t;s++)Rh.fromBufferAttribute(this,s),Rh.applyMatrix3(e),this.setXY(s,Rh.x,Rh.y);else if(this.itemSize===3)for(var a=0,o=this.count;a<o;a++)Pi.fromBufferAttribute(this,a),Pi.applyMatrix3(e),this.setXYZ(a,Pi.x,Pi.y,Pi.z);return this},applyMatrix4:function(e){for(var s=0,t=this.count;s<t;s++)Pi.x=this.getX(s),Pi.y=this.getY(s),Pi.z=this.getZ(s),Pi.applyMatrix4(e),this.setXYZ(s,Pi.x,Pi.y,Pi.z);return this},applyNormalMatrix:function(e){for(var s=0,t=this.count;s<t;s++)Pi.x=this.getX(s),Pi.y=this.getY(s),Pi.z=this.getZ(s),Pi.applyNormalMatrix(e),this.setXYZ(s,Pi.x,Pi.y,Pi.z);return this},transformDirection:function(e){for(var s=0,t=this.count;s<t;s++)Pi.x=this.getX(s),Pi.y=this.getY(s),Pi.z=this.getZ(s),Pi.transformDirection(e),this.setXYZ(s,Pi.x,Pi.y,Pi.z);return this},set:function(e,s){return s===void 0&&(s=0),this.array.set(e,s),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,s){return this.array[e*this.itemSize]=s,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,s){return this.array[e*this.itemSize+1]=s,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,s){return this.array[e*this.itemSize+2]=s,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,s){return this.array[e*this.itemSize+3]=s,this},setXY:function(e,s,t){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this},setXYZ:function(e,s,t,a){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this.array[e+2]=a,this},setXYZW:function(e,s,t,a,o){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this.array[e+2]=a,this.array[e+3]=o,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function vc(e,s,t){_n.call(this,new Int8Array(e),s,t)}vc.prototype=Object.create(_n.prototype),vc.prototype.constructor=vc;function lu(e,s,t){_n.call(this,new Uint8Array(e),s,t)}lu.prototype=Object.create(_n.prototype),lu.prototype.constructor=lu;function Tl(e,s,t){_n.call(this,new Uint8ClampedArray(e),s,t)}Tl.prototype=Object.create(_n.prototype),Tl.prototype.constructor=Tl;function El(e,s,t){_n.call(this,new Int16Array(e),s,t)}El.prototype=Object.create(_n.prototype),El.prototype.constructor=El;function Al(e,s,t){_n.call(this,new Uint16Array(e),s,t)}Al.prototype=Object.create(_n.prototype),Al.prototype.constructor=Al;function ae(e,s,t){_n.call(this,new Int32Array(e),s,t)}ae.prototype=Object.create(_n.prototype),ae.prototype.constructor=ae;function v(e,s,t){_n.call(this,new Uint32Array(e),s,t)}v.prototype=Object.create(_n.prototype),v.prototype.constructor=v;function x(e,s,t){_n.call(this,new Float32Array(e),s,t)}x.prototype=Object.create(_n.prototype),x.prototype.constructor=x;function T(e,s,t){_n.call(this,new Float64Array(e),s,t)}T.prototype=Object.create(_n.prototype),T.prototype.constructor=T;var L=function(){function e(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var s=e.prototype;return s.computeGroups=function(t){var a=[],o,c,f=void 0,d=t.faces;for(c=0;c<d.length;c++){var m=d[c];m.materialIndex!==f&&(f=m.materialIndex,o!==void 0&&(o.count=c*3-o.start,a.push(o)),o={start:c*3,materialIndex:f})}o!==void 0&&(o.count=c*3-o.start,a.push(o)),this.groups=a},s.fromGeometry=function(t){var a=t.faces,o=t.vertices,c=t.faceVertexUvs,f=c[0]&&c[0].length>0,d=c[1]&&c[1].length>0,m=t.morphTargets,y=m.length,w;if(y>0){w=[];for(var M=0;M<y;M++)w[M]={name:m[M].name,data:[]};this.morphTargets.position=w}var D=t.morphNormals,P=D.length,F;if(P>0){F=[];for(var C=0;C<P;C++)F[C]={name:D[C].name,data:[]};this.morphTargets.normal=F}var I=t.skinIndices,q=t.skinWeights,J=I.length===o.length,Z=q.length===o.length;o.length>0&&a.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var G=0;G<a.length;G++){var j=a[G];this.vertices.push(o[j.a],o[j.b],o[j.c]);var ne=j.vertexNormals;if(ne.length===3)this.normals.push(ne[0],ne[1],ne[2]);else{var se=j.normal;this.normals.push(se,se,se)}var Ee=j.vertexColors;if(Ee.length===3)this.colors.push(Ee[0],Ee[1],Ee[2]);else{var Be=j.color;this.colors.push(Be,Be,Be)}if(f===!0){var ce=c[0][G];ce!==void 0?this.uvs.push(ce[0],ce[1],ce[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",G),this.uvs.push(new xt,new xt,new xt))}if(d===!0){var oe=c[1][G];oe!==void 0?this.uvs2.push(oe[0],oe[1],oe[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",G),this.uvs2.push(new xt,new xt,new xt))}for(var ie=0;ie<y;ie++){var Ce=m[ie].vertices;w[ie].data.push(Ce[j.a],Ce[j.b],Ce[j.c])}for(var De=0;De<P;De++){var Oe=D[De].vertexNormals[G];F[De].data.push(Oe.a,Oe.b,Oe.c)}J&&this.skinIndices.push(I[j.a],I[j.b],I[j.c]),Z&&this.skinWeights.push(q[j.a],q[j.b],q[j.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},e}();function U(e){if(e.length===0)return-1/0;for(var s=e[0],t=1,a=e.length;t<a;++t)e[t]>s&&(s=e[t]);return s}var z=1,k=new qn,le=new $t,ve=new ee,fe=new ws,Ye=new ws,ke=new ee;function Ae(){Object.defineProperty(this,"id",{value:z+=2}),this.uuid=Ln.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ae.prototype=Object.assign(Object.create(rs.prototype),{constructor:Ae,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(U(e)>65535?v:Al)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,s){return this.attributes[e]=s,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,s,t){this.groups.push({start:e,count:s,materialIndex:t!==void 0?t:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,s){this.drawRange.start=e,this.drawRange.count=s},applyMatrix4:function(e){var s=this.attributes.position;s!==void 0&&(s.applyMatrix4(e),s.needsUpdate=!0);var t=this.attributes.normal;if(t!==void 0){var a=new aa().getNormalMatrix(e);t.applyNormalMatrix(a),t.needsUpdate=!0}var o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return k.makeRotationX(e),this.applyMatrix4(k),this},rotateY:function(e){return k.makeRotationY(e),this.applyMatrix4(k),this},rotateZ:function(e){return k.makeRotationZ(e),this.applyMatrix4(k),this},translate:function(e,s,t){return k.makeTranslation(e,s,t),this.applyMatrix4(k),this},scale:function(e,s,t){return k.makeScale(e,s,t),this.applyMatrix4(k),this},lookAt:function(e){return le.lookAt(e),le.updateMatrix(),this.applyMatrix4(le.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ve).negate(),this.translate(ve.x,ve.y,ve.z),this},setFromObject:function(e){var s=e.geometry;if(e.isPoints||e.isLine){var t=new x(s.vertices.length*3,3),a=new x(s.colors.length*3,3);if(this.setAttribute("position",t.copyVector3sArray(s.vertices)),this.setAttribute("color",a.copyColorsArray(s.colors)),s.lineDistances&&s.lineDistances.length===s.vertices.length){var o=new x(s.lineDistances.length,1);this.setAttribute("lineDistance",o.copyArray(s.lineDistances))}s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone())}else e.isMesh&&s&&s.isGeometry&&this.fromGeometry(s);return this},setFromPoints:function(e){for(var s=[],t=0,a=e.length;t<a;t++){var o=e[t];s.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new x(s,3)),this},updateFromObject:function(e){var s=e.geometry;if(e.isMesh){var t=s.__directGeometry;if(s.elementsNeedUpdate===!0&&(t=void 0,s.elementsNeedUpdate=!1),t===void 0)return this.fromGeometry(s);t.verticesNeedUpdate=s.verticesNeedUpdate,t.normalsNeedUpdate=s.normalsNeedUpdate,t.colorsNeedUpdate=s.colorsNeedUpdate,t.uvsNeedUpdate=s.uvsNeedUpdate,t.groupsNeedUpdate=s.groupsNeedUpdate,s.verticesNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.uvsNeedUpdate=!1,s.groupsNeedUpdate=!1,s=t}if(s.verticesNeedUpdate===!0){var a=this.attributes.position;a!==void 0&&(a.copyVector3sArray(s.vertices),a.needsUpdate=!0),s.verticesNeedUpdate=!1}if(s.normalsNeedUpdate===!0){var o=this.attributes.normal;o!==void 0&&(o.copyVector3sArray(s.normals),o.needsUpdate=!0),s.normalsNeedUpdate=!1}if(s.colorsNeedUpdate===!0){var c=this.attributes.color;c!==void 0&&(c.copyColorsArray(s.colors),c.needsUpdate=!0),s.colorsNeedUpdate=!1}if(s.uvsNeedUpdate){var f=this.attributes.uv;f!==void 0&&(f.copyVector2sArray(s.uvs),f.needsUpdate=!0),s.uvsNeedUpdate=!1}if(s.lineDistancesNeedUpdate){var d=this.attributes.lineDistance;d!==void 0&&(d.copyArray(s.lineDistances),d.needsUpdate=!0),s.lineDistancesNeedUpdate=!1}return s.groupsNeedUpdate&&(s.computeGroups(e.geometry),this.groups=s.groups,s.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new L().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var s=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new _n(s,3).copyVector3sArray(e.vertices)),e.normals.length>0){var t=new Float32Array(e.normals.length*3);this.setAttribute("normal",new _n(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var a=new Float32Array(e.colors.length*3);this.setAttribute("color",new _n(a,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var o=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new _n(o,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var c=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new _n(c,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var f in e.morphTargets){for(var d=[],m=e.morphTargets[f],y=0,w=m.length;y<w;y++){var M=m[y],D=new x(M.data.length*3,3);D.name=M.name,d.push(D.copyVector3sArray(M.data))}this.morphAttributes[f]=d}if(e.skinIndices.length>0){var P=new x(e.skinIndices.length*4,4);this.setAttribute("skinIndex",P.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var F=new x(e.skinWeights.length*4,4);this.setAttribute("skinWeight",F.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new ws);var e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ee(-1/0,-1/0,-1/0),new ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),s)for(var t=0,a=s.length;t<a;t++){var o=s[t];fe.setFromBufferAttribute(o),this.morphTargetsRelative?(ke.addVectors(this.boundingBox.min,fe.min),this.boundingBox.expandByPoint(ke),ke.addVectors(this.boundingBox.max,fe.max),this.boundingBox.expandByPoint(ke)):(this.boundingBox.expandByPoint(fe.min),this.boundingBox.expandByPoint(fe.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ya);var e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ee,1/0);return}if(e){var t=this.boundingSphere.center;if(fe.setFromBufferAttribute(e),s)for(var a=0,o=s.length;a<o;a++){var c=s[a];Ye.setFromBufferAttribute(c),this.morphTargetsRelative?(ke.addVectors(fe.min,Ye.min),fe.expandByPoint(ke),ke.addVectors(fe.max,Ye.max),fe.expandByPoint(ke)):(fe.expandByPoint(Ye.min),fe.expandByPoint(Ye.max))}fe.getCenter(t);for(var f=0,d=0,m=e.count;d<m;d++)ke.fromBufferAttribute(e,d),f=Math.max(f,t.distanceToSquared(ke));if(s)for(var y=0,w=s.length;y<w;y++)for(var M=s[y],D=this.morphTargetsRelative,P=0,F=M.count;P<F;P++)ke.fromBufferAttribute(M,P),D&&(ve.fromBufferAttribute(e,P),ke.add(ve)),f=Math.max(f,t.distanceToSquared(ke));this.boundingSphere.radius=Math.sqrt(f),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,s=this.getAttribute("position");if(s!==void 0){var t=this.getAttribute("normal");if(t===void 0)t=new _n(new Float32Array(s.count*3),3),this.setAttribute("normal",t);else for(var a=0,o=t.count;a<o;a++)t.setXYZ(a,0,0,0);var c=new ee,f=new ee,d=new ee,m=new ee,y=new ee,w=new ee,M=new ee,D=new ee;if(e)for(var P=0,F=e.count;P<F;P+=3){var C=e.getX(P+0),I=e.getX(P+1),q=e.getX(P+2);c.fromBufferAttribute(s,C),f.fromBufferAttribute(s,I),d.fromBufferAttribute(s,q),M.subVectors(d,f),D.subVectors(c,f),M.cross(D),m.fromBufferAttribute(t,C),y.fromBufferAttribute(t,I),w.fromBufferAttribute(t,q),m.add(M),y.add(M),w.add(M),t.setXYZ(C,m.x,m.y,m.z),t.setXYZ(I,y.x,y.y,y.z),t.setXYZ(q,w.x,w.y,w.z)}else for(var J=0,Z=s.count;J<Z;J+=3)c.fromBufferAttribute(s,J+0),f.fromBufferAttribute(s,J+1),d.fromBufferAttribute(s,J+2),M.subVectors(d,f),D.subVectors(c,f),M.cross(D),t.setXYZ(J+0,M.x,M.y,M.z),t.setXYZ(J+1,M.x,M.y,M.z),t.setXYZ(J+2,M.x,M.y,M.z);this.normalizeNormals(),t.needsUpdate=!0}},merge:function(e,s){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}s===void 0&&(s=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var t=this.attributes;for(var a in t)if(e.attributes[a]!==void 0)for(var o=t[a],c=o.array,f=e.attributes[a],d=f.array,m=f.itemSize*s,y=Math.min(d.length,c.length-m),w=0,M=m;w<y;w++,M++)c[M]=d[w];return this},normalizeNormals:function(){for(var e=this.attributes.normal,s=0,t=e.count;s<t;s++)ke.fromBufferAttribute(e,s),ke.normalize(),e.setXYZ(s,ke.x,ke.y,ke.z)},toNonIndexed:function(){function e(Z,G){for(var j=Z.array,ne=Z.itemSize,se=Z.normalized,Ee=new j.constructor(G.length*ne),Be=0,ce=0,oe=0,ie=G.length;oe<ie;oe++){Be=G[oe]*ne;for(var Ce=0;Ce<ne;Ce++)Ee[ce++]=j[Be++]}return new _n(Ee,ne,se)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var s=new Ae,t=this.index.array,a=this.attributes;for(var o in a){var c=a[o],f=e(c,t);s.setAttribute(o,f)}var d=this.morphAttributes;for(var m in d){for(var y=[],w=d[m],M=0,D=w.length;M<D;M++){var P=w[M],F=e(P,t);y.push(F)}s.morphAttributes[m]=y}s.morphTargetsRelative=this.morphTargetsRelative;for(var C=this.groups,I=0,q=C.length;I<q;I++){var J=C[I];s.addGroup(J.start,J.count,J.materialIndex)}return s},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var s=this.parameters;for(var t in s)s[t]!==void 0&&(e[t]=s[t]);return e}e.data={attributes:{}};var a=this.index;a!==null&&(e.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});var o=this.attributes;for(var c in o){var f=o[c],d=f.toJSON(e.data);f.name!==""&&(d.name=f.name),e.data.attributes[c]=d}var m={},y=!1;for(var w in this.morphAttributes){for(var M=this.morphAttributes[w],D=[],P=0,F=M.length;P<F;P++){var C=M[P],I=C.toJSON(e.data);C.name!==""&&(I.name=C.name),D.push(I)}D.length>0&&(m[w]=D,y=!0)}y&&(e.data.morphAttributes=m,e.data.morphTargetsRelative=this.morphTargetsRelative);var q=this.groups;q.length>0&&(e.data.groups=JSON.parse(JSON.stringify(q)));var J=this.boundingSphere;return J!==null&&(e.data.boundingSphere={center:J.center.toArray(),radius:J.radius}),e},clone:function(){return new Ae().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var s={};this.name=e.name;var t=e.index;t!==null&&this.setIndex(t.clone(s));var a=e.attributes;for(var o in a){var c=a[o];this.setAttribute(o,c.clone(s))}var f=e.morphAttributes;for(var d in f){for(var m=[],y=f[d],w=0,M=y.length;w<M;w++)m.push(y[w].clone(s));this.morphAttributes[d]=m}this.morphTargetsRelative=e.morphTargetsRelative;for(var D=e.groups,P=0,F=D.length;P<F;P++){var C=D[P];this.addGroup(C.start,C.count,C.materialIndex)}var I=e.boundingBox;I!==null&&(this.boundingBox=I.clone());var q=e.boundingSphere;return q!==null&&(this.boundingSphere=q.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var yt=new qn,Fe=new ss,_t=new ya,Mt=new ee,Gt=new ee,Dt=new ee,jt=new ee,Pt=new ee,Ot=new ee,Vt=new ee,Zt=new ee,zt=new ee,Jn=new xt,xi=new xt,Ji=new xt,yr=new ee,nr=new ee;function Bn(e,s){$t.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new Fr,this.updateMorphTargets()}Bn.prototype=Object.assign(Object.create($t.prototype),{constructor:Bn,isMesh:!0,copy:function(e){return $t.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,s){var t=this.geometry,a=this.material,o=this.matrixWorld;if(a!==void 0&&(t.boundingSphere===null&&t.computeBoundingSphere(),_t.copy(t.boundingSphere),_t.applyMatrix4(o),e.ray.intersectsSphere(_t)!==!1&&(yt.getInverse(o),Fe.copy(e.ray).applyMatrix4(yt),!(t.boundingBox!==null&&Fe.intersectsBox(t.boundingBox)===!1)))){var c;if(t.isBufferGeometry){var f=t.index,d=t.attributes.position,m=t.morphAttributes.position,y=t.morphTargetsRelative,w=t.attributes.uv,M=t.attributes.uv2,D=t.groups,P=t.drawRange;if(f!==null)if(Array.isArray(a))for(var F=0,C=D.length;F<C;F++)for(var I=D[F],q=a[I.materialIndex],J=Math.max(I.start,P.start),Z=Math.min(I.start+I.count,P.start+P.count),G=J;G<Z;G+=3){var j=f.getX(G),ne=f.getX(G+1),se=f.getX(G+2);c=oa(this,q,e,Fe,d,m,y,w,M,j,ne,se),c&&(c.faceIndex=Math.floor(G/3),c.face.materialIndex=I.materialIndex,s.push(c))}else for(var Ee=Math.max(0,P.start),Be=Math.min(f.count,P.start+P.count),ce=Ee;ce<Be;ce+=3){var oe=f.getX(ce),ie=f.getX(ce+1),Ce=f.getX(ce+2);c=oa(this,a,e,Fe,d,m,y,w,M,oe,ie,Ce),c&&(c.faceIndex=Math.floor(ce/3),s.push(c))}else if(d!==void 0)if(Array.isArray(a))for(var De=0,Oe=D.length;De<Oe;De++)for(var et=D[De],gt=a[et.materialIndex],pt=Math.max(et.start,P.start),lt=Math.min(et.start+et.count,P.start+P.count),St=pt;St<lt;St+=3){var Ht=St,Ut=St+1,rn=St+2;c=oa(this,gt,e,Fe,d,m,y,w,M,Ht,Ut,rn),c&&(c.faceIndex=Math.floor(St/3),c.face.materialIndex=et.materialIndex,s.push(c))}else for(var pn=Math.max(0,P.start),dt=Math.min(d.count,P.start+P.count),Un=pn;Un<dt;Un+=3){var Dn=Un,wn=Un+1,ci=Un+2;c=oa(this,a,e,Fe,d,m,y,w,M,Dn,wn,ci),c&&(c.faceIndex=Math.floor(Un/3),s.push(c))}}else if(t.isGeometry){var Zn=Array.isArray(a),vi=t.vertices,ri=t.faces,Vi,Me=t.faceVertexUvs[0];Me.length>0&&(Vi=Me);for(var X=0,Lt=ri.length;X<Lt;X++){var ot=ri[X],Kt=Zn?a[ot.materialIndex]:a;if(Kt!==void 0){var Ct=vi[ot.a],vn=vi[ot.b],xn=vi[ot.c];if(c=Br(this,Kt,e,Fe,Ct,vn,xn,yr),c){if(Vi&&Vi[X]){var an=Vi[X];Jn.copy(an[0]),xi.copy(an[1]),Ji.copy(an[2]),c.uv=ka.getUV(yr,Ct,vn,xn,Jn,xi,Ji,new xt)}c.face=ot,c.faceIndex=X,s.push(c)}}}}}}});function Br(e,s,t,a,o,c,f,d){var m;if(s.side===S?m=a.intersectTriangle(f,c,o,!0,d):m=a.intersectTriangle(o,c,f,s.side!==R,d),m===null)return null;nr.copy(d),nr.applyMatrix4(e.matrixWorld);var y=t.ray.origin.distanceTo(nr);return y<t.near||y>t.far?null:{distance:y,point:nr.clone(),object:e}}function oa(e,s,t,a,o,c,f,d,m,y,w,M){Mt.fromBufferAttribute(o,y),Gt.fromBufferAttribute(o,w),Dt.fromBufferAttribute(o,M);var D=e.morphTargetInfluences;if(s.morphTargets&&c&&D){Vt.set(0,0,0),Zt.set(0,0,0),zt.set(0,0,0);for(var P=0,F=c.length;P<F;P++){var C=D[P],I=c[P];C!==0&&(jt.fromBufferAttribute(I,y),Pt.fromBufferAttribute(I,w),Ot.fromBufferAttribute(I,M),f?(Vt.addScaledVector(jt,C),Zt.addScaledVector(Pt,C),zt.addScaledVector(Ot,C)):(Vt.addScaledVector(jt.sub(Mt),C),Zt.addScaledVector(Pt.sub(Gt),C),zt.addScaledVector(Ot.sub(Dt),C)))}Mt.add(Vt),Gt.add(Zt),Dt.add(zt)}e.isSkinnedMesh&&(e.boneTransform(y,Mt),e.boneTransform(w,Gt),e.boneTransform(M,Dt));var q=Br(e,s,t,a,Mt,Gt,Dt,yr);if(q){d&&(Jn.fromBufferAttribute(d,y),xi.fromBufferAttribute(d,w),Ji.fromBufferAttribute(d,M),q.uv=ka.getUV(yr,Mt,Gt,Dt,Jn,xi,Ji,new xt)),m&&(Jn.fromBufferAttribute(m,y),xi.fromBufferAttribute(m,w),Ji.fromBufferAttribute(m,M),q.uv2=ka.getUV(yr,Mt,Gt,Dt,Jn,xi,Ji,new xt));var J=new ou(y,w,M);ka.getNormal(Mt,Gt,Dt,J.normal),q.face=J}return q}var ls=function(e){en(s,e);function s(t,a,o,c,f,d){var m;t===void 0&&(t=1),a===void 0&&(a=1),o===void 0&&(o=1),c===void 0&&(c=1),f===void 0&&(f=1),d===void 0&&(d=1),m=e.call(this)||this,m.type="BoxBufferGeometry",m.parameters={width:t,height:a,depth:o,widthSegments:c,heightSegments:f,depthSegments:d};var y=oc(m);c=Math.floor(c),f=Math.floor(f),d=Math.floor(d);var w=[],M=[],D=[],P=[],F=0,C=0;I("z","y","x",-1,-1,o,a,t,d,f,0),I("z","y","x",1,-1,o,a,-t,d,f,1),I("x","z","y",1,1,t,o,a,c,d,2),I("x","z","y",1,-1,t,o,-a,c,d,3),I("x","y","z",1,-1,t,a,o,c,f,4),I("x","y","z",-1,-1,t,a,-o,c,f,5),m.setIndex(w),m.setAttribute("position",new x(M,3)),m.setAttribute("normal",new x(D,3)),m.setAttribute("uv",new x(P,2));function I(q,J,Z,G,j,ne,se,Ee,Be,ce,oe){for(var ie=Be+1,Ce=0,De=0,Oe=new ee,et=0;et<ce+1;et++)for(var gt=et*(se/ce)-se/2,pt=0;pt<ie;pt++){var lt=pt*(ne/Be)-ne/2;Oe[q]=lt*G,Oe[J]=gt*j,Oe[Z]=Ee/2,M.push(Oe.x,Oe.y,Oe.z),Oe[q]=0,Oe[J]=0,Oe[Z]=Ee>0?1:-1,D.push(Oe.x,Oe.y,Oe.z),P.push(pt/Be),P.push(1-et/ce),Ce+=1}for(var St=0;St<ce;St++)for(var Ht=0;Ht<Be;Ht++){var Ut=F+Ht+ie*St,rn=F+Ht+ie*(St+1),pn=F+(Ht+1)+ie*(St+1),dt=F+(Ht+1)+ie*St;w.push(Ut,rn,dt),w.push(rn,pn,dt),De+=6}y.addGroup(C,De,oe),C+=De,F+=Ce}return m}return s}(Ae);function Wa(e){var s={};for(var t in e){s[t]={};for(var a in e[t]){var o=e[t][a];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture)?s[t][a]=o.clone():Array.isArray(o)?s[t][a]=o.slice():s[t][a]=o}}return s}function wr(e){for(var s={},t=0;t<e.length;t++){var a=Wa(e[t]);for(var o in a)s[o]=a[o]}return s}var Wo={clone:Wa,merge:wr};function $r(e){fn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}$r.prototype=Object.create(fn.prototype),$r.prototype.constructor=$r,$r.prototype.isShaderMaterial=!0,$r.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Wa(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},$r.prototype.toJSON=function(e){var s=fn.prototype.toJSON.call(this,e);s.glslVersion=this.glslVersion,s.uniforms={};for(var t in this.uniforms){var a=this.uniforms[t],o=a.value;o&&o.isTexture?s.uniforms[t]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?s.uniforms[t]={type:"c",value:o.getHex()}:o&&o.isVector2?s.uniforms[t]={type:"v2",value:o.toArray()}:o&&o.isVector3?s.uniforms[t]={type:"v3",value:o.toArray()}:o&&o.isVector4?s.uniforms[t]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?s.uniforms[t]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?s.uniforms[t]={type:"m4",value:o.toArray()}:s.uniforms[t]={value:o}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader;var c={};for(var f in this.extensions)this.extensions[f]===!0&&(c[f]=!0);return Object.keys(c).length>0&&(s.extensions=c),s};function Ur(){$t.call(this),this.type="Camera",this.matrixWorldInverse=new qn,this.projectionMatrix=new qn,this.projectionMatrixInverse=new qn}Ur.prototype=Object.assign(Object.create($t.prototype),{constructor:Ur,isCamera:!0,copy:function(e,s){return $t.prototype.copy.call(this,e,s),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new ee),this.updateMatrixWorld(!0);var s=this.matrixWorld.elements;return e.set(-s[8],-s[9],-s[10]).normalize()},updateMatrixWorld:function(e){$t.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,s){$t.prototype.updateWorldMatrix.call(this,e,s),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function Fi(e,s,t,a){Ur.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=t!==void 0?t:.1,this.far=a!==void 0?a:2e3,this.focus=10,this.aspect=s!==void 0?s:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Fi.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Fi,isPerspectiveCamera:!0,copy:function(e,s){return Ur.prototype.copy.call(this,e,s),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var s=.5*this.getFilmHeight()/e;this.fov=Ln.RAD2DEG*2*Math.atan(s),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(Ln.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return Ln.RAD2DEG*2*Math.atan(Math.tan(Ln.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,s,t,a,o,c){this.aspect=e/s,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=t,this.view.offsetY=a,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,s=e*Math.tan(Ln.DEG2RAD*.5*this.fov)/this.zoom,t=2*s,a=this.aspect*t,o=-.5*a,c=this.view;if(this.view!==null&&this.view.enabled){var f=c.fullWidth,d=c.fullHeight;o+=c.offsetX*a/f,s-=c.offsetY*t/d,a*=c.width/f,t*=c.height/d}var m=this.filmOffset;m!==0&&(o+=e*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+a,s,s-t,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var s=$t.prototype.toJSON.call(this,e);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,this.view!==null&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}});var Ch=90,Ph=1;function Ih(e,s,t){if($t.call(this),this.type="CubeCamera",t.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=t;var a=new Fi(Ch,Ph,e,s);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new ee(1,0,0)),this.add(a);var o=new Fi(Ch,Ph,e,s);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new ee(-1,0,0)),this.add(o);var c=new Fi(Ch,Ph,e,s);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new ee(0,1,0)),this.add(c);var f=new Fi(Ch,Ph,e,s);f.layers=this.layers,f.up.set(0,0,-1),f.lookAt(new ee(0,-1,0)),this.add(f);var d=new Fi(Ch,Ph,e,s);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new ee(0,0,1)),this.add(d);var m=new Fi(Ch,Ph,e,s);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new ee(0,0,-1)),this.add(m),this.update=function(y,w){this.parent===null&&this.updateMatrixWorld();var M=y.xr.enabled,D=y.getRenderTarget();y.xr.enabled=!1;var P=t.texture.generateMipmaps;t.texture.generateMipmaps=!1,y.setRenderTarget(t,0),y.render(w,a),y.setRenderTarget(t,1),y.render(w,o),y.setRenderTarget(t,2),y.render(w,c),y.setRenderTarget(t,3),y.render(w,f),y.setRenderTarget(t,4),y.render(w,d),t.texture.generateMipmaps=P,y.setRenderTarget(t,5),y.render(w,m),y.setRenderTarget(D),y.xr.enabled=M},this.clear=function(y,w,M,D){for(var P=y.getRenderTarget(),F=0;F<6;F++)y.setRenderTarget(t,F),y.clear(w,M,D);y.setRenderTarget(P)}}Ih.prototype=Object.create($t.prototype),Ih.prototype.constructor=Ih;function qo(e,s,t,a,o,c,f,d,m,y){e=e!==void 0?e:[],s=s!==void 0?s:Y,f=f!==void 0?f:is,Si.call(this,e,s,t,a,o,c,f,d,m,y),this.flipY=!1,this._needsFlipEnvMap=!0}qo.prototype=Object.create(Si.prototype),qo.prototype.constructor=qo,qo.prototype.isCubeTexture=!0,Object.defineProperty(qo.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function yc(e,s,t){Number.isInteger(s)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),s=t),sa.call(this,e,e,s),s=s||{},this.texture=new qo(void 0,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.texture._needsFlipEnvMap=!1}yc.prototype=Object.create(sa.prototype),yc.prototype.constructor=yc,yc.prototype.isWebGLCubeRenderTarget=!0,yc.prototype.fromEquirectangularTexture=function(e,s){this.texture.type=s.type,this.texture.format=re,this.texture.encoding=s.encoding,this.texture.generateMipmaps=s.generateMipmaps,this.texture.minFilter=s.minFilter,this.texture.magFilter=s.magFilter;var t={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},a=new ls(5,5,5),o=new $r({name:"CubemapFromEquirect",uniforms:Wa(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:S,blending:N});o.uniforms.tEquirect.value=s;var c=new Bn(a,o),f=s.minFilter;s.minFilter===gi&&(s.minFilter=Nt);var d=new Ih(1,10,this);return d.update(e,c),s.minFilter=f,c.geometry.dispose(),c.material.dispose(),this};function cu(e,s,t,a,o,c,f,d,m,y,w,M){Si.call(this,null,c,f,d,m,y,a,o,w,M),this.image={data:e||null,width:s||1,height:t||1},this.magFilter=m!==void 0?m:it,this.minFilter=y!==void 0?y:it,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}cu.prototype=Object.create(Si.prototype),cu.prototype.constructor=cu,cu.prototype.isDataTexture=!0;var Dh=new ya,tm=new ee,fd=function(){function e(t,a,o,c,f,d){this.planes=[t!==void 0?t:new _a,a!==void 0?a:new _a,o!==void 0?o:new _a,c!==void 0?c:new _a,f!==void 0?f:new _a,d!==void 0?d:new _a]}var s=e.prototype;return s.set=function(t,a,o,c,f,d){var m=this.planes;return m[0].copy(t),m[1].copy(a),m[2].copy(o),m[3].copy(c),m[4].copy(f),m[5].copy(d),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){for(var a=this.planes,o=0;o<6;o++)a[o].copy(t.planes[o]);return this},s.setFromProjectionMatrix=function(t){var a=this.planes,o=t.elements,c=o[0],f=o[1],d=o[2],m=o[3],y=o[4],w=o[5],M=o[6],D=o[7],P=o[8],F=o[9],C=o[10],I=o[11],q=o[12],J=o[13],Z=o[14],G=o[15];return a[0].setComponents(m-c,D-y,I-P,G-q).normalize(),a[1].setComponents(m+c,D+y,I+P,G+q).normalize(),a[2].setComponents(m+f,D+w,I+F,G+J).normalize(),a[3].setComponents(m-f,D-w,I-F,G-J).normalize(),a[4].setComponents(m-d,D-M,I-C,G-Z).normalize(),a[5].setComponents(m+d,D+M,I+C,G+Z).normalize(),this},s.intersectsObject=function(t){var a=t.geometry;return a.boundingSphere===null&&a.computeBoundingSphere(),Dh.copy(a.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Dh)},s.intersectsSprite=function(t){return Dh.center.set(0,0,0),Dh.radius=.7071067811865476,Dh.applyMatrix4(t.matrixWorld),this.intersectsSphere(Dh)},s.intersectsSphere=function(t){for(var a=this.planes,o=t.center,c=-t.radius,f=0;f<6;f++){var d=a[f].distanceToPoint(o);if(d<c)return!1}return!0},s.intersectsBox=function(t){for(var a=this.planes,o=0;o<6;o++){var c=a[o];if(tm.x=c.normal.x>0?t.max.x:t.min.x,tm.y=c.normal.y>0?t.max.y:t.min.y,tm.z=c.normal.z>0?t.max.z:t.min.z,c.distanceToPoint(tm)<0)return!1}return!0},s.containsPoint=function(t){for(var a=this.planes,o=0;o<6;o++)if(a[o].distanceToPoint(t)<0)return!1;return!0},e}();function N_(){var e=null,s=!1,t=null,a=null;function o(c,f){t(c,f),a=e.requestAnimationFrame(o)}return{start:function(){s!==!0&&t!==null&&(a=e.requestAnimationFrame(o),s=!0)},stop:function(){e.cancelAnimationFrame(a),s=!1},setAnimationLoop:function(c){t=c},setContext:function(c){e=c}}}function mA(e,s){var t=s.isWebGL2,a=new WeakMap;function o(f,d){var m=f.array,y=f.usage,w=e.createBuffer();e.bindBuffer(d,w),e.bufferData(d,m,y),f.onUploadCallback();var M=5126;return m instanceof Float32Array?M=5126:m instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):m instanceof Uint16Array?M=5123:m instanceof Int16Array?M=5122:m instanceof Uint32Array?M=5125:m instanceof Int32Array?M=5124:m instanceof Int8Array?M=5120:m instanceof Uint8Array&&(M=5121),{buffer:w,type:M,bytesPerElement:m.BYTES_PER_ELEMENT,version:f.version}}function c(f,d,m){var y=d.array,w=d.updateRange;e.bindBuffer(m,f),w.count===-1?e.bufferSubData(m,0,y):(t?e.bufferSubData(m,w.offset*y.BYTES_PER_ELEMENT,y,w.offset,w.count):e.bufferSubData(m,w.offset*y.BYTES_PER_ELEMENT,y.subarray(w.offset,w.offset+w.count)),w.count=-1)}return{get:function(f){return f.isInterleavedBufferAttribute&&(f=f.data),a.get(f)},remove:function(f){f.isInterleavedBufferAttribute&&(f=f.data);var d=a.get(f);d&&(e.deleteBuffer(d.buffer),a.delete(f))},update:function(f,d){if(f.isGLBufferAttribute){var m=a.get(f);(!m||m.version<f.version)&&a.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);var y=a.get(f);y===void 0?a.set(f,o(f,d)):y.version<f.version&&(c(y.buffer,f,d),y.version=f.version)}}}var nm=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="PlaneBufferGeometry",f.parameters={width:t,height:a,widthSegments:o,heightSegments:c},t=t||1,a=a||1;for(var d=t/2,m=a/2,y=Math.floor(o)||1,w=Math.floor(c)||1,M=y+1,D=t/y,P=a/w,F=[],C=[],I=[],q=[],J=0;J<w+1;J++)for(var Z=J*P-m,G=0;G<M;G++){var j=G*D-d;C.push(j,-Z,0),I.push(0,0,1),q.push(G/y),q.push(1-J/w)}for(var ne=0;ne<w;ne++)for(var se=0;se<y;se++){var Ee=se+M*ne,Be=se+M*(ne+1),ce=se+1+M*(ne+1),oe=se+1+M*ne;F.push(Ee,Be,oe),F.push(Be,ce,oe)}return f.setIndex(F),f.setAttribute("position",new x(C,3)),f.setAttribute("normal",new x(I,3)),f.setAttribute("uv",new x(q,2)),f}return s}(Ae),$n={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmissionmap_fragment:`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,transmissionmap_pars_fragment:`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Wt={common:{diffuse:{value:new Xt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new aa},uv2Transform:{value:new aa},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Xt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new aa}},sprite:{diffuse:{value:new Xt(15658734)},opacity:{value:1},center:{value:new xt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new aa}}},so={basic:{uniforms:wr([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.fog]),vertexShader:$n.meshbasic_vert,fragmentShader:$n.meshbasic_frag},lambert:{uniforms:wr([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.fog,Wt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:$n.meshlambert_vert,fragmentShader:$n.meshlambert_frag},phong:{uniforms:wr([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new Xt(0)},specular:{value:new Xt(1118481)},shininess:{value:30}}]),vertexShader:$n.meshphong_vert,fragmentShader:$n.meshphong_frag},standard:{uniforms:wr([Wt.common,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.roughnessmap,Wt.metalnessmap,Wt.fog,Wt.lights,{emissive:{value:new Xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag},toon:{uniforms:wr([Wt.common,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.gradientmap,Wt.fog,Wt.lights,{emissive:{value:new Xt(0)}}]),vertexShader:$n.meshtoon_vert,fragmentShader:$n.meshtoon_frag},matcap:{uniforms:wr([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,{matcap:{value:null}}]),vertexShader:$n.meshmatcap_vert,fragmentShader:$n.meshmatcap_frag},points:{uniforms:wr([Wt.points,Wt.fog]),vertexShader:$n.points_vert,fragmentShader:$n.points_frag},dashed:{uniforms:wr([Wt.common,Wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$n.linedashed_vert,fragmentShader:$n.linedashed_frag},depth:{uniforms:wr([Wt.common,Wt.displacementmap]),vertexShader:$n.depth_vert,fragmentShader:$n.depth_frag},normal:{uniforms:wr([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,{opacity:{value:1}}]),vertexShader:$n.normal_vert,fragmentShader:$n.normal_frag},sprite:{uniforms:wr([Wt.sprite,Wt.fog]),vertexShader:$n.sprite_vert,fragmentShader:$n.sprite_frag},background:{uniforms:{uvTransform:{value:new aa},t2D:{value:null}},vertexShader:$n.background_vert,fragmentShader:$n.background_frag},cube:{uniforms:wr([Wt.envmap,{opacity:{value:1}}]),vertexShader:$n.cube_vert,fragmentShader:$n.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$n.equirect_vert,fragmentShader:$n.equirect_frag},distanceRGBA:{uniforms:wr([Wt.common,Wt.displacementmap,{referencePosition:{value:new ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$n.distanceRGBA_vert,fragmentShader:$n.distanceRGBA_frag},shadow:{uniforms:wr([Wt.lights,Wt.fog,{color:{value:new Xt(0)},opacity:{value:1}}]),vertexShader:$n.shadow_vert,fragmentShader:$n.shadow_frag}};so.physical={uniforms:wr([so.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new xt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Xt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:$n.meshphysical_vert,fragmentShader:$n.meshphysical_frag};function gA(e,s,t,a,o){var c=new Xt(0),f=0,d,m,y=null,w=0,M=null;function D(F,C,I,q){var J=C.isScene===!0?C.background:null;J&&J.isTexture&&(J=s.get(J));var Z=e.xr,G=Z.getSession&&Z.getSession();G&&G.environmentBlendMode==="additive"&&(J=null),J===null?P(c,f):J&&J.isColor&&(P(J,1),q=!0),(e.autoClear||q)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),J&&(J.isCubeTexture||J.isWebGLCubeRenderTarget||J.mapping===Je)?(m===void 0&&(m=new Bn(new ls(1,1,1),new $r({name:"BackgroundCubeMaterial",uniforms:Wa(so.cube.uniforms),vertexShader:so.cube.vertexShader,fragmentShader:so.cube.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(j,ne,se){this.matrixWorld.copyPosition(se.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(m)),J.isWebGLCubeRenderTarget&&(J=J.texture),m.material.uniforms.envMap.value=J,m.material.uniforms.flipEnvMap.value=J.isCubeTexture&&J._needsFlipEnvMap?-1:1,(y!==J||w!==J.version||M!==e.toneMapping)&&(m.material.needsUpdate=!0,y=J,w=J.version,M=e.toneMapping),F.unshift(m,m.geometry,m.material,0,0,null)):J&&J.isTexture&&(d===void 0&&(d=new Bn(new nm(2,2),new $r({name:"BackgroundMaterial",uniforms:Wa(so.background.uniforms),vertexShader:so.background.vertexShader,fragmentShader:so.background.fragmentShader,side:A,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(d)),d.material.uniforms.t2D.value=J,J.matrixAutoUpdate===!0&&J.updateMatrix(),d.material.uniforms.uvTransform.value.copy(J.matrix),(y!==J||w!==J.version||M!==e.toneMapping)&&(d.material.needsUpdate=!0,y=J,w=J.version,M=e.toneMapping),F.unshift(d,d.geometry,d.material,0,0,null))}function P(F,C){t.buffers.color.setClear(F.r,F.g,F.b,C,o)}return{getClearColor:function(){return c},setClearColor:function(F,C){c.set(F),f=C!==void 0?C:1,P(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(F){f=F,P(c,f)},render:D}}function vA(e,s,t,a){var o=e.getParameter(34921),c=a.isWebGL2?null:s.get("OES_vertex_array_object"),f=a.isWebGL2||c!==null,d={},m=C(null),y=m;function w(ce,oe,ie,Ce,De){var Oe=!1;if(f){var et=F(Ce,ie,oe);y!==et&&(y=et,D(y.object)),Oe=I(Ce,De),Oe&&q(Ce,De)}else{var gt=oe.wireframe===!0;(y.geometry!==Ce.id||y.program!==ie.id||y.wireframe!==gt)&&(y.geometry=Ce.id,y.program=ie.id,y.wireframe=gt,Oe=!0)}ce.isInstancedMesh===!0&&(Oe=!0),De!==null&&t.update(De,34963),Oe&&(se(ce,oe,ie,Ce),De!==null&&e.bindBuffer(34963,t.get(De).buffer))}function M(){return a.isWebGL2?e.createVertexArray():c.createVertexArrayOES()}function D(ce){return a.isWebGL2?e.bindVertexArray(ce):c.bindVertexArrayOES(ce)}function P(ce){return a.isWebGL2?e.deleteVertexArray(ce):c.deleteVertexArrayOES(ce)}function F(ce,oe,ie){var Ce=ie.wireframe===!0,De=d[ce.id];De===void 0&&(De={},d[ce.id]=De);var Oe=De[oe.id];Oe===void 0&&(Oe={},De[oe.id]=Oe);var et=Oe[Ce];return et===void 0&&(et=C(M()),Oe[Ce]=et),et}function C(ce){for(var oe=[],ie=[],Ce=[],De=0;De<o;De++)oe[De]=0,ie[De]=0,Ce[De]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:oe,enabledAttributes:ie,attributeDivisors:Ce,object:ce,attributes:{},index:null}}function I(ce,oe){var ie=y.attributes,Ce=ce.attributes;if(Object.keys(ie).length!==Object.keys(Ce).length)return!0;for(var De in Ce){var Oe=ie[De],et=Ce[De];if(Oe===void 0||Oe.attribute!==et||Oe.data!==et.data)return!0}return y.index!==oe}function q(ce,oe){var ie={},Ce=ce.attributes;for(var De in Ce){var Oe=Ce[De],et={};et.attribute=Oe,Oe.data&&(et.data=Oe.data),ie[De]=et}y.attributes=ie,y.index=oe}function J(){for(var ce=y.newAttributes,oe=0,ie=ce.length;oe<ie;oe++)ce[oe]=0}function Z(ce){G(ce,0)}function G(ce,oe){var ie=y.newAttributes,Ce=y.enabledAttributes,De=y.attributeDivisors;if(ie[ce]=1,Ce[ce]===0&&(e.enableVertexAttribArray(ce),Ce[ce]=1),De[ce]!==oe){var Oe=a.isWebGL2?e:s.get("ANGLE_instanced_arrays");Oe[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ce,oe),De[ce]=oe}}function j(){for(var ce=y.newAttributes,oe=y.enabledAttributes,ie=0,Ce=oe.length;ie<Ce;ie++)oe[ie]!==ce[ie]&&(e.disableVertexAttribArray(ie),oe[ie]=0)}function ne(ce,oe,ie,Ce,De,Oe){a.isWebGL2===!0&&(ie===5124||ie===5125)?e.vertexAttribIPointer(ce,oe,ie,De,Oe):e.vertexAttribPointer(ce,oe,ie,Ce,De,Oe)}function se(ce,oe,ie,Ce){if(!(a.isWebGL2===!1&&(ce.isInstancedMesh||Ce.isInstancedBufferGeometry)&&s.get("ANGLE_instanced_arrays")===null)){J();var De=Ce.attributes,Oe=ie.getAttributes(),et=oe.defaultAttributeValues;for(var gt in Oe){var pt=Oe[gt];if(pt>=0){var lt=De[gt];if(lt!==void 0){var St=lt.normalized,Ht=lt.itemSize,Ut=t.get(lt);if(Ut===void 0)continue;var rn=Ut.buffer,pn=Ut.type,dt=Ut.bytesPerElement;if(lt.isInterleavedBufferAttribute){var Un=lt.data,Dn=Un.stride,wn=lt.offset;Un&&Un.isInstancedInterleavedBuffer?(G(pt,Un.meshPerAttribute),Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=Un.meshPerAttribute*Un.count)):Z(pt),e.bindBuffer(34962,rn),ne(pt,Ht,pn,St,Dn*dt,wn*dt)}else lt.isInstancedBufferAttribute?(G(pt,lt.meshPerAttribute),Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=lt.meshPerAttribute*lt.count)):Z(pt),e.bindBuffer(34962,rn),ne(pt,Ht,pn,St,0,0)}else if(gt==="instanceMatrix"){var ci=t.get(ce.instanceMatrix);if(ci===void 0)continue;var Zn=ci.buffer,vi=ci.type;G(pt+0,1),G(pt+1,1),G(pt+2,1),G(pt+3,1),e.bindBuffer(34962,Zn),e.vertexAttribPointer(pt+0,4,vi,!1,64,0),e.vertexAttribPointer(pt+1,4,vi,!1,64,16),e.vertexAttribPointer(pt+2,4,vi,!1,64,32),e.vertexAttribPointer(pt+3,4,vi,!1,64,48)}else if(gt==="instanceColor"){var ri=t.get(ce.instanceColor);if(ri===void 0)continue;var Vi=ri.buffer,Me=ri.type;G(pt,1),e.bindBuffer(34962,Vi),e.vertexAttribPointer(pt,3,Me,!1,12,0)}else if(et!==void 0){var X=et[gt];if(X!==void 0)switch(X.length){case 2:e.vertexAttrib2fv(pt,X);break;case 3:e.vertexAttrib3fv(pt,X);break;case 4:e.vertexAttrib4fv(pt,X);break;default:e.vertexAttrib1fv(pt,X)}}}}j()}}function Ee(){Be(),y!==m&&(y=m,D(y.object))}function Be(){m.geometry=null,m.program=null,m.wireframe=!1}return{setup:w,reset:Ee,resetDefaultState:Be,dispose:function(){Ee();for(var ce in d){var oe=d[ce];for(var ie in oe){var Ce=oe[ie];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete oe[ie]}delete d[ce]}},releaseStatesOfGeometry:function(ce){if(d[ce.id]!==void 0){var oe=d[ce.id];for(var ie in oe){var Ce=oe[ie];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete oe[ie]}delete d[ce.id]}},releaseStatesOfProgram:function(ce){for(var oe in d){var ie=d[oe];if(ie[ce.id]!==void 0){var Ce=ie[ce.id];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete ie[ce.id]}}},initAttributes:J,enableAttribute:Z,disableUnusedAttributes:j}}function yA(e,s,t,a){var o=a.isWebGL2,c;function f(m,y){e.drawArrays(c,m,y),t.update(y,c,1)}function d(m,y,w){if(w!==0){var M,D;if(o)M=e,D="drawArraysInstanced";else if(M=s.get("ANGLE_instanced_arrays"),D="drawArraysInstancedANGLE",M===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[D](c,m,y,w),t.update(y,c,w)}}this.setMode=function(m){c=m},this.render=f,this.renderInstances=d}function _A(e,s,t){var a;function o(){if(a!==void 0)return a;var j=s.get("EXT_texture_filter_anisotropic");return j!==null?a=e.getParameter(j.MAX_TEXTURE_MAX_ANISOTROPY_EXT):a=0,a}function c(j){if(j==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";j="mediump"}return j==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var f=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext,d=t.precision!==void 0?t.precision:"highp",m=c(d);m!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",m,"instead."),d=m);var y=t.logarithmicDepthBuffer===!0,w=e.getParameter(34930),M=e.getParameter(35660),D=e.getParameter(3379),P=e.getParameter(34076),F=e.getParameter(34921),C=e.getParameter(36347),I=e.getParameter(36348),q=e.getParameter(36349),J=M>0,Z=f||!!s.get("OES_texture_float"),G=f?e.getParameter(36183):0;return{isWebGL2:f,getMaxAnisotropy:o,getMaxPrecision:c,precision:d,logarithmicDepthBuffer:y,maxTextures:w,maxVertexTextures:M,maxTextureSize:D,maxCubemapSize:P,maxAttributes:F,maxVertexUniforms:C,maxVaryings:I,maxFragmentUniforms:q,vertexTextures:J,floatFragmentTextures:Z,floatVertexTextures:J&&Z,maxSamples:G}}function xA(e){var s=this,t=null,a=0,o=!1,c=!1,f=new _a,d=new aa,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(M,D,P){var F=M.length!==0||D||a!==0||o;return o=D,t=w(M,P,0),a=M.length,F},this.beginShadows=function(){c=!0,w(null)},this.endShadows=function(){c=!1,y()},this.setState=function(M,D,P){var F=M.clippingPlanes,C=M.clipIntersection,I=M.clipShadows,q=e.get(M);if(!o||F===null||F.length===0||c&&!I)c?w(null):y();else{var J=c?0:a,Z=J*4,G=q.clippingState||null;m.value=G,G=w(F,D,Z,P);for(var j=0;j!==Z;++j)G[j]=t[j];q.clippingState=G,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=J}};function y(){m.value!==t&&(m.value=t,m.needsUpdate=a>0),s.numPlanes=a,s.numIntersection=0}function w(M,D,P,F){var C=M!==null?M.length:0,I=null;if(C!==0){if(I=m.value,F!==!0||I===null){var q=P+C*4,J=D.matrixWorldInverse;d.getNormalMatrix(J),(I===null||I.length<q)&&(I=new Float32Array(q));for(var Z=0,G=P;Z!==C;++Z,G+=4)f.copy(M[Z]).applyMatrix4(J,d),f.normal.toArray(I,G),I[G+3]=f.constant}m.value=I,m.needsUpdate=!0}return s.numPlanes=C,s.numIntersection=0,I}}function bA(e){var s=new WeakMap;function t(o,c){return c===Ge?o.mapping=Y:c===ue&&(o.mapping=He),o}function a(o){if(o&&o.isTexture){var c=o.mapping;if(c===Ge||c===ue)if(s.has(o)){var f=s.get(o).texture;return t(f,o.mapping)}else{var d=o.image;if(d&&d.height>0){var m=e.getRenderList(),y=e.getRenderTarget(),w=e.getRenderState(),M=new yc(d.height/2);return M.fromEquirectangularTexture(e,o),s.set(o,M),e.setRenderTarget(y),e.setRenderList(m),e.setRenderState(w),t(M.texture,o.mapping)}else return null}}return o}return{get:a,dispose:function(){s=new WeakMap}}}function wA(e){var s={};return{has:function(t){if(s[t]!==void 0)return s[t]!==null;var a;switch(t){case"WEBGL_depth_texture":a=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=e.getExtension(t)}return s[t]=a,a!==null},get:function(t){return this.has(t)||console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),s[t]}}}function MA(e,s,t,a){var o=new WeakMap,c=new WeakMap;function f(y){var w=y.target,M=o.get(w);M.index!==null&&s.remove(M.index);for(var D in M.attributes)s.remove(M.attributes[D]);w.removeEventListener("dispose",f),o.delete(w);var P=c.get(M);P&&(s.remove(P),c.delete(M)),a.releaseStatesOfGeometry(w),w.isInstancedBufferGeometry===!0&&delete w._maxInstanceCount,t.memory.geometries--}function d(y){var w=y.attributes;for(var M in w)s.update(w[M],34962);var D=y.morphAttributes;for(var P in D)for(var F=D[P],C=0,I=F.length;C<I;C++)s.update(F[C],34962)}function m(y){var w=[],M=y.index,D=y.attributes.position,P=0;if(M!==null){var F=M.array;P=M.version;for(var C=0,I=F.length;C<I;C+=3){var q=F[C+0],J=F[C+1],Z=F[C+2];w.push(q,J,J,Z,Z,q)}}else{var G=D.array;P=D.version;for(var j=0,ne=G.length/3-1;j<ne;j+=3){var se=j+0,Ee=j+1,Be=j+2;w.push(se,Ee,Ee,Be,Be,se)}}var ce=new(U(w)>65535?v:Al)(w,1);ce.version=P;var oe=c.get(y);oe&&s.remove(oe),c.set(y,ce)}return{get:function(y,w){var M=o.get(w);return M||(w.addEventListener("dispose",f),w.isBufferGeometry?M=w:w.isGeometry&&(w._bufferGeometry===void 0&&(w._bufferGeometry=new Ae().setFromObject(y)),M=w._bufferGeometry),o.set(w,M),t.memory.geometries++,M)},update:d,getWireframeAttribute:function(y){var w=c.get(y);if(w){var M=y.index;M!==null&&w.version<M.version&&m(y)}else m(y);return c.get(y)}}}function SA(e,s,t,a){var o=a.isWebGL2,c,f,d;function m(w,M){e.drawElements(c,M,f,w*d),t.update(M,c,1)}function y(w,M,D){if(D!==0){var P,F;if(o)P=e,F="drawElementsInstanced";else if(P=s.get("ANGLE_instanced_arrays"),F="drawElementsInstancedANGLE",P===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}P[F](c,M,f,w*d,D),t.update(M,c,D)}}this.setMode=function(w){c=w},this.setIndex=function(w){f=w.type,d=w.bytesPerElement},this.render=m,this.renderInstances=y}function TA(){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(s,t,a){switch(e.calls++,t){case 4:e.triangles+=a*(s/3);break;case 1:e.lines+=a*(s/2);break;case 3:e.lines+=a*(s-1);break;case 2:e.lines+=a*s;break;case 0:e.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}}}function EA(e,s){return e[0]-s[0]}function AA(e,s){return Math.abs(s[1])-Math.abs(e[1])}function LA(e){for(var s={},t=new Float32Array(8),a=[],o=0;o<8;o++)a[o]=[o,0];return{update:function(c,f,d,m){var y=c.morphTargetInfluences,w=y===void 0?0:y.length,M=s[f.id];if(M===void 0){M=[];for(var D=0;D<w;D++)M[D]=[D,0];s[f.id]=M}for(var P=0;P<w;P++){var F=M[P];F[0]=P,F[1]=y[P]}M.sort(AA);for(var C=0;C<8;C++)C<w&&M[C][1]?(a[C][0]=M[C][0],a[C][1]=M[C][1]):(a[C][0]=Number.MAX_SAFE_INTEGER,a[C][1]=0);a.sort(EA);for(var I=d.morphTargets&&f.morphAttributes.position,q=d.morphNormals&&f.morphAttributes.normal,J=0,Z=0;Z<8;Z++){var G=a[Z],j=G[0],ne=G[1];j!==Number.MAX_SAFE_INTEGER&&ne?(I&&f.getAttribute("morphTarget"+Z)!==I[j]&&f.setAttribute("morphTarget"+Z,I[j]),q&&f.getAttribute("morphNormal"+Z)!==q[j]&&f.setAttribute("morphNormal"+Z,q[j]),t[Z]=ne,J+=ne):(I&&f.getAttribute("morphTarget"+Z)!==void 0&&f.deleteAttribute("morphTarget"+Z),q&&f.getAttribute("morphNormal"+Z)!==void 0&&f.deleteAttribute("morphNormal"+Z),t[Z]=0)}var se=f.morphTargetsRelative?1:1-J;m.getUniforms().setValue(e,"morphTargetBaseInfluence",se),m.getUniforms().setValue(e,"morphTargetInfluences",t)}}}function RA(e,s,t,a){var o=new WeakMap;function c(f){var d=a.render.frame,m=f.geometry,y=s.get(f,m);return o.get(y)!==d&&(m.isGeometry&&y.updateFromObject(f),s.update(y),o.set(y,d)),f.isInstancedMesh&&(t.update(f.instanceMatrix,34962),f.instanceColor!==null&&t.update(f.instanceColor,34962)),y}return{update:c,dispose:function(){o=new WeakMap}}}function Oh(e,s,t,a){Si.call(this,null),this.image={data:e||null,width:s||1,height:t||1,depth:a||1},this.magFilter=it,this.minFilter=it,this.wrapR=ut,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Oh.prototype=Object.create(Si.prototype),Oh.prototype.constructor=Oh,Oh.prototype.isDataTexture2DArray=!0;function Nh(e,s,t,a){Si.call(this,null),this.image={data:e||null,width:s||1,height:t||1,depth:a||1},this.magFilter=it,this.minFilter=it,this.wrapR=ut,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Nh.prototype=Object.create(Si.prototype),Nh.prototype.constructor=Nh,Nh.prototype.isDataTexture3D=!0;var F_=new Si,CA=new Oh,PA=new Nh,B_=new qo,U_=[],G_=[],z_=new Float32Array(16),H_=new Float32Array(9),k_=new Float32Array(4);function Fh(e,s,t){var a=e[0];if(a<=0||a>0)return e;var o=s*t,c=U_[o];if(c===void 0&&(c=new Float32Array(o),U_[o]=c),s!==0){a.toArray(c,0);for(var f=1,d=0;f!==s;++f)d+=t,e[f].toArray(c,d)}return c}function Ls(e,s){if(e.length!==s.length)return!1;for(var t=0,a=e.length;t<a;t++)if(e[t]!==s[t])return!1;return!0}function cs(e,s){for(var t=0,a=s.length;t<a;t++)e[t]=s[t]}function V_(e,s){var t=G_[s];t===void 0&&(t=new Int32Array(s),G_[s]=t);for(var a=0;a!==s;++a)t[a]=e.allocateTextureUnit();return t}function IA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1f(this.addr,s),t[0]=s)}function DA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y)&&(e.uniform2f(this.addr,s.x,s.y),t[0]=s.x,t[1]=s.y);else{if(Ls(t,s))return;e.uniform2fv(this.addr,s),cs(t,s)}}function OA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y||t[2]!==s.z)&&(e.uniform3f(this.addr,s.x,s.y,s.z),t[0]=s.x,t[1]=s.y,t[2]=s.z);else if(s.r!==void 0)(t[0]!==s.r||t[1]!==s.g||t[2]!==s.b)&&(e.uniform3f(this.addr,s.r,s.g,s.b),t[0]=s.r,t[1]=s.g,t[2]=s.b);else{if(Ls(t,s))return;e.uniform3fv(this.addr,s),cs(t,s)}}function NA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y||t[2]!==s.z||t[3]!==s.w)&&(e.uniform4f(this.addr,s.x,s.y,s.z,s.w),t[0]=s.x,t[1]=s.y,t[2]=s.z,t[3]=s.w);else{if(Ls(t,s))return;e.uniform4fv(this.addr,s),cs(t,s)}}function FA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ls(t,s))return;e.uniformMatrix2fv(this.addr,!1,s),cs(t,s)}else{if(Ls(t,a))return;k_.set(a),e.uniformMatrix2fv(this.addr,!1,k_),cs(t,a)}}function BA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ls(t,s))return;e.uniformMatrix3fv(this.addr,!1,s),cs(t,s)}else{if(Ls(t,a))return;H_.set(a),e.uniformMatrix3fv(this.addr,!1,H_),cs(t,a)}}function UA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ls(t,s))return;e.uniformMatrix4fv(this.addr,!1,s),cs(t,s)}else{if(Ls(t,a))return;z_.set(a),e.uniformMatrix4fv(this.addr,!1,z_),cs(t,a)}}function GA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.safeSetTexture2D(s||F_,o)}function zA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.setTexture2DArray(s||CA,o)}function HA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.setTexture3D(s||PA,o)}function kA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.safeSetTextureCube(s||B_,o)}function VA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1i(this.addr,s),t[0]=s)}function WA(e,s){var t=this.cache;Ls(t,s)||(e.uniform2iv(this.addr,s),cs(t,s))}function qA(e,s){var t=this.cache;Ls(t,s)||(e.uniform3iv(this.addr,s),cs(t,s))}function XA(e,s){var t=this.cache;Ls(t,s)||(e.uniform4iv(this.addr,s),cs(t,s))}function jA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1ui(this.addr,s),t[0]=s)}function YA(e){switch(e){case 5126:return IA;case 35664:return DA;case 35665:return OA;case 35666:return NA;case 35674:return FA;case 35675:return BA;case 35676:return UA;case 5124:case 35670:return VA;case 35667:case 35671:return WA;case 35668:case 35672:return qA;case 35669:case 35673:return XA;case 5125:return jA;case 35678:case 36198:case 36298:case 36306:case 35682:return GA;case 35679:case 36299:case 36307:return HA;case 35680:case 36300:case 36308:case 36293:return kA;case 36289:case 36303:case 36311:case 36292:return zA}}function ZA(e,s){e.uniform1fv(this.addr,s)}function JA(e,s){e.uniform1iv(this.addr,s)}function KA(e,s){e.uniform2iv(this.addr,s)}function $A(e,s){e.uniform3iv(this.addr,s)}function QA(e,s){e.uniform4iv(this.addr,s)}function eL(e,s){var t=Fh(s,this.size,2);e.uniform2fv(this.addr,t)}function tL(e,s){var t=Fh(s,this.size,3);e.uniform3fv(this.addr,t)}function nL(e,s){var t=Fh(s,this.size,4);e.uniform4fv(this.addr,t)}function iL(e,s){var t=Fh(s,this.size,4);e.uniformMatrix2fv(this.addr,!1,t)}function rL(e,s){var t=Fh(s,this.size,9);e.uniformMatrix3fv(this.addr,!1,t)}function aL(e,s){var t=Fh(s,this.size,16);e.uniformMatrix4fv(this.addr,!1,t)}function sL(e,s,t){var a=s.length,o=V_(t,a);e.uniform1iv(this.addr,o);for(var c=0;c!==a;++c)t.safeSetTexture2D(s[c]||F_,o[c])}function oL(e,s,t){var a=s.length,o=V_(t,a);e.uniform1iv(this.addr,o);for(var c=0;c!==a;++c)t.safeSetTextureCube(s[c]||B_,o[c])}function lL(e){switch(e){case 5126:return ZA;case 35664:return eL;case 35665:return tL;case 35666:return nL;case 35674:return iL;case 35675:return rL;case 35676:return aL;case 5124:case 35670:return JA;case 35667:case 35671:return KA;case 35668:case 35672:return $A;case 35669:case 35673:return QA;case 35678:case 36198:case 36298:case 36306:case 35682:return sL;case 35680:case 36300:case 36308:case 36293:return oL}}function cL(e,s,t){this.id=e,this.addr=t,this.cache=[],this.setValue=YA(s.type)}function W_(e,s,t){this.id=e,this.addr=t,this.cache=[],this.size=s.size,this.setValue=lL(s.type)}W_.prototype.updateCache=function(e){var s=this.cache;e instanceof Float32Array&&s.length!==e.length&&(this.cache=new Float32Array(e.length)),cs(s,e)};function q_(e){this.id=e,this.seq=[],this.map={}}q_.prototype.setValue=function(e,s,t){for(var a=this.seq,o=0,c=a.length;o!==c;++o){var f=a[o];f.setValue(e,s[f.id],t)}};var Av=/([\w\d_]+)(\])?(\[|\.)?/g;function X_(e,s){e.seq.push(s),e.map[s.id]=s}function uL(e,s,t){var a=e.name,o=a.length;for(Av.lastIndex=0;;){var c=Av.exec(a),f=Av.lastIndex,d=c[1],m=c[2]==="]",y=c[3];if(m&&(d=d|0),y===void 0||y==="["&&f+2===o){X_(t,y===void 0?new cL(d,e,s):new W_(d,e,s));break}else{var w=t.map,M=w[d];M===void 0&&(M=new q_(d),X_(t,M)),t=M}}}function _c(e,s){this.seq=[],this.map={};for(var t=e.getProgramParameter(s,35718),a=0;a<t;++a){var o=e.getActiveUniform(s,a),c=e.getUniformLocation(s,o.name);uL(o,c,this)}}_c.prototype.setValue=function(e,s,t,a){var o=this.map[s];o!==void 0&&o.setValue(e,t,a)},_c.prototype.setOptional=function(e,s,t){var a=s[t];a!==void 0&&this.setValue(e,t,a)},_c.upload=function(e,s,t,a){for(var o=0,c=s.length;o!==c;++o){var f=s[o],d=t[f.id];d.needsUpdate!==!1&&f.setValue(e,d.value,a)}},_c.seqWithValue=function(e,s){for(var t=[],a=0,o=e.length;a!==o;++a){var c=e[a];c.id in s&&t.push(c)}return t};function j_(e,s,t){var a=e.createShader(s);return e.shaderSource(a,t),e.compileShader(a),a}var hL=0;function fL(e){for(var s=e.split(`
`),t=0;t<s.length;t++)s[t]=t+1+": "+s[t];return s.join(`
`)}function Y_(e){switch(e){case Wr:return["Linear","( value )"];case gl:return["sRGB","( value )"];case Oo:return["RGBE","( value )"];case $f:return["RGBM","( value, 7.0 )"];case $c:return["RGBM","( value, 16.0 )"];case Qf:return["RGBD","( value, 256.0 )"];case Kc:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case qr:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Z_(e,s,t){var a=e.getShaderParameter(s,35713),o=e.getShaderInfoLog(s).trim();if(a&&o==="")return"";var c=e.getShaderSource(s);return"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+o+fL(c)}function dd(e,s){var t=Y_(s);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function dL(e,s){var t=Y_(s);return"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function pL(e,s){var t;switch(s){case Se:t="Linear";break;case Pe:t="Reinhard";break;case ze:t="OptimizedCineon";break;case Ze:t="ACESFilmic";break;case Xe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",s),t="Linear"}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function mL(e){var s=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return s.filter(pd).join(`
`)}function gL(e){var s=[];for(var t in e){var a=e[t];a!==!1&&s.push("#define "+t+" "+a)}return s.join(`
`)}function vL(e,s){for(var t={},a=e.getProgramParameter(s,35721),o=0;o<a;o++){var c=e.getActiveAttrib(s,o),f=c.name;t[f]=e.getAttribLocation(s,f)}return t}function pd(e){return e!==""}function J_(e,s){return e.replace(/NUM_DIR_LIGHTS/g,s.numDirLights).replace(/NUM_SPOT_LIGHTS/g,s.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,s.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,s.numPointLights).replace(/NUM_HEMI_LIGHTS/g,s.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,s.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,s.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,s.numPointLightShadows)}function K_(e,s){return e.replace(/NUM_CLIPPING_PLANES/g,s.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,s.numClippingPlanes-s.numClipIntersection)}function Lv(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,yL)}function yL(e,s){var t=$n[s];if(t===void 0)throw new Error("Can not resolve #include <"+s+">");return Lv(t)}function $_(e){return e.replace(/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,Q_).replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,_L)}function _L(e,s,t,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Q_(e,s,t,a)}function Q_(e,s,t,a){for(var o="",c=parseInt(s);c<parseInt(t);c++)o+=a.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return o}function ex(e){var s="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?s+=`
#define HIGH_PRECISION`:e.precision==="mediump"?s+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(s+=`
#define LOW_PRECISION`),s}function xL(e){var s="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===g?s="SHADOWMAP_TYPE_PCF":e.shadowMapType===_?s="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===b&&(s="SHADOWMAP_TYPE_VSM"),s}function bL(e){var s="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Y:case He:s="ENVMAP_TYPE_CUBE";break;case Je:case ct:s="ENVMAP_TYPE_CUBE_UV";break}return s}function wL(e){var s="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case He:case ct:s="ENVMAP_MODE_REFRACTION";break}return s}function ML(e){var s="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case de:s="ENVMAP_BLENDING_MULTIPLY";break;case be:s="ENVMAP_BLENDING_MIX";break;case Re:s="ENVMAP_BLENDING_ADD";break}return s}function SL(e,s,t,a){var o=e.getContext(),c=t.defines,f=t.vertexShader,d=t.fragmentShader,m=xL(t),y=bL(t),w=wL(t),M=ML(t),D=e.gammaFactor>0?e.gammaFactor:1,P=t.isWebGL2?"":mL(t),F=gL(c),C=o.createProgram(),I,q,J=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(I=[F].filter(pd).join(`
`),I.length>0&&(I+=`
`),q=[P,F].filter(pd).join(`
`),q.length>0&&(q+=`
`)):(I=[ex(t),"#define SHADER_NAME "+t.shaderName,F,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+D,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+w:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+m:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(pd).join(`
`),q=[P,ex(t),"#define SHADER_NAME "+t.shaderName,F,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.envMap?"#define "+w:"",t.envMap?"#define "+M:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+m:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==we?"#define TONE_MAPPING":"",t.toneMapping!==we?$n.tonemapping_pars_fragment:"",t.toneMapping!==we?pL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",$n.encodings_pars_fragment,t.map?dd("mapTexelToLinear",t.mapEncoding):"",t.matcap?dd("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?dd("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?dd("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?dd("lightMapTexelToLinear",t.lightMapEncoding):"",dL("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(pd).join(`
`)),f=Lv(f),f=J_(f,t),f=K_(f,t),d=Lv(d),d=J_(d,t),d=K_(d,t),f=$_(f),d=$_(d),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(J=`#version 300 es
`,I=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+I,q=["#define varying in",t.glslVersion===eu?"":"out highp vec4 pc_fragColor;",t.glslVersion===eu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+q);var Z=J+I+f,G=J+q+d,j=j_(o,35633,Z),ne=j_(o,35632,G);if(o.attachShader(C,j),o.attachShader(C,ne),t.index0AttributeName!==void 0?o.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&o.bindAttribLocation(C,0,"position"),o.linkProgram(C),e.debug.checkShaderErrors){var se=o.getProgramInfoLog(C).trim(),Ee=o.getShaderInfoLog(j).trim(),Be=o.getShaderInfoLog(ne).trim(),ce=!0,oe=!0;if(o.getProgramParameter(C,35714)===!1){ce=!1;var ie=Z_(o,j,"vertex"),Ce=Z_(o,ne,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(C,35715),"gl.getProgramInfoLog",se,ie,Ce)}else se!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",se):(Ee===""||Be==="")&&(oe=!1);oe&&(this.diagnostics={runnable:ce,programLog:se,vertexShader:{log:Ee,prefix:I},fragmentShader:{log:Be,prefix:q}})}o.deleteShader(j),o.deleteShader(ne);var De;this.getUniforms=function(){return De===void 0&&(De=new _c(o,C)),De};var Oe;return this.getAttributes=function(){return Oe===void 0&&(Oe=vL(o,C)),Oe},this.destroy=function(){a.releaseStatesOfProgram(this),o.deleteProgram(C),this.program=void 0},this.name=t.shaderName,this.id=hL++,this.cacheKey=s,this.usedTimes=1,this.program=C,this.vertexShader=j,this.fragmentShader=ne,this}function TL(e,s,t,a,o,c){var f=[],d=a.isWebGL2,m=a.logarithmicDepthBuffer,y=a.floatVertexTextures,w=a.maxVertexUniforms,M=a.vertexTextures,D=a.precision,P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},F=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function C(G){var j=G.skeleton,ne=j.bones;if(y)return 1024;var se=Math.floor((w-20)/4),Ee=Math.min(se,ne.length);return Ee<ne.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+ne.length+" bones. This GPU supports "+Ee+"."),0):Ee}function I(G){var j;return G?G.isTexture?j=G.encoding:G.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),j=G.texture.encoding):j=Wr,j}function q(G,j,ne,se,Ee){var Be=se.fog,ce=G.isMeshStandardMaterial?se.environment:null,oe=s.get(G.envMap||ce),ie=P[G.type],Ce=Ee.isSkinnedMesh?C(Ee):0;G.precision!==null&&(D=a.getMaxPrecision(G.precision),D!==G.precision&&console.warn("THREE.WebGLProgram.getParameters:",G.precision,"not supported, using",D,"instead."));var De,Oe;if(ie){var et=so[ie];De=et.vertexShader,Oe=et.fragmentShader}else De=G.vertexShader,Oe=G.fragmentShader;var gt=e.getRenderTarget(),pt={isWebGL2:d,shaderID:ie,shaderName:G.type,vertexShader:De,fragmentShader:Oe,defines:G.defines,isRawShaderMaterial:G.isRawShaderMaterial===!0,glslVersion:G.glslVersion,precision:D,instancing:Ee.isInstancedMesh===!0,instancingColor:Ee.isInstancedMesh===!0&&Ee.instanceColor!==null,supportsVertexTextures:M,outputEncoding:gt!==null?I(gt.texture):e.outputEncoding,map:!!G.map,mapEncoding:I(G.map),matcap:!!G.matcap,matcapEncoding:I(G.matcap),envMap:!!oe,envMapMode:oe&&oe.mapping,envMapEncoding:I(oe),envMapCubeUV:!!oe&&(oe.mapping===Je||oe.mapping===ct),lightMap:!!G.lightMap,lightMapEncoding:I(G.lightMap),aoMap:!!G.aoMap,emissiveMap:!!G.emissiveMap,emissiveMapEncoding:I(G.emissiveMap),bumpMap:!!G.bumpMap,normalMap:!!G.normalMap,objectSpaceNormalMap:G.normalMapType===jp,tangentSpaceNormalMap:G.normalMapType===vl,clearcoatMap:!!G.clearcoatMap,clearcoatRoughnessMap:!!G.clearcoatRoughnessMap,clearcoatNormalMap:!!G.clearcoatNormalMap,displacementMap:!!G.displacementMap,roughnessMap:!!G.roughnessMap,metalnessMap:!!G.metalnessMap,specularMap:!!G.specularMap,alphaMap:!!G.alphaMap,gradientMap:!!G.gradientMap,sheen:!!G.sheen,transmissionMap:!!G.transmissionMap,combine:G.combine,vertexTangents:G.normalMap&&G.vertexTangents,vertexColors:G.vertexColors,vertexUvs:!!G.map||!!G.bumpMap||!!G.normalMap||!!G.specularMap||!!G.alphaMap||!!G.emissiveMap||!!G.roughnessMap||!!G.metalnessMap||!!G.clearcoatMap||!!G.clearcoatRoughnessMap||!!G.clearcoatNormalMap||!!G.displacementMap||!!G.transmissionMap,uvsVertexOnly:!(!!G.map||!!G.bumpMap||!!G.normalMap||!!G.specularMap||!!G.alphaMap||!!G.emissiveMap||!!G.roughnessMap||!!G.metalnessMap||!!G.clearcoatNormalMap||!!G.transmissionMap)&&!!G.displacementMap,fog:!!Be,useFog:G.fog,fogExp2:Be&&Be.isFogExp2,flatShading:G.flatShading,sizeAttenuation:G.sizeAttenuation,logarithmicDepthBuffer:m,skinning:G.skinning&&Ce>0,maxBones:Ce,useVertexTexture:y,morphTargets:G.morphTargets,morphNormals:G.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:j.directional.length,numPointLights:j.point.length,numSpotLights:j.spot.length,numRectAreaLights:j.rectArea.length,numHemiLights:j.hemi.length,numDirLightShadows:j.directionalShadowMap.length,numPointLightShadows:j.pointShadowMap.length,numSpotLightShadows:j.spotShadowMap.length,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:G.dithering,shadowMapEnabled:e.shadowMap.enabled&&ne.length>0,shadowMapType:e.shadowMap.type,toneMapping:G.toneMapped?e.toneMapping:we,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:G.premultipliedAlpha,alphaTest:G.alphaTest,doubleSided:G.side===R,flipSided:G.side===S,depthPacking:G.depthPacking!==void 0?G.depthPacking:!1,index0AttributeName:G.index0AttributeName,extensionDerivatives:G.extensions&&G.extensions.derivatives,extensionFragDepth:G.extensions&&G.extensions.fragDepth,extensionDrawBuffers:G.extensions&&G.extensions.drawBuffers,extensionShaderTextureLOD:G.extensions&&G.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||t.has("EXT_shader_texture_lod"),customProgramCacheKey:G.customProgramCacheKey()};return pt}function J(G){var j=[];if(G.shaderID?j.push(G.shaderID):(j.push(G.fragmentShader),j.push(G.vertexShader)),G.defines!==void 0)for(var ne in G.defines)j.push(ne),j.push(G.defines[ne]);if(G.isRawShaderMaterial===!1){for(var se=0;se<F.length;se++)j.push(G[F[se]]);j.push(e.outputEncoding),j.push(e.gammaFactor)}return j.push(G.customProgramCacheKey),j.join()}function Z(G){if(--G.usedTimes===0){var j=f.indexOf(G);f[j]=f[f.length-1],f.pop(),G.destroy()}}return{getParameters:q,getProgramCacheKey:J,getUniforms:function(G){var j=P[G.type],ne;if(j){var se=so[j];ne=Wo.clone(se.uniforms)}else ne=G.uniforms;return ne},acquireProgram:function(G,j){for(var ne,se=0,Ee=f.length;se<Ee;se++){var Be=f[se];if(Be.cacheKey===j){ne=Be,++ne.usedTimes;break}}return ne===void 0&&(ne=new SL(e,j,G,o),f.push(ne)),ne},releaseProgram:Z,programs:f}}function EL(){var e=new WeakMap;function s(o){var c=e.get(o);return c===void 0&&(c={},e.set(o,c)),c}function t(o){e.delete(o)}function a(o,c,f){e.get(o)[c]=f}return{get:s,remove:t,update:a,dispose:function(){e=new WeakMap}}}function AL(e,s){return e.groupOrder!==s.groupOrder?e.groupOrder-s.groupOrder:e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.program!==s.program?e.program.id-s.program.id:e.material.id!==s.material.id?e.material.id-s.material.id:e.z!==s.z?e.z-s.z:e.id-s.id}function LL(e,s){return e.groupOrder!==s.groupOrder?e.groupOrder-s.groupOrder:e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.z!==s.z?s.z-e.z:e.id-s.id}function tx(e){var s=[],t=0,a=[],o=[],c={id:-1};function f(m,y,w,M,D,P){var F=s[t],C=e.get(w);return F===void 0?(F={id:m.id,object:m,geometry:y,material:w,program:C.program||c,groupOrder:M,renderOrder:m.renderOrder,z:D,group:P},s[t]=F):(F.id=m.id,F.object=m,F.geometry=y,F.material=w,F.program=C.program||c,F.groupOrder=M,F.renderOrder=m.renderOrder,F.z=D,F.group=P),t++,F}function d(){for(var m=t,y=s.length;m<y;m++){var w=s[m];if(w.id===null)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.program=null,w.group=null}}return{opaque:a,transparent:o,init:function(){t=0,a.length=0,o.length=0},push:function(m,y,w,M,D,P){var F=f(m,y,w,M,D,P);(w.transparent===!0?o:a).push(F)},unshift:function(m,y,w,M,D,P){var F=f(m,y,w,M,D,P);(w.transparent===!0?o:a).unshift(F)},finish:d,sort:function(m,y){a.length>1&&a.sort(m||AL),o.length>1&&o.sort(y||LL)}}}function RL(e){var s=new WeakMap;function t(a,o){var c=s.get(a),f;return c===void 0?(f=new tx(e),s.set(a,new WeakMap),s.get(a).set(o,f)):(f=c.get(o),f===void 0&&(f=new tx(e),c.set(o,f))),f}return{get:t,dispose:function(){s=new WeakMap}}}function CL(){var e={};return{get:function(s){if(e[s.id]!==void 0)return e[s.id];var t;switch(s.type){case"DirectionalLight":t={direction:new ee,color:new Xt};break;case"SpotLight":t={position:new ee,direction:new ee,color:new Xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ee,color:new Xt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ee,skyColor:new Xt,groundColor:new Xt};break;case"RectAreaLight":t={color:new Xt,position:new ee,halfWidth:new ee,halfHeight:new ee};break}return e[s.id]=t,t}}}function PL(){var e={};return{get:function(s){if(e[s.id]!==void 0)return e[s.id];var t;switch(s.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[s.id]=t,t}}}var IL=0;function DL(e,s){return(s.castShadow?1:0)-(e.castShadow?1:0)}function OL(){for(var e=new CL,s=PL(),t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)t.probe.push(new ee);var o=new ee,c=new qn,f=new qn;function d(m,y,w){for(var M=0,D=0,P=0,F=0;F<9;F++)t.probe[F].set(0,0,0);var C=0,I=0,q=0,J=0,Z=0,G=0,j=0,ne=0,se=w.matrixWorldInverse;m.sort(DL);for(var Ee=0,Be=m.length;Ee<Be;Ee++){var ce=m[Ee],oe=ce.color,ie=ce.intensity,Ce=ce.distance,De=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)M+=oe.r*ie,D+=oe.g*ie,P+=oe.b*ie;else if(ce.isLightProbe)for(var Oe=0;Oe<9;Oe++)t.probe[Oe].addScaledVector(ce.sh.coefficients[Oe],ie);else if(ce.isDirectionalLight){var et=e.get(ce);if(et.color.copy(ce.color).multiplyScalar(ce.intensity),et.direction.setFromMatrixPosition(ce.matrixWorld),o.setFromMatrixPosition(ce.target.matrixWorld),et.direction.sub(o),et.direction.transformDirection(se),ce.castShadow){var gt=ce.shadow,pt=s.get(ce);pt.shadowBias=gt.bias,pt.shadowNormalBias=gt.normalBias,pt.shadowRadius=gt.radius,pt.shadowMapSize=gt.mapSize,t.directionalShadow[C]=pt,t.directionalShadowMap[C]=De,t.directionalShadowMatrix[C]=ce.shadow.matrix,G++}t.directional[C]=et,C++}else if(ce.isSpotLight){var lt=e.get(ce);if(lt.position.setFromMatrixPosition(ce.matrixWorld),lt.position.applyMatrix4(se),lt.color.copy(oe).multiplyScalar(ie),lt.distance=Ce,lt.direction.setFromMatrixPosition(ce.matrixWorld),o.setFromMatrixPosition(ce.target.matrixWorld),lt.direction.sub(o),lt.direction.transformDirection(se),lt.coneCos=Math.cos(ce.angle),lt.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),lt.decay=ce.decay,ce.castShadow){var St=ce.shadow,Ht=s.get(ce);Ht.shadowBias=St.bias,Ht.shadowNormalBias=St.normalBias,Ht.shadowRadius=St.radius,Ht.shadowMapSize=St.mapSize,t.spotShadow[q]=Ht,t.spotShadowMap[q]=De,t.spotShadowMatrix[q]=ce.shadow.matrix,ne++}t.spot[q]=lt,q++}else if(ce.isRectAreaLight){var Ut=e.get(ce);Ut.color.copy(oe).multiplyScalar(ie),Ut.position.setFromMatrixPosition(ce.matrixWorld),Ut.position.applyMatrix4(se),f.identity(),c.copy(ce.matrixWorld),c.premultiply(se),f.extractRotation(c),Ut.halfWidth.set(ce.width*.5,0,0),Ut.halfHeight.set(0,ce.height*.5,0),Ut.halfWidth.applyMatrix4(f),Ut.halfHeight.applyMatrix4(f),t.rectArea[J]=Ut,J++}else if(ce.isPointLight){var rn=e.get(ce);if(rn.position.setFromMatrixPosition(ce.matrixWorld),rn.position.applyMatrix4(se),rn.color.copy(ce.color).multiplyScalar(ce.intensity),rn.distance=ce.distance,rn.decay=ce.decay,ce.castShadow){var pn=ce.shadow,dt=s.get(ce);dt.shadowBias=pn.bias,dt.shadowNormalBias=pn.normalBias,dt.shadowRadius=pn.radius,dt.shadowMapSize=pn.mapSize,dt.shadowCameraNear=pn.camera.near,dt.shadowCameraFar=pn.camera.far,t.pointShadow[I]=dt,t.pointShadowMap[I]=De,t.pointShadowMatrix[I]=ce.shadow.matrix,j++}t.point[I]=rn,I++}else if(ce.isHemisphereLight){var Un=e.get(ce);Un.direction.setFromMatrixPosition(ce.matrixWorld),Un.direction.transformDirection(se),Un.direction.normalize(),Un.skyColor.copy(ce.color).multiplyScalar(ie),Un.groundColor.copy(ce.groundColor).multiplyScalar(ie),t.hemi[Z]=Un,Z++}}J>0&&(t.rectAreaLTC1=Wt.LTC_1,t.rectAreaLTC2=Wt.LTC_2),t.ambient[0]=M,t.ambient[1]=D,t.ambient[2]=P;var Dn=t.hash;(Dn.directionalLength!==C||Dn.pointLength!==I||Dn.spotLength!==q||Dn.rectAreaLength!==J||Dn.hemiLength!==Z||Dn.numDirectionalShadows!==G||Dn.numPointShadows!==j||Dn.numSpotShadows!==ne)&&(t.directional.length=C,t.spot.length=q,t.rectArea.length=J,t.point.length=I,t.hemi.length=Z,t.directionalShadow.length=G,t.directionalShadowMap.length=G,t.pointShadow.length=j,t.pointShadowMap.length=j,t.spotShadow.length=ne,t.spotShadowMap.length=ne,t.directionalShadowMatrix.length=G,t.pointShadowMatrix.length=j,t.spotShadowMatrix.length=ne,Dn.directionalLength=C,Dn.pointLength=I,Dn.spotLength=q,Dn.rectAreaLength=J,Dn.hemiLength=Z,Dn.numDirectionalShadows=G,Dn.numPointShadows=j,Dn.numSpotShadows=ne,t.version=IL++)}return{setup:d,state:t}}function nx(){var e=new OL,s=[],t=[];return{init:function(){s.length=0,t.length=0},state:{lightsArray:s,shadowsArray:t,lights:e},setupLights:function(a){e.setup(s,t,a)},pushLight:function(a){s.push(a)},pushShadow:function(a){t.push(a)}}}function NL(){var e=new WeakMap;function s(t,a){var o;return e.has(t)===!1?(o=new nx,e.set(t,new WeakMap),e.get(t).set(a,o)):e.get(t).has(a)===!1?(o=new nx,e.get(t).set(a,o)):o=e.get(t).get(a),o}return{get:s,dispose:function(){e=new WeakMap}}}function xc(e){fn.call(this),this.type="MeshDepthMaterial",this.depthPacking=ed,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}xc.prototype=Object.create(fn.prototype),xc.prototype.constructor=xc,xc.prototype.isMeshDepthMaterial=!0,xc.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function bc(e){fn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ee,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}bc.prototype=Object.create(fn.prototype),bc.prototype.constructor=bc,bc.prototype.isMeshDistanceMaterial=!0,bc.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function ix(e,s,t){var a=new fd,o=new xt,c=new xt,f=new Ti,d=[],m=[],y={},w={0:S,1:A,2:R},M=new $r({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new xt},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),D=M.clone();D.defines.HORIZONAL_PASS=1;var P=new Ae;P.setAttribute("position",new _n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var F=new Bn(P,M),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(j,ne,se){if(C.enabled!==!1&&!(C.autoUpdate===!1&&C.needsUpdate===!1)&&j.length!==0){var Ee=e.getRenderTarget(),Be=e.getActiveCubeFace(),ce=e.getActiveMipmapLevel(),oe=e.state;oe.setBlending(N),oe.buffers.color.setClear(1,1,1,1),oe.buffers.depth.setTest(!0),oe.setScissorTest(!1);for(var ie=0,Ce=j.length;ie<Ce;ie++){var De=j[ie],Oe=De.shadow;if(Oe===void 0){console.warn("THREE.WebGLShadowMap:",De,"has no shadow.");continue}if(!(Oe.autoUpdate===!1&&Oe.needsUpdate===!1)){o.copy(Oe.mapSize);var et=Oe.getFrameExtents();if(o.multiply(et),c.copy(Oe.mapSize),(o.x>t||o.y>t)&&(o.x>t&&(c.x=Math.floor(t/et.x),o.x=c.x*et.x,Oe.mapSize.x=c.x),o.y>t&&(c.y=Math.floor(t/et.y),o.y=c.y*et.y,Oe.mapSize.y=c.y)),Oe.map===null&&!Oe.isPointLightShadow&&this.type===b){var gt={minFilter:Nt,magFilter:Nt,format:re};Oe.map=new sa(o.x,o.y,gt),Oe.map.texture.name=De.name+".shadowMap",Oe.mapPass=new sa(o.x,o.y,gt),Oe.camera.updateProjectionMatrix()}Oe.map===null&&(Oe.map=new sa(o.x,o.y,{minFilter:it,magFilter:it,format:re}),Oe.map.texture.name=De.name+".shadowMap",Oe.camera.updateProjectionMatrix()),e.setRenderTarget(Oe.map),e.clear();for(var pt=Oe.getViewportCount(),lt=0;lt<pt;lt++){var St=Oe.getViewport(lt);f.set(c.x*St.x,c.y*St.y,c.x*St.z,c.y*St.w),oe.viewport(f),Oe.updateMatrices(De,lt),a=Oe.getFrustum(),G(ne,se,Oe.camera,De,this.type)}!Oe.isPointLightShadow&&this.type===b&&I(Oe,se),Oe.needsUpdate=!1}}C.needsUpdate=!1,e.setRenderTarget(Ee,Be,ce)}};function I(j,ne){var se=s.update(F);M.uniforms.shadow_pass.value=j.map.texture,M.uniforms.resolution.value=j.mapSize,M.uniforms.radius.value=j.radius,e.setRenderTarget(j.mapPass),e.clear(),e.renderBufferDirect(ne,null,se,M,F,null),D.uniforms.shadow_pass.value=j.mapPass.texture,D.uniforms.resolution.value=j.mapSize,D.uniforms.radius.value=j.radius,e.setRenderTarget(j.map),e.clear(),e.renderBufferDirect(ne,null,se,D,F,null)}function q(j,ne,se){var Ee=j<<0|ne<<1|se<<2,Be=d[Ee];return Be===void 0&&(Be=new xc({depthPacking:to,morphTargets:j,skinning:ne}),d[Ee]=Be),Be}function J(j,ne,se){var Ee=j<<0|ne<<1|se<<2,Be=m[Ee];return Be===void 0&&(Be=new bc({morphTargets:j,skinning:ne}),m[Ee]=Be),Be}function Z(j,ne,se,Ee,Be,ce,oe){var ie=null,Ce=q,De=j.customDepthMaterial;if(Ee.isPointLight===!0&&(Ce=J,De=j.customDistanceMaterial),De===void 0){var Oe=!1;se.morphTargets===!0&&(Oe=ne.morphAttributes&&ne.morphAttributes.position&&ne.morphAttributes.position.length>0);var et=!1;j.isSkinnedMesh===!0&&(se.skinning===!0?et=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",j));var gt=j.isInstancedMesh===!0;ie=Ce(Oe,et,gt)}else ie=De;if(e.localClippingEnabled&&se.clipShadows===!0&&se.clippingPlanes.length!==0){var pt=ie.uuid,lt=se.uuid,St=y[pt];St===void 0&&(St={},y[pt]=St);var Ht=St[lt];Ht===void 0&&(Ht=ie.clone(),St[lt]=Ht),ie=Ht}return ie.visible=se.visible,ie.wireframe=se.wireframe,oe===b?ie.side=se.shadowSide!==null?se.shadowSide:se.side:ie.side=se.shadowSide!==null?se.shadowSide:w[se.side],ie.clipShadows=se.clipShadows,ie.clippingPlanes=se.clippingPlanes,ie.clipIntersection=se.clipIntersection,ie.wireframeLinewidth=se.wireframeLinewidth,ie.linewidth=se.linewidth,Ee.isPointLight===!0&&ie.isMeshDistanceMaterial===!0&&(ie.referencePosition.setFromMatrixPosition(Ee.matrixWorld),ie.nearDistance=Be,ie.farDistance=ce),ie}function G(j,ne,se,Ee,Be){if(j.visible!==!1){var ce=j.layers.test(ne.layers);if(ce&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&Be===b)&&(!j.frustumCulled||a.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,j.matrixWorld);var oe=s.update(j),ie=j.material;if(Array.isArray(ie))for(var Ce=oe.groups,De=0,Oe=Ce.length;De<Oe;De++){var et=Ce[De],gt=ie[et.materialIndex];if(gt&&gt.visible){var pt=Z(j,oe,gt,Ee,se.near,se.far,Be);e.renderBufferDirect(se,null,oe,pt,j,et)}}else if(ie.visible){var lt=Z(j,oe,ie,Ee,se.near,se.far,Be);e.renderBufferDirect(se,null,oe,lt,j,null)}}for(var St=j.children,Ht=0,Ut=St.length;Ht<Ut;Ht++)G(St[Ht],ne,se,Ee,Be)}}}function FL(e,s,t){var a,o,c=t.isWebGL2,f=new function(){var X=!1,Lt=new Ti,ot=null,Kt=new Ti(0,0,0,0);return{setMask:function(Ct){ot!==Ct&&!X&&(e.colorMask(Ct,Ct,Ct,Ct),ot=Ct)},setLocked:function(Ct){X=Ct},setClear:function(Ct,vn,xn,an,Mn){Mn===!0&&(Ct*=an,vn*=an,xn*=an),Lt.set(Ct,vn,xn,an),Kt.equals(Lt)===!1&&(e.clearColor(Ct,vn,xn,an),Kt.copy(Lt))},reset:function(){X=!1,ot=null,Kt.set(-1,0,0,0)}}},d=new function(){var X=!1,Lt=null,ot=null,Kt=null;return{setTest:function(Ct){Ct?lt(2929):St(2929)},setMask:function(Ct){Lt!==Ct&&!X&&(e.depthMask(Ct),Lt=Ct)},setFunc:function(Ct){if(ot!==Ct){if(Ct)switch(Ct){case nt:e.depthFunc(512);break;case At:e.depthFunc(519);break;case nn:e.depthFunc(513);break;case Yt:e.depthFunc(515);break;case K:e.depthFunc(514);break;case H:e.depthFunc(518);break;case xe:e.depthFunc(516);break;case te:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);ot=Ct}},setLocked:function(Ct){X=Ct},setClear:function(Ct){Kt!==Ct&&(e.clearDepth(Ct),Kt=Ct)},reset:function(){X=!1,Lt=null,ot=null,Kt=null}}},m=new function(){var X=!1,Lt=null,ot=null,Kt=null,Ct=null,vn=null,xn=null,an=null,Mn=null;return{setTest:function(Sn){X||(Sn?lt(2960):St(2960))},setMask:function(Sn){Lt!==Sn&&!X&&(e.stencilMask(Sn),Lt=Sn)},setFunc:function(Sn,Kn,Ei){(ot!==Sn||Kt!==Kn||Ct!==Ei)&&(e.stencilFunc(Sn,Kn,Ei),ot=Sn,Kt=Kn,Ct=Ei)},setOp:function(Sn,Kn,Ei){(vn!==Sn||xn!==Kn||an!==Ei)&&(e.stencilOp(Sn,Kn,Ei),vn=Sn,xn=Kn,an=Ei)},setLocked:function(Sn){X=Sn},setClear:function(Sn){Mn!==Sn&&(e.clearStencil(Sn),Mn=Sn)},reset:function(){X=!1,Lt=null,ot=null,Kt=null,Ct=null,vn=null,xn=null,an=null,Mn=null}}},y={},w=null,M=null,D=null,P=null,F=null,C=null,I=null,q=null,J=null,Z=!1,G=null,j=null,ne=null,se=null,Ee=null,Be=e.getParameter(35661),ce=!1,oe=0,ie=e.getParameter(7938);ie.indexOf("WebGL")!==-1?(oe=parseFloat(/^WebGL\ ([0-9])/.exec(ie)[1]),ce=oe>=1):ie.indexOf("OpenGL ES")!==-1&&(oe=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ie)[1]),ce=oe>=2);var Ce=null,De={},Oe=new Ti,et=new Ti;function gt(X,Lt,ot){var Kt=new Uint8Array(4),Ct=e.createTexture();e.bindTexture(X,Ct),e.texParameteri(X,10241,9728),e.texParameteri(X,10240,9728);for(var vn=0;vn<ot;vn++)e.texImage2D(Lt+vn,0,6408,1,1,0,6408,5121,Kt);return Ct}var pt={};pt[3553]=gt(3553,3553,1),pt[34067]=gt(34067,34069,6),f.setClear(0,0,0,1),d.setClear(1),m.setClear(0),lt(2929),d.setFunc(Yt),Un(!1),Dn(h),lt(2884),dt(N);function lt(X){y[X]!==!0&&(e.enable(X),y[X]=!0)}function St(X){y[X]!==!1&&(e.disable(X),y[X]=!1)}function Ht(X){return w!==X?(e.useProgram(X),w=X,!0):!1}var Ut=(a={},a[ge]=32774,a[ye]=32778,a[$]=32779,a);if(c)Ut[Ie]=32775,Ut[tt]=32776;else{var rn=s.get("EXT_blend_minmax");rn!==null&&(Ut[Ie]=rn.MIN_EXT,Ut[tt]=rn.MAX_EXT)}var pn=(o={},o[qe]=0,o[ft]=1,o[je]=768,o[Ue]=770,o[Tt]=776,o[We]=774,o[Te]=772,o[Ne]=769,o[Le]=771,o[at]=775,o[Ve]=773,o);function dt(X,Lt,ot,Kt,Ct,vn,xn,an){if(X===N){M&&(St(3042),M=!1);return}if(M||(lt(3042),M=!0),X!==pe){if(X!==D||an!==Z){if((P!==ge||I!==ge)&&(e.blendEquation(32774),P=ge,I=ge),an)switch(X){case W:e.blendFuncSeparate(1,771,1,771);break;case V:e.blendFunc(1,1);break;case B:e.blendFuncSeparate(0,0,769,771);break;case O:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}else switch(X){case W:e.blendFuncSeparate(770,771,1,771);break;case V:e.blendFunc(770,1);break;case B:e.blendFunc(0,769);break;case O:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}F=null,C=null,q=null,J=null,D=X,Z=an}return}Ct=Ct||Lt,vn=vn||ot,xn=xn||Kt,(Lt!==P||Ct!==I)&&(e.blendEquationSeparate(Ut[Lt],Ut[Ct]),P=Lt,I=Ct),(ot!==F||Kt!==C||vn!==q||xn!==J)&&(e.blendFuncSeparate(pn[ot],pn[Kt],pn[vn],pn[xn]),F=ot,C=Kt,q=vn,J=xn),D=X,Z=null}function Un(X){G!==X&&(X?e.frontFace(2304):e.frontFace(2305),G=X)}function Dn(X){X!==u?(lt(2884),X!==j&&(X===h?e.cullFace(1029):X===p?e.cullFace(1028):e.cullFace(1032))):St(2884),j=X}function wn(X){X!==ne&&(ce&&e.lineWidth(X),ne=X)}function ci(X,Lt,ot){X?(lt(32823),(se!==Lt||Ee!==ot)&&(e.polygonOffset(Lt,ot),se=Lt,Ee=ot)):St(32823)}function Zn(X){X===void 0&&(X=33984+Be-1),Ce!==X&&(e.activeTexture(X),Ce=X)}function vi(X,Lt){Ce===null&&Zn();var ot=De[Ce];ot===void 0&&(ot={type:void 0,texture:void 0},De[Ce]=ot),(ot.type!==X||ot.texture!==Lt)&&(e.bindTexture(X,Lt||pt[X]),ot.type=X,ot.texture=Lt)}function ri(){var X=De[Ce];X!==void 0&&X.type!==void 0&&(e.bindTexture(X.type,null),X.type=void 0,X.texture=void 0)}function Vi(X){Oe.equals(X)===!1&&(e.scissor(X.x,X.y,X.z,X.w),Oe.copy(X))}function Me(X){et.equals(X)===!1&&(e.viewport(X.x,X.y,X.z,X.w),et.copy(X))}return{buffers:{color:f,depth:d,stencil:m},enable:lt,disable:St,useProgram:Ht,setBlending:dt,setMaterial:function(X,Lt){X.side===R?St(2884):lt(2884);var ot=X.side===S;Lt&&(ot=!ot),Un(ot),X.blending===W&&X.transparent===!1?dt(N):dt(X.blending,X.blendEquation,X.blendSrc,X.blendDst,X.blendEquationAlpha,X.blendSrcAlpha,X.blendDstAlpha,X.premultipliedAlpha),d.setFunc(X.depthFunc),d.setTest(X.depthTest),d.setMask(X.depthWrite),f.setMask(X.colorWrite);var Kt=X.stencilWrite;m.setTest(Kt),Kt&&(m.setMask(X.stencilWriteMask),m.setFunc(X.stencilFunc,X.stencilRef,X.stencilFuncMask),m.setOp(X.stencilFail,X.stencilZFail,X.stencilZPass)),ci(X.polygonOffset,X.polygonOffsetFactor,X.polygonOffsetUnits)},setFlipSided:Un,setCullFace:Dn,setLineWidth:wn,setPolygonOffset:ci,setScissorTest:function(X){X?lt(3089):St(3089)},activeTexture:Zn,bindTexture:vi,unbindTexture:ri,compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},scissor:Vi,viewport:Me,reset:function(){y={},Ce=null,De={},w=null,D=null,G=null,j=null,f.reset(),d.reset(),m.reset()}}}function BL(e,s,t,a,o,c,f){var d,m,y=o.isWebGL2,w=o.maxTextures,M=o.maxCubemapSize,D=o.maxTextureSize,P=o.maxSamples,F=new WeakMap,C,I=!1;try{I=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function q(Me,X){return I?new OffscreenCanvas(Me,X):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function J(Me,X,Lt,ot){var Kt=1;if((Me.width>ot||Me.height>ot)&&(Kt=ot/Math.max(Me.width,Me.height)),Kt<1||X===!0)if(typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Me instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Me instanceof ImageBitmap){var Ct=X?Ln.floorPowerOfTwo:Math.floor,vn=Ct(Kt*Me.width),xn=Ct(Kt*Me.height);C===void 0&&(C=q(vn,xn));var an=Lt?q(vn,xn):C;an.width=vn,an.height=xn;var Mn=an.getContext("2d");return Mn.drawImage(Me,0,0,vn,xn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Me.width+"x"+Me.height+") to ("+vn+"x"+xn+")."),an}else return"data"in Me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Me.width+"x"+Me.height+")."),Me;return Me}function Z(Me){return Ln.isPowerOfTwo(Me.width)&&Ln.isPowerOfTwo(Me.height)}function G(Me){return y?!1:Me.wrapS!==ut||Me.wrapT!==ut||Me.minFilter!==it&&Me.minFilter!==Nt}function j(Me,X){return Me.generateMipmaps&&X&&Me.minFilter!==it&&Me.minFilter!==Nt}function ne(Me,X,Lt,ot){e.generateMipmap(Me);var Kt=a.get(X);Kt.__maxMipLevel=Math.log(Math.max(Lt,ot))*Math.LOG2E}function se(Me,X,Lt){if(y===!1)return X;if(Me!==null){if(e[Me]!==void 0)return e[Me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Me+"'")}var ot=X;return X===6403&&(Lt===5126&&(ot=33326),Lt===5131&&(ot=33325),Lt===5121&&(ot=33321)),X===6407&&(Lt===5126&&(ot=34837),Lt===5131&&(ot=34843),Lt===5121&&(ot=32849)),X===6408&&(Lt===5126&&(ot=34836),Lt===5131&&(ot=34842),Lt===5121&&(ot=32856)),(ot===33325||ot===33326||ot===34842||ot===34836)&&s.get("EXT_color_buffer_float"),ot}function Ee(Me){return Me===it||Me===Rt||Me===mt?9728:9729}function Be(Me){var X=Me.target;X.removeEventListener("dispose",Be),oe(X),X.isVideoTexture&&F.delete(X),f.memory.textures--}function ce(Me){var X=Me.target;X.removeEventListener("dispose",ce),ie(X),f.memory.textures--}function oe(Me){var X=a.get(Me);X.__webglInit!==void 0&&(e.deleteTexture(X.__webglTexture),a.remove(Me))}function ie(Me){var X=a.get(Me),Lt=a.get(Me.texture);if(!!Me){if(Lt.__webglTexture!==void 0&&e.deleteTexture(Lt.__webglTexture),Me.depthTexture&&Me.depthTexture.dispose(),Me.isWebGLCubeRenderTarget)for(var ot=0;ot<6;ot++)e.deleteFramebuffer(X.__webglFramebuffer[ot]),X.__webglDepthbuffer&&e.deleteRenderbuffer(X.__webglDepthbuffer[ot]);else e.deleteFramebuffer(X.__webglFramebuffer),X.__webglDepthbuffer&&e.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&e.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer&&e.deleteRenderbuffer(X.__webglColorRenderbuffer),X.__webglDepthRenderbuffer&&e.deleteRenderbuffer(X.__webglDepthRenderbuffer);a.remove(Me.texture),a.remove(Me)}}var Ce=0;function De(){var Me=Ce;return Me>=w&&console.warn("THREE.WebGLTextures: Trying to use "+Me+" texture units while this GPU supports only "+w),Ce+=1,Me}function Oe(Me,X){var Lt=a.get(Me);if(Me.isVideoTexture&&ci(Me),Me.version>0&&Lt.__version!==Me.version){var ot=Me.image;if(ot===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(ot.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ht(Lt,Me,X);return}}t.activeTexture(33984+X),t.bindTexture(3553,Lt.__webglTexture)}function et(Me,X){var Lt=a.get(Me);if(Me.version>0&&Lt.__version!==Me.version){Ut(Lt,Me,X);return}t.activeTexture(33984+X),t.bindTexture(34067,Lt.__webglTexture)}var gt=(d={},d[Ft]=10497,d[ut]=33071,d[me]=33648,d),pt=(m={},m[it]=9728,m[Rt]=9984,m[mt]=9986,m[Nt]=9729,m[gn]=9985,m[gi]=9987,m);function lt(Me,X,Lt){Lt?(e.texParameteri(Me,10242,gt[X.wrapS]),e.texParameteri(Me,10243,gt[X.wrapT]),(Me===32879||Me===35866)&&e.texParameteri(Me,32882,gt[X.wrapR]),e.texParameteri(Me,10240,pt[X.magFilter]),e.texParameteri(Me,10241,pt[X.minFilter])):(e.texParameteri(Me,10242,33071),e.texParameteri(Me,10243,33071),(Me===32879||Me===35866)&&e.texParameteri(Me,32882,33071),(X.wrapS!==ut||X.wrapT!==ut)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(Me,10240,Ee(X.magFilter)),e.texParameteri(Me,10241,Ee(X.minFilter)),X.minFilter!==it&&X.minFilter!==Nt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var ot=s.get("EXT_texture_filter_anisotropic");if(ot){if(X.type===Ci&&s.get("OES_texture_float_linear")===null||X.type===ns&&(y||s.get("OES_texture_half_float_linear"))===null)return;(X.anisotropy>1||a.get(X).__currentAnisotropy)&&(e.texParameterf(Me,ot.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,o.getMaxAnisotropy())),a.get(X).__currentAnisotropy=X.anisotropy)}}function St(Me,X){Me.__webglInit===void 0&&(Me.__webglInit=!0,X.addEventListener("dispose",Be),Me.__webglTexture=e.createTexture(),f.memory.textures++)}function Ht(Me,X,Lt){var ot=3553;X.isDataTexture2DArray&&(ot=35866),X.isDataTexture3D&&(ot=32879),St(Me,X),t.activeTexture(33984+Lt),t.bindTexture(ot,Me.__webglTexture),e.pixelStorei(37440,X.flipY),e.pixelStorei(37441,X.premultiplyAlpha),e.pixelStorei(3317,X.unpackAlignment);var Kt=G(X)&&Z(X.image)===!1,Ct=J(X.image,Kt,!1,D),vn=Z(Ct)||y,xn=c.convert(X.format),an=c.convert(X.type),Mn=se(X.internalFormat,xn,an);lt(ot,X,vn);var Sn,Kn=X.mipmaps;if(X.isDepthTexture)Mn=6402,y?X.type===Ci?Mn=36012:X.type===ji?Mn=33190:X.type===va?Mn=35056:Mn=33189:X.type===Ci&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),X.format===Bt&&Mn===6402&&X.type!==Ys&&X.type!==ji&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),X.type=Ys,an=c.convert(X.type)),X.format===Cn&&Mn===6402&&(Mn=34041,X.type!==va&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),X.type=va,an=c.convert(X.type))),t.texImage2D(3553,0,Mn,Ct.width,Ct.height,0,xn,an,null);else if(X.isDataTexture)if(Kn.length>0&&vn){for(var Ei=0,Gr=Kn.length;Ei<Gr;Ei++)Sn=Kn[Ei],t.texImage2D(3553,Ei,Mn,Sn.width,Sn.height,0,xn,an,Sn.data);X.generateMipmaps=!1,Me.__maxMipLevel=Kn.length-1}else t.texImage2D(3553,0,Mn,Ct.width,Ct.height,0,xn,an,Ct.data),Me.__maxMipLevel=0;else if(X.isCompressedTexture){for(var Ui=0,Xa=Kn.length;Ui<Xa;Ui++)Sn=Kn[Ui],X.format!==re&&X.format!==is?xn!==null?t.compressedTexImage2D(3553,Ui,Mn,Sn.width,Sn.height,0,Sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,Ui,Mn,Sn.width,Sn.height,0,xn,an,Sn.data);Me.__maxMipLevel=Kn.length-1}else if(X.isDataTexture2DArray)t.texImage3D(35866,0,Mn,Ct.width,Ct.height,Ct.depth,0,xn,an,Ct.data),Me.__maxMipLevel=0;else if(X.isDataTexture3D)t.texImage3D(32879,0,Mn,Ct.width,Ct.height,Ct.depth,0,xn,an,Ct.data),Me.__maxMipLevel=0;else if(Kn.length>0&&vn){for(var bi=0,mo=Kn.length;bi<mo;bi++)Sn=Kn[bi],t.texImage2D(3553,bi,Mn,xn,an,Sn);X.generateMipmaps=!1,Me.__maxMipLevel=Kn.length-1}else t.texImage2D(3553,0,Mn,xn,an,Ct),Me.__maxMipLevel=0;j(X,vn)&&ne(ot,X,Ct.width,Ct.height),Me.__version=X.version,X.onUpdate&&X.onUpdate(X)}function Ut(Me,X,Lt){if(X.image.length===6){St(Me,X),t.activeTexture(33984+Lt),t.bindTexture(34067,Me.__webglTexture),e.pixelStorei(37440,X.flipY);for(var ot=X&&(X.isCompressedTexture||X.image[0].isCompressedTexture),Kt=X.image[0]&&X.image[0].isDataTexture,Ct=[],vn=0;vn<6;vn++)!ot&&!Kt?Ct[vn]=J(X.image[vn],!1,!0,M):Ct[vn]=Kt?X.image[vn].image:X.image[vn];var xn=Ct[0],an=Z(xn)||y,Mn=c.convert(X.format),Sn=c.convert(X.type),Kn=se(X.internalFormat,Mn,Sn);lt(34067,X,an);var Ei;if(ot){for(var Gr=0;Gr<6;Gr++){Ei=Ct[Gr].mipmaps;for(var Ui=0;Ui<Ei.length;Ui++){var Xa=Ei[Ui];X.format!==re&&X.format!==is?Mn!==null?t.compressedTexImage2D(34069+Gr,Ui,Kn,Xa.width,Xa.height,0,Xa.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+Gr,Ui,Kn,Xa.width,Xa.height,0,Mn,Sn,Xa.data)}}Me.__maxMipLevel=Ei.length-1}else{Ei=X.mipmaps;for(var bi=0;bi<6;bi++)if(Kt){t.texImage2D(34069+bi,0,Kn,Ct[bi].width,Ct[bi].height,0,Mn,Sn,Ct[bi].data);for(var mo=0;mo<Ei.length;mo++){var Su=Ei[mo],go=Su.image[bi].image;t.texImage2D(34069+bi,mo+1,Kn,go.width,go.height,0,Mn,Sn,go.data)}}else{t.texImage2D(34069+bi,0,Kn,Mn,Sn,Ct[bi]);for(var Dl=0;Dl<Ei.length;Dl++){var ef=Ei[Dl];t.texImage2D(34069+bi,Dl+1,Kn,Mn,Sn,ef.image[bi])}}Me.__maxMipLevel=Ei.length}j(X,an)&&ne(34067,X,xn.width,xn.height),Me.__version=X.version,X.onUpdate&&X.onUpdate(X)}}function rn(Me,X,Lt,ot){var Kt=c.convert(X.texture.format),Ct=c.convert(X.texture.type),vn=se(X.texture.internalFormat,Kt,Ct);t.texImage2D(ot,0,vn,X.width,X.height,0,Kt,Ct,null),e.bindFramebuffer(36160,Me),e.framebufferTexture2D(36160,Lt,ot,a.get(X.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function pn(Me,X,Lt){if(e.bindRenderbuffer(36161,Me),X.depthBuffer&&!X.stencilBuffer){var ot=33189;if(Lt){var Kt=X.depthTexture;Kt&&Kt.isDepthTexture&&(Kt.type===Ci?ot=36012:Kt.type===ji&&(ot=33190));var Ct=wn(X);e.renderbufferStorageMultisample(36161,Ct,ot,X.width,X.height)}else e.renderbufferStorage(36161,ot,X.width,X.height);e.framebufferRenderbuffer(36160,36096,36161,Me)}else if(X.depthBuffer&&X.stencilBuffer){if(Lt){var vn=wn(X);e.renderbufferStorageMultisample(36161,vn,35056,X.width,X.height)}else e.renderbufferStorage(36161,34041,X.width,X.height);e.framebufferRenderbuffer(36160,33306,36161,Me)}else{var xn=c.convert(X.texture.format),an=c.convert(X.texture.type),Mn=se(X.texture.internalFormat,xn,an);if(Lt){var Sn=wn(X);e.renderbufferStorageMultisample(36161,Sn,Mn,X.width,X.height)}else e.renderbufferStorage(36161,Mn,X.width,X.height)}e.bindRenderbuffer(36161,null)}function dt(Me,X){var Lt=X&&X.isWebGLCubeRenderTarget;if(Lt)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,Me),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!a.get(X.depthTexture).__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),Oe(X.depthTexture,0);var ot=a.get(X.depthTexture).__webglTexture;if(X.depthTexture.format===Bt)e.framebufferTexture2D(36160,36096,3553,ot,0);else if(X.depthTexture.format===Cn)e.framebufferTexture2D(36160,33306,3553,ot,0);else throw new Error("Unknown depthTexture format")}function Un(Me){var X=a.get(Me),Lt=Me.isWebGLCubeRenderTarget===!0;if(Me.depthTexture){if(Lt)throw new Error("target.depthTexture not supported in Cube render targets");dt(X.__webglFramebuffer,Me)}else if(Lt){X.__webglDepthbuffer=[];for(var ot=0;ot<6;ot++)e.bindFramebuffer(36160,X.__webglFramebuffer[ot]),X.__webglDepthbuffer[ot]=e.createRenderbuffer(),pn(X.__webglDepthbuffer[ot],Me,!1)}else e.bindFramebuffer(36160,X.__webglFramebuffer),X.__webglDepthbuffer=e.createRenderbuffer(),pn(X.__webglDepthbuffer,Me,!1);e.bindFramebuffer(36160,null)}function Dn(Me){var X=a.get(Me),Lt=a.get(Me.texture);Me.addEventListener("dispose",ce),Lt.__webglTexture=e.createTexture(),f.memory.textures++;var ot=Me.isWebGLCubeRenderTarget===!0,Kt=Me.isWebGLMultisampleRenderTarget===!0,Ct=Z(Me)||y;if(y&&Me.texture.format===is&&(Me.texture.type===Ci||Me.texture.type===ns)&&(Me.texture.format=re,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),ot){X.__webglFramebuffer=[];for(var vn=0;vn<6;vn++)X.__webglFramebuffer[vn]=e.createFramebuffer()}else if(X.__webglFramebuffer=e.createFramebuffer(),Kt)if(y){X.__webglMultisampledFramebuffer=e.createFramebuffer(),X.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,X.__webglColorRenderbuffer);var xn=c.convert(Me.texture.format),an=c.convert(Me.texture.type),Mn=se(Me.texture.internalFormat,xn,an),Sn=wn(Me);e.renderbufferStorageMultisample(36161,Sn,Mn,Me.width,Me.height),e.bindFramebuffer(36160,X.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,X.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),Me.depthBuffer&&(X.__webglDepthRenderbuffer=e.createRenderbuffer(),pn(X.__webglDepthRenderbuffer,Me,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ot){t.bindTexture(34067,Lt.__webglTexture),lt(34067,Me.texture,Ct);for(var Kn=0;Kn<6;Kn++)rn(X.__webglFramebuffer[Kn],Me,36064,34069+Kn);j(Me.texture,Ct)&&ne(34067,Me.texture,Me.width,Me.height),t.bindTexture(34067,null)}else t.bindTexture(3553,Lt.__webglTexture),lt(3553,Me.texture,Ct),rn(X.__webglFramebuffer,Me,36064,3553),j(Me.texture,Ct)&&ne(3553,Me.texture,Me.width,Me.height),t.bindTexture(3553,null);Me.depthBuffer&&Un(Me)}function wn(Me){return y&&Me.isWebGLMultisampleRenderTarget?Math.min(P,Me.samples):0}function ci(Me){var X=f.render.frame;F.get(Me)!==X&&(F.set(Me,X),Me.update())}var Zn=!1,vi=!1;function ri(Me,X){Me&&Me.isWebGLRenderTarget&&(Zn===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Zn=!0),Me=Me.texture),Oe(Me,X)}function Vi(Me,X){Me&&Me.isWebGLCubeRenderTarget&&(vi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),vi=!0),Me=Me.texture),et(Me,X)}this.allocateTextureUnit=De,this.resetTextureUnits=function(){Ce=0},this.setTexture2D=Oe,this.setTexture2DArray=function(Me,X){var Lt=a.get(Me);if(Me.version>0&&Lt.__version!==Me.version){Ht(Lt,Me,X);return}t.activeTexture(33984+X),t.bindTexture(35866,Lt.__webglTexture)},this.setTexture3D=function(Me,X){var Lt=a.get(Me);if(Me.version>0&&Lt.__version!==Me.version){Ht(Lt,Me,X);return}t.activeTexture(33984+X),t.bindTexture(32879,Lt.__webglTexture)},this.setTextureCube=et,this.setupRenderTarget=Dn,this.updateRenderTargetMipmap=function(Me){var X=Me.texture,Lt=Z(Me)||y;if(j(X,Lt)){var ot=Me.isWebGLCubeRenderTarget?34067:3553,Kt=a.get(X).__webglTexture;t.bindTexture(ot,Kt),ne(ot,X,Me.width,Me.height),t.bindTexture(ot,null)}},this.updateMultisampleRenderTarget=function(Me){if(Me.isWebGLMultisampleRenderTarget)if(y){var X=a.get(Me);e.bindFramebuffer(36008,X.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,X.__webglFramebuffer);var Lt=Me.width,ot=Me.height,Kt=16384;Me.depthBuffer&&(Kt|=256),Me.stencilBuffer&&(Kt|=1024),e.blitFramebuffer(0,0,Lt,ot,0,0,Lt,ot,Kt,9728),e.bindFramebuffer(36160,X.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=ri,this.safeSetTextureCube=Vi}function rx(e,s,t){var a=t.isWebGL2;return{convert:function(o){var c;if(o===Or)return 5121;if(o===ga)return 32819;if(o===bs)return 32820;if(o===mr)return 33635;if(o===er)return 5120;if(o===Vr)return 5122;if(o===Ys)return 5123;if(o===ma)return 5124;if(o===ji)return 5125;if(o===Ci)return 5126;if(o===ns)return a?5131:(c=s.get("OES_texture_half_float"),c!==null?c.HALF_FLOAT_OES:null);if(o===Ea)return 6406;if(o===is)return 6407;if(o===re)return 6408;if(o===$e)return 6409;if(o===Ke)return 6410;if(o===Bt)return 6402;if(o===Cn)return 34041;if(o===In)return 6403;if(o===Yn)return 36244;if(o===An)return 33319;if(o===Yi)return 33320;if(o===Zi)return 36248;if(o===on)return 36249;if(o===oi||o===xr||o===li||o===tr)if(c=s.get("WEBGL_compressed_texture_s3tc"),c!==null){if(o===oi)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===xr)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===li)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===tr)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===cr||o===Zs||o===Lr||o===Js)if(c=s.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(o===cr)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Zs)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Lr)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===Js)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===br)return c=s.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===Ks||o===vh)&&(c=s.get("WEBGL_compressed_texture_etc"),c!==null)){if(o===Ks)return c.COMPRESSED_RGB8_ETC2;if(o===vh)return c.COMPRESSED_RGBA8_ETC2_EAC}if(o===Hf||o===yh||o===kf||o===Vf||o===Up||o===Gp||o===zp||o===Wf||o===Hp||o===kp||o===nc||o===qf||o===Vp||o===Xf||o===ic||o===dl||o===Wp||o===Mi||o===rc||o===_h||o===jf||o===Yf||o===Zf||o===$s||o===qp||o===Jf||o===Yc||o===La)return c=s.get("WEBGL_compressed_texture_astc"),c!==null?o:null;if(o===Aa)return c=s.get("EXT_texture_compression_bptc"),c!==null?o:null;if(o===va)return a?34042:(c=s.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}}}function im(e){Fi.call(this),this.cameras=e||[]}im.prototype=Object.assign(Object.create(Fi.prototype),{constructor:im,isArrayCamera:!0});function wc(){$t.call(this),this.type="Group"}wc.prototype=Object.assign(Object.create($t.prototype),{constructor:wc,isGroup:!0});function md(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(md.prototype,{constructor:md,getHandSpace:function(){if(this._hand===null&&(this._hand=new wc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){var s=new wc;s.matrixAutoUpdate=!1,s.visible=!1,this._hand.joints.push(s),this._hand.add(s)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new wc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new wc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(e,s,t){var a=null,o=null,c=null,f=this._targetRay,d=this._grip,m=this._hand;if(e)if(m&&e.hand){c=!0;for(var y=0;y<=window.XRHand.LITTLE_PHALANX_TIP;y++)if(e.hand[y]){var w=s.getJointPose(e.hand[y],t),M=m.joints[y];w!==null&&(M.matrix.fromArray(w.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.jointRadius=w.radius),M.visible=w!==null;var D=m.joints[window.XRHand.INDEX_PHALANX_TIP],P=m.joints[window.XRHand.THUMB_PHALANX_TIP],F=D.position.distanceTo(P.position),C=.02,I=.005;m.inputState.pinching&&F>C+I?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&F<=C-I&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else f!==null&&(a=s.getPose(e.targetRaySpace,t),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale))),d!==null&&e.gripSpace&&(o=s.getPose(e.gripSpace,t),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale)));return f!==null&&(f.visible=a!==null),d!==null&&(d.visible=o!==null),m!==null&&(m.visible=c!==null),this}});function ax(e,s){var t=this,a=null,o=1,c=null,f="local-floor",d=null,m=[],y=new Map,w=new Fi;w.layers.enable(1),w.viewport=new Ti;var M=new Fi;M.layers.enable(2),M.viewport=new Ti;var D=[w,M],P=new im;P.layers.enable(1),P.layers.enable(2);var F=null,C=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){var ie=m[oe];return ie===void 0&&(ie=new md,m[oe]=ie),ie.getTargetRaySpace()},this.getControllerGrip=function(oe){var ie=m[oe];return ie===void 0&&(ie=new md,m[oe]=ie),ie.getGripSpace()},this.getHand=function(oe){var ie=m[oe];return ie===void 0&&(ie=new md,m[oe]=ie),ie.getHandSpace()};function I(oe){var ie=y.get(oe.inputSource);ie&&ie.dispatchEvent({type:oe.type,data:oe.inputSource})}function q(){y.forEach(function(oe,ie){oe.disconnect(ie)}),y.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),ce.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}function J(oe){c=oe,ce.setContext(a),ce.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(oe){o=oe,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){f=oe,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c},this.getSession=function(){return a},this.setSession=function(oe){if(a=oe,a!==null){a.addEventListener("select",I),a.addEventListener("selectstart",I),a.addEventListener("selectend",I),a.addEventListener("squeeze",I),a.addEventListener("squeezestart",I),a.addEventListener("squeezeend",I),a.addEventListener("end",q);var ie=s.getContextAttributes();ie.xrCompatible!==!0&&s.makeXRCompatible();var Ce={antialias:ie.antialias,alpha:ie.alpha,depth:ie.depth,stencil:ie.stencil,framebufferScaleFactor:o},De=new XRWebGLLayer(a,s,Ce);a.updateRenderState({baseLayer:De}),a.requestReferenceSpace(f).then(J),a.addEventListener("inputsourceschange",Z)}};function Z(oe){for(var ie=a.inputSources,Ce=0;Ce<m.length;Ce++)y.set(ie[Ce],m[Ce]);for(var De=0;De<oe.removed.length;De++){var Oe=oe.removed[De],et=y.get(Oe);et&&(et.dispatchEvent({type:"disconnected",data:Oe}),y.delete(Oe))}for(var gt=0;gt<oe.added.length;gt++){var pt=oe.added[gt],lt=y.get(pt);lt&&lt.dispatchEvent({type:"connected",data:pt})}}var G=new ee,j=new ee;function ne(oe,ie,Ce){G.setFromMatrixPosition(ie.matrixWorld),j.setFromMatrixPosition(Ce.matrixWorld);var De=G.distanceTo(j),Oe=ie.projectionMatrix.elements,et=Ce.projectionMatrix.elements,gt=Oe[14]/(Oe[10]-1),pt=Oe[14]/(Oe[10]+1),lt=(Oe[9]+1)/Oe[5],St=(Oe[9]-1)/Oe[5],Ht=(Oe[8]-1)/Oe[0],Ut=(et[8]+1)/et[0],rn=De/(-Ht+Ut),pn=rn*-Ht;ie.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(pn),oe.translateZ(rn),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.getInverse(oe.matrixWorld);var dt=gt+rn,Un=pt+rn;oe.projectionMatrix.makePerspective(gt*Ht-pn,gt*Ut+(De-pn),lt*pt/Un*dt,St*pt/Un*dt,dt,Un)}function se(oe,ie){ie===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(ie.matrixWorld,oe.matrix),oe.matrixWorldInverse.getInverse(oe.matrixWorld)}this.getCamera=function(oe){P.near=M.near=w.near=oe.near,P.far=M.far=w.far=oe.far,(F!==P.near||C!==P.far)&&(a.updateRenderState({depthNear:P.near,depthFar:P.far}),F=P.near,C=P.far);var ie=oe.parent,Ce=P.cameras;se(P,ie);for(var De=0;De<Ce.length;De++)se(Ce[De],ie);oe.matrixWorld.copy(P.matrixWorld);for(var Oe=oe.children,et=0,gt=Oe.length;et<gt;et++)Oe[et].updateMatrixWorld(!0);return Ce.length===2?ne(P,w,M):P.projectionMatrix.copy(w.projectionMatrix),P};var Ee=null;function Be(oe,ie){if(d=ie.getViewerPose(c),d!==null){var Ce=d.views,De=a.renderState.baseLayer;e.setFramebuffer(De.framebuffer);var Oe=!1;Ce.length!==P.cameras.length&&(P.cameras.length=0,Oe=!0);for(var et=0;et<Ce.length;et++){var gt=Ce[et],pt=De.getViewport(gt),lt=D[et];lt.matrix.fromArray(gt.transform.matrix),lt.projectionMatrix.fromArray(gt.projectionMatrix),lt.viewport.set(pt.x,pt.y,pt.width,pt.height),et===0&&P.matrix.copy(lt.matrix),Oe===!0&&P.cameras.push(lt)}}for(var St=a.inputSources,Ht=0;Ht<m.length;Ht++){var Ut=m[Ht],rn=St[Ht];Ut.update(rn,ie,c)}Ee&&Ee(oe,ie)}var ce=new N_;ce.setAnimationLoop(Be),this.setAnimationLoop=function(oe){Ee=oe},this.dispose=function(){}}Object.assign(ax.prototype,rs.prototype);function UL(e){function s(C,I){C.opacity.value=I.opacity,I.color&&C.diffuse.value.copy(I.color),I.emissive&&C.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap),I.specularMap&&(C.specularMap.value=I.specularMap);var q=e.get(I).envMap;if(q){C.envMap.value=q,C.flipEnvMap.value=q.isCubeTexture&&q._needsFlipEnvMap?-1:1,C.reflectivity.value=I.reflectivity,C.refractionRatio.value=I.refractionRatio;var J=e.get(q).__maxMipLevel;J!==void 0&&(C.maxMipLevel.value=J)}I.lightMap&&(C.lightMap.value=I.lightMap,C.lightMapIntensity.value=I.lightMapIntensity),I.aoMap&&(C.aoMap.value=I.aoMap,C.aoMapIntensity.value=I.aoMapIntensity);var Z;I.map?Z=I.map:I.specularMap?Z=I.specularMap:I.displacementMap?Z=I.displacementMap:I.normalMap?Z=I.normalMap:I.bumpMap?Z=I.bumpMap:I.roughnessMap?Z=I.roughnessMap:I.metalnessMap?Z=I.metalnessMap:I.alphaMap?Z=I.alphaMap:I.emissiveMap?Z=I.emissiveMap:I.clearcoatMap?Z=I.clearcoatMap:I.clearcoatNormalMap?Z=I.clearcoatNormalMap:I.clearcoatRoughnessMap&&(Z=I.clearcoatRoughnessMap),Z!==void 0&&(Z.isWebGLRenderTarget&&(Z=Z.texture),Z.matrixAutoUpdate===!0&&Z.updateMatrix(),C.uvTransform.value.copy(Z.matrix));var G;I.aoMap?G=I.aoMap:I.lightMap&&(G=I.lightMap),G!==void 0&&(G.isWebGLRenderTarget&&(G=G.texture),G.matrixAutoUpdate===!0&&G.updateMatrix(),C.uv2Transform.value.copy(G.matrix))}function t(C,I){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity}function a(C,I){C.dashSize.value=I.dashSize,C.totalSize.value=I.dashSize+I.gapSize,C.scale.value=I.scale}function o(C,I,q,J){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity,C.size.value=I.size*q,C.scale.value=J*.5,I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap);var Z;I.map?Z=I.map:I.alphaMap&&(Z=I.alphaMap),Z!==void 0&&(Z.matrixAutoUpdate===!0&&Z.updateMatrix(),C.uvTransform.value.copy(Z.matrix))}function c(C,I){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity,C.rotation.value=I.rotation,I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap);var q;I.map?q=I.map:I.alphaMap&&(q=I.alphaMap),q!==void 0&&(q.matrixAutoUpdate===!0&&q.updateMatrix(),C.uvTransform.value.copy(q.matrix))}function f(C,I){I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap)}function d(C,I){C.specular.value.copy(I.specular),C.shininess.value=Math.max(I.shininess,1e-4),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function m(C,I){I.gradientMap&&(C.gradientMap.value=I.gradientMap),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function y(C,I){C.roughness.value=I.roughness,C.metalness.value=I.metalness,I.roughnessMap&&(C.roughnessMap.value=I.roughnessMap),I.metalnessMap&&(C.metalnessMap.value=I.metalnessMap),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias);var q=e.get(I).envMap;q&&(C.envMapIntensity.value=I.envMapIntensity)}function w(C,I){y(C,I),C.reflectivity.value=I.reflectivity,C.clearcoat.value=I.clearcoat,C.clearcoatRoughness.value=I.clearcoatRoughness,I.sheen&&C.sheen.value.copy(I.sheen),I.clearcoatMap&&(C.clearcoatMap.value=I.clearcoatMap),I.clearcoatRoughnessMap&&(C.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap),I.clearcoatNormalMap&&(C.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),C.clearcoatNormalMap.value=I.clearcoatNormalMap,I.side===S&&C.clearcoatNormalScale.value.negate()),C.transmission.value=I.transmission,I.transmissionMap&&(C.transmissionMap.value=I.transmissionMap)}function M(C,I){I.matcap&&(C.matcap.value=I.matcap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function D(C,I){I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function P(C,I){I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias),C.referencePosition.value.copy(I.referencePosition),C.nearDistance.value=I.nearDistance,C.farDistance.value=I.farDistance}function F(C,I){I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}return{refreshFogUniforms:function(C,I){C.fogColor.value.copy(I.color),I.isFog?(C.fogNear.value=I.near,C.fogFar.value=I.far):I.isFogExp2&&(C.fogDensity.value=I.density)},refreshMaterialUniforms:function(C,I,q,J){I.isMeshBasicMaterial?s(C,I):I.isMeshLambertMaterial?(s(C,I),f(C,I)):I.isMeshToonMaterial?(s(C,I),m(C,I)):I.isMeshPhongMaterial?(s(C,I),d(C,I)):I.isMeshStandardMaterial?(s(C,I),I.isMeshPhysicalMaterial?w(C,I):y(C,I)):I.isMeshMatcapMaterial?(s(C,I),M(C,I)):I.isMeshDepthMaterial?(s(C,I),D(C,I)):I.isMeshDistanceMaterial?(s(C,I),P(C,I)):I.isMeshNormalMaterial?(s(C,I),F(C,I)):I.isLineBasicMaterial?(t(C,I),I.isLineDashedMaterial&&a(C,I)):I.isPointsMaterial?o(C,I,q,J):I.isSpriteMaterial?c(C,I):I.isShadowMaterial?(C.color.value.copy(I.color),C.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function gd(e){e=e||{};var s=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=e.context!==void 0?e.context:null,a=e.alpha!==void 0?e.alpha:!1,o=e.depth!==void 0?e.depth:!0,c=e.stencil!==void 0?e.stencil:!0,f=e.antialias!==void 0?e.antialias:!1,d=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,m=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,y=e.powerPreference!==void 0?e.powerPreference:"default",w=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,M=null,D=null;this.domElement=s,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Wr,this.physicallyCorrectLights=!1,this.toneMapping=we,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var P=this,F=!1,C=null,I=0,q=0,J=null,Z=null,G=-1,j=null,ne=null,se=new Ti,Ee=new Ti,Be=null,ce=s.width,oe=s.height,ie=1,Ce=null,De=null,Oe=new Ti(0,0,ce,oe),et=new Ti(0,0,ce,oe),gt=!1,pt=new fd,lt=!1,St=!1,Ht=new qn,Ut=new ee,rn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function pn(){return J===null?ie:1}var dt=t;function Un(he,st){for(var Qe=0;Qe<he.length;Qe++){var vt=he[Qe],kt=s.getContext(vt,st);if(kt!==null)return kt}return null}try{if(s.addEventListener("webglcontextlost",Su,!1),s.addEventListener("webglcontextrestored",go,!1),dt===null){var Dn=["webgl2","webgl","experimental-webgl"];if(P.isWebGL1Renderer===!0&&Dn.shift(),dt=Un(Dn,{alpha:a,depth:o,stencil:c,antialias:f,premultipliedAlpha:d,preserveDrawingBuffer:m,powerPreference:y,failIfMajorPerformanceCaveat:w}),dt===null)throw Un(Dn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}dt.getShaderPrecisionFormat===void 0&&(dt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}var wn,ci,Zn,vi,ri,Vi,Me,X,Lt,ot,Kt,Ct,vn,xn,an,Mn,Sn,Kn,Ei,Gr,Ui;function Xa(){wn=new wA(dt),ci=new _A(dt,wn,e),ci.isWebGL2===!1&&(wn.get("WEBGL_depth_texture"),wn.get("OES_texture_float"),wn.get("OES_texture_half_float"),wn.get("OES_texture_half_float_linear"),wn.get("OES_standard_derivatives"),wn.get("OES_element_index_uint"),wn.get("OES_vertex_array_object"),wn.get("ANGLE_instanced_arrays")),wn.get("OES_texture_float_linear"),Gr=new rx(dt,wn,ci),Zn=new FL(dt,wn,ci),Zn.scissor(Ee.copy(et).multiplyScalar(ie).floor()),Zn.viewport(se.copy(Oe).multiplyScalar(ie).floor()),vi=new TA(dt),ri=new EL,Vi=new BL(dt,wn,Zn,ri,ci,Gr,vi),Me=new bA(P),X=new mA(dt,ci),Ui=new vA(dt,wn,X,ci),Lt=new MA(dt,X,vi,Ui),ot=new RA(dt,Lt,X,vi),Sn=new LA(dt),an=new xA(ri),Kt=new TL(P,Me,wn,ci,Ui,an),Ct=new UL(ri),vn=new RL(ri),xn=new NL,Mn=new gA(P,Me,Zn,ot,d),Kn=new yA(dt,wn,vi,ci),Ei=new SA(dt,wn,vi,ci),vi.programs=Kt.programs,P.capabilities=ci,P.extensions=wn,P.properties=ri,P.renderLists=vn,P.state=Zn,P.info=vi}Xa();var bi=new ax(P,dt);this.xr=bi;var mo=new ix(P,ot,ci.maxTextureSize);this.shadowMap=mo,this.getContext=function(){return dt},this.getContextAttributes=function(){return dt.getContextAttributes()},this.forceContextLoss=function(){var he=wn.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){var he=wn.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(he){he!==void 0&&(ie=he,this.setSize(ce,oe,!1))},this.getSize=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),he=new xt),he.set(ce,oe)},this.setSize=function(he,st,Qe){if(bi.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ce=he,oe=st,s.width=Math.floor(he*ie),s.height=Math.floor(st*ie),Qe!==!1&&(s.style.width=he+"px",s.style.height=st+"px"),this.setViewport(0,0,he,st)},this.getDrawingBufferSize=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),he=new xt),he.set(ce*ie,oe*ie).floor()},this.setDrawingBufferSize=function(he,st,Qe){ce=he,oe=st,ie=Qe,s.width=Math.floor(he*Qe),s.height=Math.floor(st*Qe),this.setViewport(0,0,he,st)},this.getCurrentViewport=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),he=new Ti),he.copy(se)},this.getViewport=function(he){return he.copy(Oe)},this.setViewport=function(he,st,Qe,vt){he.isVector4?Oe.set(he.x,he.y,he.z,he.w):Oe.set(he,st,Qe,vt),Zn.viewport(se.copy(Oe).multiplyScalar(ie).floor())},this.getScissor=function(he){return he.copy(et)},this.setScissor=function(he,st,Qe,vt){he.isVector4?et.set(he.x,he.y,he.z,he.w):et.set(he,st,Qe,vt),Zn.scissor(Ee.copy(et).multiplyScalar(ie).floor())},this.getScissorTest=function(){return gt},this.setScissorTest=function(he){Zn.setScissorTest(gt=he)},this.setOpaqueSort=function(he){Ce=he},this.setTransparentSort=function(he){De=he},this.getClearColor=function(){return Mn.getClearColor()},this.setClearColor=function(){Mn.setClearColor.apply(Mn,arguments)},this.getClearAlpha=function(){return Mn.getClearAlpha()},this.setClearAlpha=function(){Mn.setClearAlpha.apply(Mn,arguments)},this.clear=function(he,st,Qe){var vt=0;(he===void 0||he)&&(vt|=16384),(st===void 0||st)&&(vt|=256),(Qe===void 0||Qe)&&(vt|=1024),dt.clear(vt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",Su,!1),s.removeEventListener("webglcontextrestored",go,!1),vn.dispose(),xn.dispose(),ri.dispose(),Me.dispose(),ot.dispose(),Ui.dispose(),bi.dispose(),vo.stop()};function Su(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),F=!0}function go(){console.log("THREE.WebGLRenderer: Context Restored."),F=!1,Xa()}function Dl(he){var st=he.target;st.removeEventListener("dispose",Dl),ef(st)}function ef(he){Tu(he),ri.remove(he)}function Tu(he){var st=ri.get(he).program;st!==void 0&&Kt.releaseProgram(st)}function Gy(he,st){he.render(function(Qe){P.renderBufferImmediate(Qe,st)})}this.renderBufferImmediate=function(he,st){Ui.initAttributes();var Qe=ri.get(he);he.hasPositions&&!Qe.position&&(Qe.position=dt.createBuffer()),he.hasNormals&&!Qe.normal&&(Qe.normal=dt.createBuffer()),he.hasUvs&&!Qe.uv&&(Qe.uv=dt.createBuffer()),he.hasColors&&!Qe.color&&(Qe.color=dt.createBuffer());var vt=st.getAttributes();he.hasPositions&&(dt.bindBuffer(34962,Qe.position),dt.bufferData(34962,he.positionArray,35048),Ui.enableAttribute(vt.position),dt.vertexAttribPointer(vt.position,3,5126,!1,0,0)),he.hasNormals&&(dt.bindBuffer(34962,Qe.normal),dt.bufferData(34962,he.normalArray,35048),Ui.enableAttribute(vt.normal),dt.vertexAttribPointer(vt.normal,3,5126,!1,0,0)),he.hasUvs&&(dt.bindBuffer(34962,Qe.uv),dt.bufferData(34962,he.uvArray,35048),Ui.enableAttribute(vt.uv),dt.vertexAttribPointer(vt.uv,2,5126,!1,0,0)),he.hasColors&&(dt.bindBuffer(34962,Qe.color),dt.bufferData(34962,he.colorArray,35048),Ui.enableAttribute(vt.color),dt.vertexAttribPointer(vt.color,3,5126,!1,0,0)),Ui.disableUnusedAttributes(),dt.drawArrays(4,0,he.count),he.count=0},this.renderBufferDirect=function(he,st,Qe,vt,kt,hi){st===null&&(st=rn);var ai=kt.isMesh&&kt.matrixWorld.determinant()<0,di=nf(he,st,vt,kt);Zn.setMaterial(vt,ai);var Gn=Qe.index,hr=Qe.attributes.position;if(Gn===null){if(hr===void 0||hr.count===0)return}else if(Gn.count===0)return;var fr=1;vt.wireframe===!0&&(Gn=Lt.getWireframeAttribute(Qe),fr=2),(vt.morphTargets||vt.morphNormals)&&Sn.update(kt,Qe,vt,di),Ui.setup(kt,vt,di,Qe,Gn);var Cr,un=Kn;Gn!==null&&(Cr=X.get(Gn),un=Ei,un.setIndex(Cr));var Qr=Gn!==null?Gn.count:hr.count,ea=Qe.drawRange.start*fr,yi=Qe.drawRange.count*fr,zr=hi!==null?hi.start*fr:0,fi=hi!==null?hi.count*fr:1/0,On=Math.max(ea,zr),_i=Math.min(Qr,ea+yi,zr+fi)-1,Qn=Math.max(0,_i-On+1);if(Qn!==0){if(kt.isMesh)vt.wireframe===!0?(Zn.setLineWidth(vt.wireframeLinewidth*pn()),un.setMode(1)):un.setMode(4);else if(kt.isLine){var ui=vt.linewidth;ui===void 0&&(ui=1),Zn.setLineWidth(ui*pn()),kt.isLineSegments?un.setMode(1):kt.isLineLoop?un.setMode(2):un.setMode(3)}else kt.isPoints?un.setMode(0):kt.isSprite&&un.setMode(4);if(kt.isInstancedMesh)un.renderInstances(On,Qn,kt.count);else if(Qe.isInstancedBufferGeometry){var rr=Math.min(Qe.instanceCount,Qe._maxInstanceCount);un.renderInstances(On,Qn,rr)}else un.render(On,Qn)}},this.compile=function(he,st){D=xn.get(he,st),D.init(),he.traverse(function(vt){vt.isLight&&(D.pushLight(vt),vt.castShadow&&D.pushShadow(vt))}),D.setupLights(st);var Qe=new WeakMap;he.traverse(function(vt){var kt=vt.material;if(kt)if(Array.isArray(kt))for(var hi=0;hi<kt.length;hi++){var ai=kt[hi];Qe.has(ai)===!1&&(ja(ai,he,vt),Qe.set(ai))}else Qe.has(kt)===!1&&(ja(kt,he,vt),Qe.set(kt))})};var tf=null;function ig(he){bi.isPresenting||tf&&tf(he)}var vo=new N_;vo.setAnimationLoop(ig),typeof window<"u"&&vo.setContext(window),this.setAnimationLoop=function(he){tf=he,bi.setAnimationLoop(he),he===null?vo.stop():vo.start()},this.render=function(he,st){var Qe,vt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Qe=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),vt=arguments[3]),st!==void 0&&st.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(F!==!0){Ui.resetDefaultState(),G=-1,j=null,he.autoUpdate===!0&&he.updateMatrixWorld(),st.parent===null&&st.updateMatrixWorld(),bi.enabled===!0&&bi.isPresenting===!0&&(st=bi.getCamera(st)),he.isScene===!0&&he.onBeforeRender(P,he,st,Qe||J),D=xn.get(he,st),D.init(),Ht.multiplyMatrices(st.projectionMatrix,st.matrixWorldInverse),pt.setFromProjectionMatrix(Ht),St=this.localClippingEnabled,lt=an.init(this.clippingPlanes,St,st),M=vn.get(he,st),M.init(),Eu(he,st,0,P.sortObjects),M.finish(),P.sortObjects===!0&&M.sort(Ce,De),lt===!0&&an.beginShadows();var kt=D.state.shadowsArray;mo.render(kt,he,st),D.setupLights(st),lt===!0&&an.endShadows(),this.info.autoReset===!0&&this.info.reset(),Qe!==void 0&&this.setRenderTarget(Qe),Mn.render(M,he,st,vt);var hi=M.opaque,ai=M.transparent;hi.length>0&&Ol(hi,he,st),ai.length>0&&Ol(ai,he,st),he.isScene===!0&&he.onAfterRender(P,he,st),J!==null&&(Vi.updateRenderTargetMipmap(J),Vi.updateMultisampleRenderTarget(J)),Zn.buffers.depth.setTest(!0),Zn.buffers.depth.setMask(!0),Zn.buffers.color.setMask(!0),Zn.setPolygonOffset(!1),M=null,D=null}};function Eu(he,st,Qe,vt){if(he.visible!==!1){var kt=he.layers.test(st.layers);if(kt){if(he.isGroup)Qe=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(st);else if(he.isLight)D.pushLight(he),he.castShadow&&D.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||pt.intersectsSprite(he)){vt&&Ut.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Ht);var hi=ot.update(he),ai=he.material;ai.visible&&M.push(he,hi,ai,Qe,Ut.z,null)}}else if(he.isImmediateRenderObject)vt&&Ut.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Ht),M.push(he,null,he.material,Qe,Ut.z,null);else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==vi.render.frame&&(he.skeleton.update(),he.skeleton.frame=vi.render.frame),!he.frustumCulled||pt.intersectsObject(he))){vt&&Ut.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Ht);var di=ot.update(he),Gn=he.material;if(Array.isArray(Gn))for(var hr=di.groups,fr=0,Cr=hr.length;fr<Cr;fr++){var un=hr[fr],Qr=Gn[un.materialIndex];Qr&&Qr.visible&&M.push(he,di,Qr,Qe,Ut.z,un)}else Gn.visible&&M.push(he,di,Gn,Qe,Ut.z,null)}}for(var ea=he.children,yi=0,zr=ea.length;yi<zr;yi++)Eu(ea[yi],st,Qe,vt)}}function Ol(he,st,Qe){for(var vt=st.isScene===!0?st.overrideMaterial:null,kt=0,hi=he.length;kt<hi;kt++){var ai=he[kt],di=ai.object,Gn=ai.geometry,hr=vt===null?ai.material:vt,fr=ai.group;if(Qe.isArrayCamera){ne=Qe;for(var Cr=Qe.cameras,un=0,Qr=Cr.length;un<Qr;un++){var ea=Cr[un];di.layers.test(ea.layers)&&(Zn.viewport(se.copy(ea.viewport)),D.setupLights(ea),Pc(di,st,ea,Gn,hr,fr))}}else ne=null,Pc(di,st,Qe,Gn,hr,fr)}}function Pc(he,st,Qe,vt,kt,hi){if(he.onBeforeRender(P,st,Qe,vt,kt,hi),D=xn.get(st,ne||Qe),he.modelViewMatrix.multiplyMatrices(Qe.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),he.isImmediateRenderObject){var ai=nf(Qe,st,kt,he);Zn.setMaterial(kt),Ui.reset(),Gy(he,ai)}else P.renderBufferDirect(Qe,st,vt,kt,he,hi);he.onAfterRender(P,st,Qe,vt,kt,hi),D=xn.get(st,ne||Qe)}function ja(he,st,Qe){st.isScene!==!0&&(st=rn);var vt=ri.get(he),kt=D.state.lights,hi=D.state.shadowsArray,ai=kt.state.version,di=Kt.getParameters(he,kt.state,hi,st,Qe),Gn=Kt.getProgramCacheKey(di),hr=vt.program,fr=!0;if(hr===void 0)he.addEventListener("dispose",Dl);else if(hr.cacheKey!==Gn)Tu(he);else if(vt.lightsStateVersion!==ai)fr=!1;else if(di.shaderID!==void 0){var Cr=he.isMeshStandardMaterial?st.environment:null;vt.envMap=Me.get(he.envMap||Cr);return}else fr=!1;fr&&(di.uniforms=Kt.getUniforms(he),he.onBeforeCompile(di,P),hr=Kt.acquireProgram(di,Gn),vt.program=hr,vt.uniforms=di.uniforms,vt.outputEncoding=di.outputEncoding);var un=vt.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(vt.numClippingPlanes=an.numPlanes,vt.numIntersection=an.numIntersection,un.clippingPlanes=an.uniform),vt.environment=he.isMeshStandardMaterial?st.environment:null,vt.fog=st.fog,vt.envMap=Me.get(he.envMap||vt.environment),vt.needsLights=Ud(he),vt.lightsStateVersion=ai,vt.needsLights&&(un.ambientLightColor.value=kt.state.ambient,un.lightProbe.value=kt.state.probe,un.directionalLights.value=kt.state.directional,un.directionalLightShadows.value=kt.state.directionalShadow,un.spotLights.value=kt.state.spot,un.spotLightShadows.value=kt.state.spotShadow,un.rectAreaLights.value=kt.state.rectArea,un.ltc_1.value=kt.state.rectAreaLTC1,un.ltc_2.value=kt.state.rectAreaLTC2,un.pointLights.value=kt.state.point,un.pointLightShadows.value=kt.state.pointShadow,un.hemisphereLights.value=kt.state.hemi,un.directionalShadowMap.value=kt.state.directionalShadowMap,un.directionalShadowMatrix.value=kt.state.directionalShadowMatrix,un.spotShadowMap.value=kt.state.spotShadowMap,un.spotShadowMatrix.value=kt.state.spotShadowMatrix,un.pointShadowMap.value=kt.state.pointShadowMap,un.pointShadowMatrix.value=kt.state.pointShadowMatrix);var Qr=vt.program.getUniforms(),ea=_c.seqWithValue(Qr.seq,un);vt.uniformsList=ea}function nf(he,st,Qe,vt){st.isScene!==!0&&(st=rn),Vi.resetTextureUnits();var kt=st.fog,hi=Qe.isMeshStandardMaterial?st.environment:null,ai=J===null?P.outputEncoding:J.texture.encoding,di=Me.get(Qe.envMap||hi),Gn=ri.get(Qe),hr=D.state.lights;if(lt===!0&&(St===!0||he!==j)){var fr=he===j&&Qe.id===G;an.setState(Qe,he,fr)}Qe.version===Gn.__version?(Qe.fog&&Gn.fog!==kt||Gn.environment!==hi||Gn.needsLights&&Gn.lightsStateVersion!==hr.state.version||Gn.numClippingPlanes!==void 0&&(Gn.numClippingPlanes!==an.numPlanes||Gn.numIntersection!==an.numIntersection)||Gn.outputEncoding!==ai||Gn.envMap!==di)&&ja(Qe,st,vt):(ja(Qe,st,vt),Gn.__version=Qe.version);var Cr=!1,un=!1,Qr=!1,ea=Gn.program,yi=ea.getUniforms(),zr=Gn.uniforms;if(Zn.useProgram(ea.program)&&(Cr=!0,un=!0,Qr=!0),Qe.id!==G&&(G=Qe.id,un=!0),Cr||j!==he){if(yi.setValue(dt,"projectionMatrix",he.projectionMatrix),ci.logarithmicDepthBuffer&&yi.setValue(dt,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),j!==he&&(j=he,un=!0,Qr=!0),Qe.isShaderMaterial||Qe.isMeshPhongMaterial||Qe.isMeshToonMaterial||Qe.isMeshStandardMaterial||Qe.envMap){var fi=yi.map.cameraPosition;fi!==void 0&&fi.setValue(dt,Ut.setFromMatrixPosition(he.matrixWorld))}(Qe.isMeshPhongMaterial||Qe.isMeshToonMaterial||Qe.isMeshLambertMaterial||Qe.isMeshBasicMaterial||Qe.isMeshStandardMaterial||Qe.isShaderMaterial)&&yi.setValue(dt,"isOrthographic",he.isOrthographicCamera===!0),(Qe.isMeshPhongMaterial||Qe.isMeshToonMaterial||Qe.isMeshLambertMaterial||Qe.isMeshBasicMaterial||Qe.isMeshStandardMaterial||Qe.isShaderMaterial||Qe.isShadowMaterial||Qe.skinning)&&yi.setValue(dt,"viewMatrix",he.matrixWorldInverse)}if(Qe.skinning){yi.setOptional(dt,vt,"bindMatrix"),yi.setOptional(dt,vt,"bindMatrixInverse");var On=vt.skeleton;if(On){var _i=On.bones;if(ci.floatVertexTextures){if(On.boneTexture===void 0){var Qn=Math.sqrt(_i.length*4);Qn=Ln.ceilPowerOfTwo(Qn),Qn=Math.max(Qn,4);var ui=new Float32Array(Qn*Qn*4);ui.set(On.boneMatrices);var rr=new cu(ui,Qn,Qn,re,Ci);On.boneMatrices=ui,On.boneTexture=rr,On.boneTextureSize=Qn}yi.setValue(dt,"boneTexture",On.boneTexture,Vi),yi.setValue(dt,"boneTextureSize",On.boneTextureSize)}else yi.setOptional(dt,On,"boneMatrices")}}return(un||Gn.receiveShadow!==vt.receiveShadow)&&(Gn.receiveShadow=vt.receiveShadow,yi.setValue(dt,"receiveShadow",vt.receiveShadow)),un&&(yi.setValue(dt,"toneMappingExposure",P.toneMappingExposure),Gn.needsLights&&rg(zr,Qr),kt&&Qe.fog&&Ct.refreshFogUniforms(zr,kt),Ct.refreshMaterialUniforms(zr,Qe,ie,oe),_c.upload(dt,Gn.uniformsList,zr,Vi)),Qe.isShaderMaterial&&Qe.uniformsNeedUpdate===!0&&(_c.upload(dt,Gn.uniformsList,zr,Vi),Qe.uniformsNeedUpdate=!1),Qe.isSpriteMaterial&&yi.setValue(dt,"center",vt.center),yi.setValue(dt,"modelViewMatrix",vt.modelViewMatrix),yi.setValue(dt,"normalMatrix",vt.normalMatrix),yi.setValue(dt,"modelMatrix",vt.matrixWorld),ea}function rg(he,st){he.ambientLightColor.needsUpdate=st,he.lightProbe.needsUpdate=st,he.directionalLights.needsUpdate=st,he.directionalLightShadows.needsUpdate=st,he.pointLights.needsUpdate=st,he.pointLightShadows.needsUpdate=st,he.spotLights.needsUpdate=st,he.spotLightShadows.needsUpdate=st,he.rectAreaLights.needsUpdate=st,he.hemisphereLights.needsUpdate=st}function Ud(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.setFramebuffer=function(he){C!==he&&J===null&&dt.bindFramebuffer(36160,he),C=he},this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return q},this.getRenderList=function(){return M},this.setRenderList=function(he){M=he},this.getRenderState=function(){return D},this.setRenderState=function(he){D=he},this.getRenderTarget=function(){return J},this.setRenderTarget=function(he,st,Qe){st===void 0&&(st=0),Qe===void 0&&(Qe=0),J=he,I=st,q=Qe,he&&ri.get(he).__webglFramebuffer===void 0&&Vi.setupRenderTarget(he);var vt=C,kt=!1;if(he){var hi=ri.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(vt=hi[st],kt=!0):he.isWebGLMultisampleRenderTarget?vt=ri.get(he).__webglMultisampledFramebuffer:vt=hi,se.copy(he.viewport),Ee.copy(he.scissor),Be=he.scissorTest}else se.copy(Oe).multiplyScalar(ie).floor(),Ee.copy(et).multiplyScalar(ie).floor(),Be=gt;if(Z!==vt&&(dt.bindFramebuffer(36160,vt),Z=vt),Zn.viewport(se),Zn.scissor(Ee),Zn.setScissorTest(Be),kt){var ai=ri.get(he.texture);dt.framebufferTexture2D(36160,36064,34069+st,ai.__webglTexture,Qe)}},this.readRenderTargetPixels=function(he,st,Qe,vt,kt,hi,ai){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var di=ri.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&ai!==void 0&&(di=di[ai]),di){var Gn=!1;di!==Z&&(dt.bindFramebuffer(36160,di),Gn=!0);try{var hr=he.texture,fr=hr.format,Cr=hr.type;if(fr!==re&&Gr.convert(fr)!==dt.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Cr!==Or&&Gr.convert(Cr)!==dt.getParameter(35738)&&!(Cr===Ci&&(ci.isWebGL2||wn.get("OES_texture_float")||wn.get("WEBGL_color_buffer_float")))&&!(Cr===ns&&(ci.isWebGL2?wn.get("EXT_color_buffer_float"):wn.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}dt.checkFramebufferStatus(36160)===36053?st>=0&&st<=he.width-vt&&Qe>=0&&Qe<=he.height-kt&&dt.readPixels(st,Qe,vt,kt,Gr.convert(fr),Gr.convert(Cr),hi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Gn&&dt.bindFramebuffer(36160,Z)}}},this.copyFramebufferToTexture=function(he,st,Qe){Qe===void 0&&(Qe=0);var vt=Math.pow(2,-Qe),kt=Math.floor(st.image.width*vt),hi=Math.floor(st.image.height*vt),ai=Gr.convert(st.format);Vi.setTexture2D(st,0),dt.copyTexImage2D(3553,Qe,ai,he.x,he.y,kt,hi,0),Zn.unbindTexture()},this.copyTextureToTexture=function(he,st,Qe,vt){vt===void 0&&(vt=0);var kt=st.image.width,hi=st.image.height,ai=Gr.convert(Qe.format),di=Gr.convert(Qe.type);Vi.setTexture2D(Qe,0),dt.pixelStorei(37440,Qe.flipY),dt.pixelStorei(37441,Qe.premultiplyAlpha),dt.pixelStorei(3317,Qe.unpackAlignment),st.isDataTexture?dt.texSubImage2D(3553,vt,he.x,he.y,kt,hi,ai,di,st.image.data):st.isCompressedTexture?dt.compressedTexSubImage2D(3553,vt,he.x,he.y,st.mipmaps[0].width,st.mipmaps[0].height,ai,st.mipmaps[0].data):dt.texSubImage2D(3553,vt,he.x,he.y,ai,di,st.image),vt===0&&Qe.generateMipmaps&&dt.generateMipmap(3553),Zn.unbindTexture()},this.initTexture=function(he){Vi.setTexture2D(he,0),Zn.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Rv(e){gd.call(this,e)}Rv.prototype=Object.assign(Object.create(gd.prototype),{constructor:Rv,isWebGL1Renderer:!0});var sx=function(){function e(t,a){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new Xt(t),this.density=a!==void 0?a:25e-5}var s=e.prototype;return s.clone=function(){return new e(this.color,this.density)},s.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),ox=function(){function e(t,a,o){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new Xt(t),this.near=a!==void 0?a:1,this.far=o!==void 0?o:1e3}var s=e.prototype;return s.clone=function(){return new e(this.color,this.near,this.far)},s.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),Cv=function(e){en(s,e);function s(){var a=e.call(this)||this;return Object.defineProperty(oc(a),"isScene",{value:!0}),a.type="Scene",a.background=null,a.environment=null,a.fog=null,a.overrideMaterial=null,a.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:oc(a)})),a}var t=s.prototype;return t.copy=function(a,o){return e.prototype.copy.call(this,a,o),a.background!==null&&(this.background=a.background.clone()),a.environment!==null&&(this.environment=a.environment.clone()),a.fog!==null&&(this.fog=a.fog.clone()),a.overrideMaterial!==null&&(this.overrideMaterial=a.overrideMaterial.clone()),this.autoUpdate=a.autoUpdate,this.matrixAutoUpdate=a.matrixAutoUpdate,this},t.toJSON=function(a){var o=e.prototype.toJSON.call(this,a);return this.background!==null&&(o.object.background=this.background.toJSON(a)),this.environment!==null&&(o.object.environment=this.environment.toJSON(a)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},s}($t);function us(e,s){this.array=e,this.stride=s,this.count=e!==void 0?e.length/s:0,this.usage=Qc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ln.generateUUID()}Object.defineProperty(us.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(us.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,s,t){e*=this.stride,t*=s.stride;for(var a=0,o=this.stride;a<o;a++)this.array[e+a]=s.array[t+a];return this},set:function(e,s){return s===void 0&&(s=0),this.array.set(e,s),this},clone:function(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ln.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var s=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),t=new us(s,this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ln.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var uu=new ee;function Mc(e,s,t,a){this.name="",this.data=e,this.itemSize=s,this.offset=t,this.normalized=a===!0}Object.defineProperties(Mc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(Mc.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var s=0,t=this.data.count;s<t;s++)uu.x=this.getX(s),uu.y=this.getY(s),uu.z=this.getZ(s),uu.applyMatrix4(e),this.setXYZ(s,uu.x,uu.y,uu.z);return this},setX:function(e,s){return this.data.array[e*this.data.stride+this.offset]=s,this},setY:function(e,s){return this.data.array[e*this.data.stride+this.offset+1]=s,this},setZ:function(e,s){return this.data.array[e*this.data.stride+this.offset+2]=s,this},setW:function(e,s){return this.data.array[e*this.data.stride+this.offset+3]=s,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,s,t){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this},setXYZ:function(e,s,t,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this.data.array[e+2]=a,this},setXYZW:function(e,s,t,a,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this.data.array[e+2]=a,this.data.array[e+3]=o,this},clone:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var s=[],t=0;t<this.count;t++)for(var a=t*this.data.stride+this.offset,o=0;o<this.itemSize;o++)s.push(this.data.array[a+o]);return new _n(new this.array.constructor(s),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Mc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var s=[],t=0;t<this.count;t++)for(var a=t*this.data.stride+this.offset,o=0;o<this.itemSize;o++)s.push(this.data.array[a+o]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function Sc(e){fn.call(this),this.type="SpriteMaterial",this.color=new Xt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Sc.prototype=Object.create(fn.prototype),Sc.prototype.constructor=Sc,Sc.prototype.isSpriteMaterial=!0,Sc.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Bh,vd=new ee,Uh=new ee,Gh=new ee,zh=new xt,yd=new xt,lx=new qn,rm=new ee,_d=new ee,am=new ee,cx=new xt,Pv=new xt,ux=new xt;function xd(e){if($t.call(this),this.type="Sprite",Bh===void 0){Bh=new Ae;var s=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new us(s,5);Bh.setIndex([0,1,2,0,2,3]),Bh.setAttribute("position",new Mc(t,3,0,!1)),Bh.setAttribute("uv",new Mc(t,2,3,!1))}this.geometry=Bh,this.material=e!==void 0?e:new Sc,this.center=new xt(.5,.5)}xd.prototype=Object.assign(Object.create($t.prototype),{constructor:xd,isSprite:!0,raycast:function(e,s){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Uh.setFromMatrixScale(this.matrixWorld),lx.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Gh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Uh.multiplyScalar(-Gh.z);var t=this.material.rotation,a,o;t!==0&&(o=Math.cos(t),a=Math.sin(t));var c=this.center;sm(rm.set(-.5,-.5,0),Gh,c,Uh,a,o),sm(_d.set(.5,-.5,0),Gh,c,Uh,a,o),sm(am.set(.5,.5,0),Gh,c,Uh,a,o),cx.set(0,0),Pv.set(1,0),ux.set(1,1);var f=e.ray.intersectTriangle(rm,_d,am,!1,vd);if(!(f===null&&(sm(_d.set(-.5,.5,0),Gh,c,Uh,a,o),Pv.set(0,1),f=e.ray.intersectTriangle(rm,am,_d,!1,vd),f===null))){var d=e.ray.origin.distanceTo(vd);d<e.near||d>e.far||s.push({distance:d,point:vd.clone(),uv:ka.getUV(vd,rm,_d,am,cx,Pv,ux,new xt),face:null,object:this})}},copy:function(e){return $t.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}});function sm(e,s,t,a,o,c){zh.subVectors(e,t).addScalar(.5).multiply(a),o!==void 0?(yd.x=c*zh.x-o*zh.y,yd.y=o*zh.x+c*zh.y):yd.copy(zh),e.copy(s),e.x+=yd.x,e.y+=yd.y,e.applyMatrix4(lx)}var om=new ee,hx=new ee;function bd(){$t.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}bd.prototype=Object.assign(Object.create($t.prototype),{constructor:bd,isLOD:!0,copy:function(e){$t.prototype.copy.call(this,e,!1);for(var s=e.levels,t=0,a=s.length;t<a;t++){var o=s[t];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,s){s===void 0&&(s=0),s=Math.abs(s);var t=this.levels,a;for(a=0;a<t.length&&!(s<t[a].distance);a++);return t.splice(a,0,{distance:s,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var s=this.levels;if(s.length>0){var t,a;for(t=1,a=s.length;t<a&&!(e<s[t].distance);t++);return s[t-1].object}return null},raycast:function(e,s){var t=this.levels;if(t.length>0){om.setFromMatrixPosition(this.matrixWorld);var a=e.ray.origin.distanceTo(om);this.getObjectForDistance(a).raycast(e,s)}},update:function(e){var s=this.levels;if(s.length>1){om.setFromMatrixPosition(e.matrixWorld),hx.setFromMatrixPosition(this.matrixWorld);var t=om.distanceTo(hx)/e.zoom;s[0].object.visible=!0;var a,o;for(a=1,o=s.length;a<o&&t>=s[a].distance;a++)s[a-1].object.visible=!1,s[a].object.visible=!0;for(this._currentLevel=a-1;a<o;a++)s[a].object.visible=!1}},toJSON:function(e){var s=$t.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(s.object.autoUpdate=!1),s.object.levels=[];for(var t=this.levels,a=0,o=t.length;a<o;a++){var c=t[a];s.object.levels.push({object:c.object.uuid,distance:c.distance})}return s}});function lm(e,s){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Bn.call(this,e,s),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new qn,this.bindMatrixInverse=new qn}lm.prototype=Object.assign(Object.create(Bn.prototype),{constructor:lm,isSkinnedMesh:!0,copy:function(e){return Bn.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,s){this.skeleton=e,s===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.getInverse(s)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Ti,s=this.geometry.attributes.skinWeight,t=0,a=s.count;t<a;t++){e.x=s.getX(t),e.y=s.getY(t),e.z=s.getZ(t),e.w=s.getW(t);var o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),s.setXYZW(t,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Bn.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){var e=new ee,s=new Ti,t=new Ti,a=new ee,o=new qn;return function(c,f){var d=this.skeleton,m=this.geometry;s.fromBufferAttribute(m.attributes.skinIndex,c),t.fromBufferAttribute(m.attributes.skinWeight,c),e.fromBufferAttribute(m.attributes.position,c).applyMatrix4(this.bindMatrix),f.set(0,0,0);for(var y=0;y<4;y++){var w=t.getComponent(y);if(w!==0){var M=s.getComponent(y);o.multiplyMatrices(d.bones[M].matrixWorld,d.boneInverses[M]),f.addScaledVector(a.copy(e).applyMatrix4(o),w)}}return f.applyMatrix4(this.bindMatrixInverse)}}()});var fx=new qn,GL=new qn;function cm(e,s){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,s===void 0)this.calculateInverses();else if(this.bones.length===s.length)this.boneInverses=s.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var t=0,a=this.bones.length;t<a;t++)this.boneInverses.push(new qn)}}Object.assign(cm.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,s=this.bones.length;e<s;e++){var t=new qn;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(var e=0,s=this.bones.length;e<s;e++){var t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(var a=0,o=this.bones.length;a<o;a++){var c=this.bones[a];c&&(c.parent&&c.parent.isBone?(c.matrix.getInverse(c.parent.matrixWorld),c.matrix.multiply(c.matrixWorld)):c.matrix.copy(c.matrixWorld),c.matrix.decompose(c.position,c.quaternion,c.scale))}},update:function(){for(var e=this.bones,s=this.boneInverses,t=this.boneMatrices,a=this.boneTexture,o=0,c=e.length;o<c;o++){var f=e[o]?e[o].matrixWorld:GL;fx.multiplyMatrices(f,s[o]),fx.toArray(t,o*16)}a!==void 0&&(a.needsUpdate=!0)},clone:function(){return new cm(this.bones,this.boneInverses)},getBoneByName:function(e){for(var s=0,t=this.bones.length;s<t;s++){var a=this.bones[s];if(a.name===e)return a}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function Iv(){$t.call(this),this.type="Bone"}Iv.prototype=Object.assign(Object.create($t.prototype),{constructor:Iv,isBone:!0});var dx=new qn,px=new qn,um=[],wd=new Bn;function hm(e,s,t){Bn.call(this,e,s),this.instanceMatrix=new _n(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}hm.prototype=Object.assign(Object.create(Bn.prototype),{constructor:hm,isInstancedMesh:!0,copy:function(e){return Bn.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},setColorAt:function(e,s){this.instanceColor===null&&(this.instanceColor=new _n(new Float32Array(this.count*3),3)),s.toArray(this.instanceColor.array,e*3)},getMatrixAt:function(e,s){s.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,s){var t=this.matrixWorld,a=this.count;if(wd.geometry=this.geometry,wd.material=this.material,wd.material!==void 0)for(var o=0;o<a;o++){this.getMatrixAt(o,dx),px.multiplyMatrices(t,dx),wd.matrixWorld=px,wd.raycast(e,um);for(var c=0,f=um.length;c<f;c++){var d=um[c];d.instanceId=o,d.object=this,s.push(d)}um.length=0}},setMatrixAt:function(e,s){s.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function ur(e){fn.call(this),this.type="LineBasicMaterial",this.color=new Xt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}ur.prototype=Object.create(fn.prototype),ur.prototype.constructor=ur,ur.prototype.isLineBasicMaterial=!0,ur.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var mx=new ee,gx=new ee,vx=new qn,fm=new ss,dm=new ya;function Rs(e,s,t){t===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),$t.call(this),this.type="Line",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new ur,this.updateMorphTargets()}Rs.prototype=Object.assign(Object.create($t.prototype),{constructor:Rs,isLine:!0,copy:function(e){return $t.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var s=e.attributes.position,t=[0],a=1,o=s.count;a<o;a++)mx.fromBufferAttribute(s,a-1),gx.fromBufferAttribute(s,a),t[a]=t[a-1],t[a]+=mx.distanceTo(gx);e.setAttribute("lineDistance",new x(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var c=e.vertices,f=e.lineDistances;f[0]=0;for(var d=1,m=c.length;d<m;d++)f[d]=f[d-1],f[d]+=c[d-1].distanceTo(c[d])}return this},raycast:function(e,s){var t=this.geometry,a=this.matrixWorld,o=e.params.Line.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),dm.copy(t.boundingSphere),dm.applyMatrix4(a),dm.radius+=o,e.ray.intersectsSphere(dm)!==!1){vx.getInverse(a),fm.copy(e.ray).applyMatrix4(vx);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,d=new ee,m=new ee,y=new ee,w=new ee,M=this.isLineSegments?2:1;if(t.isBufferGeometry){var D=t.index,P=t.attributes,F=P.position;if(D!==null)for(var C=D.array,I=0,q=C.length-1;I<q;I+=M){var J=C[I],Z=C[I+1];d.fromBufferAttribute(F,J),m.fromBufferAttribute(F,Z);var G=fm.distanceSqToSegment(d,m,w,y);if(!(G>f)){w.applyMatrix4(this.matrixWorld);var j=e.ray.origin.distanceTo(w);j<e.near||j>e.far||s.push({distance:j,point:y.clone().applyMatrix4(this.matrixWorld),index:I,face:null,faceIndex:null,object:this})}}else for(var ne=0,se=F.count-1;ne<se;ne+=M){d.fromBufferAttribute(F,ne),m.fromBufferAttribute(F,ne+1);var Ee=fm.distanceSqToSegment(d,m,w,y);if(!(Ee>f)){w.applyMatrix4(this.matrixWorld);var Be=e.ray.origin.distanceTo(w);Be<e.near||Be>e.far||s.push({distance:Be,point:y.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}}else if(t.isGeometry)for(var ce=t.vertices,oe=ce.length,ie=0;ie<oe-1;ie+=M){var Ce=fm.distanceSqToSegment(ce[ie],ce[ie+1],w,y);if(!(Ce>f)){w.applyMatrix4(this.matrixWorld);var De=e.ray.origin.distanceTo(w);De<e.near||De>e.far||s.push({distance:De,point:y.clone().applyMatrix4(this.matrixWorld),index:ie,face:null,faceIndex:null,object:this})}}}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var pm=new ee,mm=new ee;function Ca(e,s){Rs.call(this,e,s),this.type="LineSegments"}Ca.prototype=Object.assign(Object.create(Rs.prototype),{constructor:Ca,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var s=e.attributes.position,t=[],a=0,o=s.count;a<o;a+=2)pm.fromBufferAttribute(s,a),mm.fromBufferAttribute(s,a+1),t[a]=a===0?0:t[a-1],t[a+1]=t[a]+pm.distanceTo(mm);e.setAttribute("lineDistance",new x(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var c=e.vertices,f=e.lineDistances,d=0,m=c.length;d<m;d+=2)pm.copy(c[d]),mm.copy(c[d+1]),f[d]=d===0?0:f[d-1],f[d+1]=f[d]+pm.distanceTo(mm);return this}});function gm(e,s){Rs.call(this,e,s),this.type="LineLoop"}gm.prototype=Object.assign(Object.create(Rs.prototype),{constructor:gm,isLineLoop:!0});function oo(e){fn.call(this),this.type="PointsMaterial",this.color=new Xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}oo.prototype=Object.create(fn.prototype),oo.prototype.constructor=oo,oo.prototype.isPointsMaterial=!0,oo.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var yx=new qn,Dv=new ss,vm=new ya,ym=new ee;function Hh(e,s){$t.call(this),this.type="Points",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new oo,this.updateMorphTargets()}Hh.prototype=Object.assign(Object.create($t.prototype),{constructor:Hh,isPoints:!0,copy:function(e){return $t.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,s){var t=this.geometry,a=this.matrixWorld,o=e.params.Points.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),vm.copy(t.boundingSphere),vm.applyMatrix4(a),vm.radius+=o,e.ray.intersectsSphere(vm)!==!1){yx.getInverse(a),Dv.copy(e.ray).applyMatrix4(yx);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c;if(t.isBufferGeometry){var d=t.index,m=t.attributes,y=m.position;if(d!==null)for(var w=d.array,M=0,D=w.length;M<D;M++){var P=w[M];ym.fromBufferAttribute(y,P),Ov(ym,P,f,a,e,s,this)}else for(var F=0,C=y.count;F<C;F++)ym.fromBufferAttribute(y,F),Ov(ym,F,f,a,e,s,this)}else for(var I=t.vertices,q=0,J=I.length;q<J;q++)Ov(I[q],q,f,a,e,s,this)}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Ov(e,s,t,a,o,c,f){var d=Dv.distanceSqToPoint(e);if(d<t){var m=new ee;Dv.closestPointToPoint(e,m),m.applyMatrix4(a);var y=o.ray.origin.distanceTo(m);if(y<o.near||y>o.far)return;c.push({distance:y,distanceToRay:Math.sqrt(d),point:m,index:s,face:null,object:f})}}function Nv(e,s,t,a,o,c,f,d,m){Si.call(this,e,s,t,a,o,c,f,d,m),this.format=f!==void 0?f:is,this.minFilter=c!==void 0?c:Nt,this.magFilter=o!==void 0?o:Nt,this.generateMipmaps=!1;var y=this;function w(){y.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}Nv.prototype=Object.assign(Object.create(Si.prototype),{constructor:Nv,isVideoTexture:!0,update:function(){var e=this.image,s="requestVideoFrameCallback"in e;s===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function kh(e,s,t,a,o,c,f,d,m,y,w,M){Si.call(this,null,c,f,d,m,y,a,o,w,M),this.image={width:s,height:t},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}kh.prototype=Object.create(Si.prototype),kh.prototype.constructor=kh,kh.prototype.isCompressedTexture=!0;function Md(e,s,t,a,o,c,f,d,m){Si.call(this,e,s,t,a,o,c,f,d,m),this.needsUpdate=!0}Md.prototype=Object.create(Si.prototype),Md.prototype.constructor=Md,Md.prototype.isCanvasTexture=!0;function Sd(e,s,t,a,o,c,f,d,m,y){if(y=y!==void 0?y:Bt,y!==Bt&&y!==Cn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&y===Bt&&(t=Ys),t===void 0&&y===Cn&&(t=va),Si.call(this,null,a,o,c,f,d,y,t,m),this.image={width:e,height:s},this.magFilter=f!==void 0?f:it,this.minFilter=d!==void 0?d:it,this.flipY=!1,this.generateMipmaps=!1}Sd.prototype=Object.create(Si.prototype),Sd.prototype.constructor=Sd,Sd.prototype.isDepthTexture=!0;var zL=0,Xo=new qn,Fv=new $t,_m=new ee;function Bi(){Object.defineProperty(this,"id",{value:zL+=2}),this.uuid=Ln.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Bi.prototype=Object.assign(Object.create(rs.prototype),{constructor:Bi,isGeometry:!0,applyMatrix4:function(e){for(var s=new aa().getNormalMatrix(e),t=0,a=this.vertices.length;t<a;t++){var o=this.vertices[t];o.applyMatrix4(e)}for(var c=0,f=this.faces.length;c<f;c++){var d=this.faces[c];d.normal.applyMatrix3(s).normalize();for(var m=0,y=d.vertexNormals.length;m<y;m++)d.vertexNormals[m].applyMatrix3(s).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Xo.makeRotationX(e),this.applyMatrix4(Xo),this},rotateY:function(e){return Xo.makeRotationY(e),this.applyMatrix4(Xo),this},rotateZ:function(e){return Xo.makeRotationZ(e),this.applyMatrix4(Xo),this},translate:function(e,s,t){return Xo.makeTranslation(e,s,t),this.applyMatrix4(Xo),this},scale:function(e,s,t){return Xo.makeScale(e,s,t),this.applyMatrix4(Xo),this},lookAt:function(e){return Fv.lookAt(e),Fv.updateMatrix(),this.applyMatrix4(Fv.matrix),this},fromBufferGeometry:function(e){var s=this,t=e.index!==null?e.index:void 0,a=e.attributes;if(a.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var o=a.position,c=a.normal,f=a.color,d=a.uv,m=a.uv2;m!==void 0&&(this.faceVertexUvs[1]=[]);for(var y=0;y<o.count;y++)s.vertices.push(new ee().fromBufferAttribute(o,y)),f!==void 0&&s.colors.push(new Xt().fromBufferAttribute(f,y));function w(Z,G,j,ne){var se=f===void 0?[]:[s.colors[Z].clone(),s.colors[G].clone(),s.colors[j].clone()],Ee=c===void 0?[]:[new ee().fromBufferAttribute(c,Z),new ee().fromBufferAttribute(c,G),new ee().fromBufferAttribute(c,j)],Be=new ou(Z,G,j,Ee,se,ne);s.faces.push(Be),d!==void 0&&s.faceVertexUvs[0].push([new xt().fromBufferAttribute(d,Z),new xt().fromBufferAttribute(d,G),new xt().fromBufferAttribute(d,j)]),m!==void 0&&s.faceVertexUvs[1].push([new xt().fromBufferAttribute(m,Z),new xt().fromBufferAttribute(m,G),new xt().fromBufferAttribute(m,j)])}var M=e.groups;if(M.length>0)for(var D=0;D<M.length;D++)for(var P=M[D],F=P.start,C=P.count,I=F;I<F+C;I+=3)t!==void 0?w(t.getX(I),t.getX(I+1),t.getX(I+2),P.materialIndex):w(I,I+1,I+2,P.materialIndex);else if(t!==void 0)for(var q=0;q<t.count;q+=3)w(t.getX(q),t.getX(q+1),t.getX(q+2));else for(var J=0;J<o.count;J+=3)w(J,J+1,J+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_m).negate(),this.translate(_m.x,_m.y,_m.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,s=this.boundingSphere.radius,t=s===0?1:1/s,a=new qn;return a.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix4(a),this},computeFaceNormals:function(){for(var e=new ee,s=new ee,t=0,a=this.faces.length;t<a;t++){var o=this.faces[t],c=this.vertices[o.a],f=this.vertices[o.b],d=this.vertices[o.c];e.subVectors(d,f),s.subVectors(c,f),e.cross(s),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);for(var s=new Array(this.vertices.length),t=0,a=this.vertices.length;t<a;t++)s[t]=new ee;if(e)for(var o=new ee,c=new ee,f=0,d=this.faces.length;f<d;f++){var m=this.faces[f],y=this.vertices[m.a],w=this.vertices[m.b],M=this.vertices[m.c];o.subVectors(M,w),c.subVectors(y,w),o.cross(c),s[m.a].add(o),s[m.b].add(o),s[m.c].add(o)}else{this.computeFaceNormals();for(var D=0,P=this.faces.length;D<P;D++){var F=this.faces[D];s[F.a].add(F.normal),s[F.b].add(F.normal),s[F.c].add(F.normal)}}for(var C=0,I=this.vertices.length;C<I;C++)s[C].normalize();for(var q=0,J=this.faces.length;q<J;q++){var Z=this.faces[q],G=Z.vertexNormals;G.length===3?(G[0].copy(s[Z.a]),G[1].copy(s[Z.b]),G[2].copy(s[Z.c])):(G[0]=s[Z.a].clone(),G[1]=s[Z.b].clone(),G[2]=s[Z.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var e=0,s=this.faces.length;e<s;e++){var t=this.faces[e],a=t.vertexNormals;a.length===3?(a[0].copy(t.normal),a[1].copy(t.normal),a[2].copy(t.normal)):(a[0]=t.normal.clone(),a[1]=t.normal.clone(),a[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e=0,s=this.faces.length;e<s;e++){var t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(var a=0,o=t.vertexNormals.length;a<o;a++)t.__originalVertexNormals[a]?t.__originalVertexNormals[a].copy(t.vertexNormals[a]):t.__originalVertexNormals[a]=t.vertexNormals[a].clone()}var c=new Bi;c.faces=this.faces;for(var f=0,d=this.morphTargets.length;f<d;f++){if(!this.morphNormals[f]){this.morphNormals[f]={},this.morphNormals[f].faceNormals=[],this.morphNormals[f].vertexNormals=[];for(var m=this.morphNormals[f].faceNormals,y=this.morphNormals[f].vertexNormals,w=0,M=this.faces.length;w<M;w++){var D=new ee,P={a:new ee,b:new ee,c:new ee};m.push(D),y.push(P)}}var F=this.morphNormals[f];c.vertices=this.morphTargets[f].vertices,c.computeFaceNormals(),c.computeVertexNormals();for(var C=0,I=this.faces.length;C<I;C++){var q=this.faces[C],J=F.faceNormals[C],Z=F.vertexNormals[C];J.copy(q.normal),Z.a.copy(q.vertexNormals[0]),Z.b.copy(q.vertexNormals[1]),Z.c.copy(q.vertexNormals[2])}}for(var G=0,j=this.faces.length;G<j;G++){var ne=this.faces[G];ne.normal=ne.__originalFaceNormal,ne.vertexNormals=ne.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new ws),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ya),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,s,t){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var a,o=this.vertices.length,c=this.vertices,f=e.vertices,d=this.faces,m=e.faces,y=this.colors,w=e.colors;t===void 0&&(t=0),s!==void 0&&(a=new aa().getNormalMatrix(s));for(var M=0,D=f.length;M<D;M++){var P=f[M],F=P.clone();s!==void 0&&F.applyMatrix4(s),c.push(F)}for(var C=0,I=w.length;C<I;C++)y.push(w[C].clone());for(var q=0,J=m.length;q<J;q++){var Z=m[q],G=void 0,j=void 0,ne=Z.vertexNormals,se=Z.vertexColors,Ee=new ou(Z.a+o,Z.b+o,Z.c+o);Ee.normal.copy(Z.normal),a!==void 0&&Ee.normal.applyMatrix3(a).normalize();for(var Be=0,ce=ne.length;Be<ce;Be++)G=ne[Be].clone(),a!==void 0&&G.applyMatrix3(a).normalize(),Ee.vertexNormals.push(G);Ee.color.copy(Z.color);for(var oe=0,ie=se.length;oe<ie;oe++)j=se[oe],Ee.vertexColors.push(j.clone());Ee.materialIndex=Z.materialIndex+t,d.push(Ee)}for(var Ce=0,De=e.faceVertexUvs.length;Ce<De;Ce++){var Oe=e.faceVertexUvs[Ce];this.faceVertexUvs[Ce]===void 0&&(this.faceVertexUvs[Ce]=[]);for(var et=0,gt=Oe.length;et<gt;et++){for(var pt=Oe[et],lt=[],St=0,Ht=pt.length;St<Ht;St++)lt.push(pt[St].clone());this.faceVertexUvs[Ce].push(lt)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){for(var e={},s=[],t=[],a=Math.pow(10,4),o=0,c=this.vertices.length;o<c;o++){var f=this.vertices[o],d=Math.round(f.x*a)+"_"+Math.round(f.y*a)+"_"+Math.round(f.z*a);e[d]===void 0?(e[d]=o,s.push(this.vertices[o]),t[o]=s.length-1):t[o]=t[e[d]]}for(var m=[],y=0,w=this.faces.length;y<w;y++){var M=this.faces[y];M.a=t[M.a],M.b=t[M.b],M.c=t[M.c];for(var D=[M.a,M.b,M.c],P=0;P<3;P++)if(D[P]===D[(P+1)%3]){m.push(y);break}}for(var F=m.length-1;F>=0;F--){var C=m[F];this.faces.splice(C,1);for(var I=0,q=this.faceVertexUvs.length;I<q;I++)this.faceVertexUvs[I].splice(C,1)}var J=this.vertices.length-s.length;return this.vertices=s,J},setFromPoints:function(e){this.vertices=[];for(var s=0,t=e.length;s<t;s++){var a=e[s];this.vertices.push(new ee(a.x,a.y,a.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,s=e.length,t=0;t<s;t++)e[t]._id=t;e.sort(function(y,w){return y.materialIndex-w.materialIndex});var a=this.faceVertexUvs[0],o=this.faceVertexUvs[1],c,f;a&&a.length===s&&(c=[]),o&&o.length===s&&(f=[]);for(var d=0;d<s;d++){var m=e[d]._id;c&&c.push(a[m]),f&&f.push(o[m])}c&&(this.faceVertexUvs[0]=c),f&&(this.faceVertexUvs[1]=f)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var s=this.parameters;for(var t in s)s[t]!==void 0&&(e[t]=s[t]);return e}for(var a=[],o=0;o<this.vertices.length;o++){var c=this.vertices[o];a.push(c.x,c.y,c.z)}for(var f=[],d=[],m={},y=[],w={},M=[],D={},P=0;P<this.faces.length;P++){var F=this.faces[P],C=this.faceVertexUvs[0][P]!==void 0,I=F.normal.length()>0,q=F.vertexNormals.length>0,J=F.color.r!==1||F.color.g!==1||F.color.b!==1,Z=F.vertexColors.length>0,G=0;if(G=Ee(G,0,0),G=Ee(G,1,!0),G=Ee(G,2,!1),G=Ee(G,3,C),G=Ee(G,4,I),G=Ee(G,5,q),G=Ee(G,6,J),G=Ee(G,7,Z),f.push(G),f.push(F.a,F.b,F.c),f.push(F.materialIndex),C){var j=this.faceVertexUvs[0][P];f.push(oe(j[0]),oe(j[1]),oe(j[2]))}if(I&&f.push(Be(F.normal)),q){var ne=F.vertexNormals;f.push(Be(ne[0]),Be(ne[1]),Be(ne[2]))}if(J&&f.push(ce(F.color)),Z){var se=F.vertexColors;f.push(ce(se[0]),ce(se[1]),ce(se[2]))}}function Ee(ie,Ce,De){return De?ie|1<<Ce:ie&~(1<<Ce)}function Be(ie){var Ce=ie.x.toString()+ie.y.toString()+ie.z.toString();return m[Ce]!==void 0||(m[Ce]=d.length/3,d.push(ie.x,ie.y,ie.z)),m[Ce]}function ce(ie){var Ce=ie.r.toString()+ie.g.toString()+ie.b.toString();return w[Ce]!==void 0||(w[Ce]=y.length,y.push(ie.getHex())),w[Ce]}function oe(ie){var Ce=ie.x.toString()+ie.y.toString();return D[Ce]!==void 0||(D[Ce]=M.length/2,M.push(ie.x,ie.y)),D[Ce]}return e.data={},e.data.vertices=a,e.data.normals=d,y.length>0&&(e.data.colors=y),M.length>0&&(e.data.uvs=[M]),e.data.faces=f,e},clone:function(){return new Bi().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var s=e.vertices,t=0,a=s.length;t<a;t++)this.vertices.push(s[t].clone());for(var o=e.colors,c=0,f=o.length;c<f;c++)this.colors.push(o[c].clone());for(var d=e.faces,m=0,y=d.length;m<y;m++)this.faces.push(d[m].clone());for(var w=0,M=e.faceVertexUvs.length;w<M;w++){var D=e.faceVertexUvs[w];this.faceVertexUvs[w]===void 0&&(this.faceVertexUvs[w]=[]);for(var P=0,F=D.length;P<F;P++){for(var C=D[P],I=[],q=0,J=C.length;q<J;q++){var Z=C[q];I.push(Z.clone())}this.faceVertexUvs[w].push(I)}}for(var G=e.morphTargets,j=0,ne=G.length;j<ne;j++){var se={};if(se.name=G[j].name,G[j].vertices!==void 0){se.vertices=[];for(var Ee=0,Be=G[j].vertices.length;Ee<Be;Ee++)se.vertices.push(G[j].vertices[Ee].clone())}if(G[j].normals!==void 0){se.normals=[];for(var ce=0,oe=G[j].normals.length;ce<oe;ce++)se.normals.push(G[j].normals[ce].clone())}this.morphTargets.push(se)}for(var ie=e.morphNormals,Ce=0,De=ie.length;Ce<De;Ce++){var Oe={};if(ie[Ce].vertexNormals!==void 0){Oe.vertexNormals=[];for(var et=0,gt=ie[Ce].vertexNormals.length;et<gt;et++){var pt=ie[Ce].vertexNormals[et],lt={};lt.a=pt.a.clone(),lt.b=pt.b.clone(),lt.c=pt.c.clone(),Oe.vertexNormals.push(lt)}}if(ie[Ce].faceNormals!==void 0){Oe.faceNormals=[];for(var St=0,Ht=ie[Ce].faceNormals.length;St<Ht;St++)Oe.faceNormals.push(ie[Ce].faceNormals[St].clone())}this.morphNormals.push(Oe)}for(var Ut=e.skinWeights,rn=0,pn=Ut.length;rn<pn;rn++)this.skinWeights.push(Ut[rn].clone());for(var dt=e.skinIndices,Un=0,Dn=dt.length;Un<Dn;Un++)this.skinIndices.push(dt[Un].clone());for(var wn=e.lineDistances,ci=0,Zn=wn.length;ci<Zn;ci++)this.lineDistances.push(wn[ci]);var vi=e.boundingBox;vi!==null&&(this.boundingBox=vi.clone());var ri=e.boundingSphere;return ri!==null&&(this.boundingSphere=ri.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Bv=function(e){en(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;return m.type="BoxGeometry",m.parameters={width:t,height:a,depth:o,widthSegments:c,heightSegments:f,depthSegments:d},m.fromBufferGeometry(new ls(t,a,o,c,f,d)),m.mergeVertices(),m}return s}(Bi),Uv=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="CircleBufferGeometry",f.parameters={radius:t,segments:a,thetaStart:o,thetaLength:c},t=t||1,a=a!==void 0?Math.max(3,a):8,o=o!==void 0?o:0,c=c!==void 0?c:Math.PI*2;var d=[],m=[],y=[],w=[],M=new ee,D=new xt;m.push(0,0,0),y.push(0,0,1),w.push(.5,.5);for(var P=0,F=3;P<=a;P++,F+=3){var C=o+P/a*c;M.x=t*Math.cos(C),M.y=t*Math.sin(C),m.push(M.x,M.y,M.z),y.push(0,0,1),D.x=(m[F]/t+1)/2,D.y=(m[F+1]/t+1)/2,w.push(D.x,D.y)}for(var I=1;I<=a;I++)d.push(I,I+1,0);return f.setIndex(d),f.setAttribute("position",new x(m,3)),f.setAttribute("normal",new x(y,3)),f.setAttribute("uv",new x(w,2)),f}return s}(Ae),_x=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="CircleGeometry",f.parameters={radius:t,segments:a,thetaStart:o,thetaLength:c},f.fromBufferGeometry(new Uv(t,a,o,c)),f.mergeVertices(),f}return s}(Bi),Td=function(e){en(s,e);function s(t,a,o,c,f,d,m,y){var w=e.call(this)||this;w.type="CylinderBufferGeometry",w.parameters={radiusTop:t,radiusBottom:a,height:o,radialSegments:c,heightSegments:f,openEnded:d,thetaStart:m,thetaLength:y};var M=oc(w);t=t!==void 0?t:1,a=a!==void 0?a:1,o=o||1,c=Math.floor(c)||8,f=Math.floor(f)||1,d=d!==void 0?d:!1,m=m!==void 0?m:0,y=y!==void 0?y:Math.PI*2;var D=[],P=[],F=[],C=[],I=0,q=[],J=o/2,Z=0;G(),d===!1&&(t>0&&j(!0),a>0&&j(!1)),w.setIndex(D),w.setAttribute("position",new x(P,3)),w.setAttribute("normal",new x(F,3)),w.setAttribute("uv",new x(C,2));function G(){for(var ne=new ee,se=new ee,Ee=0,Be=(a-t)/o,ce=0;ce<=f;ce++){for(var oe=[],ie=ce/f,Ce=ie*(a-t)+t,De=0;De<=c;De++){var Oe=De/c,et=Oe*y+m,gt=Math.sin(et),pt=Math.cos(et);se.x=Ce*gt,se.y=-ie*o+J,se.z=Ce*pt,P.push(se.x,se.y,se.z),ne.set(gt,Be,pt).normalize(),F.push(ne.x,ne.y,ne.z),C.push(Oe,1-ie),oe.push(I++)}q.push(oe)}for(var lt=0;lt<c;lt++)for(var St=0;St<f;St++){var Ht=q[St][lt],Ut=q[St+1][lt],rn=q[St+1][lt+1],pn=q[St][lt+1];D.push(Ht,Ut,pn),D.push(Ut,rn,pn),Ee+=6}M.addGroup(Z,Ee,0),Z+=Ee}function j(ne){for(var se=I,Ee=new xt,Be=new ee,ce=0,oe=ne===!0?t:a,ie=ne===!0?1:-1,Ce=1;Ce<=c;Ce++)P.push(0,J*ie,0),F.push(0,ie,0),C.push(.5,.5),I++;for(var De=I,Oe=0;Oe<=c;Oe++){var et=Oe/c,gt=et*y+m,pt=Math.cos(gt),lt=Math.sin(gt);Be.x=oe*lt,Be.y=J*ie,Be.z=oe*pt,P.push(Be.x,Be.y,Be.z),F.push(0,ie,0),Ee.x=pt*.5+.5,Ee.y=lt*.5*ie+.5,C.push(Ee.x,Ee.y),I++}for(var St=0;St<c;St++){var Ht=se+St,Ut=De+St;ne===!0?D.push(Ut,Ut+1,Ht):D.push(Ut+1,Ut,Ht),ce+=3}M.addGroup(Z,ce,ne===!0?1:2),Z+=ce}return w}return s}(Ae),Gv=function(e){en(s,e);function s(t,a,o,c,f,d,m,y){var w=e.call(this)||this;return w.type="CylinderGeometry",w.parameters={radiusTop:t,radiusBottom:a,height:o,radialSegments:c,heightSegments:f,openEnded:d,thetaStart:m,thetaLength:y},w.fromBufferGeometry(new Td(t,a,o,c,f,d,m,y)),w.mergeVertices(),w}return s}(Bi),xx=function(e){en(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this,0,t,a,o,c,f,d,m)||this;return y.type="ConeGeometry",y.parameters={radius:t,height:a,radialSegments:o,heightSegments:c,openEnded:f,thetaStart:d,thetaLength:m},y}return s}(Gv),bx=function(e){en(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this,0,t,a,o,c,f,d,m)||this;return y.type="ConeBufferGeometry",y.parameters={radius:t,height:a,radialSegments:o,heightSegments:c,openEnded:f,thetaStart:d,thetaLength:m},y}return s}(Td),hu=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="PolyhedronBufferGeometry",f.parameters={vertices:t,indices:a,radius:o,detail:c},o=o||1,c=c||0;var d=[],m=[];y(c),M(o),D(),f.setAttribute("position",new x(d,3)),f.setAttribute("normal",new x(d.slice(),3)),f.setAttribute("uv",new x(m,2)),c===0?f.computeVertexNormals():f.normalizeNormals();function y(G){for(var j=new ee,ne=new ee,se=new ee,Ee=0;Ee<a.length;Ee+=3)C(a[Ee+0],j),C(a[Ee+1],ne),C(a[Ee+2],se),w(j,ne,se,G)}function w(G,j,ne,se){for(var Ee=se+1,Be=[],ce=0;ce<=Ee;ce++){Be[ce]=[];for(var oe=G.clone().lerp(ne,ce/Ee),ie=j.clone().lerp(ne,ce/Ee),Ce=Ee-ce,De=0;De<=Ce;De++)De===0&&ce===Ee?Be[ce][De]=oe:Be[ce][De]=oe.clone().lerp(ie,De/Ce)}for(var Oe=0;Oe<Ee;Oe++)for(var et=0;et<2*(Ee-Oe)-1;et++){var gt=Math.floor(et/2);et%2===0?(F(Be[Oe][gt+1]),F(Be[Oe+1][gt]),F(Be[Oe][gt])):(F(Be[Oe][gt+1]),F(Be[Oe+1][gt+1]),F(Be[Oe+1][gt]))}}function M(G){for(var j=new ee,ne=0;ne<d.length;ne+=3)j.x=d[ne+0],j.y=d[ne+1],j.z=d[ne+2],j.normalize().multiplyScalar(G),d[ne+0]=j.x,d[ne+1]=j.y,d[ne+2]=j.z}function D(){for(var G=new ee,j=0;j<d.length;j+=3){G.x=d[j+0],G.y=d[j+1],G.z=d[j+2];var ne=J(G)/2/Math.PI+.5,se=Z(G)/Math.PI+.5;m.push(ne,1-se)}I(),P()}function P(){for(var G=0;G<m.length;G+=6){var j=m[G+0],ne=m[G+2],se=m[G+4],Ee=Math.max(j,ne,se),Be=Math.min(j,ne,se);Ee>.9&&Be<.1&&(j<.2&&(m[G+0]+=1),ne<.2&&(m[G+2]+=1),se<.2&&(m[G+4]+=1))}}function F(G){d.push(G.x,G.y,G.z)}function C(G,j){var ne=G*3;j.x=t[ne+0],j.y=t[ne+1],j.z=t[ne+2]}function I(){for(var G=new ee,j=new ee,ne=new ee,se=new ee,Ee=new xt,Be=new xt,ce=new xt,oe=0,ie=0;oe<d.length;oe+=9,ie+=6){G.set(d[oe+0],d[oe+1],d[oe+2]),j.set(d[oe+3],d[oe+4],d[oe+5]),ne.set(d[oe+6],d[oe+7],d[oe+8]),Ee.set(m[ie+0],m[ie+1]),Be.set(m[ie+2],m[ie+3]),ce.set(m[ie+4],m[ie+5]),se.copy(G).add(j).add(ne).divideScalar(3);var Ce=J(se);q(Ee,ie+0,G,Ce),q(Be,ie+2,j,Ce),q(ce,ie+4,ne,Ce)}}function q(G,j,ne,se){se<0&&G.x===1&&(m[j]=G.x-1),ne.x===0&&ne.z===0&&(m[j]=se/2/Math.PI+.5)}function J(G){return Math.atan2(G.z,-G.x)}function Z(G){return Math.atan2(-G.y,Math.sqrt(G.x*G.x+G.z*G.z))}return f}return s}(Ae),zv=function(e){en(s,e);function s(t,a){var o,c=(1+Math.sqrt(5))/2,f=1/c;return o=e.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-f,-c,0,-f,c,0,f,-c,0,f,c,-f,-c,0,-f,c,0,f,-c,0,f,c,0,-c,0,-f,c,0,-f,-c,0,f,c,0,f],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,a)||this,o.type="DodecahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(hu),wx=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;return o.type="DodecahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new zv(t,a)),o.mergeVertices(),o}return s}(Bi),xm=new ee,bm=new ee,Hv=new ee,Vh=new ka,kv=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;o.type="EdgesGeometry",o.parameters={thresholdAngle:a},a=a!==void 0?a:1,t.isGeometry&&(t=new Ae().fromGeometry(t));for(var c=Math.pow(10,4),f=Math.cos(Ln.DEG2RAD*a),d=t.getIndex(),m=t.getAttribute("position"),y=d?d.count:m.count,w=[0,0,0],M=["a","b","c"],D=new Array(3),P={},F=[],C=0;C<y;C+=3){d?(w[0]=d.getX(C),w[1]=d.getX(C+1),w[2]=d.getX(C+2)):(w[0]=C,w[1]=C+1,w[2]=C+2);var I=Vh.a,q=Vh.b,J=Vh.c;if(I.fromBufferAttribute(m,w[0]),q.fromBufferAttribute(m,w[1]),J.fromBufferAttribute(m,w[2]),Vh.getNormal(Hv),D[0]=Math.round(I.x*c)+","+Math.round(I.y*c)+","+Math.round(I.z*c),D[1]=Math.round(q.x*c)+","+Math.round(q.y*c)+","+Math.round(q.z*c),D[2]=Math.round(J.x*c)+","+Math.round(J.y*c)+","+Math.round(J.z*c),!(D[0]===D[1]||D[1]===D[2]||D[2]===D[0]))for(var Z=0;Z<3;Z++){var G=(Z+1)%3,j=D[Z],ne=D[G],se=Vh[M[Z]],Ee=Vh[M[G]],Be=j+"_"+ne,ce=ne+"_"+j;ce in P&&P[ce]?(Hv.dot(P[ce].normal)<=f&&(F.push(se.x,se.y,se.z),F.push(Ee.x,Ee.y,Ee.z)),P[ce]=null):Be in P||(P[Be]={index0:w[Z],index1:w[G],normal:Hv.clone()})}}for(var oe in P)if(P[oe]){var ie=P[oe],Ce=ie.index0,De=ie.index1;xm.fromBufferAttribute(m,Ce),bm.fromBufferAttribute(m,De),F.push(xm.x,xm.y,xm.z),F.push(bm.x,bm.y,bm.z)}return o.setAttribute("position",new x(F,3)),o}return s}(Ae),HL={triangulate:function(e,s,t){t=t||2;var a=s&&s.length,o=a?s[0]*t:e.length,c=Mx(e,0,o,t,!0),f=[];if(!c||c.next===c.prev)return f;var d,m,y,w,M,D,P;if(a&&(c=XL(e,s,c,t)),e.length>80*t){d=y=e[0],m=w=e[1];for(var F=t;F<o;F+=t)M=e[F],D=e[F+1],M<d&&(d=M),D<m&&(m=D),M>y&&(y=M),D>w&&(w=D);P=Math.max(y-d,w-m),P=P!==0?1/P:0}return Ed(c,f,t,d,m,P),f}};function Mx(e,s,t,a,o){var c,f;if(o===iR(e,s,t,a)>0)for(c=s;c<t;c+=a)f=Ex(c,e[c],e[c+1],f);else for(c=t-a;c>=s;c-=a)f=Ex(c,e[c],e[c+1],f);return f&&wm(f,f.next)&&(Ld(f),f=f.next),f}function Tc(e,s){if(!e)return e;s||(s=e);var t=e,a;do if(a=!1,!t.steiner&&(wm(t,t.next)||_r(t.prev,t,t.next)===0)){if(Ld(t),t=s=t.prev,t===t.next)break;a=!0}else t=t.next;while(a||t!==s);return s}function Ed(e,s,t,a,o,c,f){if(!!e){!f&&c&&KL(e,a,o,c);for(var d=e,m,y;e.prev!==e.next;){if(m=e.prev,y=e.next,c?VL(e,a,o,c):kL(e)){s.push(m.i/t),s.push(e.i/t),s.push(y.i/t),Ld(e),e=y.next,d=y.next;continue}if(e=y,e===d){f?f===1?(e=WL(Tc(e),s,t),Ed(e,s,t,a,o,c,2)):f===2&&qL(e,s,t,a,o,c):Ed(Tc(e),s,t,a,o,c,1);break}}}}function kL(e){var s=e.prev,t=e,a=e.next;if(_r(s,t,a)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(Wh(s.x,s.y,t.x,t.y,a.x,a.y,o.x,o.y)&&_r(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function VL(e,s,t,a){var o=e.prev,c=e,f=e.next;if(_r(o,c,f)>=0)return!1;for(var d=o.x<c.x?o.x<f.x?o.x:f.x:c.x<f.x?c.x:f.x,m=o.y<c.y?o.y<f.y?o.y:f.y:c.y<f.y?c.y:f.y,y=o.x>c.x?o.x>f.x?o.x:f.x:c.x>f.x?c.x:f.x,w=o.y>c.y?o.y>f.y?o.y:f.y:c.y>f.y?c.y:f.y,M=Vv(d,m,s,t,a),D=Vv(y,w,s,t,a),P=e.prevZ,F=e.nextZ;P&&P.z>=M&&F&&F.z<=D;){if(P!==e.prev&&P!==e.next&&Wh(o.x,o.y,c.x,c.y,f.x,f.y,P.x,P.y)&&_r(P.prev,P,P.next)>=0||(P=P.prevZ,F!==e.prev&&F!==e.next&&Wh(o.x,o.y,c.x,c.y,f.x,f.y,F.x,F.y)&&_r(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;P&&P.z>=M;){if(P!==e.prev&&P!==e.next&&Wh(o.x,o.y,c.x,c.y,f.x,f.y,P.x,P.y)&&_r(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;F&&F.z<=D;){if(F!==e.prev&&F!==e.next&&Wh(o.x,o.y,c.x,c.y,f.x,f.y,F.x,F.y)&&_r(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function WL(e,s,t){var a=e;do{var o=a.prev,c=a.next.next;!wm(o,c)&&Sx(o,a,a.next,c)&&Ad(o,c)&&Ad(c,o)&&(s.push(o.i/t),s.push(a.i/t),s.push(c.i/t),Ld(a),Ld(a.next),a=e=c),a=a.next}while(a!==e);return Tc(a)}function qL(e,s,t,a,o,c){var f=e;do{for(var d=f.next.next;d!==f.prev;){if(f.i!==d.i&&eR(f,d)){var m=Tx(f,d);f=Tc(f,f.next),m=Tc(m,m.next),Ed(f,s,t,a,o,c),Ed(m,s,t,a,o,c);return}d=d.next}f=f.next}while(f!==e)}function XL(e,s,t,a){var o=[],c,f,d,m,y;for(c=0,f=s.length;c<f;c++)d=s[c]*a,m=c<f-1?s[c+1]*a:e.length,y=Mx(e,d,m,a,!1),y===y.next&&(y.steiner=!0),o.push(QL(y));for(o.sort(jL),c=0;c<o.length;c++)YL(o[c],t),t=Tc(t,t.next);return t}function jL(e,s){return e.x-s.x}function YL(e,s){if(s=ZL(e,s),s){var t=Tx(s,e);Tc(s,s.next),Tc(t,t.next)}}function ZL(e,s){var t=s,a=e.x,o=e.y,c=-1/0,f;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){var d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=a&&d>c){if(c=d,d===a){if(o===t.y)return t;if(o===t.next.y)return t.next}f=t.x<t.next.x?t:t.next}}t=t.next}while(t!==s);if(!f)return null;if(a===c)return f;var m=f,y=f.x,w=f.y,M=1/0,D;t=f;do a>=t.x&&t.x>=y&&a!==t.x&&Wh(o<w?a:c,o,y,w,o<w?c:a,o,t.x,t.y)&&(D=Math.abs(o-t.y)/(a-t.x),Ad(t,e)&&(D<M||D===M&&(t.x>f.x||t.x===f.x&&JL(f,t)))&&(f=t,M=D)),t=t.next;while(t!==m);return f}function JL(e,s){return _r(e.prev,e,s.prev)<0&&_r(s.next,e,e.next)<0}function KL(e,s,t,a){var o=e;do o.z===null&&(o.z=Vv(o.x,o.y,s,t,a)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,$L(o)}function $L(e){var s,t,a,o,c,f,d,m,y=1;do{for(t=e,e=null,c=null,f=0;t;){for(f++,a=t,d=0,s=0;s<y&&(d++,a=a.nextZ,!!a);s++);for(m=y;d>0||m>0&&a;)d!==0&&(m===0||!a||t.z<=a.z)?(o=t,t=t.nextZ,d--):(o=a,a=a.nextZ,m--),c?c.nextZ=o:e=o,o.prevZ=c,c=o;t=a}c.nextZ=null,y*=2}while(f>1);return e}function Vv(e,s,t,a,o){return e=32767*(e-t)*o,s=32767*(s-a)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e|s<<1}function QL(e){var s=e,t=e;do(s.x<t.x||s.x===t.x&&s.y<t.y)&&(t=s),s=s.next;while(s!==e);return t}function Wh(e,s,t,a,o,c,f,d){return(o-f)*(s-d)-(e-f)*(c-d)>=0&&(e-f)*(a-d)-(t-f)*(s-d)>=0&&(t-f)*(c-d)-(o-f)*(a-d)>=0}function eR(e,s){return e.next.i!==s.i&&e.prev.i!==s.i&&!tR(e,s)&&(Ad(e,s)&&Ad(s,e)&&nR(e,s)&&(_r(e.prev,e,s.prev)||_r(e,s.prev,s))||wm(e,s)&&_r(e.prev,e,e.next)>0&&_r(s.prev,s,s.next)>0)}function _r(e,s,t){return(s.y-e.y)*(t.x-s.x)-(s.x-e.x)*(t.y-s.y)}function wm(e,s){return e.x===s.x&&e.y===s.y}function Sx(e,s,t,a){var o=Sm(_r(e,s,t)),c=Sm(_r(e,s,a)),f=Sm(_r(t,a,e)),d=Sm(_r(t,a,s));return!!(o!==c&&f!==d||o===0&&Mm(e,t,s)||c===0&&Mm(e,a,s)||f===0&&Mm(t,e,a)||d===0&&Mm(t,s,a))}function Mm(e,s,t){return s.x<=Math.max(e.x,t.x)&&s.x>=Math.min(e.x,t.x)&&s.y<=Math.max(e.y,t.y)&&s.y>=Math.min(e.y,t.y)}function Sm(e){return e>0?1:e<0?-1:0}function tR(e,s){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==s.i&&t.next.i!==s.i&&Sx(t,t.next,e,s))return!0;t=t.next}while(t!==e);return!1}function Ad(e,s){return _r(e.prev,e,e.next)<0?_r(e,s,e.next)>=0&&_r(e,e.prev,s)>=0:_r(e,s,e.prev)<0||_r(e,e.next,s)<0}function nR(e,s){var t=e,a=!1,o=(e.x+s.x)/2,c=(e.y+s.y)/2;do t.y>c!=t.next.y>c&&t.next.y!==t.y&&o<(t.next.x-t.x)*(c-t.y)/(t.next.y-t.y)+t.x&&(a=!a),t=t.next;while(t!==e);return a}function Tx(e,s){var t=new Wv(e.i,e.x,e.y),a=new Wv(s.i,s.x,s.y),o=e.next,c=s.prev;return e.next=s,s.prev=e,t.next=o,o.prev=t,a.next=t,t.prev=a,c.next=a,a.prev=c,a}function Ex(e,s,t,a){var o=new Wv(e,s,t);return a?(o.next=a.next,o.prev=a,a.next.prev=o,a.next=o):(o.prev=o,o.next=o),o}function Ld(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Wv(e,s,t){this.i=e,this.x=s,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iR(e,s,t,a){for(var o=0,c=s,f=t-a;c<t;c+=a)o+=(e[f]-e[c])*(e[c+1]+e[f+1]),f=c;return o}var Ll={area:function(e){for(var s=e.length,t=0,a=s-1,o=0;o<s;a=o++)t+=e[a].x*e[o].y-e[o].x*e[a].y;return t*.5},isClockWise:function(e){return Ll.area(e)<0},triangulateShape:function(e,s){var t=[],a=[],o=[];Ax(e),Lx(t,e);var c=e.length;s.forEach(Ax);for(var f=0;f<s.length;f++)a.push(c),c+=s[f].length,Lx(t,s[f]);for(var d=HL.triangulate(t,a),m=0;m<d.length;m+=3)o.push(d.slice(m,m+3));return o}};function Ax(e){var s=e.length;s>2&&e[s-1].equals(e[0])&&e.pop()}function Lx(e,s){for(var t=0;t<s.length;t++)e.push(s[t].x),e.push(s[t].y)}var Rd=function(e){en(s,e);function s(a,o){var c=e.call(this)||this;c.type="ExtrudeBufferGeometry",c.parameters={shapes:a,options:o},a=Array.isArray(a)?a:[a];for(var f=oc(c),d=[],m=[],y=0,w=a.length;y<w;y++){var M=a[y];D(M)}c.setAttribute("position",new x(d,3)),c.setAttribute("uv",new x(m,2)),c.computeVertexNormals();function D(P){var F=[],C=o.curveSegments!==void 0?o.curveSegments:12,I=o.steps!==void 0?o.steps:1,q=o.depth!==void 0?o.depth:100,J=o.bevelEnabled!==void 0?o.bevelEnabled:!0,Z=o.bevelThickness!==void 0?o.bevelThickness:6,G=o.bevelSize!==void 0?o.bevelSize:Z-2,j=o.bevelOffset!==void 0?o.bevelOffset:0,ne=o.bevelSegments!==void 0?o.bevelSegments:3,se=o.extrudePath,Ee=o.UVGenerator!==void 0?o.UVGenerator:rR;o.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),q=o.amount);var Be,ce=!1,oe,ie,Ce,De;se&&(Be=se.getSpacedPoints(I),ce=!0,J=!1,oe=se.computeFrenetFrames(I,!1),ie=new ee,Ce=new ee,De=new ee),J||(ne=0,Z=0,G=0,j=0);var Oe=P.extractPoints(C),et=Oe.shape,gt=Oe.holes,pt=!Ll.isClockWise(et);if(pt){et=et.reverse();for(var lt=0,St=gt.length;lt<St;lt++){var Ht=gt[lt];Ll.isClockWise(Ht)&&(gt[lt]=Ht.reverse())}}for(var Ut=Ll.triangulateShape(et,gt),rn=et,pn=0,dt=gt.length;pn<dt;pn++){var Un=gt[pn];et=et.concat(Un)}function Dn(fi,On,_i){return On||console.error("THREE.ExtrudeGeometry: vec does not exist"),On.clone().multiplyScalar(_i).add(fi)}var wn=et.length,ci=Ut.length;function Zn(fi,On,_i){var Qn,ui,rr,Ma=fi.x-On.x,Sa=fi.y-On.y,Ia=_i.x-fi.x,ds=_i.y-fi.y,Nl=Ma*Ma+Sa*Sa;if(Math.abs(Ma*ds-Sa*Ia)>Number.EPSILON){var Ab=Math.sqrt(Nl),Lb=Math.sqrt(Ia*Ia+ds*ds),Rb=On.x-Sa/Ab,Cb=On.y+Ma/Ab,$R=_i.x-ds/Lb,QR=_i.y+Ia/Lb,Pb=(($R-Rb)*ds-(QR-Cb)*Ia)/(Ma*ds-Sa*Ia);Qn=Rb+Ma*Pb-fi.x,ui=Cb+Sa*Pb-fi.y;var Ib=Qn*Qn+ui*ui;if(Ib<=2)return new xt(Qn,ui);rr=Math.sqrt(Ib/2)}else{var ag=!1;Ma>Number.EPSILON?Ia>Number.EPSILON&&(ag=!0):Ma<-Number.EPSILON?Ia<-Number.EPSILON&&(ag=!0):Math.sign(Sa)===Math.sign(ds)&&(ag=!0),ag?(Qn=-Sa,ui=Ma,rr=Math.sqrt(Nl)):(Qn=Ma,ui=Sa,rr=Math.sqrt(Nl/2))}return new xt(Qn/rr,ui/rr)}for(var vi=[],ri=0,Vi=rn.length,Me=Vi-1,X=ri+1;ri<Vi;ri++,Me++,X++)Me===Vi&&(Me=0),X===Vi&&(X=0),vi[ri]=Zn(rn[ri],rn[Me],rn[X]);for(var Lt=[],ot,Kt=vi.concat(),Ct=0,vn=gt.length;Ct<vn;Ct++){var xn=gt[Ct];ot=[];for(var an=0,Mn=xn.length,Sn=Mn-1,Kn=an+1;an<Mn;an++,Sn++,Kn++)Sn===Mn&&(Sn=0),Kn===Mn&&(Kn=0),ot[an]=Zn(xn[an],xn[Sn],xn[Kn]);Lt.push(ot),Kt=Kt.concat(ot)}for(var Ei=0;Ei<ne;Ei++){for(var Gr=Ei/ne,Ui=Z*Math.cos(Gr*Math.PI/2),Xa=G*Math.sin(Gr*Math.PI/2)+j,bi=0,mo=rn.length;bi<mo;bi++){var Su=Dn(rn[bi],vi[bi],Xa);un(Su.x,Su.y,-Ui)}for(var go=0,Dl=gt.length;go<Dl;go++){var ef=gt[go];ot=Lt[go];for(var Tu=0,Gy=ef.length;Tu<Gy;Tu++){var tf=Dn(ef[Tu],ot[Tu],Xa);un(tf.x,tf.y,-Ui)}}}for(var ig=G+j,vo=0;vo<wn;vo++){var Eu=J?Dn(et[vo],Kt[vo],ig):et[vo];ce?(Ce.copy(oe.normals[0]).multiplyScalar(Eu.x),ie.copy(oe.binormals[0]).multiplyScalar(Eu.y),De.copy(Be[0]).add(Ce).add(ie),un(De.x,De.y,De.z)):un(Eu.x,Eu.y,0)}for(var Ol=1;Ol<=I;Ol++)for(var Pc=0;Pc<wn;Pc++){var ja=J?Dn(et[Pc],Kt[Pc],ig):et[Pc];ce?(Ce.copy(oe.normals[Ol]).multiplyScalar(ja.x),ie.copy(oe.binormals[Ol]).multiplyScalar(ja.y),De.copy(Be[Ol]).add(Ce).add(ie),un(De.x,De.y,De.z)):un(ja.x,ja.y,q/I*Ol)}for(var nf=ne-1;nf>=0;nf--){for(var rg=nf/ne,Ud=Z*Math.cos(rg*Math.PI/2),he=G*Math.sin(rg*Math.PI/2)+j,st=0,Qe=rn.length;st<Qe;st++){var vt=Dn(rn[st],vi[st],he);un(vt.x,vt.y,q+Ud)}for(var kt=0,hi=gt.length;kt<hi;kt++){var ai=gt[kt];ot=Lt[kt];for(var di=0,Gn=ai.length;di<Gn;di++){var hr=Dn(ai[di],ot[di],he);ce?un(hr.x,hr.y+Be[I-1].y,Be[I-1].x+Ud):un(hr.x,hr.y,q+Ud)}}}fr(),function(){var fi=d.length/3,On=0;Cr(rn,On),On+=rn.length;for(var _i=0,Qn=gt.length;_i<Qn;_i++){var ui=gt[_i];Cr(ui,On),On+=ui.length}f.addGroup(fi,d.length/3-fi,1)}();function fr(){var fi=d.length/3;if(J){for(var On=0,_i=wn*On,Qn=0;Qn<ci;Qn++){var ui=Ut[Qn];Qr(ui[2]+_i,ui[1]+_i,ui[0]+_i)}On=I+ne*2,_i=wn*On;for(var rr=0;rr<ci;rr++){var Ma=Ut[rr];Qr(Ma[0]+_i,Ma[1]+_i,Ma[2]+_i)}}else{for(var Sa=0;Sa<ci;Sa++){var Ia=Ut[Sa];Qr(Ia[2],Ia[1],Ia[0])}for(var ds=0;ds<ci;ds++){var Nl=Ut[ds];Qr(Nl[0]+wn*I,Nl[1]+wn*I,Nl[2]+wn*I)}}f.addGroup(fi,d.length/3-fi,0)}function Cr(fi,On){for(var _i=fi.length;--_i>=0;){var Qn=_i,ui=_i-1;ui<0&&(ui=fi.length-1);for(var rr=0,Ma=I+ne*2;rr<Ma;rr++){var Sa=wn*rr,Ia=wn*(rr+1),ds=On+ui+Sa,Nl=On+ui+Ia;ea(On+Qn+Sa,ds,Nl,On+Qn+Ia)}}}function un(fi,On,_i){F.push(fi),F.push(On),F.push(_i)}function Qr(fi,On,_i){yi(fi),yi(On),yi(_i);var Qn=d.length/3,ui=Ee.generateTopUV(f,d,Qn-3,Qn-2,Qn-1);zr(ui[0]),zr(ui[1]),zr(ui[2])}function ea(fi,On,_i,Qn){yi(fi),yi(On),yi(Qn),yi(On),yi(_i),yi(Qn);var ui=d.length/3,rr=Ee.generateSideWallUV(f,d,ui-6,ui-3,ui-2,ui-1);zr(rr[0]),zr(rr[1]),zr(rr[3]),zr(rr[1]),zr(rr[2]),zr(rr[3])}function yi(fi){d.push(F[fi*3+0]),d.push(F[fi*3+1]),d.push(F[fi*3+2])}function zr(fi){m.push(fi.x),m.push(fi.y)}}return c}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this),o=this.parameters.shapes,c=this.parameters.options;return aR(o,c,a)},s}(Ae),rR={generateTopUV:function(e,s,t,a,o){var c=s[t*3],f=s[t*3+1],d=s[a*3],m=s[a*3+1],y=s[o*3],w=s[o*3+1];return[new xt(c,f),new xt(d,m),new xt(y,w)]},generateSideWallUV:function(e,s,t,a,o,c){var f=s[t*3],d=s[t*3+1],m=s[t*3+2],y=s[a*3],w=s[a*3+1],M=s[a*3+2],D=s[o*3],P=s[o*3+1],F=s[o*3+2],C=s[c*3],I=s[c*3+1],q=s[c*3+2];return Math.abs(d-w)<.01?[new xt(f,1-m),new xt(y,1-M),new xt(D,1-F),new xt(C,1-q)]:[new xt(d,1-m),new xt(w,1-M),new xt(P,1-F),new xt(I,1-q)]}};function aR(e,s,t){if(t.shapes=[],Array.isArray(e))for(var a=0,o=e.length;a<o;a++){var c=e[a];t.shapes.push(c.uuid)}else t.shapes.push(e.uuid);return s.extrudePath!==void 0&&(t.options.extrudePath=s.extrudePath.toJSON()),t}var qv=function(e){en(s,e);function s(a,o){var c=e.call(this)||this;return c.type="ExtrudeGeometry",c.parameters={shapes:a,options:o},c.fromBufferGeometry(new Rd(a,o)),c.mergeVertices(),c}var t=s.prototype;return t.toJSON=function(){var a=e.prototype.toJSON.call(this),o=this.parameters.shapes,c=this.parameters.options;return sR(o,c,a)},s}(Bi);function sR(e,s,t){if(t.shapes=[],Array.isArray(e))for(var a=0,o=e.length;a<o;a++){var c=e[a];t.shapes.push(c.uuid)}else t.shapes.push(e.uuid);return s.extrudePath!==void 0&&(t.options.extrudePath=s.extrudePath.toJSON()),t}var Xv=function(e){en(s,e);function s(t,a){var o,c=(1+Math.sqrt(5))/2;return o=e.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,a)||this,o.type="IcosahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(hu),Rx=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;return o.type="IcosahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Xv(t,a)),o.mergeVertices(),o}return s}(Bi),jv=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="LatheBufferGeometry",f.parameters={points:t,segments:a,phiStart:o,phiLength:c},a=Math.floor(a)||12,o=o||0,c=c||Math.PI*2,c=Ln.clamp(c,0,Math.PI*2);for(var d=[],m=[],y=[],w=1/a,M=new ee,D=new xt,P=0;P<=a;P++)for(var F=o+P*w*c,C=Math.sin(F),I=Math.cos(F),q=0;q<=t.length-1;q++)M.x=t[q].x*C,M.y=t[q].y,M.z=t[q].x*I,m.push(M.x,M.y,M.z),D.x=P/a,D.y=q/(t.length-1),y.push(D.x,D.y);for(var J=0;J<a;J++)for(var Z=0;Z<t.length-1;Z++){var G=Z+J*t.length,j=G+t.length,ne=G+t.length+1,se=G+1;d.push(G,j,se),d.push(j,ne,se)}if(f.setIndex(d),f.setAttribute("position",new x(m,3)),f.setAttribute("uv",new x(y,2)),f.computeVertexNormals(),c===Math.PI*2)for(var Ee=f.attributes.normal.array,Be=new ee,ce=new ee,oe=new ee,ie=a*t.length*3,Ce=0,De=0;Ce<t.length;Ce++,De+=3)Be.x=Ee[De+0],Be.y=Ee[De+1],Be.z=Ee[De+2],ce.x=Ee[ie+De+0],ce.y=Ee[ie+De+1],ce.z=Ee[ie+De+2],oe.addVectors(Be,ce).normalize(),Ee[De+0]=Ee[ie+De+0]=oe.x,Ee[De+1]=Ee[ie+De+1]=oe.y,Ee[De+2]=Ee[ie+De+2]=oe.z;return f}return s}(Ae),Cx=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="LatheGeometry",f.parameters={points:t,segments:a,phiStart:o,phiLength:c},f.fromBufferGeometry(new jv(t,a,o,c)),f.mergeVertices(),f}return s}(Bi),Tm=function(e){en(s,e);function s(t,a){var o=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,a)||this;return o.type="OctahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(hu),Px=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;return o.type="OctahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Tm(t,a)),o.mergeVertices(),o}return s}(Bi);function qh(e,s,t){Ae.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:s,stacks:t};var a=[],o=[],c=[],f=[],d=1e-5,m=new ee,y=new ee,w=new ee,M=new ee,D=new ee;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var P=s+1,F=0;F<=t;F++)for(var C=F/t,I=0;I<=s;I++){var q=I/s;e(q,C,y),o.push(y.x,y.y,y.z),q-d>=0?(e(q-d,C,w),M.subVectors(y,w)):(e(q+d,C,w),M.subVectors(w,y)),C-d>=0?(e(q,C-d,w),D.subVectors(y,w)):(e(q,C+d,w),D.subVectors(w,y)),m.crossVectors(M,D).normalize(),c.push(m.x,m.y,m.z),f.push(q,C)}for(var J=0;J<t;J++)for(var Z=0;Z<s;Z++){var G=J*P+Z,j=J*P+Z+1,ne=(J+1)*P+Z+1,se=(J+1)*P+Z;a.push(G,j,se),a.push(j,ne,se)}this.setIndex(a),this.setAttribute("position",new x(o,3)),this.setAttribute("normal",new x(c,3)),this.setAttribute("uv",new x(f,2))}qh.prototype=Object.create(Ae.prototype),qh.prototype.constructor=qh;function Cd(e,s,t){Bi.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:s,stacks:t},this.fromBufferGeometry(new qh(e,s,t)),this.mergeVertices()}Cd.prototype=Object.create(Bi.prototype),Cd.prototype.constructor=Cd;var Ix=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="PlaneGeometry",f.parameters={width:t,height:a,widthSegments:o,heightSegments:c},f.fromBufferGeometry(new nm(t,a,o,c)),f.mergeVertices(),f}return s}(Bi),Dx=function(e){en(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="PolyhedronGeometry",f.parameters={vertices:t,indices:a,radius:o,detail:c},f.fromBufferGeometry(new hu(t,a,o,c)),f.mergeVertices(),f}return s}(Bi),Yv=function(e){en(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="RingBufferGeometry",m.parameters={innerRadius:t,outerRadius:a,thetaSegments:o,phiSegments:c,thetaStart:f,thetaLength:d},t=t||.5,a=a||1,f=f!==void 0?f:0,d=d!==void 0?d:Math.PI*2,o=o!==void 0?Math.max(3,o):8,c=c!==void 0?Math.max(1,c):1;for(var y=[],w=[],M=[],D=[],P=t,F=(a-t)/c,C=new ee,I=new xt,q=0;q<=c;q++){for(var J=0;J<=o;J++){var Z=f+J/o*d;C.x=P*Math.cos(Z),C.y=P*Math.sin(Z),w.push(C.x,C.y,C.z),M.push(0,0,1),I.x=(C.x/a+1)/2,I.y=(C.y/a+1)/2,D.push(I.x,I.y)}P+=F}for(var G=0;G<c;G++)for(var j=G*(o+1),ne=0;ne<o;ne++){var se=ne+j,Ee=se+o+1,Be=se+o+2,ce=se+1;y.push(se,Ee,ce),y.push(Ee,Be,ce)}return m.setIndex(y),m.setAttribute("position",new x(w,3)),m.setAttribute("normal",new x(M,3)),m.setAttribute("uv",new x(D,2)),m}return s}(Ae),Ox=function(e){en(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;return m.type="RingGeometry",m.parameters={innerRadius:t,outerRadius:a,thetaSegments:o,phiSegments:c,thetaStart:f,thetaLength:d},m.fromBufferGeometry(new Yv(t,a,o,c,f,d)),m.mergeVertices(),m}return s}(Bi),Zv=function(e){en(s,e);function s(a,o){var c=e.call(this)||this;c.type="ShapeBufferGeometry",c.parameters={shapes:a,curveSegments:o},o=o||12;var f=[],d=[],m=[],y=[],w=0,M=0;if(Array.isArray(a)===!1)P(a);else for(var D=0;D<a.length;D++)P(a[D]),c.addGroup(w,M,D),w+=M,M=0;c.setIndex(f),c.setAttribute("position",new x(d,3)),c.setAttribute("normal",new x(m,3)),c.setAttribute("uv",new x(y,2));function P(F){var C=d.length/3,I=F.extractPoints(o),q=I.shape,J=I.holes;Ll.isClockWise(q)===!1&&(q=q.reverse());for(var Z=0,G=J.length;Z<G;Z++){var j=J[Z];Ll.isClockWise(j)===!0&&(J[Z]=j.reverse())}for(var ne=Ll.triangulateShape(q,J),se=0,Ee=J.length;se<Ee;se++){var Be=J[se];q=q.concat(Be)}for(var ce=0,oe=q.length;ce<oe;ce++){var ie=q[ce];d.push(ie.x,ie.y,0),m.push(0,0,1),y.push(ie.x,ie.y)}for(var Ce=0,De=ne.length;Ce<De;Ce++){var Oe=ne[Ce],et=Oe[0]+C,gt=Oe[1]+C,pt=Oe[2]+C;f.push(et,gt,pt),M+=3}}return c}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this),o=this.parameters.shapes;return oR(o,a)},s}(Ae);function oR(e,s){if(s.shapes=[],Array.isArray(e))for(var t=0,a=e.length;t<a;t++){var o=e[t];s.shapes.push(o.uuid)}else s.shapes.push(e.uuid);return s}var Jv=function(e){en(s,e);function s(a,o){var c=e.call(this)||this;return c.type="ShapeGeometry",typeof o=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),o=o.curveSegments),c.parameters={shapes:a,curveSegments:o},c.fromBufferGeometry(new Zv(a,o)),c.mergeVertices(),c}var t=s.prototype;return t.toJSON=function(){var a=Bi.prototype.toJSON.call(this),o=this.parameters.shapes;return lR(o,a)},s}(Bi);function lR(e,s){if(s.shapes=[],Array.isArray(e))for(var t=0,a=e.length;t<a;t++){var o=e[t];s.shapes.push(o.uuid)}else s.shapes.push(e.uuid);return s}var Em=function(e){en(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;y.type="SphereBufferGeometry",y.parameters={radius:t,widthSegments:a,heightSegments:o,phiStart:c,phiLength:f,thetaStart:d,thetaLength:m},t=t||1,a=Math.max(3,Math.floor(a)||8),o=Math.max(2,Math.floor(o)||6),c=c!==void 0?c:0,f=f!==void 0?f:Math.PI*2,d=d!==void 0?d:0,m=m!==void 0?m:Math.PI;for(var w=Math.min(d+m,Math.PI),M=0,D=[],P=new ee,F=new ee,C=[],I=[],q=[],J=[],Z=0;Z<=o;Z++){var G=[],j=Z/o,ne=0;Z==0&&d==0?ne=.5/a:Z==o&&w==Math.PI&&(ne=-.5/a);for(var se=0;se<=a;se++){var Ee=se/a;P.x=-t*Math.cos(c+Ee*f)*Math.sin(d+j*m),P.y=t*Math.cos(d+j*m),P.z=t*Math.sin(c+Ee*f)*Math.sin(d+j*m),I.push(P.x,P.y,P.z),F.copy(P).normalize(),q.push(F.x,F.y,F.z),J.push(Ee+ne,1-j),G.push(M++)}D.push(G)}for(var Be=0;Be<o;Be++)for(var ce=0;ce<a;ce++){var oe=D[Be][ce+1],ie=D[Be][ce],Ce=D[Be+1][ce],De=D[Be+1][ce+1];(Be!==0||d>0)&&C.push(oe,ie,De),(Be!==o-1||w<Math.PI)&&C.push(ie,Ce,De)}return y.setIndex(C),y.setAttribute("position",new x(I,3)),y.setAttribute("normal",new x(q,3)),y.setAttribute("uv",new x(J,2)),y}return s}(Ae),Nx=function(e){en(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;return y.type="SphereGeometry",y.parameters={radius:t,widthSegments:a,heightSegments:o,phiStart:c,phiLength:f,thetaStart:d,thetaLength:m},y.fromBufferGeometry(new Em(t,a,o,c,f,d,m)),y.mergeVertices(),y}return s}(Bi),Kv=function(e){en(s,e);function s(t,a){var o=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,a)||this;return o.type="TetrahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(hu),Fx=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;return o.type="TetrahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Kv(t,a)),o.mergeVertices(),o}return s}(Bi),$v=function(e){en(s,e);function s(t,a){var o;a=a||{};var c=a.font;if(!(c&&c.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Ae||oc(o);var f=c.generateShapes(t,a.size);return a.depth=a.height!==void 0?a.height:50,a.bevelThickness===void 0&&(a.bevelThickness=10),a.bevelSize===void 0&&(a.bevelSize=8),a.bevelEnabled===void 0&&(a.bevelEnabled=!1),o=e.call(this,f,a)||this,o.type="TextBufferGeometry",o}return s}(Rd),Bx=function(e){en(s,e);function s(t,a){var o=e.call(this)||this;return o.type="TextGeometry",o.parameters={text:t,parameters:a},o.fromBufferGeometry(new $v(t,a)),o.mergeVertices(),o}return s}(Bi),Qv=function(e){en(s,e);function s(t,a,o,c,f){var d=e.call(this)||this;d.type="TorusBufferGeometry",d.parameters={radius:t,tube:a,radialSegments:o,tubularSegments:c,arc:f},t=t||1,a=a||.4,o=Math.floor(o)||8,c=Math.floor(c)||6,f=f||Math.PI*2;for(var m=[],y=[],w=[],M=[],D=new ee,P=new ee,F=new ee,C=0;C<=o;C++)for(var I=0;I<=c;I++){var q=I/c*f,J=C/o*Math.PI*2;P.x=(t+a*Math.cos(J))*Math.cos(q),P.y=(t+a*Math.cos(J))*Math.sin(q),P.z=a*Math.sin(J),y.push(P.x,P.y,P.z),D.x=t*Math.cos(q),D.y=t*Math.sin(q),F.subVectors(P,D).normalize(),w.push(F.x,F.y,F.z),M.push(I/c),M.push(C/o)}for(var Z=1;Z<=o;Z++)for(var G=1;G<=c;G++){var j=(c+1)*Z+G-1,ne=(c+1)*(Z-1)+G-1,se=(c+1)*(Z-1)+G,Ee=(c+1)*Z+G;m.push(j,ne,Ee),m.push(ne,se,Ee)}return d.setIndex(m),d.setAttribute("position",new x(y,3)),d.setAttribute("normal",new x(w,3)),d.setAttribute("uv",new x(M,2)),d}return s}(Ae),Ux=function(e){en(s,e);function s(t,a,o,c,f){var d=e.call(this)||this;return d.type="TorusGeometry",d.parameters={radius:t,tube:a,radialSegments:o,tubularSegments:c,arc:f},d.fromBufferGeometry(new Qv(t,a,o,c,f)),d.mergeVertices(),d}return s}(Bi),ey=function(e){en(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="TorusKnotBufferGeometry",m.parameters={radius:t,tube:a,tubularSegments:o,radialSegments:c,p:f,q:d},t=t||1,a=a||.4,o=Math.floor(o)||64,c=Math.floor(c)||8,f=f||2,d=d||3;for(var y=[],w=[],M=[],D=[],P=new ee,F=new ee,C=new ee,I=new ee,q=new ee,J=new ee,Z=new ee,G=0;G<=o;++G){var j=G/o*f*Math.PI*2;et(j,f,d,t,C),et(j+.01,f,d,t,I),J.subVectors(I,C),Z.addVectors(I,C),q.crossVectors(J,Z),Z.crossVectors(q,J),q.normalize(),Z.normalize();for(var ne=0;ne<=c;++ne){var se=ne/c*Math.PI*2,Ee=-a*Math.cos(se),Be=a*Math.sin(se);P.x=C.x+(Ee*Z.x+Be*q.x),P.y=C.y+(Ee*Z.y+Be*q.y),P.z=C.z+(Ee*Z.z+Be*q.z),w.push(P.x,P.y,P.z),F.subVectors(P,C).normalize(),M.push(F.x,F.y,F.z),D.push(G/o),D.push(ne/c)}}for(var ce=1;ce<=o;ce++)for(var oe=1;oe<=c;oe++){var ie=(c+1)*(ce-1)+(oe-1),Ce=(c+1)*ce+(oe-1),De=(c+1)*ce+oe,Oe=(c+1)*(ce-1)+oe;y.push(ie,Ce,Oe),y.push(Ce,De,Oe)}m.setIndex(y),m.setAttribute("position",new x(w,3)),m.setAttribute("normal",new x(M,3)),m.setAttribute("uv",new x(D,2));function et(gt,pt,lt,St,Ht){var Ut=Math.cos(gt),rn=Math.sin(gt),pn=lt/pt*gt,dt=Math.cos(pn);Ht.x=St*(2+dt)*.5*Ut,Ht.y=St*(2+dt)*rn*.5,Ht.z=St*Math.sin(pn)*.5}return m}return s}(Ae),Gx=function(e){en(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;return y.type="TorusKnotGeometry",y.parameters={radius:t,tube:a,tubularSegments:o,radialSegments:c,p:f,q:d},m!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),y.fromBufferGeometry(new ey(t,a,o,c,f,d)),y.mergeVertices(),y}return s}(Bi),ty=function(e){en(s,e);function s(a,o,c,f,d){var m=e.call(this)||this;m.type="TubeBufferGeometry",m.parameters={path:a,tubularSegments:o,radius:c,radialSegments:f,closed:d},o=o||64,c=c||1,f=f||8,d=d||!1;var y=a.computeFrenetFrames(o,d);m.tangents=y.tangents,m.normals=y.normals,m.binormals=y.binormals;var w=new ee,M=new ee,D=new xt,P=new ee,F=[],C=[],I=[],q=[];J(),m.setIndex(q),m.setAttribute("position",new x(F,3)),m.setAttribute("normal",new x(C,3)),m.setAttribute("uv",new x(I,2));function J(){for(var ne=0;ne<o;ne++)Z(ne);Z(d===!1?o:0),j(),G()}function Z(ne){P=a.getPointAt(ne/o,P);for(var se=y.normals[ne],Ee=y.binormals[ne],Be=0;Be<=f;Be++){var ce=Be/f*Math.PI*2,oe=Math.sin(ce),ie=-Math.cos(ce);M.x=ie*se.x+oe*Ee.x,M.y=ie*se.y+oe*Ee.y,M.z=ie*se.z+oe*Ee.z,M.normalize(),C.push(M.x,M.y,M.z),w.x=P.x+c*M.x,w.y=P.y+c*M.y,w.z=P.z+c*M.z,F.push(w.x,w.y,w.z)}}function G(){for(var ne=1;ne<=o;ne++)for(var se=1;se<=f;se++){var Ee=(f+1)*(ne-1)+(se-1),Be=(f+1)*ne+(se-1),ce=(f+1)*ne+se,oe=(f+1)*(ne-1)+se;q.push(Ee,Be,oe),q.push(Be,ce,oe)}}function j(){for(var ne=0;ne<=o;ne++)for(var se=0;se<=f;se++)D.x=ne/o,D.y=se/f,I.push(D.x,D.y)}return m}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this);return a.path=this.parameters.path.toJSON(),a},s}(Ae),zx=function(e){en(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="TubeGeometry",m.parameters={path:t,tubularSegments:a,radius:o,radialSegments:c,closed:f},d!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var y=new ty(t,a,o,c,f);return m.tangents=y.tangents,m.normals=y.normals,m.binormals=y.binormals,m.fromBufferGeometry(y),m.mergeVertices(),m}return s}(Bi),ny=function(e){en(s,e);function s(t){var a=e.call(this)||this;a.type="WireframeGeometry";var o=[],c=[0,0],f={},d=["a","b","c"];if(t&&t.isGeometry){for(var m=t.faces,y=0,w=m.length;y<w;y++)for(var M=m[y],D=0;D<3;D++){var P=M[d[D]],F=M[d[(D+1)%3]];c[0]=Math.min(P,F),c[1]=Math.max(P,F);var C=c[0]+","+c[1];f[C]===void 0&&(f[C]={index1:c[0],index2:c[1]})}for(var I in f){var q=f[I],J=t.vertices[q.index1];o.push(J.x,J.y,J.z),J=t.vertices[q.index2],o.push(J.x,J.y,J.z)}}else if(t&&t.isBufferGeometry){var Z=new ee;if(t.index!==null){var G=t.attributes.position,j=t.index,ne=t.groups;ne.length===0&&(ne=[{start:0,count:j.count,materialIndex:0}]);for(var se=0,Ee=ne.length;se<Ee;++se)for(var Be=ne[se],ce=Be.start,oe=Be.count,ie=ce;ie<ce+oe;ie+=3)for(var Ce=0;Ce<3;Ce++){var De=j.getX(ie+Ce),Oe=j.getX(ie+(Ce+1)%3);c[0]=Math.min(De,Oe),c[1]=Math.max(De,Oe);var et=c[0]+","+c[1];f[et]===void 0&&(f[et]={index1:c[0],index2:c[1]})}for(var gt in f){var pt=f[gt];Z.fromBufferAttribute(G,pt.index1),o.push(Z.x,Z.y,Z.z),Z.fromBufferAttribute(G,pt.index2),o.push(Z.x,Z.y,Z.z)}}else for(var lt=t.attributes.position,St=0,Ht=lt.count/3;St<Ht;St++)for(var Ut=0;Ut<3;Ut++){var rn=3*St+Ut;Z.fromBufferAttribute(lt,rn),o.push(Z.x,Z.y,Z.z);var pn=3*St+(Ut+1)%3;Z.fromBufferAttribute(lt,pn),o.push(Z.x,Z.y,Z.z)}}return a.setAttribute("position",new x(o,3)),a}return s}(Ae),Pa=Object.freeze({__proto__:null,BoxGeometry:Bv,BoxBufferGeometry:ls,CircleGeometry:_x,CircleBufferGeometry:Uv,ConeGeometry:xx,ConeBufferGeometry:bx,CylinderGeometry:Gv,CylinderBufferGeometry:Td,DodecahedronGeometry:wx,DodecahedronBufferGeometry:zv,EdgesGeometry:kv,ExtrudeGeometry:qv,ExtrudeBufferGeometry:Rd,IcosahedronGeometry:Rx,IcosahedronBufferGeometry:Xv,LatheGeometry:Cx,LatheBufferGeometry:jv,OctahedronGeometry:Px,OctahedronBufferGeometry:Tm,ParametricGeometry:Cd,ParametricBufferGeometry:qh,PlaneGeometry:Ix,PlaneBufferGeometry:nm,PolyhedronGeometry:Dx,PolyhedronBufferGeometry:hu,RingGeometry:Ox,RingBufferGeometry:Yv,ShapeGeometry:Jv,ShapeBufferGeometry:Zv,SphereGeometry:Nx,SphereBufferGeometry:Em,TetrahedronGeometry:Fx,TetrahedronBufferGeometry:Kv,TextGeometry:Bx,TextBufferGeometry:$v,TorusGeometry:Ux,TorusBufferGeometry:Qv,TorusKnotGeometry:Gx,TorusKnotBufferGeometry:ey,TubeGeometry:zx,TubeBufferGeometry:ty,WireframeGeometry:ny});function fu(e){fn.call(this),this.type="ShadowMaterial",this.color=new Xt(0),this.transparent=!0,this.setValues(e)}fu.prototype=Object.create(fn.prototype),fu.prototype.constructor=fu,fu.prototype.isShadowMaterial=!0,fu.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this};function Rl(e){$r.call(this,e),this.type="RawShaderMaterial"}Rl.prototype=Object.create($r.prototype),Rl.prototype.constructor=Rl,Rl.prototype.isRawShaderMaterial=!0;function jo(e){fn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vl,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}jo.prototype=Object.create(fn.prototype),jo.prototype.constructor=jo,jo.prototype.isMeshStandardMaterial=!0,jo.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this};function Ec(e){jo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(s){this.reflectivity=Ln.clamp(2.5*(s-1)/(s+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}Ec.prototype=Object.create(jo.prototype),Ec.prototype.constructor=Ec,Ec.prototype.isMeshPhysicalMaterial=!0,Ec.prototype.copy=function(e){return jo.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Xt).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};function Ac(e){fn.call(this),this.type="MeshPhongMaterial",this.color=new Xt(16777215),this.specular=new Xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vl,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Ac.prototype=Object.create(fn.prototype),Ac.prototype.constructor=Ac,Ac.prototype.isMeshPhongMaterial=!0,Ac.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function du(e){fn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vl,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}du.prototype=Object.create(fn.prototype),du.prototype.constructor=du,du.prototype.isMeshToonMaterial=!0,du.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function pu(e){fn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vl,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}pu.prototype=Object.create(fn.prototype),pu.prototype.constructor=pu,pu.prototype.isMeshNormalMaterial=!0,pu.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function mu(e){fn.call(this),this.type="MeshLambertMaterial",this.color=new Xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}mu.prototype=Object.create(fn.prototype),mu.prototype.constructor=mu,mu.prototype.isMeshLambertMaterial=!0,mu.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function gu(e){fn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Xt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vl,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}gu.prototype=Object.create(fn.prototype),gu.prototype.constructor=gu,gu.prototype.isMeshMatcapMaterial=!0,gu.prototype.copy=function(e){return fn.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function vu(e){ur.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}vu.prototype=Object.create(ur.prototype),vu.prototype.constructor=vu,vu.prototype.isLineDashedMaterial=!0,vu.prototype.copy=function(e){return ur.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var cR=Object.freeze({__proto__:null,ShadowMaterial:fu,SpriteMaterial:Sc,RawShaderMaterial:Rl,ShaderMaterial:$r,PointsMaterial:oo,MeshPhysicalMaterial:Ec,MeshStandardMaterial:jo,MeshPhongMaterial:Ac,MeshToonMaterial:du,MeshNormalMaterial:pu,MeshLambertMaterial:mu,MeshDepthMaterial:xc,MeshDistanceMaterial:bc,MeshBasicMaterial:Fr,MeshMatcapMaterial:gu,LineDashedMaterial:vu,LineBasicMaterial:ur,Material:fn}),ir={arraySlice:function(e,s,t){return ir.isTypedArray(e)?new e.constructor(e.subarray(s,t!==void 0?t:e.length)):e.slice(s,t)},convertArray:function(e,s,t){return!e||!t&&e.constructor===s?e:typeof s.BYTES_PER_ELEMENT=="number"?new s(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function s(c,f){return e[c]-e[f]}for(var t=e.length,a=new Array(t),o=0;o!==t;++o)a[o]=o;return a.sort(s),a},sortedArray:function(e,s,t){for(var a=e.length,o=new e.constructor(a),c=0,f=0;f!==a;++c)for(var d=t[c]*s,m=0;m!==s;++m)o[f++]=e[d+m];return o},flattenJSON:function(e,s,t,a){for(var o=1,c=e[0];c!==void 0&&c[a]===void 0;)c=e[o++];if(c!==void 0){var f=c[a];if(f!==void 0)if(Array.isArray(f))do f=c[a],f!==void 0&&(s.push(c.time),t.push.apply(t,f)),c=e[o++];while(c!==void 0);else if(f.toArray!==void 0)do f=c[a],f!==void 0&&(s.push(c.time),f.toArray(t,t.length)),c=e[o++];while(c!==void 0);else do f=c[a],f!==void 0&&(s.push(c.time),t.push(f)),c=e[o++];while(c!==void 0)}},subclip:function(e,s,t,a,o){o=o||30;var c=e.clone();c.name=s;for(var f=[],d=0;d<c.tracks.length;++d){for(var m=c.tracks[d],y=m.getValueSize(),w=[],M=[],D=0;D<m.times.length;++D){var P=m.times[D]*o;if(!(P<t||P>=a)){w.push(m.times[D]);for(var F=0;F<y;++F)M.push(m.values[D*y+F])}}w.length!==0&&(m.times=ir.convertArray(w,m.times.constructor),m.values=ir.convertArray(M,m.values.constructor),f.push(m))}c.tracks=f;for(var C=1/0,I=0;I<c.tracks.length;++I)C>c.tracks[I].times[0]&&(C=c.tracks[I].times[0]);for(var q=0;q<c.tracks.length;++q)c.tracks[q].shift(-1*C);return c.resetDuration(),c},makeClipAdditive:function(e,s,t,a){s===void 0&&(s=0),t===void 0&&(t=e),(a===void 0||a<=0)&&(a=30);for(var o=t.tracks.length,c=s/a,f=function(y){var w=t.tracks[y],M=w.ValueTypeName;if(M==="bool"||M==="string")return"continue";var D=e.tracks.find(function(et){return et.name===w.name&&et.ValueTypeName===M});if(D===void 0)return"continue";var P=0,F=w.getValueSize();w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(P=F/3);var C=0,I=D.getValueSize();D.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(C=I/3);var q=w.times.length-1,J=void 0;if(c<=w.times[0]){var Z=P,G=F-P;J=ir.arraySlice(w.values,Z,G)}else if(c>=w.times[q]){var j=q*F+P,ne=j+F-P;J=ir.arraySlice(w.values,j,ne)}else{var se=w.createInterpolant(),Ee=P,Be=F-P;se.evaluate(c),J=ir.arraySlice(se.resultBuffer,Ee,Be)}if(M==="quaternion"){var ce=new Kr().fromArray(J).normalize().conjugate();ce.toArray(J)}for(var oe=D.times.length,ie=0;ie<oe;++ie){var Ce=ie*I+C;if(M==="quaternion")Kr.multiplyQuaternionsFlat(D.values,Ce,J,0,D.values,Ce);else for(var De=I-C*2,Oe=0;Oe<De;++Oe)D.values[Ce+Oe]-=J[Oe]}},d=0;d<o;++d)var m=f(d);return e.blendMode=eo,e}};function hs(e,s,t,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new s.constructor(t),this.sampleValues=s,this.valueSize=t}Object.assign(hs.prototype,{evaluate:function(e){var s=this.parameterPositions,t=this._cachedIndex,a=s[t],o=s[t-1];e:{t:{var c;n:{i:if(!(e<a)){for(var f=t+2;;){if(a===void 0){if(e<o)break i;return t=s.length,this._cachedIndex=t,this.afterEnd_(t-1,e,o)}if(t===f)break;if(o=a,a=s[++t],e<a)break t}c=s.length;break n}if(!(e>=o)){var d=s[1];e<d&&(t=2,o=d);for(var m=t-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(t===m)break;if(a=o,o=s[--t-1],e>=o)break t}c=t,t=0;break n}break e}for(;t<c;){var y=t+c>>>1;e<s[y]?c=y:t=y+1}if(a=s[t],o=s[t-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(a===void 0)return t=s.length,this._cachedIndex=t,this.afterEnd_(t-1,o,e)}this._cachedIndex=t,this.intervalChanged_(t,o,a)}return this.interpolate_(t,o,e,a)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var s=this.resultBuffer,t=this.sampleValues,a=this.valueSize,o=0;o!==a;++o)s[o]=t[e*a+o];return s},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(hs.prototype,{beforeStart_:hs.prototype.copySampleValue_,afterEnd_:hs.prototype.copySampleValue_});function Am(e,s,t,a){hs.call(this,e,s,t,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Am.prototype=Object.assign(Object.create(hs.prototype),{constructor:Am,DefaultSettings_:{endingStart:ml,endingEnd:ml},intervalChanged_:function(e,s,t){var a=this.parameterPositions,o=e-2,c=e+1,f=a[o],d=a[c];if(f===void 0)switch(this.getSettings_().endingStart){case Do:o=e,f=2*s-t;break;case ac:o=a.length-2,f=s+a[o]-a[o+1];break;default:o=e,f=t}if(d===void 0)switch(this.getSettings_().endingEnd){case Do:c=e,d=2*t-s;break;case ac:c=1,d=t+a[1]-a[0];break;default:c=e-1,d=s}var m=(t-s)*.5,y=this.valueSize;this._weightPrev=m/(s-f),this._weightNext=m/(d-t),this._offsetPrev=o*y,this._offsetNext=c*y},interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=this._offsetPrev,y=this._offsetNext,w=this._weightPrev,M=this._weightNext,D=(t-s)/(a-s),P=D*D,F=P*D,C=0;C!==f;++C)o[C]=(-w*F+2*w*P-w*D)*c[m+C]+((1+w)*F+(-1.5-2*w)*P+(-.5+w)*D+1)*c[d-f+C]+((-1-M)*F+(1.5+M)*P+.5*D)*c[d+C]+(M*F-M*P)*c[y+C];return o}});function Pd(e,s,t,a){hs.call(this,e,s,t,a)}Pd.prototype=Object.assign(Object.create(hs.prototype),{constructor:Pd,interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=(t-s)/(a-s),y=0;y!==f;++y)o[y]=c[d-f+y]*(1-m)+c[d+y]*m;return o}});function Lm(e,s,t,a){hs.call(this,e,s,t,a)}Lm.prototype=Object.assign(Object.create(hs.prototype),{constructor:Lm,interpolate_:function(e){return this.copySampleValue_(e-1)}});function la(e,s,t,a){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(s===void 0||s.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ir.convertArray(s,this.TimeBufferType),this.values=ir.convertArray(t,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}Object.assign(la,{toJSON:function(e){var s=e.constructor,t;if(s.toJSON!==void 0)t=s.toJSON(e);else{t={name:e.name,times:ir.convertArray(e.times,Array),values:ir.convertArray(e.values,Array)};var a=e.getInterpolation();a!==e.DefaultInterpolation&&(t.interpolation=a)}return t.type=e.ValueTypeName,t}}),Object.assign(la.prototype,{constructor:la,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Jc,InterpolantFactoryMethodDiscrete:function(e){return new Lm(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Pd(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Am(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var s;switch(e){case Zc:s=this.InterpolantFactoryMethodDiscrete;break;case Jc:s=this.InterpolantFactoryMethodLinear;break;case xh:s=this.InterpolantFactoryMethodSmooth;break}if(s===void 0){var t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=s,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Zc;case this.InterpolantFactoryMethodLinear:return Jc;case this.InterpolantFactoryMethodSmooth:return xh}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var s=this.times,t=0,a=s.length;t!==a;++t)s[t]+=e;return this},scale:function(e){if(e!==1)for(var s=this.times,t=0,a=s.length;t!==a;++t)s[t]*=e;return this},trim:function(e,s){for(var t=this.times,a=t.length,o=0,c=a-1;o!==a&&t[o]<e;)++o;for(;c!==-1&&t[c]>s;)--c;if(++c,o!==0||c!==a){o>=c&&(c=Math.max(c,1),o=c-1);var f=this.getValueSize();this.times=ir.arraySlice(t,o,c),this.values=ir.arraySlice(this.values,o*f,c*f)}return this},validate:function(){var e=!0,s=this.getValueSize();s-Math.floor(s)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var t=this.times,a=this.values,o=t.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var c=null,f=0;f!==o;f++){var d=t[f];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,d),e=!1;break}if(c!==null&&c>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,d,c),e=!1;break}c=d}if(a!==void 0&&ir.isTypedArray(a))for(var m=0,y=a.length;m!==y;++m){var w=a[m];if(isNaN(w)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,w),e=!1;break}}return e},optimize:function(){for(var e=ir.arraySlice(this.times),s=ir.arraySlice(this.values),t=this.getValueSize(),a=this.getInterpolation()===xh,o=e.length-1,c=1,f=1;f<o;++f){var d=!1,m=e[f],y=e[f+1];if(m!==y&&(f!==1||m!==m[0]))if(a)d=!0;else for(var w=f*t,M=0;M!==t;++M){var D=s[w+M];if(D!==s[w-t+M]||D!==s[w+t+M]){d=!0;break}}if(d){if(f!==c){e[c]=e[f];for(var P=f*t,F=c*t,C=0;C!==t;++C)s[F+C]=s[P+C]}++c}}if(o>0){e[c]=e[o];for(var I=c*t,q=0;q!==t;++q)s[I+q]=s[o*t+q];++c}return c!==e.length?(this.times=ir.arraySlice(e,0,c),this.values=ir.arraySlice(s,0,c*t)):(this.times=e,this.values=s),this},clone:function(){var e=ir.arraySlice(this.times,0),s=ir.arraySlice(this.values,0),t=this.constructor,a=new t(this.name,e,s);return a.createInterpolant=this.createInterpolant,a}});function Rm(e,s,t){la.call(this,e,s,t)}Rm.prototype=Object.assign(Object.create(la.prototype),{constructor:Rm,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Zc,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Cm(e,s,t,a){la.call(this,e,s,t,a)}Cm.prototype=Object.assign(Object.create(la.prototype),{constructor:Cm,ValueTypeName:"color"});function Xh(e,s,t,a){la.call(this,e,s,t,a)}Xh.prototype=Object.assign(Object.create(la.prototype),{constructor:Xh,ValueTypeName:"number"});function Pm(e,s,t,a){hs.call(this,e,s,t,a)}Pm.prototype=Object.assign(Object.create(hs.prototype),{constructor:Pm,interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=d+f;d!==m;d+=4)Kr.slerpFlat(o,0,c,d-f,c,d,(t-s)/(a-s));return o}});function Id(e,s,t,a){la.call(this,e,s,t,a)}Id.prototype=Object.assign(Object.create(la.prototype),{constructor:Id,ValueTypeName:"quaternion",DefaultInterpolation:Jc,InterpolantFactoryMethodLinear:function(e){return new Pm(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function Im(e,s,t,a){la.call(this,e,s,t,a)}Im.prototype=Object.assign(Object.create(la.prototype),{constructor:Im,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Zc,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function jh(e,s,t,a){la.call(this,e,s,t,a)}jh.prototype=Object.assign(Object.create(la.prototype),{constructor:jh,ValueTypeName:"vector"});function Cs(e,s,t,a){this.name=e,this.tracks=t,this.duration=s!==void 0?s:-1,this.blendMode=a!==void 0?a:Qs,this.uuid=Ln.generateUUID(),this.duration<0&&this.resetDuration()}function uR(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xh;case"vector":case"vector2":case"vector3":case"vector4":return jh;case"color":return Cm;case"quaternion":return Id;case"bool":case"boolean":return Rm;case"string":return Im}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function hR(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var s=uR(e.type);if(e.times===void 0){var t=[],a=[];ir.flattenJSON(e.keys,t,a,"value"),e.times=t,e.values=a}return s.parse!==void 0?s.parse(e):new s(e.name,e.times,e.values,e.interpolation)}Object.assign(Cs,{parse:function(e){for(var s=[],t=e.tracks,a=1/(e.fps||1),o=0,c=t.length;o!==c;++o)s.push(hR(t[o]).scale(a));return new Cs(e.name,e.duration,s,e.blendMode)},toJSON:function(e){for(var s=[],t=e.tracks,a={name:e.name,duration:e.duration,tracks:s,uuid:e.uuid,blendMode:e.blendMode},o=0,c=t.length;o!==c;++o)s.push(la.toJSON(t[o]));return a},CreateFromMorphTargetSequence:function(e,s,t,a){for(var o=s.length,c=[],f=0;f<o;f++){var d=[],m=[];d.push((f+o-1)%o,f,(f+1)%o),m.push(0,1,0);var y=ir.getKeyframeOrder(d);d=ir.sortedArray(d,1,y),m=ir.sortedArray(m,1,y),!a&&d[0]===0&&(d.push(o),m.push(m[0])),c.push(new Xh(".morphTargetInfluences["+s[f].name+"]",d,m).scale(1/t))}return new Cs(e,-1,c)},findByName:function(e,s){var t=e;if(!Array.isArray(e)){var a=e;t=a.geometry&&a.geometry.animations||a.animations}for(var o=0;o<t.length;o++)if(t[o].name===s)return t[o];return null},CreateClipsFromMorphTargetSequences:function(e,s,t){for(var a={},o=0,c=e.length;o<c;o++){var f=e[o],d=f.name.match(/^([\w-]*?)([\d]+)$/);if(d&&d.length>1){var m=d[1],y=a[m];y||(a[m]=y=[]),y.push(f)}}var w=[];for(var M in a)w.push(Cs.CreateFromMorphTargetSequence(M,a[M],s,t));return w},parseAnimation:function(e,s){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var t=function(j,ne,se,Ee,Be){if(se.length!==0){var ce=[],oe=[];ir.flattenJSON(se,ce,oe,Ee),ce.length!==0&&Be.push(new j(ne,ce,oe))}},a=[],o=e.name||"default",c=e.fps||30,f=e.blendMode,d=e.length||-1,m=e.hierarchy||[],y=0;y<m.length;y++){var w=m[y].keys;if(!(!w||w.length===0))if(w[0].morphTargets){var M={},D=void 0;for(D=0;D<w.length;D++)if(w[D].morphTargets)for(var P=0;P<w[D].morphTargets.length;P++)M[w[D].morphTargets[P]]=-1;for(var F in M){for(var C=[],I=[],q=0;q!==w[D].morphTargets.length;++q){var J=w[D];C.push(J.time),I.push(J.morphTarget===F?1:0)}a.push(new Xh(".morphTargetInfluence["+F+"]",C,I))}d=M.length*(c||1)}else{var Z=".bones["+s[y].name+"]";t(jh,Z+".position",w,"pos",a),t(Id,Z+".quaternion",w,"rot",a),t(jh,Z+".scale",w,"scl",a)}}if(a.length===0)return null;var G=new Cs(o,d,a,f);return G}}),Object.assign(Cs.prototype,{resetDuration:function(){for(var e=this.tracks,s=0,t=0,a=e.length;t!==a;++t){var o=this.tracks[t];s=Math.max(s,o.times[o.times.length-1])}return this.duration=s,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,s=0;s<this.tracks.length;s++)e=e&&this.tracks[s].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],s=0;s<this.tracks.length;s++)e.push(this.tracks[s].clone());return new Cs(this.name,this.duration,e,this.blendMode)}});var yu={enabled:!1,files:{},add:function(e,s){this.enabled!==!1&&(this.files[e]=s)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function iy(e,s,t){var a=this,o=!1,c=0,f=0,d=void 0,m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=s,this.onError=t,this.itemStart=function(y){f++,o===!1&&a.onStart!==void 0&&a.onStart(y,c,f),o=!0},this.itemEnd=function(y){c++,a.onProgress!==void 0&&a.onProgress(y,c,f),c===f&&(o=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(y){a.onError!==void 0&&a.onError(y)},this.resolveURL=function(y){return d?d(y):y},this.setURLModifier=function(y){return d=y,this},this.addHandler=function(y,w){return m.push(y,w),this},this.removeHandler=function(y){var w=m.indexOf(y);return w!==-1&&m.splice(w,2),this},this.getHandler=function(y){for(var w=0,M=m.length;w<M;w+=2){var D=m[w],P=m[w+1];if(D.global&&(D.lastIndex=0),D.test(y))return P}return null}}var Hx=new iy;function Ii(e){this.manager=e!==void 0?e:Hx,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ii.prototype,{load:function(){},loadAsync:function(e,s){var t=this;return new Promise(function(a,o){t.load(e,a,s,o)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var lo={};function Ps(e){Ii.call(this,e)}Ps.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Ps,load:function(e,s,t,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=yu.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;if(lo[e]!==void 0){lo[e].push({onLoad:s,onProgress:t,onError:a});return}var f=e.match(/^data:(.*?)(;base64)?,(.*)$/),d;if(f){var m=f[1],y=!!f[2],w=f[3];w=decodeURIComponent(w),y&&(w=atob(w));try{var M,D=(this.responseType||"").toLowerCase();switch(D){case"arraybuffer":case"blob":for(var P=new Uint8Array(w.length),F=0;F<w.length;F++)P[F]=w.charCodeAt(F);D==="blob"?M=new Blob([P.buffer],{type:m}):M=P.buffer;break;case"document":var C=new DOMParser;M=C.parseFromString(w,m);break;case"json":M=JSON.parse(w);break;default:M=w;break}setTimeout(function(){s&&s(M),o.manager.itemEnd(e)},0)}catch(q){setTimeout(function(){a&&a(q),o.manager.itemError(e),o.manager.itemEnd(e)},0)}}else{lo[e]=[],lo[e].push({onLoad:s,onProgress:t,onError:a}),d=new XMLHttpRequest,d.open("GET",e,!0),d.addEventListener("load",function(q){var J=this.response,Z=lo[e];if(delete lo[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),yu.add(e,J);for(var G=0,j=Z.length;G<j;G++){var ne=Z[G];ne.onLoad&&ne.onLoad(J)}o.manager.itemEnd(e)}else{for(var se=0,Ee=Z.length;se<Ee;se++){var Be=Z[se];Be.onError&&Be.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)}},!1),d.addEventListener("progress",function(q){for(var J=lo[e],Z=0,G=J.length;Z<G;Z++){var j=J[Z];j.onProgress&&j.onProgress(q)}},!1),d.addEventListener("error",function(q){var J=lo[e];delete lo[e];for(var Z=0,G=J.length;Z<G;Z++){var j=J[Z];j.onError&&j.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),d.addEventListener("abort",function(q){var J=lo[e];delete lo[e];for(var Z=0,G=J.length;Z<G;Z++){var j=J[Z];j.onError&&j.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),this.responseType!==void 0&&(d.responseType=this.responseType),this.withCredentials!==void 0&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var I in this.requestHeader)d.setRequestHeader(I,this.requestHeader[I]);d.send(null)}return o.manager.itemStart(e),d},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});function ry(e){Ii.call(this,e)}ry.prototype=Object.assign(Object.create(Ii.prototype),{constructor:ry,load:function(e,s,t,a){var o=this,c=new Ps(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){for(var s=[],t=0;t<e.length;t++){var a=Cs.parse(e[t]);s.push(a)}return s}});function ay(e){Ii.call(this,e)}ay.prototype=Object.assign(Object.create(Ii.prototype),{constructor:ay,load:function(e,s,t,a){var o=this,c=[],f=new kh;f.image=c;var d=new Ps(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(o.withCredentials);var m=0;function y(D){d.load(e[D],function(P){var F=o.parse(P,!0);c[D]={width:F.width,height:F.height,format:F.format,mipmaps:F.mipmaps},m+=1,m===6&&(F.mipmapCount===1&&(f.minFilter=Nt),f.format=F.format,f.needsUpdate=!0,s&&s(f))},t,a)}if(Array.isArray(e))for(var w=0,M=e.length;w<M;++w)y(w);else d.load(e,function(D){var P=o.parse(D,!0);if(P.isCubemap)for(var F=P.mipmaps.length/P.mipmapCount,C=0;C<F;C++){c[C]={mipmaps:[]};for(var I=0;I<P.mipmapCount;I++)c[C].mipmaps.push(P.mipmaps[C*P.mipmapCount+I]),c[C].format=P.format,c[C].width=P.width,c[C].height=P.height}else f.image.width=P.width,f.image.height=P.height,f.mipmaps=P.mipmaps;P.mipmapCount===1&&(f.minFilter=Nt),f.format=P.format,f.needsUpdate=!0,s&&s(f)},t,a);return f}});function Yh(e){Ii.call(this,e)}Yh.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Yh,load:function(e,s,t,a){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=yu.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;var f=document.createElementNS("http://www.w3.org/1999/xhtml","img");function d(){f.removeEventListener("load",d,!1),f.removeEventListener("error",m,!1),yu.add(e,this),s&&s(this),o.manager.itemEnd(e)}function m(y){f.removeEventListener("load",d,!1),f.removeEventListener("error",m,!1),a&&a(y),o.manager.itemError(e),o.manager.itemEnd(e)}return f.addEventListener("load",d,!1),f.addEventListener("error",m,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),o.manager.itemStart(e),f.src=e,f}});function Dm(e){Ii.call(this,e)}Dm.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Dm,load:function(e,s,t,a){var o=new qo,c=new Yh(this.manager);c.setCrossOrigin(this.crossOrigin),c.setPath(this.path);var f=0;function d(y){c.load(e[y],function(w){o.images[y]=w,f++,f===6&&(o.needsUpdate=!0,s&&s(o))},void 0,a)}for(var m=0;m<e.length;++m)d(m);return o}});function Om(e){Ii.call(this,e)}Om.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Om,load:function(e,s,t,a){var o=this,c=new cu,f=new Ps(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(o.withCredentials),f.load(e,function(d){var m=o.parse(d);!m||(m.image!==void 0?c.image=m.image:m.data!==void 0&&(c.image.width=m.width,c.image.height=m.height,c.image.data=m.data),c.wrapS=m.wrapS!==void 0?m.wrapS:ut,c.wrapT=m.wrapT!==void 0?m.wrapT:ut,c.magFilter=m.magFilter!==void 0?m.magFilter:Nt,c.minFilter=m.minFilter!==void 0?m.minFilter:Nt,c.anisotropy=m.anisotropy!==void 0?m.anisotropy:1,m.format!==void 0&&(c.format=m.format),m.type!==void 0&&(c.type=m.type),m.mipmaps!==void 0&&(c.mipmaps=m.mipmaps,c.minFilter=gi),m.mipmapCount===1&&(c.minFilter=Nt),c.needsUpdate=!0,s&&s(c,m))},t,a),c}});function Nm(e){Ii.call(this,e)}Nm.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Nm,load:function(e,s,t,a){var o=new Si,c=new Yh(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(f){o.image=f;var d=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;o.format=d?is:re,o.needsUpdate=!0,s!==void 0&&s(o)},t,a),o}});function dn(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(dn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,s){var t=this.getUtoTmapping(e);return this.getPoint(t,s)},getPoints:function(e){e===void 0&&(e=5);for(var s=[],t=0;t<=e;t++)s.push(this.getPoint(t/e));return s},getSpacedPoints:function(e){e===void 0&&(e=5);for(var s=[],t=0;t<=e;t++)s.push(this.getPointAt(t/e));return s},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var s=[],t,a=this.getPoint(0),o=0;s.push(0);for(var c=1;c<=e;c++)t=this.getPoint(c/e),o+=t.distanceTo(a),s.push(o),a=t;return this.cacheArcLengths=s,s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,s){var t=this.getLengths(),a=0,o=t.length,c;s?c=s:c=e*t[o-1];for(var f=0,d=o-1,m;f<=d;)if(a=Math.floor(f+(d-f)/2),m=t[a]-c,m<0)f=a+1;else if(m>0)d=a-1;else{d=a;break}if(a=d,t[a]===c)return a/(o-1);var y=t[a],w=t[a+1],M=(c-y)/(w-y),D=(a+M)/(o-1);return D},getTangent:function(e,s){var t=1e-4,a=e-t,o=e+t;a<0&&(a=0),o>1&&(o=1);var c=this.getPoint(a),f=this.getPoint(o),d=s||(c.isVector2?new xt:new ee);return d.copy(f).sub(c).normalize(),d},getTangentAt:function(e,s){var t=this.getUtoTmapping(e);return this.getTangent(t,s)},computeFrenetFrames:function(e,s){for(var t=new ee,a=[],o=[],c=[],f=new ee,d=new qn,m=0;m<=e;m++){var y=m/e;a[m]=this.getTangentAt(y,new ee),a[m].normalize()}o[0]=new ee,c[0]=new ee;var w=Number.MAX_VALUE,M=Math.abs(a[0].x),D=Math.abs(a[0].y),P=Math.abs(a[0].z);M<=w&&(w=M,t.set(1,0,0)),D<=w&&(w=D,t.set(0,1,0)),P<=w&&t.set(0,0,1),f.crossVectors(a[0],t).normalize(),o[0].crossVectors(a[0],f),c[0].crossVectors(a[0],o[0]);for(var F=1;F<=e;F++){if(o[F]=o[F-1].clone(),c[F]=c[F-1].clone(),f.crossVectors(a[F-1],a[F]),f.length()>Number.EPSILON){f.normalize();var C=Math.acos(Ln.clamp(a[F-1].dot(a[F]),-1,1));o[F].applyMatrix4(d.makeRotationAxis(f,C))}c[F].crossVectors(a[F],o[F])}if(s===!0){var I=Math.acos(Ln.clamp(o[0].dot(o[e]),-1,1));I/=e,a[0].dot(f.crossVectors(o[0],o[e]))>0&&(I=-I);for(var q=1;q<=e;q++)o[q].applyMatrix4(d.makeRotationAxis(a[q],I*q)),c[q].crossVectors(a[q],o[q])}return{tangents:a,normals:o,binormals:c}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function fs(e,s,t,a,o,c,f,d){dn.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=s||0,this.xRadius=t||1,this.yRadius=a||1,this.aStartAngle=o||0,this.aEndAngle=c||2*Math.PI,this.aClockwise=f||!1,this.aRotation=d||0}fs.prototype=Object.create(dn.prototype),fs.prototype.constructor=fs,fs.prototype.isEllipseCurve=!0,fs.prototype.getPoint=function(e,s){for(var t=s||new xt,a=Math.PI*2,o=this.aEndAngle-this.aStartAngle,c=Math.abs(o)<Number.EPSILON;o<0;)o+=a;for(;o>a;)o-=a;o<Number.EPSILON&&(c?o=0:o=a),this.aClockwise===!0&&!c&&(o===a?o=-a:o=o-a);var f=this.aStartAngle+e*o,d=this.aX+this.xRadius*Math.cos(f),m=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){var y=Math.cos(this.aRotation),w=Math.sin(this.aRotation),M=d-this.aX,D=m-this.aY;d=M*y-D*w+this.aX,m=M*w+D*y+this.aY}return t.set(d,m)},fs.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},fs.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},fs.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function Zh(e,s,t,a,o,c){fs.call(this,e,s,t,t,a,o,c),this.type="ArcCurve"}Zh.prototype=Object.create(fs.prototype),Zh.prototype.constructor=Zh,Zh.prototype.isArcCurve=!0;function sy(){var e=0,s=0,t=0,a=0;function o(c,f,d,m){e=c,s=d,t=-3*c+3*f-2*d-m,a=2*c-2*f+d+m}return{initCatmullRom:function(c,f,d,m,y){o(f,d,y*(d-c),y*(m-f))},initNonuniformCatmullRom:function(c,f,d,m,y,w,M){var D=(f-c)/y-(d-c)/(y+w)+(d-f)/w,P=(d-f)/w-(m-f)/(w+M)+(m-d)/M;D*=w,P*=w,o(f,d,D,P)},calc:function(c){var f=c*c;return e+s*c+t*f+a*(f*c)}}}var Fm=new ee,oy=new sy,ly=new sy,cy=new sy;function ba(e,s,t,a){dn.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=s||!1,this.curveType=t||"centripetal",this.tension=a!==void 0?a:.5}ba.prototype=Object.create(dn.prototype),ba.prototype.constructor=ba,ba.prototype.isCatmullRomCurve3=!0,ba.prototype.getPoint=function(e,s){var t=s||new ee,a=this.points,o=a.length,c=(o-(this.closed?0:1))*e,f=Math.floor(c),d=c-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/o)+1)*o:d===0&&f===o-1&&(f=o-2,d=1);var m,y;this.closed||f>0?m=a[(f-1)%o]:(Fm.subVectors(a[0],a[1]).add(a[0]),m=Fm);var w=a[f%o],M=a[(f+1)%o];if(this.closed||f+2<o?y=a[(f+2)%o]:(Fm.subVectors(a[o-1],a[o-2]).add(a[o-1]),y=Fm),this.curveType==="centripetal"||this.curveType==="chordal"){var D=this.curveType==="chordal"?.5:.25,P=Math.pow(m.distanceToSquared(w),D),F=Math.pow(w.distanceToSquared(M),D),C=Math.pow(M.distanceToSquared(y),D);F<1e-4&&(F=1),P<1e-4&&(P=F),C<1e-4&&(C=F),oy.initNonuniformCatmullRom(m.x,w.x,M.x,y.x,P,F,C),ly.initNonuniformCatmullRom(m.y,w.y,M.y,y.y,P,F,C),cy.initNonuniformCatmullRom(m.z,w.z,M.z,y.z,P,F,C)}else this.curveType==="catmullrom"&&(oy.initCatmullRom(m.x,w.x,M.x,y.x,this.tension),ly.initCatmullRom(m.y,w.y,M.y,y.y,this.tension),cy.initCatmullRom(m.z,w.z,M.z,y.z,this.tension));return t.set(oy.calc(d),ly.calc(d),cy.calc(d)),t},ba.prototype.copy=function(e){dn.prototype.copy.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ba.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);e.points=[];for(var s=0,t=this.points.length;s<t;s++){var a=this.points[s];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ba.prototype.fromJSON=function(e){dn.prototype.fromJSON.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(new ee().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function kx(e,s,t,a,o){var c=(a-s)*.5,f=(o-t)*.5,d=e*e;return(2*t-2*a+c+f)*(e*d)+(-3*t+3*a-2*c-f)*d+c*e+t}function fR(e,s){var t=1-e;return t*t*s}function dR(e,s){return 2*(1-e)*e*s}function pR(e,s){return e*e*s}function Dd(e,s,t,a){return fR(e,s)+dR(e,t)+pR(e,a)}function mR(e,s){var t=1-e;return t*t*t*s}function gR(e,s){var t=1-e;return 3*t*t*e*s}function vR(e,s){return 3*(1-e)*e*e*s}function yR(e,s){return e*e*e*s}function Od(e,s,t,a,o){return mR(e,s)+gR(e,t)+vR(e,a)+yR(e,o)}function co(e,s,t,a){dn.call(this),this.type="CubicBezierCurve",this.v0=e||new xt,this.v1=s||new xt,this.v2=t||new xt,this.v3=a||new xt}co.prototype=Object.create(dn.prototype),co.prototype.constructor=co,co.prototype.isCubicBezierCurve=!0,co.prototype.getPoint=function(e,s){var t=s||new xt,a=this.v0,o=this.v1,c=this.v2,f=this.v3;return t.set(Od(e,a.x,o.x,c.x,f.x),Od(e,a.y,o.y,c.y,f.y)),t},co.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},co.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},co.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Yo(e,s,t,a){dn.call(this),this.type="CubicBezierCurve3",this.v0=e||new ee,this.v1=s||new ee,this.v2=t||new ee,this.v3=a||new ee}Yo.prototype=Object.create(dn.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isCubicBezierCurve3=!0,Yo.prototype.getPoint=function(e,s){var t=s||new ee,a=this.v0,o=this.v1,c=this.v2,f=this.v3;return t.set(Od(e,a.x,o.x,c.x,f.x),Od(e,a.y,o.y,c.y,f.y),Od(e,a.z,o.z,c.z,f.z)),t},Yo.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Yo.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Yo.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function qa(e,s){dn.call(this),this.type="LineCurve",this.v1=e||new xt,this.v2=s||new xt}qa.prototype=Object.create(dn.prototype),qa.prototype.constructor=qa,qa.prototype.isLineCurve=!0,qa.prototype.getPoint=function(e,s){var t=s||new xt;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},qa.prototype.getPointAt=function(e,s){return this.getPoint(e,s)},qa.prototype.getTangent=function(e,s){var t=s||new xt;return t.copy(this.v2).sub(this.v1).normalize(),t},qa.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},qa.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},qa.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function uo(e,s){dn.call(this),this.type="LineCurve3",this.v1=e||new ee,this.v2=s||new ee}uo.prototype=Object.create(dn.prototype),uo.prototype.constructor=uo,uo.prototype.isLineCurve3=!0,uo.prototype.getPoint=function(e,s){var t=s||new ee;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},uo.prototype.getPointAt=function(e,s){return this.getPoint(e,s)},uo.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},uo.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},uo.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ho(e,s,t){dn.call(this),this.type="QuadraticBezierCurve",this.v0=e||new xt,this.v1=s||new xt,this.v2=t||new xt}ho.prototype=Object.create(dn.prototype),ho.prototype.constructor=ho,ho.prototype.isQuadraticBezierCurve=!0,ho.prototype.getPoint=function(e,s){var t=s||new xt,a=this.v0,o=this.v1,c=this.v2;return t.set(Dd(e,a.x,o.x,c.x),Dd(e,a.y,o.y,c.y)),t},ho.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ho.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ho.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function Zo(e,s,t){dn.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new ee,this.v1=s||new ee,this.v2=t||new ee}Zo.prototype=Object.create(dn.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isQuadraticBezierCurve3=!0,Zo.prototype.getPoint=function(e,s){var t=s||new ee,a=this.v0,o=this.v1,c=this.v2;return t.set(Dd(e,a.x,o.x,c.x),Dd(e,a.y,o.y,c.y),Dd(e,a.z,o.z,c.z)),t},Zo.prototype.copy=function(e){return dn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Zo.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Zo.prototype.fromJSON=function(e){return dn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function fo(e){dn.call(this),this.type="SplineCurve",this.points=e||[]}fo.prototype=Object.create(dn.prototype),fo.prototype.constructor=fo,fo.prototype.isSplineCurve=!0,fo.prototype.getPoint=function(e,s){var t=s||new xt,a=this.points,o=(a.length-1)*e,c=Math.floor(o),f=o-c,d=a[c===0?c:c-1],m=a[c],y=a[c>a.length-2?a.length-1:c+1],w=a[c>a.length-3?a.length-1:c+2];return t.set(kx(f,d.x,m.x,y.x,w.x),kx(f,d.y,m.y,y.y,w.y)),t},fo.prototype.copy=function(e){dn.prototype.copy.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(a.clone())}return this},fo.prototype.toJSON=function(){var e=dn.prototype.toJSON.call(this);e.points=[];for(var s=0,t=this.points.length;s<t;s++){var a=this.points[s];e.points.push(a.toArray())}return e},fo.prototype.fromJSON=function(e){dn.prototype.fromJSON.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(new xt().fromArray(a))}return this};var uy=Object.freeze({__proto__:null,ArcCurve:Zh,CatmullRomCurve3:ba,CubicBezierCurve:co,CubicBezierCurve3:Yo,EllipseCurve:fs,LineCurve:qa,LineCurve3:uo,QuadraticBezierCurve:ho,QuadraticBezierCurve3:Zo,SplineCurve:fo});function Cl(){dn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Cl.prototype=Object.assign(Object.create(dn.prototype),{constructor:Cl,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);e.equals(s)||this.curves.push(new qa(s,e))},getPoint:function(e){for(var s=e*this.getLength(),t=this.getCurveLengths(),a=0;a<t.length;){if(t[a]>=s){var o=t[a]-s,c=this.curves[a],f=c.getLength(),d=f===0?0:1-o/f;return c.getPointAt(d)}a++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],s=0,t=0,a=this.curves.length;t<a;t++)s+=this.curves[t].getLength(),e.push(s);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var s=[],t=0;t<=e;t++)s.push(this.getPoint(t/e));return this.autoClose&&s.push(s[0]),s},getPoints:function(e){e=e||12;for(var s=[],t,a=0,o=this.curves;a<o.length;a++)for(var c=o[a],f=c&&c.isEllipseCurve?e*2:c&&(c.isLineCurve||c.isLineCurve3)?1:c&&c.isSplineCurve?e*c.points.length:e,d=c.getPoints(f),m=0;m<d.length;m++){var y=d[m];t&&t.equals(y)||(s.push(y),t=y)}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s},copy:function(e){dn.prototype.copy.call(this,e),this.curves=[];for(var s=0,t=e.curves.length;s<t;s++){var a=e.curves[s];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=dn.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var s=0,t=this.curves.length;s<t;s++){var a=this.curves[s];e.curves.push(a.toJSON())}return e},fromJSON:function(e){dn.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var s=0,t=e.curves.length;s<t;s++){var a=e.curves[s];this.curves.push(new uy[a.type]().fromJSON(a))}return this}});function po(e){Cl.call(this),this.type="Path",this.currentPoint=new xt,e&&this.setFromPoints(e)}po.prototype=Object.assign(Object.create(Cl.prototype),{constructor:po,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var s=1,t=e.length;s<t;s++)this.lineTo(e[s].x,e[s].y);return this},moveTo:function(e,s){return this.currentPoint.set(e,s),this},lineTo:function(e,s){var t=new qa(this.currentPoint.clone(),new xt(e,s));return this.curves.push(t),this.currentPoint.set(e,s),this},quadraticCurveTo:function(e,s,t,a){var o=new ho(this.currentPoint.clone(),new xt(e,s),new xt(t,a));return this.curves.push(o),this.currentPoint.set(t,a),this},bezierCurveTo:function(e,s,t,a,o,c){var f=new co(this.currentPoint.clone(),new xt(e,s),new xt(t,a),new xt(o,c));return this.curves.push(f),this.currentPoint.set(o,c),this},splineThru:function(e){var s=[this.currentPoint.clone()].concat(e),t=new fo(s);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,s,t,a,o,c){var f=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+f,s+d,t,a,o,c),this},absarc:function(e,s,t,a,o,c){return this.absellipse(e,s,t,t,a,o,c),this},ellipse:function(e,s,t,a,o,c,f,d){var m=this.currentPoint.x,y=this.currentPoint.y;return this.absellipse(e+m,s+y,t,a,o,c,f,d),this},absellipse:function(e,s,t,a,o,c,f,d){var m=new fs(e,s,t,a,o,c,f,d);if(this.curves.length>0){var y=m.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(m);var w=m.getPoint(1);return this.currentPoint.copy(w),this},copy:function(e){return Cl.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Cl.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Cl.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function Lc(e){po.call(this,e),this.uuid=Ln.generateUUID(),this.type="Shape",this.holes=[]}Lc.prototype=Object.assign(Object.create(po.prototype),{constructor:Lc,getPointsHoles:function(e){for(var s=[],t=0,a=this.holes.length;t<a;t++)s[t]=this.holes[t].getPoints(e);return s},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){po.prototype.copy.call(this,e),this.holes=[];for(var s=0,t=e.holes.length;s<t;s++){var a=e.holes[s];this.holes.push(a.clone())}return this},toJSON:function(){var e=po.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var s=0,t=this.holes.length;s<t;s++){var a=this.holes[s];e.holes.push(a.toJSON())}return e},fromJSON:function(e){po.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var s=0,t=e.holes.length;s<t;s++){var a=e.holes[s];this.holes.push(new po().fromJSON(a))}return this}});function Ki(e,s){$t.call(this),this.type="Light",this.color=new Xt(e),this.intensity=s!==void 0?s:1}Ki.prototype=Object.assign(Object.create($t.prototype),{constructor:Ki,isLight:!0,copy:function(e){return $t.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var s=$t.prototype.toJSON.call(this,e);return s.object.color=this.color.getHex(),s.object.intensity=this.intensity,this.groundColor!==void 0&&(s.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(s.object.distance=this.distance),this.angle!==void 0&&(s.object.angle=this.angle),this.decay!==void 0&&(s.object.decay=this.decay),this.penumbra!==void 0&&(s.object.penumbra=this.penumbra),this.shadow!==void 0&&(s.object.shadow=this.shadow.toJSON()),s}});function Bm(e,s,t){Ki.call(this,e,t),this.type="HemisphereLight",this.position.copy($t.DefaultUp),this.updateMatrix(),this.groundColor=new Xt(s)}Bm.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Bm,isHemisphereLight:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function Pl(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new xt(512,512),this.map=null,this.mapPass=null,this.matrix=new qn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fd,this._frameExtents=new xt(1,1),this._viewportCount=1,this._viewports=[new Ti(0,0,1,1)]}Object.assign(Pl.prototype,{_projScreenMatrix:new qn,_lightPositionWorld:new ee,_lookTarget:new ee,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var s=this.camera,t=this.matrix,a=this._projScreenMatrix,o=this._lookTarget,c=this._lightPositionWorld;c.setFromMatrixPosition(e.matrixWorld),s.position.copy(c),o.setFromMatrixPosition(e.target.matrixWorld),s.lookAt(o),s.updateMatrixWorld(),a.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(s.projectionMatrix),t.multiply(s.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function hy(){Pl.call(this,new Fi(50,1,.5,500)),this.focus=1}hy.prototype=Object.assign(Object.create(Pl.prototype),{constructor:hy,isSpotLightShadow:!0,updateMatrices:function(e){var s=this.camera,t=Ln.RAD2DEG*2*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,o=e.distance||s.far;(t!==s.fov||a!==s.aspect||o!==s.far)&&(s.fov=t,s.aspect=a,s.far=o,s.updateProjectionMatrix()),Pl.prototype.updateMatrices.call(this,e)}});function Um(e,s,t,a,o,c){Ki.call(this,e,s),this.type="SpotLight",this.position.copy($t.DefaultUp),this.updateMatrix(),this.target=new $t,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(f){this.intensity=f/Math.PI}}),this.distance=t!==void 0?t:0,this.angle=a!==void 0?a:Math.PI/3,this.penumbra=o!==void 0?o:0,this.decay=c!==void 0?c:1,this.shadow=new hy}Um.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Um,isSpotLight:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function fy(){Pl.call(this,new Fi(90,1,.5,500)),this._frameExtents=new xt(4,2),this._viewportCount=6,this._viewports=[new Ti(2,1,1,1),new Ti(0,1,1,1),new Ti(3,1,1,1),new Ti(1,1,1,1),new Ti(3,0,1,1),new Ti(1,0,1,1)],this._cubeDirections=[new ee(1,0,0),new ee(-1,0,0),new ee(0,0,1),new ee(0,0,-1),new ee(0,1,0),new ee(0,-1,0)],this._cubeUps=[new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,0,1),new ee(0,0,-1)]}fy.prototype=Object.assign(Object.create(Pl.prototype),{constructor:fy,isPointLightShadow:!0,updateMatrices:function(e,s){s===void 0&&(s=0);var t=this.camera,a=this.matrix,o=this._lightPositionWorld,c=this._lookTarget,f=this._projScreenMatrix;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),c.copy(t.position),c.add(this._cubeDirections[s]),t.up.copy(this._cubeUps[s]),t.lookAt(c),t.updateMatrixWorld(),a.makeTranslation(-o.x,-o.y,-o.z),f.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f)}});function Gm(e,s,t,a){Ki.call(this,e,s),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(o){this.intensity=o/(4*Math.PI)}}),this.distance=t!==void 0?t:0,this.decay=a!==void 0?a:1,this.shadow=new fy}Gm.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Gm,isPointLight:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function Jh(e,s,t,a,o,c){Ur.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=s!==void 0?s:1,this.top=t!==void 0?t:1,this.bottom=a!==void 0?a:-1,this.near=o!==void 0?o:.1,this.far=c!==void 0?c:2e3,this.updateProjectionMatrix()}Jh.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Jh,isOrthographicCamera:!0,copy:function(e,s){return Ur.prototype.copy.call(this,e,s),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,s,t,a,o,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=t,this.view.offsetY=a,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,a=(this.top+this.bottom)/2,o=t-e,c=t+e,f=a+s,d=a-s;if(this.view!==null&&this.view.enabled){var m=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=m*this.view.offsetX,c=o+m*this.view.width,f-=y*this.view.offsetY,d=f-y*this.view.height}this.projectionMatrix.makeOrthographic(o,c,f,d,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var s=$t.prototype.toJSON.call(this,e);return s.object.zoom=this.zoom,s.object.left=this.left,s.object.right=this.right,s.object.top=this.top,s.object.bottom=this.bottom,s.object.near=this.near,s.object.far=this.far,this.view!==null&&(s.object.view=Object.assign({},this.view)),s}});function dy(){Pl.call(this,new Jh(-5,5,5,-5,.5,500))}dy.prototype=Object.assign(Object.create(Pl.prototype),{constructor:dy,isDirectionalLightShadow:!0,updateMatrices:function(e){Pl.prototype.updateMatrices.call(this,e)}});function zm(e,s){Ki.call(this,e,s),this.type="DirectionalLight",this.position.copy($t.DefaultUp),this.updateMatrix(),this.target=new $t,this.shadow=new dy}zm.prototype=Object.assign(Object.create(Ki.prototype),{constructor:zm,isDirectionalLight:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Hm(e,s){Ki.call(this,e,s),this.type="AmbientLight"}Hm.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Hm,isAmbientLight:!0});function km(e,s,t,a){Ki.call(this,e,s),this.type="RectAreaLight",this.width=t!==void 0?t:10,this.height=a!==void 0?a:10}km.prototype=Object.assign(Object.create(Ki.prototype),{constructor:km,isRectAreaLight:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var s=Ki.prototype.toJSON.call(this,e);return s.object.width=this.width,s.object.height=this.height,s}});var Vx=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new ee)}var s=e.prototype;return s.set=function(t){for(var a=0;a<9;a++)this.coefficients[a].copy(t[a]);return this},s.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},s.getAt=function(t,a){var o=t.x,c=t.y,f=t.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.282095),a.addScaledVector(d[1],.488603*c),a.addScaledVector(d[2],.488603*f),a.addScaledVector(d[3],.488603*o),a.addScaledVector(d[4],1.092548*(o*c)),a.addScaledVector(d[5],1.092548*(c*f)),a.addScaledVector(d[6],.315392*(3*f*f-1)),a.addScaledVector(d[7],1.092548*(o*f)),a.addScaledVector(d[8],.546274*(o*o-c*c)),a},s.getIrradianceAt=function(t,a){var o=t.x,c=t.y,f=t.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.886227),a.addScaledVector(d[1],2*.511664*c),a.addScaledVector(d[2],2*.511664*f),a.addScaledVector(d[3],2*.511664*o),a.addScaledVector(d[4],2*.429043*o*c),a.addScaledVector(d[5],2*.429043*c*f),a.addScaledVector(d[6],.743125*f*f-.247708),a.addScaledVector(d[7],2*.429043*o*f),a.addScaledVector(d[8],.429043*(o*o-c*c)),a},s.add=function(t){for(var a=0;a<9;a++)this.coefficients[a].add(t.coefficients[a]);return this},s.addScaledSH=function(t,a){for(var o=0;o<9;o++)this.coefficients[o].addScaledVector(t.coefficients[o],a);return this},s.scale=function(t){for(var a=0;a<9;a++)this.coefficients[a].multiplyScalar(t);return this},s.lerp=function(t,a){for(var o=0;o<9;o++)this.coefficients[o].lerp(t.coefficients[o],a);return this},s.equals=function(t){for(var a=0;a<9;a++)if(!this.coefficients[a].equals(t.coefficients[a]))return!1;return!0},s.copy=function(t){return this.set(t.coefficients)},s.clone=function(){return new this.constructor().copy(this)},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=this.coefficients,c=0;c<9;c++)o[c].fromArray(t,a+c*3);return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);for(var o=this.coefficients,c=0;c<9;c++)o[c].toArray(t,a+c*3);return t},e.getBasisAt=function(t,a){var o=t.x,c=t.y,f=t.z;a[0]=.282095,a[1]=.488603*c,a[2]=.488603*f,a[3]=.488603*o,a[4]=1.092548*o*c,a[5]=1.092548*c*f,a[6]=.315392*(3*f*f-1),a[7]=1.092548*o*f,a[8]=.546274*(o*o-c*c)},e}();function Is(e,s){Ki.call(this,void 0,s),this.type="LightProbe",this.sh=e!==void 0?e:new Vx}Is.prototype=Object.assign(Object.create(Ki.prototype),{constructor:Is,isLightProbe:!0,copy:function(e){return Ki.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var s=Ki.prototype.toJSON.call(this,e);return s.object.sh=this.sh.toArray(),s}});function Vm(e){Ii.call(this,e),this.textures={}}Vm.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Vm,load:function(e,s,t,a){var o=this,c=new Ps(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){var s=this.textures;function t(m){return s[m]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",m),s[m]}var a=new cR[e.type];if(e.uuid!==void 0&&(a.uuid=e.uuid),e.name!==void 0&&(a.name=e.name),e.color!==void 0&&a.color.setHex(e.color),e.roughness!==void 0&&(a.roughness=e.roughness),e.metalness!==void 0&&(a.metalness=e.metalness),e.sheen!==void 0&&(a.sheen=new Xt().setHex(e.sheen)),e.emissive!==void 0&&a.emissive.setHex(e.emissive),e.specular!==void 0&&a.specular.setHex(e.specular),e.shininess!==void 0&&(a.shininess=e.shininess),e.clearcoat!==void 0&&(a.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(a.fog=e.fog),e.flatShading!==void 0&&(a.flatShading=e.flatShading),e.blending!==void 0&&(a.blending=e.blending),e.combine!==void 0&&(a.combine=e.combine),e.side!==void 0&&(a.side=e.side),e.opacity!==void 0&&(a.opacity=e.opacity),e.transparent!==void 0&&(a.transparent=e.transparent),e.alphaTest!==void 0&&(a.alphaTest=e.alphaTest),e.depthTest!==void 0&&(a.depthTest=e.depthTest),e.depthWrite!==void 0&&(a.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(a.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(a.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(a.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(a.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(a.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(a.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(a.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(a.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(a.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(a.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(a.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(a.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(a.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(a.rotation=e.rotation),e.linewidth!==1&&(a.linewidth=e.linewidth),e.dashSize!==void 0&&(a.dashSize=e.dashSize),e.gapSize!==void 0&&(a.gapSize=e.gapSize),e.scale!==void 0&&(a.scale=e.scale),e.polygonOffset!==void 0&&(a.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(a.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(a.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(a.skinning=e.skinning),e.morphTargets!==void 0&&(a.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(a.morphNormals=e.morphNormals),e.dithering!==void 0&&(a.dithering=e.dithering),e.vertexTangents!==void 0&&(a.vertexTangents=e.vertexTangents),e.visible!==void 0&&(a.visible=e.visible),e.toneMapped!==void 0&&(a.toneMapped=e.toneMapped),e.userData!==void 0&&(a.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?a.vertexColors=e.vertexColors>0:a.vertexColors=e.vertexColors),e.uniforms!==void 0)for(var o in e.uniforms){var c=e.uniforms[o];switch(a.uniforms[o]={},c.type){case"t":a.uniforms[o].value=t(c.value);break;case"c":a.uniforms[o].value=new Xt().setHex(c.value);break;case"v2":a.uniforms[o].value=new xt().fromArray(c.value);break;case"v3":a.uniforms[o].value=new ee().fromArray(c.value);break;case"v4":a.uniforms[o].value=new Ti().fromArray(c.value);break;case"m3":a.uniforms[o].value=new aa().fromArray(c.value);break;case"m4":a.uniforms[o].value=new qn().fromArray(c.value);break;default:a.uniforms[o].value=c.value}}if(e.defines!==void 0&&(a.defines=e.defines),e.vertexShader!==void 0&&(a.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(a.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var f in e.extensions)a.extensions[f]=e.extensions[f];if(e.shading!==void 0&&(a.flatShading=e.shading===1),e.size!==void 0&&(a.size=e.size),e.sizeAttenuation!==void 0&&(a.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(a.map=t(e.map)),e.matcap!==void 0&&(a.matcap=t(e.matcap)),e.alphaMap!==void 0&&(a.alphaMap=t(e.alphaMap)),e.bumpMap!==void 0&&(a.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(a.bumpScale=e.bumpScale),e.normalMap!==void 0&&(a.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(a.normalMapType=e.normalMapType),e.normalScale!==void 0){var d=e.normalScale;Array.isArray(d)===!1&&(d=[d,d]),a.normalScale=new xt().fromArray(d)}return e.displacementMap!==void 0&&(a.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(a.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(a.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(a.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(a.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(a.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(a.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(a.specularMap=t(e.specularMap)),e.envMap!==void 0&&(a.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(a.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(a.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(a.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(a.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(a.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(a.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(a.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(a.gradientMap=t(e.gradientMap)),e.clearcoatMap!==void 0&&(a.clearcoatMap=t(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(a.clearcoatRoughnessMap=t(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(a.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(a.clearcoatNormalScale=new xt().fromArray(e.clearcoatNormalScale)),e.transmission!==void 0&&(a.transmission=e.transmission),e.transmissionMap!==void 0&&(a.transmissionMap=t(e.transmissionMap)),a},setTextures:function(e){return this.textures=e,this}});var py={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var s="",t=0,a=e.length;t<a;t++)s+=String.fromCharCode(e[t]);try{return decodeURIComponent(escape(s))}catch{return s}},extractUrlBase:function(e){var s=e.lastIndexOf("/");return s===-1?"./":e.substr(0,s+1)}};function Nd(){Ae.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Nd.prototype=Object.assign(Object.create(Ae.prototype),{constructor:Nd,isInstancedBufferGeometry:!0,copy:function(e){return Ae.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=Ae.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}});function Wm(e,s,t,a){typeof t=="number"&&(a=t,t=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),_n.call(this,e,s,t),this.meshPerAttribute=a||1}Wm.prototype=Object.assign(Object.create(_n.prototype),{constructor:Wm,isInstancedBufferAttribute:!0,copy:function(e){return _n.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=_n.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function qm(e){Ii.call(this,e)}qm.prototype=Object.assign(Object.create(Ii.prototype),{constructor:qm,load:function(e,s,t,a){var o=this,c=new Ps(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){var s={},t={};function a(et,gt){if(s[gt]!==void 0)return s[gt];var pt=et.interleavedBuffers,lt=pt[gt],St=o(et,lt.buffer),Ht=new Xm[lt.type](St),Ut=new us(Ht,lt.stride);return Ut.uuid=lt.uuid,s[gt]=Ut,Ut}function o(et,gt){if(t[gt]!==void 0)return t[gt];var pt=et.arrayBuffers,lt=pt[gt],St=new Uint32Array(lt).buffer;return t[gt]=St,St}var c=e.isInstancedBufferGeometry?new Nd:new Ae,f=e.data.index;if(f!==void 0){var d=new Xm[f.type](f.array);c.setIndex(new _n(d,1))}var m=e.data.attributes;for(var y in m){var w=m[y],M=void 0;if(w.isInterleavedBufferAttribute){var D=a(e.data,w.data);M=new Mc(D,w.itemSize,w.offset,w.normalized)}else{var P=new Xm[w.type](w.array),F=w.isInstancedBufferAttribute?Wm:_n;M=new F(P,w.itemSize,w.normalized)}w.name!==void 0&&(M.name=w.name),c.setAttribute(y,M)}var C=e.data.morphAttributes;if(C)for(var I in C){for(var q=C[I],J=[],Z=0,G=q.length;Z<G;Z++){var j=q[Z],ne=void 0;if(j.isInterleavedBufferAttribute){var se=a(e.data,j.data);ne=new Mc(se,j.itemSize,j.offset,j.normalized)}else{var Ee=new Xm[j.type](j.array);ne=new _n(Ee,j.itemSize,j.normalized)}j.name!==void 0&&(ne.name=j.name),J.push(ne)}c.morphAttributes[I]=J}var Be=e.data.morphTargetsRelative;Be&&(c.morphTargetsRelative=!0);var ce=e.data.groups||e.data.drawcalls||e.data.offsets;if(ce!==void 0)for(var oe=0,ie=ce.length;oe!==ie;++oe){var Ce=ce[oe];c.addGroup(Ce.start,Ce.count,Ce.materialIndex)}var De=e.data.boundingSphere;if(De!==void 0){var Oe=new ee;De.center!==void 0&&Oe.fromArray(De.center),c.boundingSphere=new ya(Oe,De.radius)}return e.name&&(c.name=e.name),e.userData&&(c.userData=e.userData),c}});var Xm={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},_R=function(e){en(s,e);function s(a){return e.call(this,a)||this}var t=s.prototype;return t.load=function(a,o,c,f){var d=this,m=this.path===""?py.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||m;var y=new Ps(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(this.withCredentials),y.load(a,function(w){var M=null;try{M=JSON.parse(w)}catch(P){f!==void 0&&f(P),console.error("THREE:ObjectLoader: Can't parse "+a+".",P.message);return}var D=M.metadata;if(D===void 0||D.type===void 0||D.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+a);return}d.parse(M,o)},c,f)},t.parse=function(a,o){var c=this.parseShape(a.shapes),f=this.parseGeometries(a.geometries,c),d=this.parseImages(a.images,function(){o!==void 0&&o(w)}),m=this.parseTextures(a.textures,d),y=this.parseMaterials(a.materials,m),w=this.parseObject(a.object,f,y);return a.animations&&(w.animations=this.parseAnimations(a.animations)),(a.images===void 0||a.images.length===0)&&o!==void 0&&o(w),w},t.parseShape=function(a){var o={};if(a!==void 0)for(var c=0,f=a.length;c<f;c++){var d=new Lc().fromJSON(a[c]);o[d.uuid]=d}return o},t.parseGeometries=function(a,o){var c={},f;if(a!==void 0)for(var d=new qm,m=0,y=a.length;m<y;m++){var w=void 0,M=a[m];switch(M.type){case"PlaneGeometry":case"PlaneBufferGeometry":w=new Pa[M.type](M.width,M.height,M.widthSegments,M.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":w=new Pa[M.type](M.width,M.height,M.depth,M.widthSegments,M.heightSegments,M.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":w=new Pa[M.type](M.radius,M.segments,M.thetaStart,M.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":w=new Pa[M.type](M.radiusTop,M.radiusBottom,M.height,M.radialSegments,M.heightSegments,M.openEnded,M.thetaStart,M.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":w=new Pa[M.type](M.radius,M.height,M.radialSegments,M.heightSegments,M.openEnded,M.thetaStart,M.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":w=new Pa[M.type](M.radius,M.widthSegments,M.heightSegments,M.phiStart,M.phiLength,M.thetaStart,M.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":w=new Pa[M.type](M.radius,M.detail);break;case"RingGeometry":case"RingBufferGeometry":w=new Pa[M.type](M.innerRadius,M.outerRadius,M.thetaSegments,M.phiSegments,M.thetaStart,M.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":w=new Pa[M.type](M.radius,M.tube,M.radialSegments,M.tubularSegments,M.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":w=new Pa[M.type](M.radius,M.tube,M.tubularSegments,M.radialSegments,M.p,M.q);break;case"TubeGeometry":case"TubeBufferGeometry":w=new Pa[M.type](new uy[M.path.type]().fromJSON(M.path),M.tubularSegments,M.radius,M.radialSegments,M.closed);break;case"LatheGeometry":case"LatheBufferGeometry":w=new Pa[M.type](M.points,M.segments,M.phiStart,M.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":w=new Pa[M.type](M.vertices,M.indices,M.radius,M.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":f=[];for(var D=0,P=M.shapes.length;D<P;D++){var F=o[M.shapes[D]];f.push(F)}w=new Pa[M.type](f,M.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":f=[];for(var C=0,I=M.shapes.length;C<I;C++){var q=o[M.shapes[C]];f.push(q)}var J=M.options.extrudePath;J!==void 0&&(M.options.extrudePath=new uy[J.type]().fromJSON(J)),w=new Pa[M.type](f,M.options);break;case"BufferGeometry":case"InstancedBufferGeometry":w=d.parse(M);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+M.type+'"');continue}w.uuid=M.uuid,M.name!==void 0&&(w.name=M.name),w.isBufferGeometry===!0&&M.userData!==void 0&&(w.userData=M.userData),c[M.uuid]=w}return c},t.parseMaterials=function(a,o){var c={},f={};if(a!==void 0){var d=new Vm;d.setTextures(o);for(var m=0,y=a.length;m<y;m++){var w=a[m];if(w.type==="MultiMaterial"){for(var M=[],D=0;D<w.materials.length;D++){var P=w.materials[D];c[P.uuid]===void 0&&(c[P.uuid]=d.parse(P)),M.push(c[P.uuid])}f[w.uuid]=M}else c[w.uuid]===void 0&&(c[w.uuid]=d.parse(w)),f[w.uuid]=c[w.uuid]}}return f},t.parseAnimations=function(a){for(var o=[],c=0;c<a.length;c++){var f=a[c],d=Cs.parse(f);f.uuid!==void 0&&(d.uuid=f.uuid),o.push(d)}return o},t.parseImages=function(a,o){var c=this,f={},d;function m(Z){return c.manager.itemStart(Z),d.load(Z,function(){c.manager.itemEnd(Z)},void 0,function(){c.manager.itemError(Z),c.manager.itemEnd(Z)})}if(a!==void 0&&a.length>0){var y=new iy(o);d=new Yh(y),d.setCrossOrigin(this.crossOrigin);for(var w=0,M=a.length;w<M;w++){var D=a[w],P=D.url;if(Array.isArray(P)){f[D.uuid]=[];for(var F=0,C=P.length;F<C;F++){var I=P[F],q=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(I)?I:c.resourcePath+I;f[D.uuid].push(m(q))}}else{var J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(D.url)?D.url:c.resourcePath+D.url;f[D.uuid]=m(J)}}}return f},t.parseTextures=function(a,o){function c(M,D){return typeof M=="number"?M:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",M),D[M])}var f={};if(a!==void 0)for(var d=0,m=a.length;d<m;d++){var y=a[d];y.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',y.uuid),o[y.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",y.image);var w=void 0;Array.isArray(o[y.image])?w=new qo(o[y.image]):w=new Si(o[y.image]),w.needsUpdate=!0,w.uuid=y.uuid,y.name!==void 0&&(w.name=y.name),y.mapping!==void 0&&(w.mapping=c(y.mapping,xR)),y.offset!==void 0&&w.offset.fromArray(y.offset),y.repeat!==void 0&&w.repeat.fromArray(y.repeat),y.center!==void 0&&w.center.fromArray(y.center),y.rotation!==void 0&&(w.rotation=y.rotation),y.wrap!==void 0&&(w.wrapS=c(y.wrap[0],Wx),w.wrapT=c(y.wrap[1],Wx)),y.format!==void 0&&(w.format=y.format),y.type!==void 0&&(w.type=y.type),y.encoding!==void 0&&(w.encoding=y.encoding),y.minFilter!==void 0&&(w.minFilter=c(y.minFilter,qx)),y.magFilter!==void 0&&(w.magFilter=c(y.magFilter,qx)),y.anisotropy!==void 0&&(w.anisotropy=y.anisotropy),y.flipY!==void 0&&(w.flipY=y.flipY),y.premultiplyAlpha!==void 0&&(w.premultiplyAlpha=y.premultiplyAlpha),y.unpackAlignment!==void 0&&(w.unpackAlignment=y.unpackAlignment),f[y.uuid]=w}return f},t.parseObject=function(a,o,c){var f;function d(Z){return o[Z]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",Z),o[Z]}function m(Z){if(Z!==void 0){if(Array.isArray(Z)){for(var G=[],j=0,ne=Z.length;j<ne;j++){var se=Z[j];c[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",se),G.push(c[se])}return G}return c[Z]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Z),c[Z]}}var y,w;switch(a.type){case"Scene":f=new Cv,a.background!==void 0&&Number.isInteger(a.background)&&(f.background=new Xt(a.background)),a.fog!==void 0&&(a.fog.type==="Fog"?f.fog=new ox(a.fog.color,a.fog.near,a.fog.far):a.fog.type==="FogExp2"&&(f.fog=new sx(a.fog.color,a.fog.density)));break;case"PerspectiveCamera":f=new Fi(a.fov,a.aspect,a.near,a.far),a.focus!==void 0&&(f.focus=a.focus),a.zoom!==void 0&&(f.zoom=a.zoom),a.filmGauge!==void 0&&(f.filmGauge=a.filmGauge),a.filmOffset!==void 0&&(f.filmOffset=a.filmOffset),a.view!==void 0&&(f.view=Object.assign({},a.view));break;case"OrthographicCamera":f=new Jh(a.left,a.right,a.top,a.bottom,a.near,a.far),a.zoom!==void 0&&(f.zoom=a.zoom),a.view!==void 0&&(f.view=Object.assign({},a.view));break;case"AmbientLight":f=new Hm(a.color,a.intensity);break;case"DirectionalLight":f=new zm(a.color,a.intensity);break;case"PointLight":f=new Gm(a.color,a.intensity,a.distance,a.decay);break;case"RectAreaLight":f=new km(a.color,a.intensity,a.width,a.height);break;case"SpotLight":f=new Um(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":f=new Bm(a.color,a.groundColor,a.intensity);break;case"LightProbe":f=new Is().fromJSON(a);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":y=d(a.geometry),w=m(a.material),f=new Bn(y,w);break;case"InstancedMesh":y=d(a.geometry),w=m(a.material);var M=a.count,D=a.instanceMatrix;f=new hm(y,w,M),f.instanceMatrix=new _n(new Float32Array(D.array),16);break;case"LOD":f=new bd;break;case"Line":f=new Rs(d(a.geometry),m(a.material),a.mode);break;case"LineLoop":f=new gm(d(a.geometry),m(a.material));break;case"LineSegments":f=new Ca(d(a.geometry),m(a.material));break;case"PointCloud":case"Points":f=new Hh(d(a.geometry),m(a.material));break;case"Sprite":f=new xd(m(a.material));break;case"Group":f=new wc;break;default:f=new $t}if(f.uuid=a.uuid,a.name!==void 0&&(f.name=a.name),a.matrix!==void 0?(f.matrix.fromArray(a.matrix),a.matrixAutoUpdate!==void 0&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(a.position!==void 0&&f.position.fromArray(a.position),a.rotation!==void 0&&f.rotation.fromArray(a.rotation),a.quaternion!==void 0&&f.quaternion.fromArray(a.quaternion),a.scale!==void 0&&f.scale.fromArray(a.scale)),a.castShadow!==void 0&&(f.castShadow=a.castShadow),a.receiveShadow!==void 0&&(f.receiveShadow=a.receiveShadow),a.shadow&&(a.shadow.bias!==void 0&&(f.shadow.bias=a.shadow.bias),a.shadow.normalBias!==void 0&&(f.shadow.normalBias=a.shadow.normalBias),a.shadow.radius!==void 0&&(f.shadow.radius=a.shadow.radius),a.shadow.mapSize!==void 0&&f.shadow.mapSize.fromArray(a.shadow.mapSize),a.shadow.camera!==void 0&&(f.shadow.camera=this.parseObject(a.shadow.camera))),a.visible!==void 0&&(f.visible=a.visible),a.frustumCulled!==void 0&&(f.frustumCulled=a.frustumCulled),a.renderOrder!==void 0&&(f.renderOrder=a.renderOrder),a.userData!==void 0&&(f.userData=a.userData),a.layers!==void 0&&(f.layers.mask=a.layers),a.children!==void 0)for(var P=a.children,F=0;F<P.length;F++)f.add(this.parseObject(P[F],o,c));if(a.type==="LOD"){a.autoUpdate!==void 0&&(f.autoUpdate=a.autoUpdate);for(var C=a.levels,I=0;I<C.length;I++){var q=C[I],J=f.getObjectByProperty("uuid",q.object);J!==void 0&&f.addLevel(J,q.distance)}}return f},t.setTexturePath=function(a){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(a)},s}(Ii),xR={UVMapping:Q,CubeReflectionMapping:Y,CubeRefractionMapping:He,EquirectangularReflectionMapping:Ge,EquirectangularRefractionMapping:ue,CubeUVReflectionMapping:Je,CubeUVRefractionMapping:ct},Wx={RepeatWrapping:Ft,ClampToEdgeWrapping:ut,MirroredRepeatWrapping:me},qx={NearestFilter:it,NearestMipmapNearestFilter:Rt,NearestMipmapLinearFilter:mt,LinearFilter:Nt,LinearMipmapNearestFilter:gn,LinearMipmapLinearFilter:gi};function my(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ii.call(this,e),this.options={premultiplyAlpha:"none"}}my.prototype=Object.assign(Object.create(Ii.prototype),{constructor:my,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,s,t,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=yu.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;var f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(e,f).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,o.options)}).then(function(d){yu.add(e,d),s&&s(d),o.manager.itemEnd(e)}).catch(function(d){a&&a(d),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}});function gy(){this.type="ShapePath",this.color=new Xt,this.subPaths=[],this.currentPath=null}Object.assign(gy.prototype,{moveTo:function(e,s){return this.currentPath=new po,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,s),this},lineTo:function(e,s){return this.currentPath.lineTo(e,s),this},quadraticCurveTo:function(e,s,t,a){return this.currentPath.quadraticCurveTo(e,s,t,a),this},bezierCurveTo:function(e,s,t,a,o,c){return this.currentPath.bezierCurveTo(e,s,t,a,o,c),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,s){function t(pt){for(var lt=[],St=0,Ht=pt.length;St<Ht;St++){var Ut=pt[St],rn=new Lc;rn.curves=Ut.curves,lt.push(rn)}return lt}function a(pt,lt){for(var St=lt.length,Ht=!1,Ut=St-1,rn=0;rn<St;Ut=rn++){var pn=lt[Ut],dt=lt[rn],Un=dt.x-pn.x,Dn=dt.y-pn.y;if(Math.abs(Dn)>Number.EPSILON){if(Dn<0&&(pn=lt[rn],Un=-Un,dt=lt[Ut],Dn=-Dn),pt.y<pn.y||pt.y>dt.y)continue;if(pt.y===pn.y){if(pt.x===pn.x)return!0}else{var wn=Dn*(pt.x-pn.x)-Un*(pt.y-pn.y);if(wn===0)return!0;if(wn<0)continue;Ht=!Ht}}else{if(pt.y!==pn.y)continue;if(dt.x<=pt.x&&pt.x<=pn.x||pn.x<=pt.x&&pt.x<=dt.x)return!0}}return Ht}var o=Ll.isClockWise,c=this.subPaths;if(c.length===0)return[];if(s===!0)return t(c);var f,d,m,y=[];if(c.length===1)return d=c[0],m=new Lc,m.curves=d.curves,y.push(m),y;var w=!o(c[0].getPoints());w=e?!w:w;var M=[],D=[],P=[],F=0,C;D[F]=void 0,P[F]=[];for(var I=0,q=c.length;I<q;I++)d=c[I],C=d.getPoints(),f=o(C),f=e?!f:f,f?(!w&&D[F]&&F++,D[F]={s:new Lc,p:C},D[F].s.curves=d.curves,w&&F++,P[F]=[]):P[F].push({h:d,p:C[0]});if(!D[0])return t(c);if(D.length>1){for(var J=!1,Z=[],G=0,j=D.length;G<j;G++)M[G]=[];for(var ne=0,se=D.length;ne<se;ne++)for(var Ee=P[ne],Be=0;Be<Ee.length;Be++){for(var ce=Ee[Be],oe=!0,ie=0;ie<D.length;ie++)a(ce.p,D[ie].p)&&(ne!==ie&&Z.push({froms:ne,tos:ie,hole:Be}),oe?(oe=!1,M[ie].push(ce)):J=!0);oe&&M[ne].push(ce)}Z.length>0&&(J||(P=M))}for(var Ce,De=0,Oe=D.length;De<Oe;De++){m=D[De].s,y.push(m),Ce=P[De];for(var et=0,gt=Ce.length;et<gt;et++)m.holes.push(Ce[et].h)}return y}});function vy(e){this.type="Font",this.data=e}Object.assign(vy.prototype,{isFont:!0,generateShapes:function(e,s){s===void 0&&(s=100);for(var t=[],a=bR(e,s,this.data),o=0,c=a.length;o<c;o++)Array.prototype.push.apply(t,a[o].toShapes());return t}});function bR(e,s,t){for(var a=Array.from?Array.from(e):String(e).split(""),o=s/t.resolution,c=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*o,f=[],d=0,m=0,y=0;y<a.length;y++){var w=a[y];if(w===`
`)d=0,m-=c;else{var M=wR(w,o,d,m,t);d+=M.offsetX,f.push(M.path)}}return f}function wR(e,s,t,a,o){var c=o.glyphs[e]||o.glyphs["?"];if(!c){console.error('THREE.Font: character "'+e+'" does not exists in font family '+o.familyName+".");return}var f=new gy,d,m,y,w,M,D,P,F;if(c.o)for(var C=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),I=0,q=C.length;I<q;){var J=C[I++];switch(J){case"m":d=C[I++]*s+t,m=C[I++]*s+a,f.moveTo(d,m);break;case"l":d=C[I++]*s+t,m=C[I++]*s+a,f.lineTo(d,m);break;case"q":y=C[I++]*s+t,w=C[I++]*s+a,M=C[I++]*s+t,D=C[I++]*s+a,f.quadraticCurveTo(M,D,y,w);break;case"b":y=C[I++]*s+t,w=C[I++]*s+a,M=C[I++]*s+t,D=C[I++]*s+a,P=C[I++]*s+t,F=C[I++]*s+a,f.bezierCurveTo(M,D,P,F,y,w);break}}return{offsetX:c.ha*s,path:f}}function yy(e){Ii.call(this,e)}yy.prototype=Object.assign(Object.create(Ii.prototype),{constructor:yy,load:function(e,s,t,a){var o=this,c=new Ps(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){var d;try{d=JSON.parse(f)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),d=JSON.parse(f.substring(65,f.length-2))}var m=o.parse(d);s&&s(m)},t,a)},parse:function(e){return new vy(e)}});var jm,_y={getContext:function(){return jm===void 0&&(jm=new(window.AudioContext||window.webkitAudioContext)),jm},setContext:function(e){jm=e}};function Ym(e){Ii.call(this,e)}Ym.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Ym,load:function(e,s,t,a){var o=this,c=new Ps(o.manager);c.setResponseType("arraybuffer"),c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{var d=f.slice(0),m=_y.getContext();m.decodeAudioData(d,function(y){s(y)})}catch(y){a?a(y):console.error(y),o.manager.itemError(e)}},t,a)}});function xy(e,s,t){Is.call(this,void 0,t);var a=new Xt().set(e),o=new Xt().set(s),c=new ee(a.r,a.g,a.b),f=new ee(o.r,o.g,o.b),d=Math.sqrt(Math.PI),m=d*Math.sqrt(.75);this.sh.coefficients[0].copy(c).add(f).multiplyScalar(d),this.sh.coefficients[1].copy(c).sub(f).multiplyScalar(m)}xy.prototype=Object.assign(Object.create(Is.prototype),{constructor:xy,isHemisphereLightProbe:!0,copy:function(e){return Is.prototype.copy.call(this,e),this},toJSON:function(e){var s=Is.prototype.toJSON.call(this,e);return s}});function by(e,s){Is.call(this,void 0,s);var t=new Xt().set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}by.prototype=Object.assign(Object.create(Is.prototype),{constructor:by,isAmbientLightProbe:!0,copy:function(e){return Is.prototype.copy.call(this,e),this},toJSON:function(e){var s=Is.prototype.toJSON.call(this,e);return s}});var Xx=new qn,jx=new qn;function Yx(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Fi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(Yx.prototype,{update:function(e){var s=this._cache,t=s.focus!==e.focus||s.fov!==e.fov||s.aspect!==e.aspect*this.aspect||s.near!==e.near||s.far!==e.far||s.zoom!==e.zoom||s.eyeSep!==this.eyeSep;if(t){s.focus=e.focus,s.fov=e.fov,s.aspect=e.aspect*this.aspect,s.near=e.near,s.far=e.far,s.zoom=e.zoom,s.eyeSep=this.eyeSep;var a=e.projectionMatrix.clone(),o=s.eyeSep/2,c=o*s.near/s.focus,f=s.near*Math.tan(Ln.DEG2RAD*s.fov*.5)/s.zoom,d,m;jx.elements[12]=-o,Xx.elements[12]=o,d=-f*s.aspect+c,m=f*s.aspect+c,a.elements[0]=2*s.near/(m-d),a.elements[8]=(m+d)/(m-d),this.cameraL.projectionMatrix.copy(a),d=-f*s.aspect-c,m=f*s.aspect-c,a.elements[0]=2*s.near/(m-d),a.elements[8]=(m+d)/(m-d),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(jx),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Xx)}});var Zx=function(){function e(t){this.autoStart=t!==void 0?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var s=e.prototype;return s.start=function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},s.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},s.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},s.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var a=(typeof performance>"u"?Date:performance).now();t=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=t}return t},e}(),_u=new ee,Jx=new Kr,MR=new ee,xu=new ee,SR=function(e){en(s,e);function s(){var a=e.call(this)||this;return a.type="AudioListener",a.context=_y.getContext(),a.gain=a.context.createGain(),a.gain.connect(a.context.destination),a.filter=null,a.timeDelta=0,a._clock=new Zx,a}var t=s.prototype;return t.getInput=function(){return this.gain},t.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},t.getFilter=function(){return this.filter},t.setFilter=function(a){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},t.getMasterVolume=function(){return this.gain.gain.value},t.setMasterVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},t.updateMatrixWorld=function(a){e.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,c=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_u,Jx,MR),xu.set(0,0,-1).applyQuaternion(Jx),o.positionX){var f=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(_u.x,f),o.positionY.linearRampToValueAtTime(_u.y,f),o.positionZ.linearRampToValueAtTime(_u.z,f),o.forwardX.linearRampToValueAtTime(xu.x,f),o.forwardY.linearRampToValueAtTime(xu.y,f),o.forwardZ.linearRampToValueAtTime(xu.z,f),o.upX.linearRampToValueAtTime(c.x,f),o.upY.linearRampToValueAtTime(c.y,f),o.upZ.linearRampToValueAtTime(c.z,f)}else o.setPosition(_u.x,_u.y,_u.z),o.setOrientation(xu.x,xu.y,xu.z,c.x,c.y,c.z)},s}($t),wy=function(e){en(s,e);function s(a){var o=e.call(this)||this;return o.type="Audio",o.listener=a,o.context=a.context,o.gain=o.context.createGain(),o.gain.connect(a.getInput()),o.autoplay=!1,o.buffer=null,o.detune=0,o.loop=!1,o.loopStart=0,o.loopEnd=0,o.offset=0,o.duration=void 0,o.playbackRate=1,o.isPlaying=!1,o.hasPlaybackControl=!0,o.source=null,o.sourceType="empty",o._startedAt=0,o._progress=0,o._connected=!1,o.filters=[],o}var t=s.prototype;return t.getOutput=function(){return this.gain},t.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},t.setMediaElementSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this},t.setMediaStreamSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),this.connect(),this},t.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this},t.play=function(a){if(a===void 0&&(a=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+a;var o=this.context.createBufferSource();return o.buffer=this.buffer,o.loop=this.loop,o.loopStart=this.loopStart,o.loopEnd=this.loopEnd,o.onended=this.onEnded.bind(this),o.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=o,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},t.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},t.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},t.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,o=this.filters.length;a<o;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},t.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,o=this.filters.length;a<o;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},t.getFilters=function(){return this.filters},t.setFilters=function(a){return a||(a=[]),this._connected===!0?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},t.setDetune=function(a){if(this.detune=a,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},t.getDetune=function(){return this.detune},t.getFilter=function(){return this.getFilters()[0]},t.setFilter=function(a){return this.setFilters(a?[a]:[])},t.setPlaybackRate=function(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=a,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},t.getPlaybackRate=function(){return this.playbackRate},t.onEnded=function(){this.isPlaying=!1},t.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},t.setLoop=function(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=a,this.isPlaying===!0&&(this.source.loop=this.loop),this},t.setLoopStart=function(a){return this.loopStart=a,this},t.setLoopEnd=function(a){return this.loopEnd=a,this},t.getVolume=function(){return this.gain.gain.value},t.setVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},s}($t),bu=new ee,Kx=new Kr,TR=new ee,wu=new ee,ER=function(e){en(s,e);function s(a){var o=e.call(this,a)||this;return o.panner=o.context.createPanner(),o.panner.panningModel="HRTF",o.panner.connect(o.gain),o}var t=s.prototype;return t.getOutput=function(){return this.panner},t.getRefDistance=function(){return this.panner.refDistance},t.setRefDistance=function(a){return this.panner.refDistance=a,this},t.getRolloffFactor=function(){return this.panner.rolloffFactor},t.setRolloffFactor=function(a){return this.panner.rolloffFactor=a,this},t.getDistanceModel=function(){return this.panner.distanceModel},t.setDistanceModel=function(a){return this.panner.distanceModel=a,this},t.getMaxDistance=function(){return this.panner.maxDistance},t.setMaxDistance=function(a){return this.panner.maxDistance=a,this},t.setDirectionalCone=function(a,o,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=c,this},t.updateMatrixWorld=function(a){if(e.prototype.updateMatrixWorld.call(this,a),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(bu,Kx,TR),wu.set(0,0,1).applyQuaternion(Kx);var o=this.panner;if(o.positionX){var c=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(bu.x,c),o.positionY.linearRampToValueAtTime(bu.y,c),o.positionZ.linearRampToValueAtTime(bu.z,c),o.orientationX.linearRampToValueAtTime(wu.x,c),o.orientationY.linearRampToValueAtTime(wu.y,c),o.orientationZ.linearRampToValueAtTime(wu.z,c)}else o.setPosition(bu.x,bu.y,bu.z),o.setOrientation(wu.x,wu.y,wu.z)}},s}(wy),$x=function(){function e(t,a){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=a!==void 0?a:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var s=e.prototype;return s.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},s.getAverageFrequency=function(){for(var t=0,a=this.getFrequencyData(),o=0;o<a.length;o++)t+=a[o];return t/a.length},e}();function My(e,s,t){this.binding=e,this.valueSize=t;var a,o,c;switch(s){case"quaternion":a=this._slerp,o=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":a=this._select,o=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:a=this._lerp,o=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=o,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(My.prototype,{accumulate:function(e,s){var t=this.buffer,a=this.valueSize,o=e*a+a,c=this.cumulativeWeight;if(c===0){for(var f=0;f!==a;++f)t[o+f]=t[f];c=s}else{c+=s;var d=s/c;this._mixBufferRegion(t,o,0,d,a)}this.cumulativeWeight=c},accumulateAdditive:function(e){var s=this.buffer,t=this.valueSize,a=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(s,a,0,e,t),this.cumulativeWeightAdditive+=e},apply:function(e){var s=this.valueSize,t=this.buffer,a=e*s+s,o=this.cumulativeWeight,c=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var d=s*this._origIndex;this._mixBufferRegion(t,a,d,1-o,s)}c>0&&this._mixBufferRegionAdditive(t,a,this._addIndex*s,1,s);for(var m=s;m!==s+s;++m)if(t[m]!==t[m+s]){f.setValue(t,a);break}},saveOriginalState:function(){var e=this.binding,s=this.buffer,t=this.valueSize,a=t*this._origIndex;e.getValue(s,a);for(var o=t;o!==a;++o)s[o]=s[a+o%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,s=e+this.valueSize,t=e;t<s;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,s=this._addIndex*this.valueSize,t=0;t<this.valueSize;t++)this.buffer[s+t]=this.buffer[e+t]},_select:function(e,s,t,a,o){if(a>=.5)for(var c=0;c!==o;++c)e[s+c]=e[t+c]},_slerp:function(e,s,t,a){Kr.slerpFlat(e,s,e,s,e,t,a)},_slerpAdditive:function(e,s,t,a,o){var c=this._workIndex*o;Kr.multiplyQuaternionsFlat(e,c,e,s,e,t),Kr.slerpFlat(e,s,e,s,e,c,a)},_lerp:function(e,s,t,a,o){for(var c=0;c!==o;++c){var f=s+c;e[f]=e[f]*(1-a)+e[t+c]*a}},_lerpAdditive:function(e,s,t,a,o){for(var c=0;c!==o;++c){var f=s+c;e[f]=e[f]+e[t+c]*a}}});var Sy="\\[\\]\\.:\\/",AR=new RegExp("["+Sy+"]","g"),Ty="[^"+Sy+"]",LR="[^"+Sy.replace("\\.","")+"]",RR=/((?:WC+[\/:])*)/.source.replace("WC",Ty),CR=/(WCOD+)?/.source.replace("WCOD",LR),PR=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ty),IR=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ty),DR=new RegExp("^"+RR+CR+PR+IR+"$"),OR=["material","materials","bones"];function Qx(e,s,t){var a=t||wa.parseTrackName(s);this._targetGroup=e,this._bindings=e.subscribe_(s,a)}Object.assign(Qx.prototype,{getValue:function(e,s){this.bind();var t=this._targetGroup.nCachedObjects_,a=this._bindings[t];a!==void 0&&a.getValue(e,s)},setValue:function(e,s){for(var t=this._bindings,a=this._targetGroup.nCachedObjects_,o=t.length;a!==o;++a)t[a].setValue(e,s)},bind:function(){for(var e=this._bindings,s=this._targetGroup.nCachedObjects_,t=e.length;s!==t;++s)e[s].bind()},unbind:function(){for(var e=this._bindings,s=this._targetGroup.nCachedObjects_,t=e.length;s!==t;++s)e[s].unbind()}});function wa(e,s,t){this.path=s,this.parsedPath=t||wa.parseTrackName(s),this.node=wa.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(wa,{Composite:Qx,create:function(e,s,t){return e&&e.isAnimationObjectGroup?new wa.Composite(e,s,t):new wa(e,s,t)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(AR,"")},parseTrackName:function(e){var s=DR.exec(e);if(!s)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},a=t.nodeName&&t.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){var o=t.nodeName.substring(a+1);OR.indexOf(o)!==-1&&(t.nodeName=t.nodeName.substring(0,a),t.objectName=o)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t},findNode:function(e,s){if(!s||s===""||s==="."||s===-1||s===e.name||s===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(s);if(t!==void 0)return t}if(e.children){var a=function c(f){for(var d=0;d<f.length;d++){var m=f[d];if(m.name===s||m.uuid===s)return m;var y=c(m.children);if(y)return y}return null},o=a(e.children);if(o)return o}return null}}),Object.assign(wa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,s){e[s]=this.node[this.propertyName]},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)e[s++]=t[a]},function(e,s){e[s]=this.resolvedProperty[this.propertyIndex]},function(e,s){this.resolvedProperty.toArray(e,s)}],SetterByBindingTypeAndVersioning:[[function(e,s){this.targetObject[this.propertyName]=e[s]},function(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.needsUpdate=!0},function(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++]},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++];this.targetObject.needsUpdate=!0},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){this.resolvedProperty[this.propertyIndex]=e[s]},function(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.needsUpdate=!0},function(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){this.resolvedProperty.fromArray(e,s)},function(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.needsUpdate=!0},function(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,s){this.bind(),this.getValue(e,s)},setValue:function(e,s){this.bind(),this.setValue(e,s)},bind:function(){var e=this.node,s=this.parsedPath,t=s.objectName,a=s.propertyName,o=s.propertyIndex;if(e||(e=wa.findNode(this.rootNode,s.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(t){var c=s.objectIndex;switch(t){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var f=0;f<e.length;f++)if(e[f].name===c){c=f;break}break;default:if(e[t]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[t]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}var d=e[a];if(d===void 0){var m=s.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+m+"."+a+" but it wasn't found.",e);return}var y=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?y=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(y=this.Versioning.MatrixWorldNeedsUpdate);var w=this.BindingType.Direct;if(o!==void 0){if(a==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}w=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=o}else d.fromArray!==void 0&&d.toArray!==void 0?(w=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(w=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=a;this.getValue=this.GetterByBindingType[w],this.setValue=this.SetterByBindingTypeAndVersioning[w][y]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(wa.prototype,{_getValue_unbound:wa.prototype.getValue,_setValue_unbound:wa.prototype.setValue});function eb(){this.uuid=Ln.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var s=0,t=arguments.length;s!==t;++s)e[arguments[s].uuid]=s;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}Object.assign(eb.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._paths,a=this._parsedPaths,o=this._bindings,c=o.length,f=void 0,d=e.length,m=this.nCachedObjects_,y=0,w=arguments.length;y!==w;++y){var M=arguments[y],D=M.uuid,P=s[D];if(P===void 0){P=d++,s[D]=P,e.push(M);for(var F=0;F!==c;++F)o[F].push(new wa(M,t[F],a[F]))}else if(P<m){f=e[P];var C=--m,I=e[C];s[I.uuid]=P,e[P]=I,s[D]=C,e[C]=M;for(var q=0;q!==c;++q){var J=o[q],Z=J[C],G=J[P];J[P]=Z,G===void 0&&(G=new wa(M,t[q],a[q])),J[C]=G}}else e[P]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=m},remove:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._bindings,a=t.length,o=this.nCachedObjects_,c=0,f=arguments.length;c!==f;++c){var d=arguments[c],m=d.uuid,y=s[m];if(y!==void 0&&y>=o){var w=o++,M=e[w];s[M.uuid]=y,e[y]=M,s[m]=w,e[w]=d;for(var D=0;D!==a;++D){var P=t[D],F=P[w],C=P[y];P[y]=F,P[w]=C}}}this.nCachedObjects_=o},uncache:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._bindings,a=t.length,o=this.nCachedObjects_,c=e.length,f=0,d=arguments.length;f!==d;++f){var m=arguments[f],y=m.uuid,w=s[y];if(w!==void 0)if(delete s[y],w<o){var M=--o,D=e[M],P=--c,F=e[P];s[D.uuid]=w,e[w]=D,s[F.uuid]=M,e[M]=F,e.pop();for(var C=0;C!==a;++C){var I=t[C],q=I[M],J=I[P];I[w]=q,I[M]=J,I.pop()}}else{var Z=--c,G=e[Z];s[G.uuid]=w,e[w]=G,e.pop();for(var j=0;j!==a;++j){var ne=t[j];ne[w]=ne[Z],ne.pop()}}}this.nCachedObjects_=o},subscribe_:function(e,s){var t=this._bindingsIndicesByPath,a=t[e],o=this._bindings;if(a!==void 0)return o[a];var c=this._paths,f=this._parsedPaths,d=this._objects,m=d.length,y=this.nCachedObjects_,w=new Array(m);a=o.length,t[e]=a,c.push(e),f.push(s),o.push(w);for(var M=y,D=d.length;M!==D;++M){var P=d[M];w[M]=new wa(P,e,s)}return w},unsubscribe_:function(e){var s=this._bindingsIndicesByPath,t=s[e];if(t!==void 0){var a=this._paths,o=this._parsedPaths,c=this._bindings,f=c.length-1,d=c[f],m=e[f];s[m]=t,c[t]=d,c.pop(),o[t]=o[f],o.pop(),a[t]=a[f],a.pop()}}});var NR=function(){function e(t,a,o,c){this._mixer=t,this._clip=a,this._localRoot=o||null,this.blendMode=c||a.blendMode;for(var f=a.tracks,d=f.length,m=new Array(d),y={endingStart:ml,endingEnd:ml},w=0;w!==d;++w){var M=f[w].createInterpolant(null);m[w]=M,M.settings=y}this._interpolantSettings=y,this._interpolants=m,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ii,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var s=e.prototype;return s.play=function(){return this._mixer._activateAction(this),this},s.stop=function(){return this._mixer._deactivateAction(this),this.reset()},s.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},s.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},s.isScheduled=function(){return this._mixer._isActiveAction(this)},s.startAt=function(t){return this._startTime=t,this},s.setLoop=function(t,a){return this.loop=t,this.repetitions=a,this},s.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},s.getEffectiveWeight=function(){return this._effectiveWeight},s.fadeIn=function(t){return this._scheduleFading(t,0,1)},s.fadeOut=function(t){return this._scheduleFading(t,1,0)},s.crossFadeFrom=function(t,a,o){if(t.fadeOut(a),this.fadeIn(a),o){var c=this._clip.duration,f=t._clip.duration;t.warp(1,f/c,a),this.warp(c/f,1,a)}return this},s.crossFadeTo=function(t,a,o){return t.crossFadeFrom(this,a,o)},s.stopFading=function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},s.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},s.getEffectiveTimeScale=function(){return this._effectiveTimeScale},s.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},s.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},s.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},s.warp=function(t,a,o){var c=this._mixer,f=c.time,d=this.timeScale,m=this._timeScaleInterpolant;m===null&&(m=c._lendControlInterpolant(),this._timeScaleInterpolant=m);var y=m.parameterPositions,w=m.sampleValues;return y[0]=f,y[1]=f+o,w[0]=t/d,w[1]=a/d,this},s.stopWarping=function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},s.getMixer=function(){return this._mixer},s.getClip=function(){return this._clip},s.getRoot=function(){return this._localRoot||this._mixer._root},s._update=function(t,a,o,c){if(!this.enabled){this._updateWeight(t);return}var f=this._startTime;if(f!==null){var d=(t-f)*o;if(d<0||o===0)return;this._startTime=null,a=o*d}a*=this._updateTimeScale(t);var m=this._updateTime(a),y=this._updateWeight(t);if(y>0){var w=this._interpolants,M=this._propertyBindings;switch(this.blendMode){case eo:for(var D=0,P=w.length;D!==P;++D)w[D].evaluate(m),M[D].accumulateAdditive(y);break;case Qs:default:for(var F=0,C=w.length;F!==C;++F)w[F].evaluate(m),M[F].accumulate(c,y)}}},s._updateWeight=function(t){var a=0;if(this.enabled){a=this.weight;var o=this._weightInterpolant;if(o!==null){var c=o.evaluate(t)[0];a*=c,t>o.parameterPositions[1]&&(this.stopFading(),c===0&&(this.enabled=!1))}}return this._effectiveWeight=a,a},s._updateTimeScale=function(t){var a=0;if(!this.paused){a=this.timeScale;var o=this._timeScaleInterpolant;if(o!==null){var c=o.evaluate(t)[0];a*=c,t>o.parameterPositions[1]&&(this.stopWarping(),a===0?this.paused=!0:this.timeScale=a)}}return this._effectiveTimeScale=a,a},s._updateTime=function(t){var a=this._clip.duration,o=this.loop,c=this.time+t,f=this._loopCount,d=o===Xp;if(t===0)return f===-1?c:d&&(f&1)===1?a-c:c;if(o===pl){f===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(c>=a)c=a;else if(c<0)c=0;else{this.time=c;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(f===-1&&(t>=0?(f=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),c>=a||c<0){var m=Math.floor(c/a);c-=a*m,f+=Math.abs(m);var y=this.repetitions-f;if(y<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,c=t>0?a:0,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(y===1){var w=t<0;this._setEndings(w,!w,d)}else this._setEndings(!1,!1,d);this._loopCount=f,this.time=c,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m})}}else this.time=c;if(d&&(f&1)===1)return a-c}return c},s._setEndings=function(t,a,o){var c=this._interpolantSettings;o?(c.endingStart=Do,c.endingEnd=Do):(t?c.endingStart=this.zeroSlopeAtStart?Do:ml:c.endingStart=ac,a?c.endingEnd=this.zeroSlopeAtEnd?Do:ml:c.endingEnd=ac)},s._scheduleFading=function(t,a,o){var c=this._mixer,f=c.time,d=this._weightInterpolant;d===null&&(d=c._lendControlInterpolant(),this._weightInterpolant=d);var m=d.parameterPositions,y=d.sampleValues;return m[0]=f,y[0]=a,m[1]=f+t,y[1]=o,this},e}();function Ey(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Ey.prototype=Object.assign(Object.create(rs.prototype),{constructor:Ey,_bindAction:function(e,s){var t=e._localRoot||this._root,a=e._clip.tracks,o=a.length,c=e._propertyBindings,f=e._interpolants,d=t.uuid,m=this._bindingsByRootAndName,y=m[d];y===void 0&&(y={},m[d]=y);for(var w=0;w!==o;++w){var M=a[w],D=M.name,P=y[D];if(P!==void 0)c[w]=P;else{if(P=c[w],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,d,D));continue}var F=s&&s._propertyBindings[w].binding.parsedPath;P=new My(wa.create(t,D,F),M.ValueTypeName,M.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,d,D),c[w]=P}f[w].resultBuffer=P.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var s=(e._localRoot||this._root).uuid,t=e._clip.uuid,a=this._actionsByClip[t];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,t,s)}for(var o=e._propertyBindings,c=0,f=o.length;c!==f;++c){var d=o[c];d.useCount++===0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var s=e._propertyBindings,t=0,a=s.length;t!==a;++t){var o=s[t];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var s=e._cacheIndex;return s!==null&&s<this._nActiveActions},_addInactiveAction:function(e,s,t){var a=this._actions,o=this._actionsByClip,c=o[s];if(c===void 0)c={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[s]=c;else{var f=c.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=a.length,a.push(e),c.actionByRoot[t]=e},_removeInactiveAction:function(e){var s=this._actions,t=s[s.length-1],a=e._cacheIndex;t._cacheIndex=a,s[a]=t,s.pop(),e._cacheIndex=null;var o=e._clip.uuid,c=this._actionsByClip,f=c[o],d=f.knownActions,m=d[d.length-1],y=e._byClipCacheIndex;m._byClipCacheIndex=y,d[y]=m,d.pop(),e._byClipCacheIndex=null;var w=f.actionByRoot,M=(e._localRoot||this._root).uuid;delete w[M],d.length===0&&delete c[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var s=e._propertyBindings,t=0,a=s.length;t!==a;++t){var o=s[t];--o.referenceCount===0&&this._removeInactiveBinding(o)}},_lendAction:function(e){var s=this._actions,t=e._cacheIndex,a=this._nActiveActions++,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_takeBackAction:function(e){var s=this._actions,t=e._cacheIndex,a=--this._nActiveActions,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_addInactiveBinding:function(e,s,t){var a=this._bindingsByRootAndName,o=this._bindings,c=a[s];c===void 0&&(c={},a[s]=c),c[t]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var s=this._bindings,t=e.binding,a=t.rootNode.uuid,o=t.path,c=this._bindingsByRootAndName,f=c[a],d=s[s.length-1],m=e._cacheIndex;d._cacheIndex=m,s[m]=d,s.pop(),delete f[o],Object.keys(f).length===0&&delete c[a]},_lendBinding:function(e){var s=this._bindings,t=e._cacheIndex,a=this._nActiveBindings++,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_takeBackBinding:function(e){var s=this._bindings,t=e._cacheIndex,a=--this._nActiveBindings,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_lendControlInterpolant:function(){var e=this._controlInterpolants,s=this._nActiveControlInterpolants++,t=e[s];return t===void 0&&(t=new Pd(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),t.__cacheIndex=s,e[s]=t),t},_takeBackControlInterpolant:function(e){var s=this._controlInterpolants,t=e.__cacheIndex,a=--this._nActiveControlInterpolants,o=s[a];e.__cacheIndex=a,s[a]=e,o.__cacheIndex=t,s[t]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,s,t){var a=s||this._root,o=a.uuid,c=typeof e=="string"?Cs.findByName(a,e):e,f=c!==null?c.uuid:e,d=this._actionsByClip[f],m=null;if(t===void 0&&(c!==null?t=c.blendMode:t=Qs),d!==void 0){var y=d.actionByRoot[o];if(y!==void 0&&y.blendMode===t)return y;m=d.knownActions[0],c===null&&(c=m._clip)}if(c===null)return null;var w=new NR(this,c,s,t);return this._bindAction(w,m),this._addInactiveAction(w,f,o),w},existingAction:function(e,s){var t=s||this._root,a=t.uuid,o=typeof e=="string"?Cs.findByName(t,e):e,c=o?o.uuid:e,f=this._actionsByClip[c];return f!==void 0&&f.actionByRoot[a]||null},stopAllAction:function(){for(var e=this._actions,s=this._nActiveActions,t=s-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var s=this._actions,t=this._nActiveActions,a=this.time+=e,o=Math.sign(e),c=this._accuIndex^=1,f=0;f!==t;++f){var d=s[f];d._update(a,e,o,c)}for(var m=this._bindings,y=this._nActiveBindings,w=0;w!==y;++w)m[w].apply(c);return this},setTime:function(e){this.time=0;for(var s=0;s<this._actions.length;s++)this._actions[s].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var s=this._actions,t=e.uuid,a=this._actionsByClip,o=a[t];if(o!==void 0){for(var c=o.knownActions,f=0,d=c.length;f!==d;++f){var m=c[f];this._deactivateAction(m);var y=m._cacheIndex,w=s[s.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,w._cacheIndex=y,s[y]=w,s.pop(),this._removeInactiveBindingsForAction(m)}delete a[t]}},uncacheRoot:function(e){var s=e.uuid,t=this._actionsByClip;for(var a in t){var o=t[a].actionByRoot,c=o[s];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}var f=this._bindingsByRootAndName,d=f[s];if(d!==void 0)for(var m in d){var y=d[m];y.restoreOriginalState(),this._removeInactiveBinding(y)}},uncacheAction:function(e,s){var t=this.existingAction(e,s);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}});var tb=function(){function e(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}var s=e.prototype;return s.clone=function(){return new e(this.value.clone===void 0?this.value:this.value.clone())},e}();function Ay(e,s,t){us.call(this,e,s),this.meshPerAttribute=t||1}Ay.prototype=Object.assign(Object.create(us.prototype),{constructor:Ay,isInstancedInterleavedBuffer:!0,copy:function(e){return us.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var s=us.prototype.clone.call(this,e);return s.meshPerAttribute=this.meshPerAttribute,s},toJSON:function(e){var s=us.prototype.toJSON.call(this,e);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}});function Ly(e,s,t,a,o){this.buffer=e,this.type=s,this.itemSize=t,this.elementSize=a,this.count=o,this.version=0}Object.defineProperty(Ly.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Ly.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,s){return this.type=e,this.elementSize=s,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}});function Ry(e,s,t,a){this.ray=new ss(e,s),this.near=t||0,this.far=a||1/0,this.camera=null,this.layers=new od,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function nb(e,s){return e.distance-s.distance}function Cy(e,s,t,a){if(e.layers.test(s.layers)&&e.raycast(s,t),a===!0)for(var o=e.children,c=0,f=o.length;c<f;c++)Cy(o[c],s,t,!0)}Object.assign(Ry.prototype,{set:function(e,s){this.ray.set(e,s)},setFromCamera:function(e,s){s&&s.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(s.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(s).sub(this.ray.origin).normalize(),this.camera=s):s&&s.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(s.near+s.far)/(s.near-s.far)).unproject(s),this.ray.direction.set(0,0,-1).transformDirection(s.matrixWorld),this.camera=s):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,s,t){var a=t||[];return Cy(e,this,a,s),a.sort(nb),a},intersectObjects:function(e,s,t){var a=t||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),a;for(var o=0,c=e.length;o<c;o++)Cy(e[o],this,a,s);return a.sort(nb),a}});var FR=function(){function e(t,a,o){return t===void 0&&(t=1),a===void 0&&(a=0),o===void 0&&(o=0),this.radius=t,this.phi=a,this.theta=o,this}var s=e.prototype;return s.set=function(t,a,o){return this.radius=t,this.phi=a,this.theta=o,this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},s.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},s.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},s.setFromCartesianCoords=function(t,a,o){return this.radius=Math.sqrt(t*t+a*a+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,o),this.phi=Math.acos(Ln.clamp(a/this.radius,-1,1))),this},e}(),BR=function(){function e(t,a,o){return this.radius=t!==void 0?t:1,this.theta=a!==void 0?a:0,this.y=o!==void 0?o:0,this}var s=e.prototype;return s.set=function(t,a,o){return this.radius=t,this.theta=a,this.y=o,this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},s.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},s.setFromCartesianCoords=function(t,a,o){return this.radius=Math.sqrt(t*t+o*o),this.theta=Math.atan2(t,o),this.y=a,this},e}(),ib=new xt,rb=function(){function e(t,a){Object.defineProperty(this,"isBox2",{value:!0}),this.min=t!==void 0?t:new xt(1/0,1/0),this.max=a!==void 0?a:new xt(-1/0,-1/0)}var s=e.prototype;return s.set=function(t,a){return this.min.copy(t),this.max.copy(a),this},s.setFromPoints=function(t){this.makeEmpty();for(var a=0,o=t.length;a<o;a++)this.expandByPoint(t[a]);return this},s.setFromCenterAndSize=function(t,a){var o=ib.copy(a).multiplyScalar(.5);return this.min.copy(t).sub(o),this.max.copy(t).add(o),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},s.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},s.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new xt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},s.getSize=function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new xt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},s.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},s.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},s.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},s.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},s.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},s.getParameter=function(t,a){return a===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),a=new xt),a.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},s.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},s.clampPoint=function(t,a){return a===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),a=new xt),a.copy(t).clamp(this.min,this.max)},s.distanceToPoint=function(t){var a=ib.copy(t).clamp(this.min,this.max);return a.sub(t).length()},s.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},s.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},s.translate=function(t){return this.min.add(t),this.max.add(t),this},s.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}(),ab=new ee,Zm=new ee,sb=function(){function e(t,a){this.start=t!==void 0?t:new ee,this.end=a!==void 0?a:new ee}var s=e.prototype;return s.set=function(t,a){return this.start.copy(t),this.end.copy(a),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ee),t.addVectors(this.start,this.end).multiplyScalar(.5)},s.delta=function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ee),t.subVectors(this.end,this.start)},s.distanceSq=function(){return this.start.distanceToSquared(this.end)},s.distance=function(){return this.start.distanceTo(this.end)},s.at=function(t,a){return a===void 0&&(console.warn("THREE.Line3: .at() target is now required"),a=new ee),this.delta(a).multiplyScalar(t).add(this.start)},s.closestPointToPointParameter=function(t,a){ab.subVectors(t,this.start),Zm.subVectors(this.end,this.start);var o=Zm.dot(Zm),c=Zm.dot(ab),f=c/o;return a&&(f=Ln.clamp(f,0,1)),f},s.closestPointToPoint=function(t,a,o){var c=this.closestPointToPointParameter(t,a);return o===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),o=new ee),this.delta(o).multiplyScalar(c).add(this.start)},s.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},s.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},e}();function Fd(e){$t.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Fd.prototype=Object.create($t.prototype),Fd.prototype.constructor=Fd,Fd.prototype.isImmediateRenderObject=!0;var ob=new ee,UR=function(e){en(s,e);function s(a,o){var c=e.call(this)||this;c.light=a,c.light.updateMatrixWorld(),c.matrix=a.matrixWorld,c.matrixAutoUpdate=!1,c.color=o;for(var f=new Ae,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],m=0,y=1,w=32;m<w;m++,y++){var M=m/w*Math.PI*2,D=y/w*Math.PI*2;d.push(Math.cos(M),Math.sin(M),1,Math.cos(D),Math.sin(D),1)}f.setAttribute("position",new x(d,3));var P=new ur({fog:!1,toneMapped:!1});return c.cone=new Ca(f,P),c.add(c.cone),c.update(),c}var t=s.prototype;return t.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},t.update=function(){this.light.updateMatrixWorld();var a=this.light.distance?this.light.distance:1e3,o=a*Math.tan(this.light.angle);this.cone.scale.set(o,o,a),ob.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ob),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},s}($t),Rc=new ee,Jm=new qn,Py=new qn,lb=function(e){en(s,e);function s(a){for(var o,c=cb(a),f=new Ae,d=[],m=[],y=new Xt(0,0,1),w=new Xt(0,1,0),M=0;M<c.length;M++){var D=c[M];D.parent&&D.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),m.push(y.r,y.g,y.b),m.push(w.r,w.g,w.b))}f.setAttribute("position",new x(d,3)),f.setAttribute("color",new x(m,3));var P=new ur({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return o=e.call(this,f,P)||this,o.type="SkeletonHelper",o.isSkeletonHelper=!0,o.root=a,o.bones=c,o.matrix=a.matrixWorld,o.matrixAutoUpdate=!1,o}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=this.bones,c=this.geometry,f=c.getAttribute("position");Py.getInverse(this.root.matrixWorld);for(var d=0,m=0;d<o.length;d++){var y=o[d];y.parent&&y.parent.isBone&&(Jm.multiplyMatrices(Py,y.matrixWorld),Rc.setFromMatrixPosition(Jm),f.setXYZ(m,Rc.x,Rc.y,Rc.z),Jm.multiplyMatrices(Py,y.parent.matrixWorld),Rc.setFromMatrixPosition(Jm),f.setXYZ(m+1,Rc.x,Rc.y,Rc.z),m+=2)}c.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,a)},s}(Ca);function cb(e){var s=[];e&&e.isBone&&s.push(e);for(var t=0;t<e.children.length;t++)s.push.apply(s,cb(e.children[t]));return s}var GR=function(e){en(s,e);function s(a,o,c){var f,d=new Em(o,4,2),m=new Fr({wireframe:!0,fog:!1,toneMapped:!1});return f=e.call(this,d,m)||this,f.light=a,f.light.updateMatrixWorld(),f.color=c,f.type="PointLightHelper",f.matrix=f.light.matrixWorld,f.matrixAutoUpdate=!1,f.update(),f}var t=s.prototype;return t.dispose=function(){this.geometry.dispose(),this.material.dispose()},t.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},s}(Bn),zR=new ee,ub=new Xt,hb=new Xt,HR=function(e){en(s,e);function s(a,o,c){var f=e.call(this)||this;f.light=a,f.light.updateMatrixWorld(),f.matrix=a.matrixWorld,f.matrixAutoUpdate=!1,f.color=c;var d=new Tm(o);d.rotateY(Math.PI*.5),f.material=new Fr({wireframe:!0,fog:!1,toneMapped:!1}),f.color===void 0&&(f.material.vertexColors=!0);var m=d.getAttribute("position"),y=new Float32Array(m.count*3);return d.setAttribute("color",new _n(y,3)),f.add(new Bn(d,f.material)),f.update(),f}var t=s.prototype;return t.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},t.update=function(){var a=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=a.geometry.getAttribute("color");ub.copy(this.light.color),hb.copy(this.light.groundColor);for(var c=0,f=o.count;c<f;c++){var d=c<f/2?ub:hb;o.setXYZ(c,d.r,d.g,d.b)}o.needsUpdate=!0}a.lookAt(zR.setFromMatrixPosition(this.light.matrixWorld).negate())},s}($t),fb=function(e){en(s,e);function s(t,a,o,c){var f;t=t||10,a=a||10,o=new Xt(o!==void 0?o:4473924),c=new Xt(c!==void 0?c:8947848);for(var d=a/2,m=t/a,y=t/2,w=[],M=[],D=0,P=0,F=-y;D<=a;D++,F+=m){w.push(-y,0,F,y,0,F),w.push(F,0,-y,F,0,y);var C=D===d?o:c;C.toArray(M,P),P+=3,C.toArray(M,P),P+=3,C.toArray(M,P),P+=3,C.toArray(M,P),P+=3}var I=new Ae;I.setAttribute("position",new x(w,3)),I.setAttribute("color",new x(M,3));var q=new ur({vertexColors:!0,toneMapped:!1});return f=e.call(this,I,q)||this,f.type="GridHelper",f}return s}(Ca),kR=function(e){en(s,e);function s(t,a,o,c,f,d){var m;t=t||10,a=a||16,o=o||8,c=c||64,f=new Xt(f!==void 0?f:4473924),d=new Xt(d!==void 0?d:8947848);for(var y=[],w=[],M=0;M<=a;M++){var D=M/a*(Math.PI*2),P=Math.sin(D)*t,F=Math.cos(D)*t;y.push(0,0,0),y.push(P,0,F);var C=M&1?f:d;w.push(C.r,C.g,C.b),w.push(C.r,C.g,C.b)}for(var I=0;I<=o;I++)for(var q=I&1?f:d,J=t-t/o*I,Z=0;Z<c;Z++){var G=Z/c*(Math.PI*2),j=Math.sin(G)*J,ne=Math.cos(G)*J;y.push(j,0,ne),w.push(q.r,q.g,q.b),G=(Z+1)/c*(Math.PI*2),j=Math.sin(G)*J,ne=Math.cos(G)*J,y.push(j,0,ne),w.push(q.r,q.g,q.b)}var se=new Ae;se.setAttribute("position",new x(y,3)),se.setAttribute("color",new x(w,3));var Ee=new ur({vertexColors:!0,toneMapped:!1});return m=e.call(this,se,Ee)||this,m.type="PolarGridHelper",m}return s}(Ca),db=new ee,Km=new ee,pb=new ee,VR=function(e){en(s,e);function s(a,o,c){var f=e.call(this)||this;f.light=a,f.light.updateMatrixWorld(),f.matrix=a.matrixWorld,f.matrixAutoUpdate=!1,f.color=c,o===void 0&&(o=1);var d=new Ae;d.setAttribute("position",new x([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3));var m=new ur({fog:!1,toneMapped:!1});return f.lightPlane=new Rs(d,m),f.add(f.lightPlane),d=new Ae,d.setAttribute("position",new x([0,0,0,0,0,1],3)),f.targetLine=new Rs(d,m),f.add(f.targetLine),f.update(),f}var t=s.prototype;return t.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},t.update=function(){db.setFromMatrixPosition(this.light.matrixWorld),Km.setFromMatrixPosition(this.light.target.matrixWorld),pb.subVectors(Km,db),this.lightPlane.lookAt(Km),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Km),this.targetLine.scale.z=pb.length()},s}($t),$m=new ee,Mr=new Ur,WR=function(e){en(s,e);function s(a){var o,c=new Ae,f=new ur({color:16777215,vertexColors:!0,toneMapped:!1}),d=[],m=[],y={},w=new Xt(16755200),M=new Xt(16711680),D=new Xt(43775),P=new Xt(16777215),F=new Xt(3355443);C("n1","n2",w),C("n2","n4",w),C("n4","n3",w),C("n3","n1",w),C("f1","f2",w),C("f2","f4",w),C("f4","f3",w),C("f3","f1",w),C("n1","f1",w),C("n2","f2",w),C("n3","f3",w),C("n4","f4",w),C("p","n1",M),C("p","n2",M),C("p","n3",M),C("p","n4",M),C("u1","u2",D),C("u2","u3",D),C("u3","u1",D),C("c","t",P),C("p","c",F),C("cn1","cn2",F),C("cn3","cn4",F),C("cf1","cf2",F),C("cf3","cf4",F);function C(q,J,Z){I(q,Z),I(J,Z)}function I(q,J){d.push(0,0,0),m.push(J.r,J.g,J.b),y[q]===void 0&&(y[q]=[]),y[q].push(d.length/3-1)}return c.setAttribute("position",new x(d,3)),c.setAttribute("color",new x(m,3)),o=e.call(this,c,f)||this,o.type="CameraHelper",o.camera=a,o.camera.updateProjectionMatrix&&o.camera.updateProjectionMatrix(),o.matrix=a.matrixWorld,o.matrixAutoUpdate=!1,o.pointMap=y,o.update(),o}var t=s.prototype;return t.update=function(){var a=this.geometry,o=this.pointMap,c=1,f=1;Mr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Rr("c",o,a,Mr,0,0,-1),Rr("t",o,a,Mr,0,0,1),Rr("n1",o,a,Mr,-c,-f,-1),Rr("n2",o,a,Mr,c,-f,-1),Rr("n3",o,a,Mr,-c,f,-1),Rr("n4",o,a,Mr,c,f,-1),Rr("f1",o,a,Mr,-c,-f,1),Rr("f2",o,a,Mr,c,-f,1),Rr("f3",o,a,Mr,-c,f,1),Rr("f4",o,a,Mr,c,f,1),Rr("u1",o,a,Mr,c*.7,f*1.1,-1),Rr("u2",o,a,Mr,-c*.7,f*1.1,-1),Rr("u3",o,a,Mr,0,f*2,-1),Rr("cf1",o,a,Mr,-c,0,1),Rr("cf2",o,a,Mr,c,0,1),Rr("cf3",o,a,Mr,0,-f,1),Rr("cf4",o,a,Mr,0,f,1),Rr("cn1",o,a,Mr,-c,0,-1),Rr("cn2",o,a,Mr,c,0,-1),Rr("cn3",o,a,Mr,0,-f,-1),Rr("cn4",o,a,Mr,0,f,-1),a.getAttribute("position").needsUpdate=!0},s}(Ca);function Rr(e,s,t,a,o,c,f){$m.set(o,c,f).unproject(a);var d=s[e];if(d!==void 0)for(var m=t.getAttribute("position"),y=0,w=d.length;y<w;y++)m.setXYZ(d[y],$m.x,$m.y,$m.z)}var Qm=new ws,mb=function(e){en(s,e);function s(a,o){var c;o===void 0&&(o=16776960);var f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(8*3),m=new Ae;return m.setIndex(new _n(f,1)),m.setAttribute("position",new _n(d,3)),c=e.call(this,m,new ur({color:o,toneMapped:!1}))||this,c.object=a,c.type="BoxHelper",c.matrixAutoUpdate=!1,c.update(),c}var t=s.prototype;return t.update=function(a){if(a!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Qm.setFromObject(this.object),!Qm.isEmpty()){var o=Qm.min,c=Qm.max,f=this.geometry.attributes.position,d=f.array;d[0]=c.x,d[1]=c.y,d[2]=c.z,d[3]=o.x,d[4]=c.y,d[5]=c.z,d[6]=o.x,d[7]=o.y,d[8]=c.z,d[9]=c.x,d[10]=o.y,d[11]=c.z,d[12]=c.x,d[13]=c.y,d[14]=o.z,d[15]=o.x,d[16]=c.y,d[17]=o.z,d[18]=o.x,d[19]=o.y,d[20]=o.z,d[21]=c.x,d[22]=o.y,d[23]=o.z,f.needsUpdate=!0,this.geometry.computeBoundingSphere()}},t.setFromObject=function(a){return this.object=a,this.update(),this},t.copy=function(a){return Ca.prototype.copy.call(this,a),this.object=a.object,this},s}(Ca),qR=function(e){en(s,e);function s(a,o){var c;o===void 0&&(o=16776960);var f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Ae;return d.setIndex(new _n(f,1)),d.setAttribute("position",new x([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),c=e.call(this,d,new ur({color:o,toneMapped:!1}))||this,c.box=a,c.type="Box3Helper",c.geometry.computeBoundingSphere(),c}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,a))},s}(Ca),XR=function(e){en(s,e);function s(a,o,c){var f,d=c!==void 0?c:16776960,m=new Ae;m.setAttribute("position",new x([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),m.computeBoundingSphere(),f=e.call(this,m,new ur({color:d,toneMapped:!1}))||this,f.type="PlaneHelper",f.plane=a,f.size=o===void 0?1:o;var y=new Ae;return y.setAttribute("position",new x([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),y.computeBoundingSphere(),f.add(new Bn(y,new Fr({color:d,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),f}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=-this.plane.constant;Math.abs(o)<1e-8&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=o<0?S:A,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,a)},s}(Rs),gb=new ee,eg,Iy,jR=function(e){en(s,e);function s(a,o,c,f,d,m){var y=e.call(this)||this;return y.type="ArrowHelper",a===void 0&&(a=new ee(0,0,1)),o===void 0&&(o=new ee(0,0,0)),c===void 0&&(c=1),f===void 0&&(f=16776960),d===void 0&&(d=.2*c),m===void 0&&(m=.2*d),eg===void 0&&(eg=new Ae,eg.setAttribute("position",new x([0,0,0,0,1,0],3)),Iy=new Td(0,.5,1,5,1),Iy.translate(0,-.5,0)),y.position.copy(o),y.line=new Rs(eg,new ur({color:f,toneMapped:!1})),y.line.matrixAutoUpdate=!1,y.add(y.line),y.cone=new Bn(Iy,new Fr({color:f,toneMapped:!1})),y.cone.matrixAutoUpdate=!1,y.add(y.cone),y.setDirection(a),y.setLength(c,d,m),y}var t=s.prototype;return t.setDirection=function(a){if(a.y>.99999)this.quaternion.set(0,0,0,1);else if(a.y<-.99999)this.quaternion.set(1,0,0,0);else{gb.set(a.z,0,-a.x).normalize();var o=Math.acos(a.y);this.quaternion.setFromAxisAngle(gb,o)}},t.setLength=function(a,o,c){o===void 0&&(o=.2*a),c===void 0&&(c=.2*o),this.line.scale.set(1,Math.max(1e-4,a-o),1),this.line.updateMatrix(),this.cone.scale.set(c,o,c),this.cone.position.y=a,this.cone.updateMatrix()},t.setColor=function(a){this.line.material.color.set(a),this.cone.material.color.set(a)},t.copy=function(a){return e.prototype.copy.call(this,a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this},s}($t),vb=function(e){en(s,e);function s(t){var a;t===void 0&&(t=1);var o=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],c=new Ae;c.setAttribute("position",new x(o,3)),c.setAttribute("color",new x([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var f=new ur({vertexColors:!0,toneMapped:!1});return a=e.call(this,c,f)||this,a.type="AxesHelper",a}return s}(Ca),Il,Kh=4,Cc=8,Jo=Math.pow(2,Cc),yb=[.125,.215,.35,.446,.526,.582],_b=Cc-Kh+1+yb.length,$h=20,Ko=(Il={},Il[Wr]=0,Il[gl]=1,Il[Oo]=2,Il[$f]=3,Il[$c]=4,Il[Qf]=5,Il[Kc]=6,Il),Dy=new Jh,Oy=JR(),Bd=Oy._lodPlanes,xb=Oy._sizeLods,tg=Oy._sigmas,Ny=null,Mu=(1+Math.sqrt(5))/2,Qh=1/Mu,bb=[new ee(1,1,1),new ee(-1,1,1),new ee(1,1,-1),new ee(-1,1,-1),new ee(0,Mu,Qh),new ee(0,Mu,-Qh),new ee(Qh,0,Mu),new ee(-Qh,0,Mu),new ee(Mu,Qh,0),new ee(-Mu,Qh,0)],YR=function(){function e(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=KR($h),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var s=e.prototype;return s.fromScene=function(t,a,o,c){a===void 0&&(a=0),o===void 0&&(o=.1),c===void 0&&(c=100),Ny=this._renderer.getRenderTarget();var f=this._allocateTargets();return this._sceneToCubeUV(t,o,c,f),a>0&&this._blur(f,0,0,a),this._applyPMREM(f),this._cleanup(f),f},s.fromEquirectangular=function(t){return this._fromTexture(t)},s.fromCubemap=function(t){return this._fromTexture(t)},s.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=Sb(),this._compileMaterial(this._cubemapShader))},s.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=Mb(),this._compileMaterial(this._equirectShader))},s.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var t=0;t<Bd.length;t++)Bd[t].dispose()},s._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Ny),t.scissorTest=!1,ng(t,0,0,t.width,t.height)},s._fromTexture=function(t){Ny=this._renderer.getRenderTarget();var a=this._allocateTargets(t);return this._textureToCubeUV(t,a),this._applyPMREM(a),this._cleanup(a),a},s._allocateTargets=function(t){var a={magFilter:it,minFilter:it,generateMipmaps:!1,type:Or,format:ht,encoding:ZR(t)?t.encoding:Oo,depthBuffer:!1},o=wb(a);return o.depthBuffer=!t,this._pingPongRenderTarget=wb(a),o},s._compileMaterial=function(t){var a=new Bn(Bd[0],t);this._renderer.compile(a,Dy)},s._sceneToCubeUV=function(t,a,o,c){var f=new Fi(90,1,a,o),d=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,w=y.outputEncoding,M=y.toneMapping,D=y.getClearColor(),P=y.getClearAlpha();y.toneMapping=we,y.outputEncoding=Wr;var F=t.background;if(F&&F.isColor){F.convertSRGBToLinear();var C=Math.max(F.r,F.g,F.b),I=Math.min(Math.max(Math.ceil(Math.log2(C)),-128),127);F=F.multiplyScalar(Math.pow(2,-I)),y.setClearColor(F,(I+128)/255),t.background=null}for(var q=0;q<6;q++){var J=q%3;J==0?(f.up.set(0,d[q],0),f.lookAt(m[q],0,0)):J==1?(f.up.set(0,0,d[q]),f.lookAt(0,m[q],0)):(f.up.set(0,d[q],0),f.lookAt(0,0,m[q])),ng(c,J*Jo,q>2?Jo:0,Jo,Jo),y.setRenderTarget(c),y.render(t,f)}y.toneMapping=M,y.outputEncoding=w,y.setClearColor(D,P)},s._textureToCubeUV=function(t,a){var o=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=Sb()):this._equirectShader==null&&(this._equirectShader=Mb());var c=t.isCubeTexture?this._cubemapShader:this._equirectShader,f=new Bn(Bd[0],c),d=c.uniforms;d.envMap.value=t,t.isCubeTexture||d.texelSize.value.set(1/t.image.width,1/t.image.height),d.inputEncoding.value=Ko[t.encoding],d.outputEncoding.value=Ko[a.texture.encoding],ng(a,0,0,3*Jo,2*Jo),o.setRenderTarget(a),o.render(f,Dy)},s._applyPMREM=function(t){var a=this._renderer,o=a.autoClear;a.autoClear=!1;for(var c=1;c<_b;c++){var f=Math.sqrt(tg[c]*tg[c]-tg[c-1]*tg[c-1]),d=bb[(c-1)%bb.length];this._blur(t,c-1,c,f,d)}a.autoClear=o},s._blur=function(t,a,o,c,f){var d=this._pingPongRenderTarget;this._halfBlur(t,d,a,o,c,"latitudinal",f),this._halfBlur(d,t,o,o,c,"longitudinal",f)},s._halfBlur=function(t,a,o,c,f,d,m){var y=this._renderer,w=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var M=new Bn(Bd[c],w),D=w.uniforms,P=xb[o]-1,F=isFinite(f)?Math.PI/(2*P):2*Math.PI/(2*$h-1),C=f/F,I=isFinite(f)?1+Math.floor(3*C):$h;I>$h&&console.warn("sigmaRadians, "+f+", is too large and will clip, as it requested "+I+" samples when the maximum is set to "+$h);for(var q=[],J=0,Z=0;Z<$h;++Z){var G=Z/C,j=Math.exp(-G*G/2);q.push(j),Z==0?J+=j:Z<I&&(J+=2*j)}for(var ne=0;ne<q.length;ne++)q[ne]=q[ne]/J;D.envMap.value=t.texture,D.samples.value=I,D.weights.value=q,D.latitudinal.value=d==="latitudinal",m&&(D.poleAxis.value=m),D.dTheta.value=F,D.mipInt.value=Cc-o,D.inputEncoding.value=Ko[t.texture.encoding],D.outputEncoding.value=Ko[t.texture.encoding];var se=xb[c],Ee=3*Math.max(0,Jo-2*se),Be=(c===0?0:2*Jo)+2*se*(c>Cc-Kh?c-Cc+Kh:0);ng(a,Ee,Be,3*se,2*se),y.setRenderTarget(a),y.render(M,Dy)},e}();function ZR(e){return e===void 0||e.type!==Or?!1:e.encoding===Wr||e.encoding===gl||e.encoding===Kc}function JR(){for(var e=[],s=[],t=[],a=Cc,o=0;o<_b;o++){var c=Math.pow(2,a);s.push(c);var f=1/c;o>Cc-Kh?f=yb[o-Cc+Kh-1]:o==0&&(f=0),t.push(f);for(var d=1/(c-1),m=-d/2,y=1+d/2,w=[m,m,y,m,y,y,m,m,y,y,m,y],M=6,D=6,P=3,F=2,C=1,I=new Float32Array(P*D*M),q=new Float32Array(F*D*M),J=new Float32Array(C*D*M),Z=0;Z<M;Z++){var G=Z%3*2/3-1,j=Z>2?0:-1;I.set([G,j,0,G+2/3,j,0,G+2/3,j+1,0,G,j,0,G+2/3,j+1,0,G,j+1,0],P*D*Z),q.set(w,F*D*Z);var ne=[Z,Z,Z,Z,Z,Z];J.set(ne,C*D*Z)}var se=new Ae;se.setAttribute("position",new _n(I,P)),se.setAttribute("uv",new _n(q,F)),se.setAttribute("faceIndex",new _n(J,C)),e.push(se),a>Kh&&a--}return{_lodPlanes:e,_sizeLods:s,_sigmas:t}}function wb(e){var s=new sa(3*Jo,3*Jo,e);return s.texture.mapping=Je,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function ng(e,s,t,a,o){e.viewport.set(s,t,a,o),e.scissor.set(s,t,a,o)}function KR(e){var s=new Float32Array(e),t=new ee(0,1,0),a=new Rl({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:Ko[Wr]},outputEncoding:{value:Ko[Wr]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+By()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return a}function Mb(){var e=new xt(1,1),s=new Rl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Ko[Wr]},outputEncoding:{value:Ko[Wr]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+By()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return s}function Sb(){var e=new Rl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ko[Wr]},outputEncoding:{value:Ko[Wr]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+By()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return e}function Fy(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function By(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}dn.create=function(e,s){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(dn.prototype),e.prototype.constructor=e,e.prototype.getPoint=s,e},Object.assign(Cl.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var s=this.getPoints(e);return this.createGeometry(s)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var s=this.getSpacedPoints(e);return this.createGeometry(s)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var s=new Bi,t=0,a=e.length;t<a;t++){var o=e[t];s.vertices.push(new ee(o.x,o.y,o.z||0))}return s}}),Object.assign(po.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}});function Tb(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ba.call(this,e),this.type="catmullrom",this.closed=!0}Tb.prototype=Object.create(ba.prototype);function Eb(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ba.call(this,e),this.type="catmullrom"}Eb.prototype=Object.create(ba.prototype);function Uy(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ba.call(this,e),this.type="catmullrom"}Uy.prototype=Object.create(ba.prototype),Object.assign(Uy.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),fb.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},lb.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ii.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),py.extractUrlBase(e)}}),Ii.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(rb.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(ws.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(ya.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),fd.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},sb.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Ln,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ln.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ln.ceilPowerOfTwo(e)}}),Object.assign(aa.prototype,{flattenToArrayOffset:function(e,s){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,s)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(qn.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,s){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,s)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new ee().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,s,t,a,o,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,s,a,t,o,c)}}),_a.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Kr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(ss.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(ka.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,s)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(ka,{barycoordFromPoint:function(e,s,t,a,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ka.getBarycoord(e,s,t,a,o)},normal:function(e,s,t,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ka.getNormal(e,s,t,a)}}),Object.assign(Lc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new qv(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jv(this,e)}}),Object.assign(xt.prototype,{fromAttribute:function(e,s,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ee.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,s){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(s,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,s,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ti.prototype,{fromAttribute:function(e,s,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Bi.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign($t.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,s){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(s,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties($t.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Bn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Bn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Kf},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(bd.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cm.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),lm.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(dn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Fi.prototype.setLens=function(e,s){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),s!==void 0&&(this.filmGauge=s),this.setFocalLength(e)},Object.defineProperties(Ki.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(_n.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===ki},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(ki)}}}),Object.assign(_n.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?ki:Qc),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ae.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,s){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(s&&s.isBufferAttribute)&&!(s&&s.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new _n(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(s),this):this.setAttribute(e,s)},addDrawCall:function(e,s,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,s)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Ae.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Nd.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(Ry.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(us.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===ki},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(us.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?ki:Qc),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Rd.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(Cv.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(tb.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(fn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Xt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===E}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Ac.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ec.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties($r.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(gd.prototype,{clearTarget:function(e,s,t,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(s,t,a)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(gd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?gl:Wr}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ix.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(sa.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(wy.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var s=this,t=new Ym;return t.load(e,function(a){s.setBuffer(a)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),$x.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ih.prototype.updateCubeMap=function(e,s){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,s)},gr.crossOrigin=void 0,gr.loadTexture=function(e,s,t,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var o=new Nm;o.setCrossOrigin(this.crossOrigin);var c=o.load(e,t,void 0,a);return s&&(c.mapping=s),c},gr.loadTextureCube=function(e,s,t,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var o=new Dm;o.setCrossOrigin(this.crossOrigin);var c=o.load(e,t,void 0,a);return s&&(c.mapping=s),c},gr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},gr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l}})),n.ACESFilmicToneMapping=Ze,n.AddEquation=ge,n.AddOperation=Re,n.AdditiveAnimationBlendMode=eo,n.AdditiveBlending=V,n.AlphaFormat=Ea,n.AlwaysDepth=At,n.AlwaysStencilFunc=td,n.AmbientLight=Hm,n.AmbientLightProbe=by,n.AnimationClip=Cs,n.AnimationLoader=ry,n.AnimationMixer=Ey,n.AnimationObjectGroup=eb,n.AnimationUtils=ir,n.ArcCurve=Zh,n.ArrayCamera=im,n.ArrowHelper=jR,n.Audio=wy,n.AudioAnalyser=$x,n.AudioContext=_y,n.AudioListener=SR,n.AudioLoader=Ym,n.AxesHelper=vb,n.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new vb(e)},n.BackSide=S,n.BasicDepthPacking=ed,n.BasicShadowMap=0,n.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Om(e)},n.Bone=Iv,n.BooleanKeyframeTrack=Rm,n.BoundingBoxHelper=function(e,s){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new mb(e,s)},n.Box2=rb,n.Box3=ws,n.Box3Helper=qR,n.BoxBufferGeometry=ls,n.BoxGeometry=Bv,n.BoxHelper=mb,n.BufferAttribute=_n,n.BufferGeometry=Ae,n.BufferGeometryLoader=qm,n.ByteType=er,n.Cache=yu,n.Camera=Ur,n.CameraHelper=WR,n.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},n.CanvasTexture=Md,n.CatmullRomCurve3=ba,n.CineonToneMapping=ze,n.CircleBufferGeometry=Uv,n.CircleGeometry=_x,n.ClampToEdgeWrapping=ut,n.Clock=Zx,n.ClosedSplineCurve3=Tb,n.Color=Xt,n.ColorKeyframeTrack=Cm,n.CompressedTexture=kh,n.CompressedTextureLoader=ay,n.ConeBufferGeometry=bx,n.ConeGeometry=xx,n.CubeCamera=Ih,n.CubeGeometry=Bv,n.CubeReflectionMapping=Y,n.CubeRefractionMapping=He,n.CubeTexture=qo,n.CubeTextureLoader=Dm,n.CubeUVReflectionMapping=Je,n.CubeUVRefractionMapping=ct,n.CubicBezierCurve=co,n.CubicBezierCurve3=Yo,n.CubicInterpolant=Am,n.CullFaceBack=h,n.CullFaceFront=p,n.CullFaceFrontBack=3,n.CullFaceNone=u,n.Curve=dn,n.CurvePath=Cl,n.CustomBlending=pe,n.CustomToneMapping=Xe,n.CylinderBufferGeometry=Td,n.CylinderGeometry=Gv,n.Cylindrical=BR,n.DataTexture=cu,n.DataTexture2DArray=Oh,n.DataTexture3D=Nh,n.DataTextureLoader=Om,n.DecrementStencilOp=7683,n.DecrementWrapStencilOp=34056,n.DefaultLoadingManager=Hx,n.DepthFormat=Bt,n.DepthStencilFormat=Cn,n.DepthTexture=Sd,n.DirectionalLight=zm,n.DirectionalLightHelper=VR,n.DiscreteInterpolant=Lm,n.DodecahedronBufferGeometry=zv,n.DodecahedronGeometry=wx,n.DoubleSide=R,n.DstAlphaFactor=Te,n.DstColorFactor=We,n.DynamicBufferAttribute=function(e,s){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new _n(e,s).setUsage(ki)},n.DynamicCopyUsage=35050,n.DynamicDrawUsage=ki,n.DynamicReadUsage=35049,n.EdgesGeometry=kv,n.EdgesHelper=function(e,s){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ca(new kv(e.geometry),new ur({color:s!==void 0?s:16777215}))},n.EllipseCurve=fs,n.EqualDepth=K,n.EqualStencilFunc=514,n.EquirectangularReflectionMapping=Ge,n.EquirectangularRefractionMapping=ue,n.Euler=Th,n.EventDispatcher=rs,n.ExtrudeBufferGeometry=Rd,n.ExtrudeGeometry=qv,n.Face3=ou,n.Face4=function(e,s,t,a,o,c,f){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ou(e,s,t,o,c,f)},n.FaceColors=1,n.FileLoader=Ps,n.FlatShading=E,n.Float32Attribute=function(e,s){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new x(e,s)},n.Float32BufferAttribute=x,n.Float64Attribute=function(e,s){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new T(e,s)},n.Float64BufferAttribute=T,n.FloatType=Ci,n.Fog=ox,n.FogExp2=sx,n.Font=vy,n.FontLoader=yy,n.FrontSide=A,n.Frustum=fd,n.GLBufferAttribute=Ly,n.GLSL1="100",n.GLSL3=eu,n.GammaEncoding=Kc,n.Geometry=Bi,n.GeometryUtils={merge:function(e,s,t){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var a;s.isMesh&&(s.matrixAutoUpdate&&s.updateMatrix(),a=s.matrix,s=s.geometry),e.merge(s,a,t)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},n.GreaterDepth=xe,n.GreaterEqualDepth=H,n.GreaterEqualStencilFunc=518,n.GreaterStencilFunc=516,n.GridHelper=fb,n.Group=wc,n.HalfFloatType=ns,n.HemisphereLight=Bm,n.HemisphereLightHelper=HR,n.HemisphereLightProbe=xy,n.IcosahedronBufferGeometry=Xv,n.IcosahedronGeometry=Rx,n.ImageBitmapLoader=my,n.ImageLoader=Yh,n.ImageUtils=gr,n.ImmediateRenderObject=Fd,n.IncrementStencilOp=7682,n.IncrementWrapStencilOp=34055,n.InstancedBufferAttribute=Wm,n.InstancedBufferGeometry=Nd,n.InstancedInterleavedBuffer=Ay,n.InstancedMesh=hm,n.Int16Attribute=function(e,s){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new El(e,s)},n.Int16BufferAttribute=El,n.Int32Attribute=function(e,s){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ae(e,s)},n.Int32BufferAttribute=ae,n.Int8Attribute=function(e,s){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new vc(e,s)},n.Int8BufferAttribute=vc,n.IntType=ma,n.InterleavedBuffer=us,n.InterleavedBufferAttribute=Mc,n.Interpolant=hs,n.InterpolateDiscrete=Zc,n.InterpolateLinear=Jc,n.InterpolateSmooth=xh,n.InvertStencilOp=5386,n.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},n.KeepStencilOp=No,n.KeyframeTrack=la,n.LOD=bd,n.LatheBufferGeometry=jv,n.LatheGeometry=Cx,n.Layers=od,n.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},n.LessDepth=nn,n.LessEqualDepth=Yt,n.LessEqualStencilFunc=515,n.LessStencilFunc=513,n.Light=Ki,n.LightProbe=Is,n.Line=Rs,n.Line3=sb,n.LineBasicMaterial=ur,n.LineCurve=qa,n.LineCurve3=uo,n.LineDashedMaterial=vu,n.LineLoop=gm,n.LinePieces=1,n.LineSegments=Ca,n.LineStrip=0,n.LinearEncoding=Wr,n.LinearFilter=Nt,n.LinearInterpolant=Pd,n.LinearMipMapLinearFilter=1008,n.LinearMipMapNearestFilter=1007,n.LinearMipmapLinearFilter=gi,n.LinearMipmapNearestFilter=gn,n.LinearToneMapping=Se,n.Loader=Ii,n.LoaderUtils=py,n.LoadingManager=iy,n.LogLuvEncoding=qr,n.LoopOnce=pl,n.LoopPingPong=Xp,n.LoopRepeat=ii,n.LuminanceAlphaFormat=Ke,n.LuminanceFormat=$e,n.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},n.Material=fn,n.MaterialLoader=Vm,n.Math=Ln,n.MathUtils=Ln,n.Matrix3=aa,n.Matrix4=qn,n.MaxEquation=tt,n.Mesh=Bn,n.MeshBasicMaterial=Fr,n.MeshDepthMaterial=xc,n.MeshDistanceMaterial=bc,n.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},n.MeshLambertMaterial=mu,n.MeshMatcapMaterial=gu,n.MeshNormalMaterial=pu,n.MeshPhongMaterial=Ac,n.MeshPhysicalMaterial=Ec,n.MeshStandardMaterial=jo,n.MeshToonMaterial=du,n.MinEquation=Ie,n.MirroredRepeatWrapping=me,n.MixOperation=be,n.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},n.MultiplyBlending=O,n.MultiplyOperation=de,n.NearestFilter=it,n.NearestMipMapLinearFilter=1005,n.NearestMipMapNearestFilter=1004,n.NearestMipmapLinearFilter=mt,n.NearestMipmapNearestFilter=Rt,n.NeverDepth=nt,n.NeverStencilFunc=512,n.NoBlending=N,n.NoColors=0,n.NoToneMapping=we,n.NormalAnimationBlendMode=Qs,n.NormalBlending=W,n.NotEqualDepth=te,n.NotEqualStencilFunc=517,n.NumberKeyframeTrack=Xh,n.Object3D=$t,n.ObjectLoader=_R,n.ObjectSpaceNormalMap=jp,n.OctahedronBufferGeometry=Tm,n.OctahedronGeometry=Px,n.OneFactor=ft,n.OneMinusDstAlphaFactor=Ve,n.OneMinusDstColorFactor=at,n.OneMinusSrcAlphaFactor=Le,n.OneMinusSrcColorFactor=Ne,n.OrthographicCamera=Jh,n.PCFShadowMap=g,n.PCFSoftShadowMap=_,n.PMREMGenerator=YR,n.ParametricBufferGeometry=qh,n.ParametricGeometry=Cd,n.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new xd(e)},n.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new oo(e)},n.ParticleSystem=function(e,s){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Hh(e,s)},n.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new oo(e)},n.Path=po,n.PerspectiveCamera=Fi,n.Plane=_a,n.PlaneBufferGeometry=nm,n.PlaneGeometry=Ix,n.PlaneHelper=XR,n.PointCloud=function(e,s){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Hh(e,s)},n.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new oo(e)},n.PointLight=Gm,n.PointLightHelper=GR,n.Points=Hh,n.PointsMaterial=oo,n.PolarGridHelper=kR,n.PolyhedronBufferGeometry=hu,n.PolyhedronGeometry=Dx,n.PositionalAudio=ER,n.PropertyBinding=wa,n.PropertyMixer=My,n.QuadraticBezierCurve=ho,n.QuadraticBezierCurve3=Zo,n.Quaternion=Kr,n.QuaternionKeyframeTrack=Id,n.QuaternionLinearInterpolant=Pm,n.REVISION=l,n.RGBADepthPacking=to,n.RGBAFormat=re,n.RGBAIntegerFormat=on,n.RGBA_ASTC_10x10_Format=qf,n.RGBA_ASTC_10x5_Format=Hp,n.RGBA_ASTC_10x6_Format=kp,n.RGBA_ASTC_10x8_Format=nc,n.RGBA_ASTC_12x10_Format=Vp,n.RGBA_ASTC_12x12_Format=Xf,n.RGBA_ASTC_4x4_Format=Hf,n.RGBA_ASTC_5x4_Format=yh,n.RGBA_ASTC_5x5_Format=kf,n.RGBA_ASTC_6x5_Format=Vf,n.RGBA_ASTC_6x6_Format=Up,n.RGBA_ASTC_8x5_Format=Gp,n.RGBA_ASTC_8x6_Format=zp,n.RGBA_ASTC_8x8_Format=Wf,n.RGBA_BPTC_Format=Aa,n.RGBA_ETC2_EAC_Format=vh,n.RGBA_PVRTC_2BPPV1_Format=Js,n.RGBA_PVRTC_4BPPV1_Format=Lr,n.RGBA_S3TC_DXT1_Format=xr,n.RGBA_S3TC_DXT3_Format=li,n.RGBA_S3TC_DXT5_Format=tr,n.RGBDEncoding=Qf,n.RGBEEncoding=Oo,n.RGBEFormat=ht,n.RGBFormat=is,n.RGBIntegerFormat=Zi,n.RGBM16Encoding=$c,n.RGBM7Encoding=$f,n.RGB_ETC1_Format=br,n.RGB_ETC2_Format=Ks,n.RGB_PVRTC_2BPPV1_Format=Zs,n.RGB_PVRTC_4BPPV1_Format=cr,n.RGB_S3TC_DXT1_Format=oi,n.RGFormat=An,n.RGIntegerFormat=Yi,n.RawShaderMaterial=Rl,n.Ray=ss,n.Raycaster=Ry,n.RectAreaLight=km,n.RedFormat=In,n.RedIntegerFormat=Yn,n.ReinhardToneMapping=Pe,n.RepeatWrapping=Ft,n.ReplaceStencilOp=7681,n.ReverseSubtractEquation=$,n.RingBufferGeometry=Yv,n.RingGeometry=Ox,n.SRGB8_ALPHA8_ASTC_10x10_Format=Jf,n.SRGB8_ALPHA8_ASTC_10x5_Format=Zf,n.SRGB8_ALPHA8_ASTC_10x6_Format=$s,n.SRGB8_ALPHA8_ASTC_10x8_Format=qp,n.SRGB8_ALPHA8_ASTC_12x10_Format=Yc,n.SRGB8_ALPHA8_ASTC_12x12_Format=La,n.SRGB8_ALPHA8_ASTC_4x4_Format=ic,n.SRGB8_ALPHA8_ASTC_5x4_Format=dl,n.SRGB8_ALPHA8_ASTC_5x5_Format=Wp,n.SRGB8_ALPHA8_ASTC_6x5_Format=Mi,n.SRGB8_ALPHA8_ASTC_6x6_Format=rc,n.SRGB8_ALPHA8_ASTC_8x5_Format=_h,n.SRGB8_ALPHA8_ASTC_8x6_Format=jf,n.SRGB8_ALPHA8_ASTC_8x8_Format=Yf,n.Scene=Cv,n.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},n.ShaderChunk=$n,n.ShaderLib=so,n.ShaderMaterial=$r,n.ShadowMaterial=fu,n.Shape=Lc,n.ShapeBufferGeometry=Zv,n.ShapeGeometry=Jv,n.ShapePath=gy,n.ShapeUtils=Ll,n.ShortType=Vr,n.Skeleton=cm,n.SkeletonHelper=lb,n.SkinnedMesh=lm,n.SmoothShading=2,n.Sphere=ya,n.SphereBufferGeometry=Em,n.SphereGeometry=Nx,n.Spherical=FR,n.SphericalHarmonics3=Vx,n.Spline=Uy,n.SplineCurve=fo,n.SplineCurve3=Eb,n.SpotLight=Um,n.SpotLightHelper=UR,n.Sprite=xd,n.SpriteMaterial=Sc,n.SrcAlphaFactor=Ue,n.SrcAlphaSaturateFactor=Tt,n.SrcColorFactor=je,n.StaticCopyUsage=35046,n.StaticDrawUsage=Qc,n.StaticReadUsage=35045,n.StereoCamera=Yx,n.StreamCopyUsage=35042,n.StreamDrawUsage=35040,n.StreamReadUsage=35041,n.StringKeyframeTrack=Im,n.SubtractEquation=ye,n.SubtractiveBlending=B,n.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},n.TangentSpaceNormalMap=vl,n.TetrahedronBufferGeometry=Kv,n.TetrahedronGeometry=Fx,n.TextBufferGeometry=$v,n.TextGeometry=Bx,n.Texture=Si,n.TextureLoader=Nm,n.TorusBufferGeometry=Qv,n.TorusGeometry=Ux,n.TorusKnotBufferGeometry=ey,n.TorusKnotGeometry=Gx,n.Triangle=ka,n.TriangleFanDrawMode=2,n.TriangleStripDrawMode=1,n.TrianglesDrawMode=Kf,n.TubeBufferGeometry=ty,n.TubeGeometry=zx,n.UVMapping=Q,n.Uint16Attribute=function(e,s){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Al(e,s)},n.Uint16BufferAttribute=Al,n.Uint32Attribute=function(e,s){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new v(e,s)},n.Uint32BufferAttribute=v,n.Uint8Attribute=function(e,s){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new lu(e,s)},n.Uint8BufferAttribute=lu,n.Uint8ClampedAttribute=function(e,s){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Tl(e,s)},n.Uint8ClampedBufferAttribute=Tl,n.Uniform=tb,n.UniformsLib=Wt,n.UniformsUtils=Wo,n.UnsignedByteType=Or,n.UnsignedInt248Type=va,n.UnsignedIntType=ji,n.UnsignedShort4444Type=ga,n.UnsignedShort5551Type=bs,n.UnsignedShort565Type=mr,n.UnsignedShortType=Ys,n.VSMShadowMap=b,n.Vector2=xt,n.Vector3=ee,n.Vector4=Ti,n.VectorKeyframeTrack=jh,n.Vertex=function(e,s,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ee(e,s,t)},n.VertexColors=2,n.VideoTexture=Nv,n.WebGL1Renderer=Rv,n.WebGLCubeRenderTarget=yc,n.WebGLMultisampleRenderTarget=Ha,n.WebGLRenderTarget=sa,n.WebGLRenderTargetCube=function(e,s,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new yc(e,t)},n.WebGLRenderer=gd,n.WebGLUtils=rx,n.WireframeGeometry=ny,n.WireframeHelper=function(e,s){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ca(new ny(e.geometry),new ur({color:s!==void 0?s:16777215}))},n.WrapAroundEnding=ac,n.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ps(e)},n.ZeroCurvatureEnding=ml,n.ZeroFactor=qe,n.ZeroSlopeEnding=Do,n.ZeroStencilOp=0,n.sRGBEncoding=gl,Object.defineProperty(n,"__esModule",{value:!0})})}),sn=Os(ms);ms.GLTFLoader;const Hr="121",kr={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ta={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},yo=0,_o=1,Er=2,ei=1,Fl=2,Ya=3,Fs=0,ti=1,jr=2,$o=1,Za=0,Na=1,Ic=2,Lu=3,xo=4,Dc=5,bo=100,Ru=101,En=102,Pn=103,Pr=104,sr=200,bn=201,rt=202,It=203,ln=204,cn=205,Gi=206,pi=207,$i=208,Di=209,Ir=210,Ai=0,Xn=1,Li=2,zi=3,or=4,tn=5,Nn=6,Wi=7,mi=0,jn=1,si=2,Jt=0,Yr=1,ua=2,Ar=3,Fa=4,gs=5,Bl=300,wo=301,Qo=302,Cu=303,Gd=304,rf=306,Ul=307,Gl=1e3,na=1001,wt=1002,Et=1003,Vn=1004,Oi=1005,Rn=1006,Dr=1007,Pu=1008,Oc=1009,Db=1010,Ob=1011,zd=1012,Nb=1013,Hd=1014,Bs=1015,Nc=1016,Fb=1017,Bb=1018,Ub=1019,af=1020,Gb=1021,Mo=1022,vs=1023,zb=1024,Hb=1025,kb=vs,Iu=1026,sf=1027,Vb=1028,Wb=1029,qb=1030,Xb=1031,jb=1032,Yb=1033,zy=33776,Hy=33777,ky=33778,Vy=33779,Wy=35840,qy=35841,Xy=35842,jy=35843,Zb=36196,Yy=37492,Zy=37496,Jb=37808,Kb=37809,$b=37810,Qb=37811,ew=37812,tw=37813,nw=37814,iw=37815,rw=37816,aw=37817,sw=37818,ow=37819,lw=37820,cw=37821,uw=36492,hw=37840,fw=37841,dw=37842,pw=37843,mw=37844,gw=37845,vw=37846,yw=37847,_w=37848,xw=37849,bw=37850,ww=37851,Mw=37852,Sw=37853,Tw=2200,Ew=2201,Aw=2202,of=2300,Du=2301,sg=2302,Ou=2400,Nu=2401,kd=2402,og=2500,Jy=2501,Lw=0,Rw=1,Ky=2,Fc=3e3,Vd=3001,Cw=3007,$y=3002,Pw=3003,Iw=3004,Dw=3005,Ow=3006,Nw=3200,Fw=3201,Bc=0,Bw=1,lg=7680,Uw=519,Wd=35044,lf=35048,Qy="300 es";function Us(){}Object.assign(Us.prototype,{addEventListener:function(r,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[r]===void 0&&(n[r]=[]),n[r].indexOf(i)===-1&&n[r].push(i)},hasEventListener:function(r,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[r]!==void 0&&n[r].indexOf(i)!==-1},removeEventListener:function(r,i){if(this._listeners===void 0)return;const l=this._listeners[r];if(l!==void 0){const u=l.indexOf(i);u!==-1&&l.splice(u,1)}},dispatchEvent:function(r){if(this._listeners===void 0)return;const n=this._listeners[r.type];if(n!==void 0){r.target=this;const l=n.slice(0);for(let u=0,h=l.length;u<h;u++)l[u].call(this,r)}}});const ia=[];for(let r=0;r<256;r++)ia[r]=(r<16?"0":"")+r.toString(16);let qd=1234567;const zn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const r=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return(ia[r&255]+ia[r>>8&255]+ia[r>>16&255]+ia[r>>24&255]+"-"+ia[i&255]+ia[i>>8&255]+"-"+ia[i>>16&15|64]+ia[i>>24&255]+"-"+ia[n&63|128]+ia[n>>8&255]+"-"+ia[n>>16&255]+ia[n>>24&255]+ia[l&255]+ia[l>>8&255]+ia[l>>16&255]+ia[l>>24&255]).toUpperCase()},clamp:function(r,i,n){return Math.max(i,Math.min(n,r))},euclideanModulo:function(r,i){return(r%i+i)%i},mapLinear:function(r,i,n,l,u){return l+(r-i)*(u-l)/(n-i)},lerp:function(r,i,n){return(1-n)*r+n*i},smoothstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*(3-2*r))},smootherstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*r*(r*(r*6-15)+10))},randInt:function(r,i){return r+Math.floor(Math.random()*(i-r+1))},randFloat:function(r,i){return r+Math.random()*(i-r)},randFloatSpread:function(r){return r*(.5-Math.random())},seededRandom:function(r){return r!==void 0&&(qd=r%2147483647),qd=qd*16807%2147483647,(qd-1)/2147483646},degToRad:function(r){return r*zn.DEG2RAD},radToDeg:function(r){return r*zn.RAD2DEG},isPowerOfTwo:function(r){return(r&r-1)===0&&r!==0},ceilPowerOfTwo:function(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},floorPowerOfTwo:function(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},setQuaternionFromProperEuler:function(r,i,n,l,u){const h=Math.cos,p=Math.sin,g=h(n/2),_=p(n/2),b=h((i+l)/2),A=p((i+l)/2),S=h((i-l)/2),R=p((i-l)/2),E=h((l-i)/2),N=p((l-i)/2);switch(u){case"XYX":r.set(g*A,_*S,_*R,g*b);break;case"YZY":r.set(_*R,g*A,_*S,g*b);break;case"ZXZ":r.set(_*S,_*R,g*A,g*b);break;case"XZX":r.set(g*A,_*N,_*E,g*b);break;case"YXY":r.set(_*E,g*A,_*N,g*b);break;case"ZYZ":r.set(_*N,_*E,g*A,g*b);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+u)}}};class bt{constructor(i=0,n=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=i,this.y=n}get width(){return this.x}set width(i){this.x=i}get height(){return this.y}set height(i){this.y=i}set(i,n){return this.x=i,this.y=n,this}setScalar(i){return this.x=i,this.y=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y)}copy(i){return this.x=i.x,this.y=i.y,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this)}addScalar(i){return this.x+=i,this.y+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this)}subScalar(i){return this.x-=i,this.y-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this}multiply(i){return this.x*=i.x,this.y*=i.y,this}multiplyScalar(i){return this.x*=i,this.y*=i,this}divide(i){return this.x/=i.x,this.y/=i.y,this}divideScalar(i){return this.multiplyScalar(1/i)}applyMatrix3(i){const n=this.x,l=this.y,u=i.elements;return this.x=u[0]*n+u[3]*l+u[6],this.y=u[1]*n+u[4]*l+u[7],this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(i){return this.x*i.x+this.y*i.y}cross(i){return this.x*i.y-this.y*i.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,l=this.y-i.y;return n*n+l*l}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this}equals(i){return i.x===this.x&&i.y===this.y}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this}rotateAround(i,n){const l=Math.cos(n),u=Math.sin(n),h=this.x-i.x,p=this.y-i.y;return this.x=h*l-p*u+i.x,this.y=h*u+p*l+i.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class Ba{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(i,n,l,u,h,p,g,_,b){const A=this.elements;return A[0]=i,A[1]=u,A[2]=g,A[3]=n,A[4]=h,A[5]=_,A[6]=l,A[7]=p,A[8]=b,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(i){const n=this.elements,l=i.elements;return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],this}extractBasis(i,n,l){return i.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),l.setFromMatrix3Column(this,2),this}setFromMatrix4(i){const n=i.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const l=i.elements,u=n.elements,h=this.elements,p=l[0],g=l[3],_=l[6],b=l[1],A=l[4],S=l[7],R=l[2],E=l[5],N=l[8],W=u[0],V=u[3],B=u[6],O=u[1],pe=u[4],ge=u[7],ye=u[2],$=u[5],Ie=u[8];return h[0]=p*W+g*O+_*ye,h[3]=p*V+g*pe+_*$,h[6]=p*B+g*ge+_*Ie,h[1]=b*W+A*O+S*ye,h[4]=b*V+A*pe+S*$,h[7]=b*B+A*ge+S*Ie,h[2]=R*W+E*O+N*ye,h[5]=R*V+E*pe+N*$,h[8]=R*B+E*ge+N*Ie,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[3]*=i,n[6]*=i,n[1]*=i,n[4]*=i,n[7]*=i,n[2]*=i,n[5]*=i,n[8]*=i,this}determinant(){const i=this.elements,n=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],_=i[6],b=i[7],A=i[8];return n*p*A-n*g*b-l*h*A+l*g*_+u*h*b-u*p*_}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const l=i.elements,u=this.elements,h=l[0],p=l[1],g=l[2],_=l[3],b=l[4],A=l[5],S=l[6],R=l[7],E=l[8],N=E*b-A*R,W=A*S-E*_,V=R*_-b*S,B=h*N+p*W+g*V;if(B===0)return this.set(0,0,0,0,0,0,0,0,0);const O=1/B;return u[0]=N*O,u[1]=(g*R-E*p)*O,u[2]=(A*p-g*b)*O,u[3]=W*O,u[4]=(E*h-g*S)*O,u[5]=(g*_-A*h)*O,u[6]=V*O,u[7]=(p*S-R*h)*O,u[8]=(b*h-p*_)*O,this}transpose(){let i;const n=this.elements;return i=n[1],n[1]=n[3],n[3]=i,i=n[2],n[2]=n[6],n[6]=i,i=n[5],n[5]=n[7],n[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).getInverse(this).transpose()}transposeIntoArray(i){const n=this.elements;return i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8],this}setUvTransform(i,n,l,u,h,p,g){const _=Math.cos(h),b=Math.sin(h);this.set(l*_,l*b,-l*(_*p+b*g)+p+i,-u*b,u*_,-u*(-b*p+_*g)+g+n,0,0,1)}scale(i,n){const l=this.elements;return l[0]*=i,l[3]*=i,l[6]*=i,l[1]*=n,l[4]*=n,l[7]*=n,this}rotate(i){const n=Math.cos(i),l=Math.sin(i),u=this.elements,h=u[0],p=u[3],g=u[6],_=u[1],b=u[4],A=u[7];return u[0]=n*h+l*_,u[3]=n*p+l*b,u[6]=n*g+l*A,u[1]=-l*h+n*_,u[4]=-l*p+n*b,u[7]=-l*g+n*A,this}translate(i,n){const l=this.elements;return l[0]+=i*l[2],l[3]+=i*l[5],l[6]+=i*l[8],l[1]+=n*l[2],l[4]+=n*l[5],l[7]+=n*l[8],this}equals(i){const n=this.elements,l=i.elements;for(let u=0;u<9;u++)if(n[u]!==l[u])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let l=0;l<9;l++)this.elements[l]=i[l+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.elements;return i[n]=l[0],i[n+1]=l[1],i[n+2]=l[2],i[n+3]=l[3],i[n+4]=l[4],i[n+5]=l[5],i[n+6]=l[6],i[n+7]=l[7],i[n+8]=l[8],i}}let Fu;const Uc={getDataURL:function(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let i;if(r instanceof HTMLCanvasElement)i=r;else{Fu===void 0&&(Fu=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Fu.width=r.width,Fu.height=r.height;const n=Fu.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):n.drawImage(r,0,0,r.width,r.height),i=Fu}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}};let Gw=0;function qi(r,i,n,l,u,h,p,g,_,b){Object.defineProperty(this,"id",{value:Gw++}),this.uuid=zn.generateUUID(),this.name="",this.image=r!==void 0?r:qi.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=i!==void 0?i:qi.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:na,this.wrapT=l!==void 0?l:na,this.magFilter=u!==void 0?u:Rn,this.minFilter=h!==void 0?h:Pu,this.anisotropy=_!==void 0?_:1,this.format=p!==void 0?p:vs,this.internalFormat=null,this.type=g!==void 0?g:Oc,this.offset=new bt(0,0),this.repeat=new bt(1,1),this.center=new bt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ba,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=b!==void 0?b:Fc,this.version=0,this.onUpdate=null}qi.DEFAULT_IMAGE=void 0,qi.DEFAULT_MAPPING=Bl,qi.prototype=Object.assign(Object.create(Us.prototype),{constructor:qi,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.name=r.name,this.image=r.image,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this},toJSON:function(r){const i=r===void 0||typeof r=="string";if(!i&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const l=this.image;if(l.uuid===void 0&&(l.uuid=zn.generateUUID()),!i&&r.images[l.uuid]===void 0){let u;if(Array.isArray(l)){u=[];for(let h=0,p=l.length;h<p;h++)u.push(Uc.getDataURL(l[h]))}else u=Uc.getDataURL(l);r.images[l.uuid]={uuid:l.uuid,url:u}}n.image=l.uuid}return i||(r.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(r){if(this.mapping!==Bl)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case Gl:r.x=r.x-Math.floor(r.x);break;case na:r.x=r.x<0?0:1;break;case wt:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case Gl:r.y=r.y-Math.floor(r.y);break;case na:r.y=r.y<0?0:1;break;case wt:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}}),Object.defineProperty(qi.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});class Hi{constructor(i=0,n=0,l=0,u=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=i,this.y=n,this.z=l,this.w=u}get width(){return this.z}set width(i){this.z=i}get height(){return this.w}set height(i){this.w=i}set(i,n,l,u){return this.x=i,this.y=n,this.z=l,this.w=u,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this.w=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setW(i){return this.w=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==void 0?i.w:1,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this.w+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this.w=i.w+n.w,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this.w+=i.w*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this.w-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this.w=i.w-n.w,this}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}applyMatrix4(i){const n=this.x,l=this.y,u=this.z,h=this.w,p=i.elements;return this.x=p[0]*n+p[4]*l+p[8]*u+p[12]*h,this.y=p[1]*n+p[5]*l+p[9]*u+p[13]*h,this.z=p[2]*n+p[6]*l+p[10]*u+p[14]*h,this.w=p[3]*n+p[7]*l+p[11]*u+p[15]*h,this}divideScalar(i){return this.multiplyScalar(1/i)}setAxisAngleFromQuaternion(i){this.w=2*Math.acos(i.w);const n=Math.sqrt(1-i.w*i.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=i.x/n,this.y=i.y/n,this.z=i.z/n),this}setAxisAngleFromRotationMatrix(i){let n,l,u,h;const _=i.elements,b=_[0],A=_[4],S=_[8],R=_[1],E=_[5],N=_[9],W=_[2],V=_[6],B=_[10];if(Math.abs(A-R)<.01&&Math.abs(S-W)<.01&&Math.abs(N-V)<.01){if(Math.abs(A+R)<.1&&Math.abs(S+W)<.1&&Math.abs(N+V)<.1&&Math.abs(b+E+B-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const pe=(b+1)/2,ge=(E+1)/2,ye=(B+1)/2,$=(A+R)/4,Ie=(S+W)/4,tt=(N+V)/4;return pe>ge&&pe>ye?pe<.01?(l=0,u=.707106781,h=.707106781):(l=Math.sqrt(pe),u=$/l,h=Ie/l):ge>ye?ge<.01?(l=.707106781,u=0,h=.707106781):(u=Math.sqrt(ge),l=$/u,h=tt/u):ye<.01?(l=.707106781,u=.707106781,h=0):(h=Math.sqrt(ye),l=Ie/h,u=tt/h),this.set(l,u,h,n),this}let O=Math.sqrt((V-N)*(V-N)+(S-W)*(S-W)+(R-A)*(R-A));return Math.abs(O)<.001&&(O=1),this.x=(V-N)/O,this.y=(S-W)/O,this.z=(R-A)/O,this.w=Math.acos((b+E+B-1)/2),this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this.w=Math.max(i.w,Math.min(n.w,this.w)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this.w=Math.max(i,Math.min(n,this.w)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z+this.w*i.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this.w+=(i.w-this.w)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this.z=i.z+(n.z-i.z)*l,this.w=i.w+(n.w-i.w)*l,this}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z&&i.w===this.w}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this.w=i[n+3],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i[n+3]=this.w,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this.w=i.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}function Gs(r,i,n){this.width=r,this.height=i,this.scissor=new Hi(0,0,r,i),this.scissorTest=!1,this.viewport=new Hi(0,0,r,i),n=n||{},this.texture=new qi(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=r,this.texture.image.height=i,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Rn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}Gs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Gs,isWebGLRenderTarget:!0,setSize:function(r,i){(this.width!==r||this.height!==i)&&(this.width=r,this.height=i,this.texture.image.width=r,this.texture.image.height=i,this.dispose()),this.viewport.set(0,0,r,i),this.scissor.set(0,0,r,i)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.width=r.width,this.height=r.height,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function e0(r,i,n){Gs.call(this,r,i,n),this.samples=4}e0.prototype=Object.assign(Object.create(Gs.prototype),{constructor:e0,isWebGLMultisampleRenderTarget:!0,copy:function(r){return Gs.prototype.copy.call(this,r),this.samples=r.samples,this}});class Ta{constructor(i=0,n=0,l=0,u=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=i,this._y=n,this._z=l,this._w=u}static slerp(i,n,l,u){return l.copy(i).slerp(n,u)}static slerpFlat(i,n,l,u,h,p,g){let _=l[u+0],b=l[u+1],A=l[u+2],S=l[u+3];const R=h[p+0],E=h[p+1],N=h[p+2],W=h[p+3];if(S!==W||_!==R||b!==E||A!==N){let V=1-g;const B=_*R+b*E+A*N+S*W,O=B>=0?1:-1,pe=1-B*B;if(pe>Number.EPSILON){const ye=Math.sqrt(pe),$=Math.atan2(ye,B*O);V=Math.sin(V*$)/ye,g=Math.sin(g*$)/ye}const ge=g*O;if(_=_*V+R*ge,b=b*V+E*ge,A=A*V+N*ge,S=S*V+W*ge,V===1-g){const ye=1/Math.sqrt(_*_+b*b+A*A+S*S);_*=ye,b*=ye,A*=ye,S*=ye}}i[n]=_,i[n+1]=b,i[n+2]=A,i[n+3]=S}static multiplyQuaternionsFlat(i,n,l,u,h,p){const g=l[u],_=l[u+1],b=l[u+2],A=l[u+3],S=h[p],R=h[p+1],E=h[p+2],N=h[p+3];return i[n]=g*N+A*S+_*E-b*R,i[n+1]=_*N+A*R+b*S-g*E,i[n+2]=b*N+A*E+g*R-_*S,i[n+3]=A*N-g*S-_*R-b*E,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,n,l,u){return this._x=i,this._y=n,this._z=l,this._w=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,n){if(!(i&&i.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const l=i._x,u=i._y,h=i._z,p=i._order,g=Math.cos,_=Math.sin,b=g(l/2),A=g(u/2),S=g(h/2),R=_(l/2),E=_(u/2),N=_(h/2);switch(p){case"XYZ":this._x=R*A*S+b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S-R*E*N;break;case"YXZ":this._x=R*A*S+b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S+R*E*N;break;case"ZXY":this._x=R*A*S-b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S-R*E*N;break;case"ZYX":this._x=R*A*S-b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S+R*E*N;break;case"YZX":this._x=R*A*S+b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S-R*E*N;break;case"XZY":this._x=R*A*S-b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S+R*E*N;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+p)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,n){const l=n/2,u=Math.sin(l);return this._x=i.x*u,this._y=i.y*u,this._z=i.z*u,this._w=Math.cos(l),this._onChangeCallback(),this}setFromRotationMatrix(i){const n=i.elements,l=n[0],u=n[4],h=n[8],p=n[1],g=n[5],_=n[9],b=n[2],A=n[6],S=n[10],R=l+g+S;if(R>0){const E=.5/Math.sqrt(R+1);this._w=.25/E,this._x=(A-_)*E,this._y=(h-b)*E,this._z=(p-u)*E}else if(l>g&&l>S){const E=2*Math.sqrt(1+l-g-S);this._w=(A-_)/E,this._x=.25*E,this._y=(u+p)/E,this._z=(h+b)/E}else if(g>S){const E=2*Math.sqrt(1+g-l-S);this._w=(h-b)/E,this._x=(u+p)/E,this._y=.25*E,this._z=(_+A)/E}else{const E=2*Math.sqrt(1+S-l-g);this._w=(p-u)/E,this._x=(h+b)/E,this._y=(_+A)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(i,n){let u=i.dot(n)+1;return u<1e-6?(u=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=u):(this._x=0,this._y=-i.z,this._z=i.y,this._w=u)):(this._x=i.y*n.z-i.z*n.y,this._y=i.z*n.x-i.x*n.z,this._z=i.x*n.y-i.y*n.x,this._w=u),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(zn.clamp(this.dot(i),-1,1)))}rotateTowards(i,n){const l=this.angleTo(i);if(l===0)return this;const u=Math.min(1,n/l);return this.slerp(i,u),this}identity(){return this.set(0,0,0,1)}inverse(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(i,n)):this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,n){const l=i._x,u=i._y,h=i._z,p=i._w,g=n._x,_=n._y,b=n._z,A=n._w;return this._x=l*A+p*g+u*b-h*_,this._y=u*A+p*_+h*g-l*b,this._z=h*A+p*b+l*_-u*g,this._w=p*A-l*g-u*_-h*b,this._onChangeCallback(),this}slerp(i,n){if(n===0)return this;if(n===1)return this.copy(i);const l=this._x,u=this._y,h=this._z,p=this._w;let g=p*i._w+l*i._x+u*i._y+h*i._z;if(g<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,g=-g):this.copy(i),g>=1)return this._w=p,this._x=l,this._y=u,this._z=h,this;const _=1-g*g;if(_<=Number.EPSILON){const E=1-n;return this._w=E*p+n*this._w,this._x=E*l+n*this._x,this._y=E*u+n*this._y,this._z=E*h+n*this._z,this.normalize(),this._onChangeCallback(),this}const b=Math.sqrt(_),A=Math.atan2(b,g),S=Math.sin((1-n)*A)/b,R=Math.sin(n*A)/b;return this._w=p*S+this._w*R,this._x=l*S+this._x*R,this._y=u*S+this._y*R,this._z=h*S+this._z*R,this._onChangeCallback(),this}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,n){return n===void 0&&(n=0),this._x=i[n],this._y=i[n+1],this._z=i[n+2],this._w=i[n+3],this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._w,i}fromBufferAttribute(i,n){return this._x=i.getX(n),this._y=i.getY(n),this._z=i.getZ(n),this._w=i.getW(n),this}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}class _e{constructor(i=0,n=0,l=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=n,this.z=l}set(i,n,l){return l===void 0&&(l=this.z),this.x=i,this.y=n,this.z=l,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(i,n)):(this.x*=i.x,this.y*=i.y,this.z*=i.z,this)}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this}multiplyVectors(i,n){return this.x=i.x*n.x,this.y=i.y*n.y,this.z=i.z*n.z,this}applyEuler(i){return i&&i.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t0.setFromEuler(i))}applyAxisAngle(i,n){return this.applyQuaternion(t0.setFromAxisAngle(i,n))}applyMatrix3(i){const n=this.x,l=this.y,u=this.z,h=i.elements;return this.x=h[0]*n+h[3]*l+h[6]*u,this.y=h[1]*n+h[4]*l+h[7]*u,this.z=h[2]*n+h[5]*l+h[8]*u,this}applyNormalMatrix(i){return this.applyMatrix3(i).normalize()}applyMatrix4(i){const n=this.x,l=this.y,u=this.z,h=i.elements,p=1/(h[3]*n+h[7]*l+h[11]*u+h[15]);return this.x=(h[0]*n+h[4]*l+h[8]*u+h[12])*p,this.y=(h[1]*n+h[5]*l+h[9]*u+h[13])*p,this.z=(h[2]*n+h[6]*l+h[10]*u+h[14])*p,this}applyQuaternion(i){const n=this.x,l=this.y,u=this.z,h=i.x,p=i.y,g=i.z,_=i.w,b=_*n+p*u-g*l,A=_*l+g*n-h*u,S=_*u+h*l-p*n,R=-h*n-p*l-g*u;return this.x=b*_+R*-h+A*-g-S*-p,this.y=A*_+R*-p+S*-h-b*-g,this.z=S*_+R*-g+b*-p-A*-h,this}project(i){return this.applyMatrix4(i.matrixWorldInverse).applyMatrix4(i.projectionMatrix)}unproject(i){return this.applyMatrix4(i.projectionMatrixInverse).applyMatrix4(i.matrixWorld)}transformDirection(i){const n=this.x,l=this.y,u=this.z,h=i.elements;return this.x=h[0]*n+h[4]*l+h[8]*u,this.y=h[1]*n+h[5]*l+h[9]*u,this.z=h[2]*n+h[6]*l+h[10]*u,this.normalize()}divide(i){return this.x/=i.x,this.y/=i.y,this.z/=i.z,this}divideScalar(i){return this.multiplyScalar(1/i)}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this.z=i.z+(n.z-i.z)*l,this}cross(i,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(i,n)):this.crossVectors(this,i)}crossVectors(i,n){const l=i.x,u=i.y,h=i.z,p=n.x,g=n.y,_=n.z;return this.x=u*_-h*g,this.y=h*p-l*_,this.z=l*g-u*p,this}projectOnVector(i){const n=i.lengthSq();if(n===0)return this.set(0,0,0);const l=i.dot(this)/n;return this.copy(i).multiplyScalar(l)}projectOnPlane(i){return cg.copy(this).projectOnVector(i),this.sub(cg)}reflect(i){return this.sub(cg.copy(i).multiplyScalar(2*this.dot(i)))}angleTo(i){const n=Math.sqrt(this.lengthSq()*i.lengthSq());if(n===0)return Math.PI/2;const l=this.dot(i)/n;return Math.acos(zn.clamp(l,-1,1))}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,l=this.y-i.y,u=this.z-i.z;return n*n+l*l+u*u}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)+Math.abs(this.z-i.z)}setFromSpherical(i){return this.setFromSphericalCoords(i.radius,i.phi,i.theta)}setFromSphericalCoords(i,n,l){const u=Math.sin(n)*i;return this.x=u*Math.sin(l),this.y=Math.cos(n)*i,this.z=u*Math.cos(l),this}setFromCylindrical(i){return this.setFromCylindricalCoords(i.radius,i.theta,i.y)}setFromCylindricalCoords(i,n,l){return this.x=i*Math.sin(n),this.y=l,this.z=i*Math.cos(n),this}setFromMatrixPosition(i){const n=i.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(i){const n=this.setFromMatrixColumn(i,0).length(),l=this.setFromMatrixColumn(i,1).length(),u=this.setFromMatrixColumn(i,2).length();return this.x=n,this.y=l,this.z=u,this}setFromMatrixColumn(i,n){return this.fromArray(i.elements,n*4)}setFromMatrix3Column(i,n){return this.fromArray(i.elements,n*3)}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const cg=new _e,t0=new Ta;class el{constructor(i,n){Object.defineProperty(this,"isBox3",{value:!0}),this.min=i!==void 0?i:new _e(1/0,1/0,1/0),this.max=n!==void 0?n:new _e(-1/0,-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromArray(i){let n=1/0,l=1/0,u=1/0,h=-1/0,p=-1/0,g=-1/0;for(let _=0,b=i.length;_<b;_+=3){const A=i[_],S=i[_+1],R=i[_+2];A<n&&(n=A),S<l&&(l=S),R<u&&(u=R),A>h&&(h=A),S>p&&(p=S),R>g&&(g=R)}return this.min.set(n,l,u),this.max.set(h,p,g),this}setFromBufferAttribute(i){let n=1/0,l=1/0,u=1/0,h=-1/0,p=-1/0,g=-1/0;for(let _=0,b=i.count;_<b;_++){const A=i.getX(_),S=i.getY(_),R=i.getZ(_);A<n&&(n=A),S<l&&(l=S),R<u&&(u=R),A>h&&(h=A),S>p&&(p=S),R>g&&(g=R)}return this.min.set(n,l,u),this.max.set(h,p,g),this}setFromPoints(i){this.makeEmpty();for(let n=0,l=i.length;n<l;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const l=cf.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(l),this.max.copy(i).add(l),this}setFromObject(i){return this.makeEmpty(),this.expandByObject(i)}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(i){return i===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),i=new _e),this.isEmpty()?i.set(0,0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),i=new _e),this.isEmpty()?i.set(0,0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}expandByObject(i){i.updateWorldMatrix(!1,!1);const n=i.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),hg.copy(n.boundingBox),hg.applyMatrix4(i.matrixWorld),this.union(hg));const l=i.children;for(let u=0,h=l.length;u<h;u++)this.expandByObject(l[u]);return this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y||i.z<this.min.z||i.z>this.max.z)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y&&this.min.z<=i.min.z&&i.max.z<=this.max.z}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new _e),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y),(i.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y||i.max.z<this.min.z||i.min.z>this.max.z)}intersectsSphere(i){return this.clampPoint(i.center,cf),cf.distanceToSquared(i.center)<=i.radius*i.radius}intersectsPlane(i){let n,l;return i.normal.x>0?(n=i.normal.x*this.min.x,l=i.normal.x*this.max.x):(n=i.normal.x*this.max.x,l=i.normal.x*this.min.x),i.normal.y>0?(n+=i.normal.y*this.min.y,l+=i.normal.y*this.max.y):(n+=i.normal.y*this.max.y,l+=i.normal.y*this.min.y),i.normal.z>0?(n+=i.normal.z*this.min.z,l+=i.normal.z*this.max.z):(n+=i.normal.z*this.max.z,l+=i.normal.z*this.min.z),n<=-i.constant&&l>=-i.constant}intersectsTriangle(i){if(this.isEmpty())return!1;this.getCenter(uf),Xd.subVectors(this.max,uf),Bu.subVectors(i.a,uf),Uu.subVectors(i.b,uf),Gu.subVectors(i.c,uf),zl.subVectors(Uu,Bu),Hl.subVectors(Gu,Uu),Gc.subVectors(Bu,Gu);let n=[0,-zl.z,zl.y,0,-Hl.z,Hl.y,0,-Gc.z,Gc.y,zl.z,0,-zl.x,Hl.z,0,-Hl.x,Gc.z,0,-Gc.x,-zl.y,zl.x,0,-Hl.y,Hl.x,0,-Gc.y,Gc.x,0];return!ug(n,Bu,Uu,Gu,Xd)||(n=[1,0,0,0,1,0,0,0,1],!ug(n,Bu,Uu,Gu,Xd))?!1:(jd.crossVectors(zl,Hl),n=[jd.x,jd.y,jd.z],ug(n,Bu,Uu,Gu,Xd))}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new _e),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return cf.copy(i).clamp(this.min,this.max).sub(i).length()}getBoundingSphere(i){return i===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(i.center),i.radius=this.getSize(cf).length()*.5,i}intersect(i){return this.min.max(i.min),this.max.min(i.max),this.isEmpty()&&this.makeEmpty(),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}applyMatrix4(i){return this.isEmpty()?this:(tl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(i),tl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(i),tl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(i),tl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(i),tl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(i),tl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(i),tl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(i),tl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(i),this.setFromPoints(tl),this)}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function ug(r,i,n,l,u){for(let h=0,p=r.length-3;h<=p;h+=3){zc.fromArray(r,h);const g=u.x*Math.abs(zc.x)+u.y*Math.abs(zc.y)+u.z*Math.abs(zc.z),_=i.dot(zc),b=n.dot(zc),A=l.dot(zc);if(Math.max(-Math.max(_,b,A),Math.min(_,b,A))>g)return!1}return!0}const tl=[new _e,new _e,new _e,new _e,new _e,new _e,new _e,new _e],cf=new _e,hg=new el,Bu=new _e,Uu=new _e,Gu=new _e,zl=new _e,Hl=new _e,Gc=new _e,uf=new _e,Xd=new _e,jd=new _e,zc=new _e,zw=new el;class nl{constructor(i,n){this.center=i!==void 0?i:new _e,this.radius=n!==void 0?n:-1}set(i,n){return this.center.copy(i),this.radius=n,this}setFromPoints(i,n){const l=this.center;n!==void 0?l.copy(n):zw.setFromPoints(i).getCenter(l);let u=0;for(let h=0,p=i.length;h<p;h++)u=Math.max(u,l.distanceToSquared(i[h]));return this.radius=Math.sqrt(u),this}clone(){return new this.constructor().copy(this)}copy(i){return this.center.copy(i.center),this.radius=i.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(i){return i.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(i){return i.distanceTo(this.center)-this.radius}intersectsSphere(i){const n=this.radius+i.radius;return i.center.distanceToSquared(this.center)<=n*n}intersectsBox(i){return i.intersectsSphere(this)}intersectsPlane(i){return Math.abs(i.distanceToPoint(this.center))<=this.radius}clampPoint(i,n){const l=this.center.distanceToSquared(i);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new _e),n.copy(i),l>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(i){return i===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),i=new el),this.isEmpty()?(i.makeEmpty(),i):(i.set(this.center,this.center),i.expandByScalar(this.radius),i)}applyMatrix4(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this}translate(i){return this.center.add(i),this}equals(i){return i.center.equals(this.center)&&i.radius===this.radius}}const il=new _e,fg=new _e,Yd=new _e,kl=new _e,dg=new _e,Zd=new _e,pg=new _e;class hf{constructor(i,n){this.origin=i!==void 0?i:new _e,this.direction=n!==void 0?n:new _e(0,0,-1)}set(i,n){return this.origin.copy(i),this.direction.copy(n),this}clone(){return new this.constructor().copy(this)}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new _e),n.copy(this.direction).multiplyScalar(i).add(this.origin)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,il)),this}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new _e),n.subVectors(i,this.origin);const l=n.dot(this.direction);return l<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(l).add(this.origin)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){const n=il.subVectors(i,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(i):(il.copy(this.direction).multiplyScalar(n).add(this.origin),il.distanceToSquared(i))}distanceSqToSegment(i,n,l,u){fg.copy(i).add(n).multiplyScalar(.5),Yd.copy(n).sub(i).normalize(),kl.copy(this.origin).sub(fg);const h=i.distanceTo(n)*.5,p=-this.direction.dot(Yd),g=kl.dot(this.direction),_=-kl.dot(Yd),b=kl.lengthSq(),A=Math.abs(1-p*p);let S,R,E,N;if(A>0)if(S=p*_-g,R=p*g-_,N=h*A,S>=0)if(R>=-N)if(R<=N){const W=1/A;S*=W,R*=W,E=S*(S+p*R+2*g)+R*(p*S+R+2*_)+b}else R=h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;else R=-h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;else R<=-N?(S=Math.max(0,-(-p*h+g)),R=S>0?-h:Math.min(Math.max(-h,-_),h),E=-S*S+R*(R+2*_)+b):R<=N?(S=0,R=Math.min(Math.max(-h,-_),h),E=R*(R+2*_)+b):(S=Math.max(0,-(p*h+g)),R=S>0?h:Math.min(Math.max(-h,-_),h),E=-S*S+R*(R+2*_)+b);else R=p>0?-h:h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;return l&&l.copy(this.direction).multiplyScalar(S).add(this.origin),u&&u.copy(Yd).multiplyScalar(R).add(fg),E}intersectSphere(i,n){il.subVectors(i.center,this.origin);const l=il.dot(this.direction),u=il.dot(il)-l*l,h=i.radius*i.radius;if(u>h)return null;const p=Math.sqrt(h-u),g=l-p,_=l+p;return g<0&&_<0?null:g<0?this.at(_,n):this.at(g,n)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){const n=i.normal.dot(this.direction);if(n===0)return i.distanceToPoint(this.origin)===0?0:null;const l=-(this.origin.dot(i.normal)+i.constant)/n;return l>=0?l:null}intersectPlane(i,n){const l=this.distanceToPlane(i);return l===null?null:this.at(l,n)}intersectsPlane(i){const n=i.distanceToPoint(this.origin);return n===0||i.normal.dot(this.direction)*n<0}intersectBox(i,n){let l,u,h,p,g,_;const b=1/this.direction.x,A=1/this.direction.y,S=1/this.direction.z,R=this.origin;return b>=0?(l=(i.min.x-R.x)*b,u=(i.max.x-R.x)*b):(l=(i.max.x-R.x)*b,u=(i.min.x-R.x)*b),A>=0?(h=(i.min.y-R.y)*A,p=(i.max.y-R.y)*A):(h=(i.max.y-R.y)*A,p=(i.min.y-R.y)*A),l>p||h>u||((h>l||l!==l)&&(l=h),(p<u||u!==u)&&(u=p),S>=0?(g=(i.min.z-R.z)*S,_=(i.max.z-R.z)*S):(g=(i.max.z-R.z)*S,_=(i.min.z-R.z)*S),l>_||g>u)||((g>l||l!==l)&&(l=g),(_<u||u!==u)&&(u=_),u<0)?null:this.at(l>=0?l:u,n)}intersectsBox(i){return this.intersectBox(i,il)!==null}intersectTriangle(i,n,l,u,h){dg.subVectors(n,i),Zd.subVectors(l,i),pg.crossVectors(dg,Zd);let p=this.direction.dot(pg),g;if(p>0){if(u)return null;g=1}else if(p<0)g=-1,p=-p;else return null;kl.subVectors(this.origin,i);const _=g*this.direction.dot(Zd.crossVectors(kl,Zd));if(_<0)return null;const b=g*this.direction.dot(dg.cross(kl));if(b<0||_+b>p)return null;const A=-g*kl.dot(pg);return A<0?null:this.at(A/p,h)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}}class Wn{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(i,n,l,u,h,p,g,_,b,A,S,R,E,N,W,V){const B=this.elements;return B[0]=i,B[4]=n,B[8]=l,B[12]=u,B[1]=h,B[5]=p,B[9]=g,B[13]=_,B[2]=b,B[6]=A,B[10]=S,B[14]=R,B[3]=E,B[7]=N,B[11]=W,B[15]=V,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Wn().fromArray(this.elements)}copy(i){const n=this.elements,l=i.elements;return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],this}copyPosition(i){const n=this.elements,l=i.elements;return n[12]=l[12],n[13]=l[13],n[14]=l[14],this}extractBasis(i,n,l){return i.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),l.setFromMatrixColumn(this,2),this}makeBasis(i,n,l){return this.set(i.x,n.x,l.x,0,i.y,n.y,l.y,0,i.z,n.z,l.z,0,0,0,0,1),this}extractRotation(i){const n=this.elements,l=i.elements,u=1/zu.setFromMatrixColumn(i,0).length(),h=1/zu.setFromMatrixColumn(i,1).length(),p=1/zu.setFromMatrixColumn(i,2).length();return n[0]=l[0]*u,n[1]=l[1]*u,n[2]=l[2]*u,n[3]=0,n[4]=l[4]*h,n[5]=l[5]*h,n[6]=l[6]*h,n[7]=0,n[8]=l[8]*p,n[9]=l[9]*p,n[10]=l[10]*p,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(i){i&&i.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,l=i.x,u=i.y,h=i.z,p=Math.cos(l),g=Math.sin(l),_=Math.cos(u),b=Math.sin(u),A=Math.cos(h),S=Math.sin(h);if(i.order==="XYZ"){const R=p*A,E=p*S,N=g*A,W=g*S;n[0]=_*A,n[4]=-_*S,n[8]=b,n[1]=E+N*b,n[5]=R-W*b,n[9]=-g*_,n[2]=W-R*b,n[6]=N+E*b,n[10]=p*_}else if(i.order==="YXZ"){const R=_*A,E=_*S,N=b*A,W=b*S;n[0]=R+W*g,n[4]=N*g-E,n[8]=p*b,n[1]=p*S,n[5]=p*A,n[9]=-g,n[2]=E*g-N,n[6]=W+R*g,n[10]=p*_}else if(i.order==="ZXY"){const R=_*A,E=_*S,N=b*A,W=b*S;n[0]=R-W*g,n[4]=-p*S,n[8]=N+E*g,n[1]=E+N*g,n[5]=p*A,n[9]=W-R*g,n[2]=-p*b,n[6]=g,n[10]=p*_}else if(i.order==="ZYX"){const R=p*A,E=p*S,N=g*A,W=g*S;n[0]=_*A,n[4]=N*b-E,n[8]=R*b+W,n[1]=_*S,n[5]=W*b+R,n[9]=E*b-N,n[2]=-b,n[6]=g*_,n[10]=p*_}else if(i.order==="YZX"){const R=p*_,E=p*b,N=g*_,W=g*b;n[0]=_*A,n[4]=W-R*S,n[8]=N*S+E,n[1]=S,n[5]=p*A,n[9]=-g*A,n[2]=-b*A,n[6]=E*S+N,n[10]=R-W*S}else if(i.order==="XZY"){const R=p*_,E=p*b,N=g*_,W=g*b;n[0]=_*A,n[4]=-S,n[8]=b*A,n[1]=R*S+W,n[5]=p*A,n[9]=E*S-N,n[2]=N*S-E,n[6]=g*A,n[10]=W*S+R}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(i){return this.compose(Hw,i,kw)}lookAt(i,n,l){const u=this.elements;return Ja.subVectors(i,n),Ja.lengthSq()===0&&(Ja.z=1),Ja.normalize(),Vl.crossVectors(l,Ja),Vl.lengthSq()===0&&(Math.abs(l.z)===1?Ja.x+=1e-4:Ja.z+=1e-4,Ja.normalize(),Vl.crossVectors(l,Ja)),Vl.normalize(),Jd.crossVectors(Ja,Vl),u[0]=Vl.x,u[4]=Jd.x,u[8]=Ja.x,u[1]=Vl.y,u[5]=Jd.y,u[9]=Ja.y,u[2]=Vl.z,u[6]=Jd.z,u[10]=Ja.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(i,n)):this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const l=i.elements,u=n.elements,h=this.elements,p=l[0],g=l[4],_=l[8],b=l[12],A=l[1],S=l[5],R=l[9],E=l[13],N=l[2],W=l[6],V=l[10],B=l[14],O=l[3],pe=l[7],ge=l[11],ye=l[15],$=u[0],Ie=u[4],tt=u[8],qe=u[12],ft=u[1],je=u[5],Ne=u[9],Ue=u[13],Le=u[2],Te=u[6],Ve=u[10],We=u[14],at=u[3],Tt=u[7],nt=u[11],At=u[15];return h[0]=p*$+g*ft+_*Le+b*at,h[4]=p*Ie+g*je+_*Te+b*Tt,h[8]=p*tt+g*Ne+_*Ve+b*nt,h[12]=p*qe+g*Ue+_*We+b*At,h[1]=A*$+S*ft+R*Le+E*at,h[5]=A*Ie+S*je+R*Te+E*Tt,h[9]=A*tt+S*Ne+R*Ve+E*nt,h[13]=A*qe+S*Ue+R*We+E*At,h[2]=N*$+W*ft+V*Le+B*at,h[6]=N*Ie+W*je+V*Te+B*Tt,h[10]=N*tt+W*Ne+V*Ve+B*nt,h[14]=N*qe+W*Ue+V*We+B*At,h[3]=O*$+pe*ft+ge*Le+ye*at,h[7]=O*Ie+pe*je+ge*Te+ye*Tt,h[11]=O*tt+pe*Ne+ge*Ve+ye*nt,h[15]=O*qe+pe*Ue+ge*We+ye*At,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[4]*=i,n[8]*=i,n[12]*=i,n[1]*=i,n[5]*=i,n[9]*=i,n[13]*=i,n[2]*=i,n[6]*=i,n[10]*=i,n[14]*=i,n[3]*=i,n[7]*=i,n[11]*=i,n[15]*=i,this}determinant(){const i=this.elements,n=i[0],l=i[4],u=i[8],h=i[12],p=i[1],g=i[5],_=i[9],b=i[13],A=i[2],S=i[6],R=i[10],E=i[14],N=i[3],W=i[7],V=i[11],B=i[15];return N*(+h*_*S-u*b*S-h*g*R+l*b*R+u*g*E-l*_*E)+W*(+n*_*E-n*b*R+h*p*R-u*p*E+u*b*A-h*_*A)+V*(+n*b*S-n*g*E-h*p*S+l*p*E+h*g*A-l*b*A)+B*(-u*g*A-n*_*S+n*g*R+u*p*S-l*p*R+l*_*A)}transpose(){const i=this.elements;let n;return n=i[1],i[1]=i[4],i[4]=n,n=i[2],i[2]=i[8],i[8]=n,n=i[6],i[6]=i[9],i[9]=n,n=i[3],i[3]=i[12],i[12]=n,n=i[7],i[7]=i[13],i[13]=n,n=i[11],i[11]=i[14],i[14]=n,this}setPosition(i,n,l){const u=this.elements;return i.isVector3?(u[12]=i.x,u[13]=i.y,u[14]=i.z):(u[12]=i,u[13]=n,u[14]=l),this}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const l=this.elements,u=i.elements,h=u[0],p=u[1],g=u[2],_=u[3],b=u[4],A=u[5],S=u[6],R=u[7],E=u[8],N=u[9],W=u[10],V=u[11],B=u[12],O=u[13],pe=u[14],ge=u[15],ye=N*pe*R-O*W*R+O*S*V-A*pe*V-N*S*ge+A*W*ge,$=B*W*R-E*pe*R-B*S*V+b*pe*V+E*S*ge-b*W*ge,Ie=E*O*R-B*N*R+B*A*V-b*O*V-E*A*ge+b*N*ge,tt=B*N*S-E*O*S-B*A*W+b*O*W+E*A*pe-b*N*pe,qe=h*ye+p*$+g*Ie+_*tt;if(qe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ft=1/qe;return l[0]=ye*ft,l[1]=(O*W*_-N*pe*_-O*g*V+p*pe*V+N*g*ge-p*W*ge)*ft,l[2]=(A*pe*_-O*S*_+O*g*R-p*pe*R-A*g*ge+p*S*ge)*ft,l[3]=(N*S*_-A*W*_-N*g*R+p*W*R+A*g*V-p*S*V)*ft,l[4]=$*ft,l[5]=(E*pe*_-B*W*_+B*g*V-h*pe*V-E*g*ge+h*W*ge)*ft,l[6]=(B*S*_-b*pe*_-B*g*R+h*pe*R+b*g*ge-h*S*ge)*ft,l[7]=(b*W*_-E*S*_+E*g*R-h*W*R-b*g*V+h*S*V)*ft,l[8]=Ie*ft,l[9]=(B*N*_-E*O*_-B*p*V+h*O*V+E*p*ge-h*N*ge)*ft,l[10]=(b*O*_-B*A*_+B*p*R-h*O*R-b*p*ge+h*A*ge)*ft,l[11]=(E*A*_-b*N*_-E*p*R+h*N*R+b*p*V-h*A*V)*ft,l[12]=tt*ft,l[13]=(E*O*g-B*N*g+B*p*W-h*O*W-E*p*pe+h*N*pe)*ft,l[14]=(B*A*g-b*O*g-B*p*S+h*O*S+b*p*pe-h*A*pe)*ft,l[15]=(b*N*g-E*A*g+E*p*S-h*N*S-b*p*W+h*A*W)*ft,this}scale(i){const n=this.elements,l=i.x,u=i.y,h=i.z;return n[0]*=l,n[4]*=u,n[8]*=h,n[1]*=l,n[5]*=u,n[9]*=h,n[2]*=l,n[6]*=u,n[10]*=h,n[3]*=l,n[7]*=u,n[11]*=h,this}getMaxScaleOnAxis(){const i=this.elements,n=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],l=i[4]*i[4]+i[5]*i[5]+i[6]*i[6],u=i[8]*i[8]+i[9]*i[9]+i[10]*i[10];return Math.sqrt(Math.max(n,l,u))}makeTranslation(i,n,l){return this.set(1,0,0,i,0,1,0,n,0,0,1,l,0,0,0,1),this}makeRotationX(i){const n=Math.cos(i),l=Math.sin(i);return this.set(1,0,0,0,0,n,-l,0,0,l,n,0,0,0,0,1),this}makeRotationY(i){const n=Math.cos(i),l=Math.sin(i);return this.set(n,0,l,0,0,1,0,0,-l,0,n,0,0,0,0,1),this}makeRotationZ(i){const n=Math.cos(i),l=Math.sin(i);return this.set(n,-l,0,0,l,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(i,n){const l=Math.cos(n),u=Math.sin(n),h=1-l,p=i.x,g=i.y,_=i.z,b=h*p,A=h*g;return this.set(b*p+l,b*g-u*_,b*_+u*g,0,b*g+u*_,A*g+l,A*_-u*p,0,b*_-u*g,A*_+u*p,h*_*_+l,0,0,0,0,1),this}makeScale(i,n,l){return this.set(i,0,0,0,0,n,0,0,0,0,l,0,0,0,0,1),this}makeShear(i,n,l){return this.set(1,n,l,0,i,1,l,0,i,n,1,0,0,0,0,1),this}compose(i,n,l){const u=this.elements,h=n._x,p=n._y,g=n._z,_=n._w,b=h+h,A=p+p,S=g+g,R=h*b,E=h*A,N=h*S,W=p*A,V=p*S,B=g*S,O=_*b,pe=_*A,ge=_*S,ye=l.x,$=l.y,Ie=l.z;return u[0]=(1-(W+B))*ye,u[1]=(E+ge)*ye,u[2]=(N-pe)*ye,u[3]=0,u[4]=(E-ge)*$,u[5]=(1-(R+B))*$,u[6]=(V+O)*$,u[7]=0,u[8]=(N+pe)*Ie,u[9]=(V-O)*Ie,u[10]=(1-(R+W))*Ie,u[11]=0,u[12]=i.x,u[13]=i.y,u[14]=i.z,u[15]=1,this}decompose(i,n,l){const u=this.elements;let h=zu.set(u[0],u[1],u[2]).length();const p=zu.set(u[4],u[5],u[6]).length(),g=zu.set(u[8],u[9],u[10]).length();this.determinant()<0&&(h=-h),i.x=u[12],i.y=u[13],i.z=u[14],zs.copy(this);const b=1/h,A=1/p,S=1/g;return zs.elements[0]*=b,zs.elements[1]*=b,zs.elements[2]*=b,zs.elements[4]*=A,zs.elements[5]*=A,zs.elements[6]*=A,zs.elements[8]*=S,zs.elements[9]*=S,zs.elements[10]*=S,n.setFromRotationMatrix(zs),l.x=h,l.y=p,l.z=g,this}makePerspective(i,n,l,u,h,p){p===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const g=this.elements,_=2*h/(n-i),b=2*h/(l-u),A=(n+i)/(n-i),S=(l+u)/(l-u),R=-(p+h)/(p-h),E=-2*p*h/(p-h);return g[0]=_,g[4]=0,g[8]=A,g[12]=0,g[1]=0,g[5]=b,g[9]=S,g[13]=0,g[2]=0,g[6]=0,g[10]=R,g[14]=E,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this}makeOrthographic(i,n,l,u,h,p){const g=this.elements,_=1/(n-i),b=1/(l-u),A=1/(p-h),S=(n+i)*_,R=(l+u)*b,E=(p+h)*A;return g[0]=2*_,g[4]=0,g[8]=0,g[12]=-S,g[1]=0,g[5]=2*b,g[9]=0,g[13]=-R,g[2]=0,g[6]=0,g[10]=-2*A,g[14]=-E,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this}equals(i){const n=this.elements,l=i.elements;for(let u=0;u<16;u++)if(n[u]!==l[u])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let l=0;l<16;l++)this.elements[l]=i[l+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.elements;return i[n]=l[0],i[n+1]=l[1],i[n+2]=l[2],i[n+3]=l[3],i[n+4]=l[4],i[n+5]=l[5],i[n+6]=l[6],i[n+7]=l[7],i[n+8]=l[8],i[n+9]=l[9],i[n+10]=l[10],i[n+11]=l[11],i[n+12]=l[12],i[n+13]=l[13],i[n+14]=l[14],i[n+15]=l[15],i}}const zu=new _e,zs=new Wn,Hw=new _e(0,0,0),kw=new _e(1,1,1),Vl=new _e,Jd=new _e,Ja=new _e;class ff{constructor(i=0,n=0,l=0,u=ff.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=n,this._z=l,this._order=u}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get order(){return this._order}set order(i){this._order=i,this._onChangeCallback()}set(i,n,l,u){return this._x=i,this._y=n,this._z=l,this._order=u||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this._onChangeCallback(),this}setFromRotationMatrix(i,n,l){const u=zn.clamp,h=i.elements,p=h[0],g=h[4],_=h[8],b=h[1],A=h[5],S=h[9],R=h[2],E=h[6],N=h[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(u(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-S,N),this._z=Math.atan2(-g,p)):(this._x=Math.atan2(E,A),this._z=0);break;case"YXZ":this._x=Math.asin(-u(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(_,N),this._z=Math.atan2(b,A)):(this._y=Math.atan2(-R,p),this._z=0);break;case"ZXY":this._x=Math.asin(u(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-R,N),this._z=Math.atan2(-g,A)):(this._y=0,this._z=Math.atan2(b,p));break;case"ZYX":this._y=Math.asin(-u(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(E,N),this._z=Math.atan2(b,p)):(this._x=0,this._z=Math.atan2(-g,A));break;case"YZX":this._z=Math.asin(u(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(-S,A),this._y=Math.atan2(-R,p)):(this._x=0,this._y=Math.atan2(_,N));break;case"XZY":this._z=Math.asin(-u(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(E,A),this._y=Math.atan2(_,p)):(this._x=Math.atan2(-S,N),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,l!==!1&&this._onChangeCallback(),this}setFromQuaternion(i,n,l){return n0.makeRotationFromQuaternion(i),this.setFromRotationMatrix(n0,n,l)}setFromVector3(i,n){return this.set(i.x,i.y,i.z,n||this._order)}reorder(i){return i0.setFromEuler(this),this.setFromQuaternion(i0,i)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order}fromArray(i){return this._x=i[0],this._y=i[1],this._z=i[2],i[3]!==void 0&&(this._order=i[3]),this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._order,i}toVector3(i){return i?i.set(this._x,this._y,this._z):new _e(this._x,this._y,this._z)}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}ff.DefaultOrder="XYZ",ff.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const n0=new Wn,i0=new Ta;class r0{constructor(){this.mask=1}set(i){this.mask=1<<i|0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!==0}}let Vw=0;const a0=new _e,Hu=new Ta,rl=new Wn,Kd=new _e,df=new _e,Ww=new _e,qw=new Ta,s0=new _e(1,0,0),o0=new _e(0,1,0),l0=new _e(0,0,1),Xw={type:"added"},jw={type:"removed"};function yn(){Object.defineProperty(this,"id",{value:Vw++}),this.uuid=zn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=yn.DefaultUp.clone();const r=new _e,i=new ff,n=new Ta,l=new _e(1,1,1);function u(){n.setFromEuler(i,!1)}function h(){i.setFromQuaternion(n,void 0,!1)}i._onChange(u),n._onChange(h),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new Wn},normalMatrix:{value:new Ba}}),this.matrix=new Wn,this.matrixWorld=new Wn,this.matrixAutoUpdate=yn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new r0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}yn.DefaultUp=new _e(0,1,0),yn.DefaultMatrixAutoUpdate=!0,yn.prototype=Object.assign(Object.create(Us.prototype),{constructor:yn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(r){return this.quaternion.premultiply(r),this},setRotationFromAxisAngle:function(r,i){this.quaternion.setFromAxisAngle(r,i)},setRotationFromEuler:function(r){this.quaternion.setFromEuler(r,!0)},setRotationFromMatrix:function(r){this.quaternion.setFromRotationMatrix(r)},setRotationFromQuaternion:function(r){this.quaternion.copy(r)},rotateOnAxis:function(r,i){return Hu.setFromAxisAngle(r,i),this.quaternion.multiply(Hu),this},rotateOnWorldAxis:function(r,i){return Hu.setFromAxisAngle(r,i),this.quaternion.premultiply(Hu),this},rotateX:function(r){return this.rotateOnAxis(s0,r)},rotateY:function(r){return this.rotateOnAxis(o0,r)},rotateZ:function(r){return this.rotateOnAxis(l0,r)},translateOnAxis:function(r,i){return a0.copy(r).applyQuaternion(this.quaternion),this.position.add(a0.multiplyScalar(i)),this},translateX:function(r){return this.translateOnAxis(s0,r)},translateY:function(r){return this.translateOnAxis(o0,r)},translateZ:function(r){return this.translateOnAxis(l0,r)},localToWorld:function(r){return r.applyMatrix4(this.matrixWorld)},worldToLocal:function(r){return r.applyMatrix4(rl.getInverse(this.matrixWorld))},lookAt:function(r,i,n){r.isVector3?Kd.copy(r):Kd.set(r,i,n);const l=this.parent;this.updateWorldMatrix(!0,!1),df.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rl.lookAt(df,Kd,this.up):rl.lookAt(Kd,df,this.up),this.quaternion.setFromRotationMatrix(rl),l&&(rl.extractRotation(l.matrixWorld),Hu.setFromRotationMatrix(rl),this.quaternion.premultiply(Hu.inverse()))},add:function(r){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(Xw)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)},remove:function(r){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(r);return i!==-1&&(r.parent=null,this.children.splice(i,1),r.dispatchEvent(jw)),this},attach:function(r){return this.updateWorldMatrix(!0,!1),rl.getInverse(this.matrixWorld),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),rl.multiply(r.parent.matrixWorld)),r.applyMatrix4(rl),r.updateWorldMatrix(!1,!1),this.add(r),this},getObjectById:function(r){return this.getObjectByProperty("id",r)},getObjectByName:function(r){return this.getObjectByProperty("name",r)},getObjectByProperty:function(r,i){if(this[r]===i)return this;for(let n=0,l=this.children.length;n<l;n++){const h=this.children[n].getObjectByProperty(r,i);if(h!==void 0)return h}},getWorldPosition:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new Ta),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(df,r,Ww),r},getWorldScale:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(df,qw,r),r},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return r.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(r){r(this);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].traverse(r)},traverseVisible:function(r){if(this.visible===!1)return;r(this);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].traverseVisible(r)},traverseAncestors:function(r){const i=this.parent;i!==null&&(r(i),i.traverseAncestors(r))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].updateMatrixWorld(r)},updateWorldMatrix:function(r,i){const n=this.parent;if(r===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const l=this.children;for(let u=0,h=l.length;u<h;u++)l[u].updateWorldMatrix(!1,!0)}},toJSON:function(r){const i=r===void 0||typeof r=="string",n={};i&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.castShadow===!0&&(l.castShadow=!0),this.receiveShadow===!0&&(l.receiveShadow=!0),this.visible===!1&&(l.visible=!1),this.frustumCulled===!1&&(l.frustumCulled=!1),this.renderOrder!==0&&(l.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON());function u(p,g){return p[g.uuid]===void 0&&(p[g.uuid]=g.toJSON(r)),g.uuid}if(this.isMesh||this.isLine||this.isPoints){l.geometry=u(r.geometries,this.geometry);const p=this.geometry.parameters;if(p!==void 0&&p.shapes!==void 0){const g=p.shapes;if(Array.isArray(g))for(let _=0,b=g.length;_<b;_++){const A=g[_];u(r.shapes,A)}else u(r.shapes,g)}}if(this.material!==void 0)if(Array.isArray(this.material)){const p=[];for(let g=0,_=this.material.length;g<_;g++)p.push(u(r.materials,this.material[g]));l.material=p}else l.material=u(r.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(r).object)}if(i){const p=h(r.geometries),g=h(r.materials),_=h(r.textures),b=h(r.images),A=h(r.shapes);p.length>0&&(n.geometries=p),g.length>0&&(n.materials=g),_.length>0&&(n.textures=_),b.length>0&&(n.images=b),A.length>0&&(n.shapes=A)}return n.object=l,n;function h(p){const g=[];for(const _ in p){const b=p[_];delete b.metadata,g.push(b)}return g}},clone:function(r){return new this.constructor().copy(this,r)},copy:function(r,i){if(i===void 0&&(i=!0),this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),i===!0)for(let n=0;n<r.children.length;n++){const l=r.children[n];this.add(l.clone())}return this}});const mg=new _e,Yw=new _e,Zw=new Ba;class al{constructor(i,n){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=i!==void 0?i:new _e(1,0,0),this.constant=n!==void 0?n:0}set(i,n){return this.normal.copy(i),this.constant=n,this}setComponents(i,n,l,u){return this.normal.set(i,n,l),this.constant=u,this}setFromNormalAndCoplanarPoint(i,n){return this.normal.copy(i),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(i,n,l){const u=mg.subVectors(l,n).cross(Yw.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(u,i),this}clone(){return new this.constructor().copy(this)}copy(i){return this.normal.copy(i.normal),this.constant=i.constant,this}normalize(){const i=1/this.normal.length();return this.normal.multiplyScalar(i),this.constant*=i,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(i){return this.normal.dot(i)+this.constant}distanceToSphere(i){return this.distanceToPoint(i.center)-i.radius}projectPoint(i,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new _e),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(i)).add(i)}intersectLine(i,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new _e);const l=i.delta(mg),u=this.normal.dot(l);if(u===0)return this.distanceToPoint(i.start)===0?n.copy(i.start):void 0;const h=-(i.start.dot(this.normal)+this.constant)/u;if(!(h<0||h>1))return n.copy(l).multiplyScalar(h).add(i.start)}intersectsLine(i){const n=this.distanceToPoint(i.start),l=this.distanceToPoint(i.end);return n<0&&l>0||l<0&&n>0}intersectsBox(i){return i.intersectsPlane(this)}intersectsSphere(i){return i.intersectsPlane(this)}coplanarPoint(i){return i===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),i=new _e),i.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(i,n){const l=n||Zw.getNormalMatrix(i),u=this.coplanarPoint(mg).applyMatrix4(i),h=this.normal.applyMatrix3(l).normalize();return this.constant=-u.dot(h),this}translate(i){return this.constant-=i.dot(this.normal),this}equals(i){return i.normal.equals(this.normal)&&i.constant===this.constant}}const Hs=new _e,sl=new _e,gg=new _e,ol=new _e,ku=new _e,Vu=new _e,c0=new _e,vg=new _e,yg=new _e,_g=new _e;class ha{constructor(i,n,l){this.a=i!==void 0?i:new _e,this.b=n!==void 0?n:new _e,this.c=l!==void 0?l:new _e}static getNormal(i,n,l,u){u===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),u=new _e),u.subVectors(l,n),Hs.subVectors(i,n),u.cross(Hs);const h=u.lengthSq();return h>0?u.multiplyScalar(1/Math.sqrt(h)):u.set(0,0,0)}static getBarycoord(i,n,l,u,h){Hs.subVectors(u,n),sl.subVectors(l,n),gg.subVectors(i,n);const p=Hs.dot(Hs),g=Hs.dot(sl),_=Hs.dot(gg),b=sl.dot(sl),A=sl.dot(gg),S=p*b-g*g;if(h===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new _e),S===0)return h.set(-2,-1,-1);const R=1/S,E=(b*_-g*A)*R,N=(p*A-g*_)*R;return h.set(1-E-N,N,E)}static containsPoint(i,n,l,u){return this.getBarycoord(i,n,l,u,ol),ol.x>=0&&ol.y>=0&&ol.x+ol.y<=1}static getUV(i,n,l,u,h,p,g,_){return this.getBarycoord(i,n,l,u,ol),_.set(0,0),_.addScaledVector(h,ol.x),_.addScaledVector(p,ol.y),_.addScaledVector(g,ol.z),_}static isFrontFacing(i,n,l,u){return Hs.subVectors(l,n),sl.subVectors(i,n),Hs.cross(sl).dot(u)<0}set(i,n,l){return this.a.copy(i),this.b.copy(n),this.c.copy(l),this}setFromPointsAndIndices(i,n,l,u){return this.a.copy(i[n]),this.b.copy(i[l]),this.c.copy(i[u]),this}clone(){return new this.constructor().copy(this)}copy(i){return this.a.copy(i.a),this.b.copy(i.b),this.c.copy(i.c),this}getArea(){return Hs.subVectors(this.c,this.b),sl.subVectors(this.a,this.b),Hs.cross(sl).length()*.5}getMidpoint(i){return i===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),i=new _e),i.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return ha.getNormal(this.a,this.b,this.c,i)}getPlane(i){return i===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),i=new al),i.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,n){return ha.getBarycoord(i,this.a,this.b,this.c,n)}getUV(i,n,l,u,h){return ha.getUV(i,this.a,this.b,this.c,n,l,u,h)}containsPoint(i){return ha.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return ha.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(i){return i.intersectsTriangle(this)}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new _e);const l=this.a,u=this.b,h=this.c;let p,g;ku.subVectors(u,l),Vu.subVectors(h,l),vg.subVectors(i,l);const _=ku.dot(vg),b=Vu.dot(vg);if(_<=0&&b<=0)return n.copy(l);yg.subVectors(i,u);const A=ku.dot(yg),S=Vu.dot(yg);if(A>=0&&S<=A)return n.copy(u);const R=_*S-A*b;if(R<=0&&_>=0&&A<=0)return p=_/(_-A),n.copy(l).addScaledVector(ku,p);_g.subVectors(i,h);const E=ku.dot(_g),N=Vu.dot(_g);if(N>=0&&E<=N)return n.copy(h);const W=E*b-_*N;if(W<=0&&b>=0&&N<=0)return g=b/(b-N),n.copy(l).addScaledVector(Vu,g);const V=A*N-E*S;if(V<=0&&S-A>=0&&E-N>=0)return c0.subVectors(h,u),g=(S-A)/(S-A+(E-N)),n.copy(u).addScaledVector(c0,g);const B=1/(V+W+R);return p=W*B,g=R*B,n.copy(l).addScaledVector(ku,p).addScaledVector(Vu,g)}equals(i){return i.a.equals(this.a)&&i.b.equals(this.b)&&i.c.equals(this.c)}}const u0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ks={h:0,s:0,l:0},$d={h:0,s:0,l:0};function xg(r,i,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(i-r)*6*n:n<1/2?i:n<2/3?r+(i-r)*6*(2/3-n):r}function bg(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function wg(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class Qt{constructor(i,n,l){return Object.defineProperty(this,"isColor",{value:!0}),n===void 0&&l===void 0?this.set(i):this.setRGB(i,n,l)}set(i){return i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i),this}setScalar(i){return this.r=i,this.g=i,this.b=i,this}setHex(i){return i=Math.floor(i),this.r=(i>>16&255)/255,this.g=(i>>8&255)/255,this.b=(i&255)/255,this}setRGB(i,n,l){return this.r=i,this.g=n,this.b=l,this}setHSL(i,n,l){if(i=zn.euclideanModulo(i,1),n=zn.clamp(n,0,1),l=zn.clamp(l,0,1),n===0)this.r=this.g=this.b=l;else{const u=l<=.5?l*(1+n):l+n-l*n,h=2*l-u;this.r=xg(h,u,i+1/3),this.g=xg(h,u,i),this.b=xg(h,u,i-1/3)}return this}setStyle(i){function n(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}let l;if(l=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(i)){let u;const h=l[1],p=l[2];switch(h){case"rgb":case"rgba":if(u=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,n(u[5]),this;if(u=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,n(u[5]),this;break;case"hsl":case"hsla":if(u=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p)){const g=parseFloat(u[1])/360,_=parseInt(u[2],10)/100,b=parseInt(u[3],10)/100;return n(u[5]),this.setHSL(g,_,b)}break}}else if(l=/^\#([A-Fa-f0-9]+)$/.exec(i)){const u=l[1],h=u.length;if(h===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(h===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return i&&i.length>0?this.setColorName(i):this}setColorName(i){const n=u0[i];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+i),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(i){return this.r=i.r,this.g=i.g,this.b=i.b,this}copyGammaToLinear(i,n){return n===void 0&&(n=2),this.r=Math.pow(i.r,n),this.g=Math.pow(i.g,n),this.b=Math.pow(i.b,n),this}copyLinearToGamma(i,n){n===void 0&&(n=2);const l=n>0?1/n:1;return this.r=Math.pow(i.r,l),this.g=Math.pow(i.g,l),this.b=Math.pow(i.b,l),this}convertGammaToLinear(i){return this.copyGammaToLinear(this,i),this}convertLinearToGamma(i){return this.copyLinearToGamma(this,i),this}copySRGBToLinear(i){return this.r=bg(i.r),this.g=bg(i.g),this.b=bg(i.b),this}copyLinearToSRGB(i){return this.r=wg(i.r),this.g=wg(i.g),this.b=wg(i.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(i){i===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),i={h:0,s:0,l:0});const n=this.r,l=this.g,u=this.b,h=Math.max(n,l,u),p=Math.min(n,l,u);let g,_;const b=(p+h)/2;if(p===h)g=0,_=0;else{const A=h-p;switch(_=b<=.5?A/(h+p):A/(2-h-p),h){case n:g=(l-u)/A+(l<u?6:0);break;case l:g=(u-n)/A+2;break;case u:g=(n-l)/A+4;break}g/=6}return i.h=g,i.s=_,i.l=b,i}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(i,n,l){return this.getHSL(ks),ks.h+=i,ks.s+=n,ks.l+=l,this.setHSL(ks.h,ks.s,ks.l),this}add(i){return this.r+=i.r,this.g+=i.g,this.b+=i.b,this}addColors(i,n){return this.r=i.r+n.r,this.g=i.g+n.g,this.b=i.b+n.b,this}addScalar(i){return this.r+=i,this.g+=i,this.b+=i,this}sub(i){return this.r=Math.max(0,this.r-i.r),this.g=Math.max(0,this.g-i.g),this.b=Math.max(0,this.b-i.b),this}multiply(i){return this.r*=i.r,this.g*=i.g,this.b*=i.b,this}multiplyScalar(i){return this.r*=i,this.g*=i,this.b*=i,this}lerp(i,n){return this.r+=(i.r-this.r)*n,this.g+=(i.g-this.g)*n,this.b+=(i.b-this.b)*n,this}lerpHSL(i,n){this.getHSL(ks),i.getHSL($d);const l=zn.lerp(ks.h,$d.h,n),u=zn.lerp(ks.s,$d.s,n),h=zn.lerp(ks.l,$d.l,n);return this.setHSL(l,u,h),this}equals(i){return i.r===this.r&&i.g===this.g&&i.b===this.b}fromArray(i,n){return n===void 0&&(n=0),this.r=i[n],this.g=i[n+1],this.b=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.r,i[n+1]=this.g,i[n+2]=this.b,i}fromBufferAttribute(i,n){return this.r=i.getX(n),this.g=i.getY(n),this.b=i.getZ(n),i.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Qt.NAMES=u0,Qt.prototype.r=1,Qt.prototype.g=1,Qt.prototype.b=1;class Mg{constructor(i,n,l,u,h,p){this.a=i,this.b=n,this.c=l,this.normal=u&&u.isVector3?u:new _e,this.vertexNormals=Array.isArray(u)?u:[],this.color=h&&h.isColor?h:new Qt,this.vertexColors=Array.isArray(h)?h:[],this.materialIndex=p!==void 0?p:0}clone(){return new this.constructor().copy(this)}copy(i){this.a=i.a,this.b=i.b,this.c=i.c,this.normal.copy(i.normal),this.color.copy(i.color),this.materialIndex=i.materialIndex;for(let n=0,l=i.vertexNormals.length;n<l;n++)this.vertexNormals[n]=i.vertexNormals[n].clone();for(let n=0,l=i.vertexColors.length;n<l;n++)this.vertexColors[n]=i.vertexColors[n].clone();return this}}let Jw=0;function Tn(){Object.defineProperty(this,"id",{value:Jw++}),this.uuid=zn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Na,this.side=Fs,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ln,this.blendDst=cn,this.blendEquation=bo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=zi,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Uw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lg,this.stencilZFail=lg,this.stencilZPass=lg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Tn.prototype=Object.assign(Object.create(Us.prototype),{constructor:Tn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(r){if(r!==void 0)for(const i in r){const n=r[i];if(n===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===$o;continue}const l=this[i];if(l===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}l&&l.isColor?l.set(n):l&&l.isVector3&&n&&n.isVector3?l.copy(n):this[i]=n}},toJSON:function(r){const i=r===void 0||typeof r=="string";i&&(r={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(r).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(r).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(r).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(r).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(r).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(r).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(r).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Na&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==Fs&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function l(u){const h=[];for(const p in u){const g=u[p];delete g.metadata,h.push(g)}return h}if(i){const u=l(r.textures),h=l(r.images);u.length>0&&(n.textures=u),h.length>0&&(n.images=h)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(r){this.name=r.name,this.fog=r.fog,this.blending=r.blending,this.side=r.side,this.flatShading=r.flatShading,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const i=r.clippingPlanes;let n=null;if(i!==null){const l=i.length;n=new Array(l);for(let u=0;u!==l;++u)n[u]=i[u].clone()}return this.clippingPlanes=n,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.premultipliedAlpha=r.premultipliedAlpha,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Tn.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});function ys(r){Tn.call(this),this.type="MeshBasicMaterial",this.color=new Qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=mi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(r)}ys.prototype=Object.create(Tn.prototype),ys.prototype.constructor=ys,ys.prototype.isMeshBasicMaterial=!0,ys.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this};const Xi=new _e,Qd=new bt;function Fn(r,i,n){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=r,this.itemSize=i,this.count=r!==void 0?r.length/i:0,this.normalized=n===!0,this.usage=Wd,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Fn.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Fn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.itemSize,n*=i.itemSize;for(let l=0,u=this.itemSize;l<u;l++)this.array[r+l]=i.array[n+l];return this},copyArray:function(r){return this.array.set(r),this},copyColorsArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",l),h=new Qt),i[n++]=h.r,i[n++]=h.g,i[n++]=h.b}return this},copyVector2sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",l),h=new bt),i[n++]=h.x,i[n++]=h.y}return this},copyVector3sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",l),h=new _e),i[n++]=h.x,i[n++]=h.y,i[n++]=h.z}return this},copyVector4sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",l),h=new Hi),i[n++]=h.x,i[n++]=h.y,i[n++]=h.z,i[n++]=h.w}return this},applyMatrix3:function(r){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)Qd.fromBufferAttribute(this,i),Qd.applyMatrix3(r),this.setXY(i,Qd.x,Qd.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)Xi.fromBufferAttribute(this,i),Xi.applyMatrix3(r),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this},applyMatrix4:function(r){for(let i=0,n=this.count;i<n;i++)Xi.x=this.getX(i),Xi.y=this.getY(i),Xi.z=this.getZ(i),Xi.applyMatrix4(r),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this},applyNormalMatrix:function(r){for(let i=0,n=this.count;i<n;i++)Xi.x=this.getX(i),Xi.y=this.getY(i),Xi.z=this.getZ(i),Xi.applyNormalMatrix(r),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this},transformDirection:function(r){for(let i=0,n=this.count;i<n;i++)Xi.x=this.getX(i),Xi.y=this.getY(i),Xi.z=this.getZ(i),Xi.transformDirection(r),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},getX:function(r){return this.array[r*this.itemSize]},setX:function(r,i){return this.array[r*this.itemSize]=i,this},getY:function(r){return this.array[r*this.itemSize+1]},setY:function(r,i){return this.array[r*this.itemSize+1]=i,this},getZ:function(r){return this.array[r*this.itemSize+2]},setZ:function(r,i){return this.array[r*this.itemSize+2]=i,this},getW:function(r){return this.array[r*this.itemSize+3]},setW:function(r,i){return this.array[r*this.itemSize+3]=i,this},setXY:function(r,i,n){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this},setXYZ:function(r,i,n,l){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=l,this},setXYZW:function(r,i,n,l,u){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=l,this.array[r+3]=u,this},onUpload:function(r){return this.onUploadCallback=r,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Sg(r,i,n){Fn.call(this,new Int8Array(r),i,n)}Sg.prototype=Object.create(Fn.prototype),Sg.prototype.constructor=Sg;function Tg(r,i,n){Fn.call(this,new Uint8Array(r),i,n)}Tg.prototype=Object.create(Fn.prototype),Tg.prototype.constructor=Tg;function Eg(r,i,n){Fn.call(this,new Uint8ClampedArray(r),i,n)}Eg.prototype=Object.create(Fn.prototype),Eg.prototype.constructor=Eg;function Ag(r,i,n){Fn.call(this,new Int16Array(r),i,n)}Ag.prototype=Object.create(Fn.prototype),Ag.prototype.constructor=Ag;function pf(r,i,n){Fn.call(this,new Uint16Array(r),i,n)}pf.prototype=Object.create(Fn.prototype),pf.prototype.constructor=pf;function Lg(r,i,n){Fn.call(this,new Int32Array(r),i,n)}Lg.prototype=Object.create(Fn.prototype),Lg.prototype.constructor=Lg;function mf(r,i,n){Fn.call(this,new Uint32Array(r),i,n)}mf.prototype=Object.create(Fn.prototype),mf.prototype.constructor=mf;function wi(r,i,n){Fn.call(this,new Float32Array(r),i,n)}wi.prototype=Object.create(Fn.prototype),wi.prototype.constructor=wi;function Rg(r,i,n){Fn.call(this,new Float64Array(r),i,n)}Rg.prototype=Object.create(Fn.prototype),Rg.prototype.constructor=Rg;class Kw{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(i){const n=[];let l,u,h;const p=i.faces;for(u=0;u<p.length;u++){const g=p[u];g.materialIndex!==h&&(h=g.materialIndex,l!==void 0&&(l.count=u*3-l.start,n.push(l)),l={start:u*3,materialIndex:h})}l!==void 0&&(l.count=u*3-l.start,n.push(l)),this.groups=n}fromGeometry(i){const n=i.faces,l=i.vertices,u=i.faceVertexUvs,h=u[0]&&u[0].length>0,p=u[1]&&u[1].length>0,g=i.morphTargets,_=g.length;let b;if(_>0){b=[];for(let B=0;B<_;B++)b[B]={name:g[B].name,data:[]};this.morphTargets.position=b}const A=i.morphNormals,S=A.length;let R;if(S>0){R=[];for(let B=0;B<S;B++)R[B]={name:A[B].name,data:[]};this.morphTargets.normal=R}const E=i.skinIndices,N=i.skinWeights,W=E.length===l.length,V=N.length===l.length;l.length>0&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let B=0;B<n.length;B++){const O=n[B];this.vertices.push(l[O.a],l[O.b],l[O.c]);const pe=O.vertexNormals;if(pe.length===3)this.normals.push(pe[0],pe[1],pe[2]);else{const ye=O.normal;this.normals.push(ye,ye,ye)}const ge=O.vertexColors;if(ge.length===3)this.colors.push(ge[0],ge[1],ge[2]);else{const ye=O.color;this.colors.push(ye,ye,ye)}if(h===!0){const ye=u[0][B];ye!==void 0?this.uvs.push(ye[0],ye[1],ye[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",B),this.uvs.push(new bt,new bt,new bt))}if(p===!0){const ye=u[1][B];ye!==void 0?this.uvs2.push(ye[0],ye[1],ye[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",B),this.uvs2.push(new bt,new bt,new bt))}for(let ye=0;ye<_;ye++){const $=g[ye].vertices;b[ye].data.push($[O.a],$[O.b],$[O.c])}for(let ye=0;ye<S;ye++){const $=A[ye].vertexNormals[B];R[ye].data.push($.a,$.b,$.c)}W&&this.skinIndices.push(E[O.a],E[O.b],E[O.c]),V&&this.skinWeights.push(N[O.a],N[O.b],N[O.c])}return this.computeGroups(i),this.verticesNeedUpdate=i.verticesNeedUpdate,this.normalsNeedUpdate=i.normalsNeedUpdate,this.colorsNeedUpdate=i.colorsNeedUpdate,this.uvsNeedUpdate=i.uvsNeedUpdate,this.groupsNeedUpdate=i.groupsNeedUpdate,i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone()),this}}function h0(r){if(r.length===0)return-1/0;let i=r[0];for(let n=1,l=r.length;n<l;++n)r[n]>i&&(i=r[n]);return i}let $w=1;const So=new Wn,Cg=new yn,Wu=new _e,Ka=new el,gf=new el,Zr=new _e;function Ni(){Object.defineProperty(this,"id",{value:$w+=2}),this.uuid=zn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ni.prototype=Object.assign(Object.create(Us.prototype),{constructor:Ni,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(r){return Array.isArray(r)?this.index=new(h0(r)>65535?mf:pf)(r,1):this.index=r,this},getAttribute:function(r){return this.attributes[r]},setAttribute:function(r,i){return this.attributes[r]=i,this},deleteAttribute:function(r){return delete this.attributes[r],this},addGroup:function(r,i,n){this.groups.push({start:r,count:i,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(r,i){this.drawRange.start=r,this.drawRange.count=i},applyMatrix4:function(r){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(r),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const u=new Ba().getNormalMatrix(r);n.applyNormalMatrix(u),n.needsUpdate=!0}const l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(r),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(r){return So.makeRotationX(r),this.applyMatrix4(So),this},rotateY:function(r){return So.makeRotationY(r),this.applyMatrix4(So),this},rotateZ:function(r){return So.makeRotationZ(r),this.applyMatrix4(So),this},translate:function(r,i,n){return So.makeTranslation(r,i,n),this.applyMatrix4(So),this},scale:function(r,i,n){return So.makeScale(r,i,n),this.applyMatrix4(So),this},lookAt:function(r){return Cg.lookAt(r),Cg.updateMatrix(),this.applyMatrix4(Cg.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wu).negate(),this.translate(Wu.x,Wu.y,Wu.z),this},setFromObject:function(r){const i=r.geometry;if(r.isPoints||r.isLine){const n=new wi(i.vertices.length*3,3),l=new wi(i.colors.length*3,3);if(this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",l.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){const u=new wi(i.lineDistances.length,1);this.setAttribute("lineDistance",u.copyArray(i.lineDistances))}i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone())}else r.isMesh&&i&&i.isGeometry&&this.fromGeometry(i);return this},setFromPoints:function(r){const i=[];for(let n=0,l=r.length;n<l;n++){const u=r[n];i.push(u.x,u.y,u.z||0)}return this.setAttribute("position",new wi(i,3)),this},updateFromObject:function(r){let i=r.geometry;if(r.isMesh){let n=i.__directGeometry;if(i.elementsNeedUpdate===!0&&(n=void 0,i.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}if(i.verticesNeedUpdate===!0){const n=this.attributes.position;n!==void 0&&(n.copyVector3sArray(i.vertices),n.needsUpdate=!0),i.verticesNeedUpdate=!1}if(i.normalsNeedUpdate===!0){const n=this.attributes.normal;n!==void 0&&(n.copyVector3sArray(i.normals),n.needsUpdate=!0),i.normalsNeedUpdate=!1}if(i.colorsNeedUpdate===!0){const n=this.attributes.color;n!==void 0&&(n.copyColorsArray(i.colors),n.needsUpdate=!0),i.colorsNeedUpdate=!1}if(i.uvsNeedUpdate){const n=this.attributes.uv;n!==void 0&&(n.copyVector2sArray(i.uvs),n.needsUpdate=!0),i.uvsNeedUpdate=!1}if(i.lineDistancesNeedUpdate){const n=this.attributes.lineDistance;n!==void 0&&(n.copyArray(i.lineDistances),n.needsUpdate=!0),i.lineDistancesNeedUpdate=!1}return i.groupsNeedUpdate&&(i.computeGroups(r.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(r){return r.__directGeometry=new Kw().fromGeometry(r),this.fromDirectGeometry(r.__directGeometry)},fromDirectGeometry:function(r){const i=new Float32Array(r.vertices.length*3);if(this.setAttribute("position",new Fn(i,3).copyVector3sArray(r.vertices)),r.normals.length>0){const n=new Float32Array(r.normals.length*3);this.setAttribute("normal",new Fn(n,3).copyVector3sArray(r.normals))}if(r.colors.length>0){const n=new Float32Array(r.colors.length*3);this.setAttribute("color",new Fn(n,3).copyColorsArray(r.colors))}if(r.uvs.length>0){const n=new Float32Array(r.uvs.length*2);this.setAttribute("uv",new Fn(n,2).copyVector2sArray(r.uvs))}if(r.uvs2.length>0){const n=new Float32Array(r.uvs2.length*2);this.setAttribute("uv2",new Fn(n,2).copyVector2sArray(r.uvs2))}this.groups=r.groups;for(const n in r.morphTargets){const l=[],u=r.morphTargets[n];for(let h=0,p=u.length;h<p;h++){const g=u[h],_=new wi(g.data.length*3,3);_.name=g.name,l.push(_.copyVector3sArray(g.data))}this.morphAttributes[n]=l}if(r.skinIndices.length>0){const n=new wi(r.skinIndices.length*4,4);this.setAttribute("skinIndex",n.copyVector4sArray(r.skinIndices))}if(r.skinWeights.length>0){const n=new wi(r.skinWeights.length*4,4);this.setAttribute("skinWeight",n.copyVector4sArray(r.skinWeights))}return r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new el);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new _e(-1/0,-1/0,-1/0),new _e(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),i)for(let n=0,l=i.length;n<l;n++){const u=i[n];Ka.setFromBufferAttribute(u),this.morphTargetsRelative?(Zr.addVectors(this.boundingBox.min,Ka.min),this.boundingBox.expandByPoint(Zr),Zr.addVectors(this.boundingBox.max,Ka.max),this.boundingBox.expandByPoint(Zr)):(this.boundingBox.expandByPoint(Ka.min),this.boundingBox.expandByPoint(Ka.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new nl);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new _e,1/0);return}if(r){const n=this.boundingSphere.center;if(Ka.setFromBufferAttribute(r),i)for(let u=0,h=i.length;u<h;u++){const p=i[u];gf.setFromBufferAttribute(p),this.morphTargetsRelative?(Zr.addVectors(Ka.min,gf.min),Ka.expandByPoint(Zr),Zr.addVectors(Ka.max,gf.max),Ka.expandByPoint(Zr)):(Ka.expandByPoint(gf.min),Ka.expandByPoint(gf.max))}Ka.getCenter(n);let l=0;for(let u=0,h=r.count;u<h;u++)Zr.fromBufferAttribute(r,u),l=Math.max(l,n.distanceToSquared(Zr));if(i)for(let u=0,h=i.length;u<h;u++){const p=i[u],g=this.morphTargetsRelative;for(let _=0,b=p.count;_<b;_++)Zr.fromBufferAttribute(p,_),g&&(Wu.fromBufferAttribute(r,_),Zr.add(Wu)),l=Math.max(l,n.distanceToSquared(Zr))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const r=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Fn(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let S=0,R=n.count;S<R;S++)n.setXYZ(S,0,0,0);const l=new _e,u=new _e,h=new _e,p=new _e,g=new _e,_=new _e,b=new _e,A=new _e;if(r)for(let S=0,R=r.count;S<R;S+=3){const E=r.getX(S+0),N=r.getX(S+1),W=r.getX(S+2);l.fromBufferAttribute(i,E),u.fromBufferAttribute(i,N),h.fromBufferAttribute(i,W),b.subVectors(h,u),A.subVectors(l,u),b.cross(A),p.fromBufferAttribute(n,E),g.fromBufferAttribute(n,N),_.fromBufferAttribute(n,W),p.add(b),g.add(b),_.add(b),n.setXYZ(E,p.x,p.y,p.z),n.setXYZ(N,g.x,g.y,g.z),n.setXYZ(W,_.x,_.y,_.z)}else for(let S=0,R=i.count;S<R;S+=3)l.fromBufferAttribute(i,S+0),u.fromBufferAttribute(i,S+1),h.fromBufferAttribute(i,S+2),b.subVectors(h,u),A.subVectors(l,u),b.cross(A),n.setXYZ(S+0,b.x,b.y,b.z),n.setXYZ(S+1,b.x,b.y,b.z),n.setXYZ(S+2,b.x,b.y,b.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(r,i){if(!(r&&r.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",r);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const l in n){if(r.attributes[l]===void 0)continue;const h=n[l].array,p=r.attributes[l],g=p.array,_=p.itemSize*i,b=Math.min(g.length,h.length-_);for(let A=0,S=_;A<b;A++,S++)h[S]=g[A]}return this},normalizeNormals:function(){const r=this.attributes.normal;for(let i=0,n=r.count;i<n;i++)Zr.fromBufferAttribute(r,i),Zr.normalize(),r.setXYZ(i,Zr.x,Zr.y,Zr.z)},toNonIndexed:function(){function r(p,g){const _=p.array,b=p.itemSize,A=p.normalized,S=new _.constructor(g.length*b);let R=0,E=0;for(let N=0,W=g.length;N<W;N++){R=g[N]*b;for(let V=0;V<b;V++)S[E++]=_[R++]}return new Fn(S,b,A)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const i=new Ni,n=this.index.array,l=this.attributes;for(const p in l){const g=l[p],_=r(g,n);i.setAttribute(p,_)}const u=this.morphAttributes;for(const p in u){const g=[],_=u[p];for(let b=0,A=_.length;b<A;b++){const S=_[b],R=r(S,n);g.push(R)}i.morphAttributes[p]=g}i.morphTargetsRelative=this.morphTargetsRelative;const h=this.groups;for(let p=0,g=h.length;p<g;p++){const _=h[p];i.addGroup(_.start,_.count,_.materialIndex)}return i},toJSON:function(){const r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){const g=this.parameters;for(const _ in g)g[_]!==void 0&&(r[_]=g[_]);return r}r.data={attributes:{}};const i=this.index;i!==null&&(r.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const g in n){const _=n[g],b=_.toJSON(r.data);_.name!==""&&(b.name=_.name),r.data.attributes[g]=b}const l={};let u=!1;for(const g in this.morphAttributes){const _=this.morphAttributes[g],b=[];for(let A=0,S=_.length;A<S;A++){const R=_[A],E=R.toJSON(r.data);R.name!==""&&(E.name=R.name),b.push(E)}b.length>0&&(l[g]=b,u=!0)}u&&(r.data.morphAttributes=l,r.data.morphTargetsRelative=this.morphTargetsRelative);const h=this.groups;h.length>0&&(r.data.groups=JSON.parse(JSON.stringify(h)));const p=this.boundingSphere;return p!==null&&(r.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),r},clone:function(){return new Ni().copy(this)},copy:function(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=r.name;const n=r.index;n!==null&&this.setIndex(n.clone(i));const l=r.attributes;for(const _ in l){const b=l[_];this.setAttribute(_,b.clone(i))}const u=r.morphAttributes;for(const _ in u){const b=[],A=u[_];for(let S=0,R=A.length;S<R;S++)b.push(A[S].clone(i));this.morphAttributes[_]=b}this.morphTargetsRelative=r.morphTargetsRelative;const h=r.groups;for(let _=0,b=h.length;_<b;_++){const A=h[_];this.addGroup(A.start,A.count,A.materialIndex)}const p=r.boundingBox;p!==null&&(this.boundingBox=p.clone());const g=r.boundingSphere;return g!==null&&(this.boundingSphere=g.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const f0=new Wn,Hc=new hf,Pg=new nl,Wl=new _e,ql=new _e,Xl=new _e,Ig=new _e,Dg=new _e,Og=new _e,ep=new _e,tp=new _e,np=new _e,qu=new bt,Xu=new bt,ju=new bt,vf=new _e,ip=new _e;function ra(r,i){yn.call(this),this.type="Mesh",this.geometry=r!==void 0?r:new Ni,this.material=i!==void 0?i:new ys,this.updateMorphTargets()}ra.prototype=Object.assign(Object.create(yn.prototype),{constructor:ra,isMesh:!0,copy:function(r){return yn.prototype.copy.call(this,r),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=r.material,this.geometry=r.geometry,this},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(r,i){const n=this.geometry,l=this.material,u=this.matrixWorld;if(l===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Pg.copy(n.boundingSphere),Pg.applyMatrix4(u),r.ray.intersectsSphere(Pg)===!1)||(f0.getInverse(u),Hc.copy(r.ray).applyMatrix4(f0),n.boundingBox!==null&&Hc.intersectsBox(n.boundingBox)===!1))return;let h;if(n.isBufferGeometry){const p=n.index,g=n.attributes.position,_=n.morphAttributes.position,b=n.morphTargetsRelative,A=n.attributes.uv,S=n.attributes.uv2,R=n.groups,E=n.drawRange;if(p!==null)if(Array.isArray(l))for(let N=0,W=R.length;N<W;N++){const V=R[N],B=l[V.materialIndex],O=Math.max(V.start,E.start),pe=Math.min(V.start+V.count,E.start+E.count);for(let ge=O,ye=pe;ge<ye;ge+=3){const $=p.getX(ge),Ie=p.getX(ge+1),tt=p.getX(ge+2);h=rp(this,B,r,Hc,g,_,b,A,S,$,Ie,tt),h&&(h.faceIndex=Math.floor(ge/3),h.face.materialIndex=V.materialIndex,i.push(h))}}else{const N=Math.max(0,E.start),W=Math.min(p.count,E.start+E.count);for(let V=N,B=W;V<B;V+=3){const O=p.getX(V),pe=p.getX(V+1),ge=p.getX(V+2);h=rp(this,l,r,Hc,g,_,b,A,S,O,pe,ge),h&&(h.faceIndex=Math.floor(V/3),i.push(h))}}else if(g!==void 0)if(Array.isArray(l))for(let N=0,W=R.length;N<W;N++){const V=R[N],B=l[V.materialIndex],O=Math.max(V.start,E.start),pe=Math.min(V.start+V.count,E.start+E.count);for(let ge=O,ye=pe;ge<ye;ge+=3){const $=ge,Ie=ge+1,tt=ge+2;h=rp(this,B,r,Hc,g,_,b,A,S,$,Ie,tt),h&&(h.faceIndex=Math.floor(ge/3),h.face.materialIndex=V.materialIndex,i.push(h))}}else{const N=Math.max(0,E.start),W=Math.min(g.count,E.start+E.count);for(let V=N,B=W;V<B;V+=3){const O=V,pe=V+1,ge=V+2;h=rp(this,l,r,Hc,g,_,b,A,S,O,pe,ge),h&&(h.faceIndex=Math.floor(V/3),i.push(h))}}}else if(n.isGeometry){const p=Array.isArray(l),g=n.vertices,_=n.faces;let b;const A=n.faceVertexUvs[0];A.length>0&&(b=A);for(let S=0,R=_.length;S<R;S++){const E=_[S],N=p?l[E.materialIndex]:l;if(N===void 0)continue;const W=g[E.a],V=g[E.b],B=g[E.c];if(h=d0(this,N,r,Hc,W,V,B,vf),h){if(b&&b[S]){const O=b[S];qu.copy(O[0]),Xu.copy(O[1]),ju.copy(O[2]),h.uv=ha.getUV(vf,W,V,B,qu,Xu,ju,new bt)}h.face=E,h.faceIndex=S,i.push(h)}}}}});function d0(r,i,n,l,u,h,p,g){let _;if(i.side===ti?_=l.intersectTriangle(p,h,u,!0,g):_=l.intersectTriangle(u,h,p,i.side!==jr,g),_===null)return null;ip.copy(g),ip.applyMatrix4(r.matrixWorld);const b=n.ray.origin.distanceTo(ip);return b<n.near||b>n.far?null:{distance:b,point:ip.clone(),object:r}}function rp(r,i,n,l,u,h,p,g,_,b,A,S){Wl.fromBufferAttribute(u,b),ql.fromBufferAttribute(u,A),Xl.fromBufferAttribute(u,S);const R=r.morphTargetInfluences;if(i.morphTargets&&h&&R){ep.set(0,0,0),tp.set(0,0,0),np.set(0,0,0);for(let N=0,W=h.length;N<W;N++){const V=R[N],B=h[N];V!==0&&(Ig.fromBufferAttribute(B,b),Dg.fromBufferAttribute(B,A),Og.fromBufferAttribute(B,S),p?(ep.addScaledVector(Ig,V),tp.addScaledVector(Dg,V),np.addScaledVector(Og,V)):(ep.addScaledVector(Ig.sub(Wl),V),tp.addScaledVector(Dg.sub(ql),V),np.addScaledVector(Og.sub(Xl),V)))}Wl.add(ep),ql.add(tp),Xl.add(np)}r.isSkinnedMesh&&(r.boneTransform(b,Wl),r.boneTransform(A,ql),r.boneTransform(S,Xl));const E=d0(r,i,n,l,Wl,ql,Xl,vf);if(E){g&&(qu.fromBufferAttribute(g,b),Xu.fromBufferAttribute(g,A),ju.fromBufferAttribute(g,S),E.uv=ha.getUV(vf,Wl,ql,Xl,qu,Xu,ju,new bt)),_&&(qu.fromBufferAttribute(_,b),Xu.fromBufferAttribute(_,A),ju.fromBufferAttribute(_,S),E.uv2=ha.getUV(vf,Wl,ql,Xl,qu,Xu,ju,new bt));const N=new Mg(b,A,S);ha.getNormal(Wl,ql,Xl,N.normal),E.face=N}return E}class p0 extends Ni{constructor(i=1,n=1,l=1,u=1,h=1,p=1){super(),this.type="BoxBufferGeometry",this.parameters={width:i,height:n,depth:l,widthSegments:u,heightSegments:h,depthSegments:p};const g=this;u=Math.floor(u),h=Math.floor(h),p=Math.floor(p);const _=[],b=[],A=[],S=[];let R=0,E=0;N("z","y","x",-1,-1,l,n,i,p,h,0),N("z","y","x",1,-1,l,n,-i,p,h,1),N("x","z","y",1,1,i,l,n,u,p,2),N("x","z","y",1,-1,i,l,-n,u,p,3),N("x","y","z",1,-1,i,n,l,u,h,4),N("x","y","z",-1,-1,i,n,-l,u,h,5),this.setIndex(_),this.setAttribute("position",new wi(b,3)),this.setAttribute("normal",new wi(A,3)),this.setAttribute("uv",new wi(S,2));function N(W,V,B,O,pe,ge,ye,$,Ie,tt,qe){const ft=ge/Ie,je=ye/tt,Ne=ge/2,Ue=ye/2,Le=$/2,Te=Ie+1,Ve=tt+1;let We=0,at=0;const Tt=new _e;for(let nt=0;nt<Ve;nt++){const At=nt*je-Ue;for(let nn=0;nn<Te;nn++){const Yt=nn*ft-Ne;Tt[W]=Yt*O,Tt[V]=At*pe,Tt[B]=Le,b.push(Tt.x,Tt.y,Tt.z),Tt[W]=0,Tt[V]=0,Tt[B]=$>0?1:-1,A.push(Tt.x,Tt.y,Tt.z),S.push(nn/Ie),S.push(1-nt/tt),We+=1}}for(let nt=0;nt<tt;nt++)for(let At=0;At<Ie;At++){const nn=R+At+Te*nt,Yt=R+At+Te*(nt+1),K=R+(At+1)+Te*(nt+1),H=R+(At+1)+Te*nt;_.push(nn,Yt,H),_.push(Yt,K,H),at+=6}g.addGroup(E,at,qe),E+=at,R+=We}}}function Yu(r){const i={};for(const n in r){i[n]={};for(const l in r[n]){const u=r[n][l];u&&(u.isColor||u.isMatrix3||u.isMatrix4||u.isVector2||u.isVector3||u.isVector4||u.isTexture)?i[n][l]=u.clone():Array.isArray(u)?i[n][l]=u.slice():i[n][l]=u}}return i}function fa(r){const i={};for(let n=0;n<r.length;n++){const l=Yu(r[n]);for(const u in l)i[u]=l[u]}return i}const Qw={clone:Yu,merge:fa};var eM=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tM=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Ua(r){Tn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=eM,this.fragmentShader=tM,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&(r.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(r))}Ua.prototype=Object.create(Tn.prototype),Ua.prototype.constructor=Ua,Ua.prototype.isShaderMaterial=!0,Ua.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Yu(r.uniforms),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.lights=r.lights,this.clipping=r.clipping,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this},Ua.prototype.toJSON=function(r){const i=Tn.prototype.toJSON.call(this,r);i.glslVersion=this.glslVersion,i.uniforms={};for(const l in this.uniforms){const h=this.uniforms[l].value;h&&h.isTexture?i.uniforms[l]={type:"t",value:h.toJSON(r).uuid}:h&&h.isColor?i.uniforms[l]={type:"c",value:h.getHex()}:h&&h.isVector2?i.uniforms[l]={type:"v2",value:h.toArray()}:h&&h.isVector3?i.uniforms[l]={type:"v3",value:h.toArray()}:h&&h.isVector4?i.uniforms[l]={type:"v4",value:h.toArray()}:h&&h.isMatrix3?i.uniforms[l]={type:"m3",value:h.toArray()}:h&&h.isMatrix4?i.uniforms[l]={type:"m4",value:h.toArray()}:i.uniforms[l]={value:h}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const n={};for(const l in this.extensions)this.extensions[l]===!0&&(n[l]=!0);return Object.keys(n).length>0&&(i.extensions=n),i};function jl(){yn.call(this),this.type="Camera",this.matrixWorldInverse=new Wn,this.projectionMatrix=new Wn,this.projectionMatrixInverse=new Wn}jl.prototype=Object.assign(Object.create(yn.prototype),{constructor:jl,isCamera:!0,copy:function(r,i){return yn.prototype.copy.call(this,r,i),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),r=new _e),this.updateMatrixWorld(!0);const i=this.matrixWorld.elements;return r.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(r){yn.prototype.updateMatrixWorld.call(this,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(r,i){yn.prototype.updateWorldMatrix.call(this,r,i),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function Jr(r,i,n,l){jl.call(this),this.type="PerspectiveCamera",this.fov=r!==void 0?r:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=l!==void 0?l:2e3,this.focus=10,this.aspect=i!==void 0?i:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Jr.prototype=Object.assign(Object.create(jl.prototype),{constructor:Jr,isPerspectiveCamera:!0,copy:function(r,i){return jl.prototype.copy.call(this,r,i),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this},setFocalLength:function(r){const i=.5*this.getFilmHeight()/r;this.fov=zn.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){const r=Math.tan(zn.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/r},getEffectiveFOV:function(){return zn.RAD2DEG*2*Math.atan(Math.tan(zn.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(r,i,n,l,u,h){this.aspect=r/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=l,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=this.near;let i=r*Math.tan(zn.DEG2RAD*.5*this.fov)/this.zoom,n=2*i,l=this.aspect*n,u=-.5*l;const h=this.view;if(this.view!==null&&this.view.enabled){const g=h.fullWidth,_=h.fullHeight;u+=h.offsetX*l/g,i-=h.offsetY*n/_,l*=h.width/g,n*=h.height/_}const p=this.filmOffset;p!==0&&(u+=r*p/this.getFilmWidth()),this.projectionMatrix.makePerspective(u,u+l,i,i-n,r,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=yn.prototype.toJSON.call(this,r);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});const Zu=90,Ju=1;function yf(r,i,n){if(yn.call(this),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const l=new Jr(Zu,Ju,r,i);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new _e(1,0,0)),this.add(l);const u=new Jr(Zu,Ju,r,i);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new _e(-1,0,0)),this.add(u);const h=new Jr(Zu,Ju,r,i);h.layers=this.layers,h.up.set(0,0,1),h.lookAt(new _e(0,1,0)),this.add(h);const p=new Jr(Zu,Ju,r,i);p.layers=this.layers,p.up.set(0,0,-1),p.lookAt(new _e(0,-1,0)),this.add(p);const g=new Jr(Zu,Ju,r,i);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new _e(0,0,1)),this.add(g);const _=new Jr(Zu,Ju,r,i);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new _e(0,0,-1)),this.add(_),this.update=function(b,A){this.parent===null&&this.updateMatrixWorld();const S=b.xr.enabled,R=b.getRenderTarget();b.xr.enabled=!1;const E=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,b.setRenderTarget(n,0),b.render(A,l),b.setRenderTarget(n,1),b.render(A,u),b.setRenderTarget(n,2),b.render(A,h),b.setRenderTarget(n,3),b.render(A,p),b.setRenderTarget(n,4),b.render(A,g),n.texture.generateMipmaps=E,b.setRenderTarget(n,5),b.render(A,_),b.setRenderTarget(R),b.xr.enabled=S},this.clear=function(b,A,S,R){const E=b.getRenderTarget();for(let N=0;N<6;N++)b.setRenderTarget(n,N),b.clear(A,S,R);b.setRenderTarget(E)}}yf.prototype=Object.create(yn.prototype),yf.prototype.constructor=yf;function Yl(r,i,n,l,u,h,p,g,_,b){r=r!==void 0?r:[],i=i!==void 0?i:wo,p=p!==void 0?p:Mo,qi.call(this,r,i,n,l,u,h,p,g,_,b),this.flipY=!1,this._needsFlipEnvMap=!0}Yl.prototype=Object.create(qi.prototype),Yl.prototype.constructor=Yl,Yl.prototype.isCubeTexture=!0,Object.defineProperty(Yl.prototype,"images",{get:function(){return this.image},set:function(r){this.image=r}});function Ku(r,i,n){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=n),Gs.call(this,r,r,i),i=i||{},this.texture=new Yl(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture._needsFlipEnvMap=!1}Ku.prototype=Object.create(Gs.prototype),Ku.prototype.constructor=Ku,Ku.prototype.isWebGLCubeRenderTarget=!0,Ku.prototype.fromEquirectangularTexture=function(r,i){this.texture.type=i.type,this.texture.format=vs,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},l=new p0(5,5,5),u=new Ua({name:"CubemapFromEquirect",uniforms:Yu(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ti,blending:Za});u.uniforms.tEquirect.value=i;const h=new ra(l,u),p=i.minFilter;return i.minFilter===Pu&&(i.minFilter=Rn),new yf(1,10,this).update(r,h),i.minFilter=p,h.geometry.dispose(),h.material.dispose(),this};function $u(r,i,n,l,u,h,p,g,_,b,A,S){qi.call(this,null,h,p,g,_,b,l,u,A,S),this.image={data:r||null,width:i||1,height:n||1},this.magFilter=_!==void 0?_:Et,this.minFilter=b!==void 0?b:Et,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}$u.prototype=Object.create(qi.prototype),$u.prototype.constructor=$u,$u.prototype.isDataTexture=!0;const Qu=new nl,ap=new _e;class sp{constructor(i,n,l,u,h,p){this.planes=[i!==void 0?i:new al,n!==void 0?n:new al,l!==void 0?l:new al,u!==void 0?u:new al,h!==void 0?h:new al,p!==void 0?p:new al]}set(i,n,l,u,h,p){const g=this.planes;return g[0].copy(i),g[1].copy(n),g[2].copy(l),g[3].copy(u),g[4].copy(h),g[5].copy(p),this}clone(){return new this.constructor().copy(this)}copy(i){const n=this.planes;for(let l=0;l<6;l++)n[l].copy(i.planes[l]);return this}setFromProjectionMatrix(i){const n=this.planes,l=i.elements,u=l[0],h=l[1],p=l[2],g=l[3],_=l[4],b=l[5],A=l[6],S=l[7],R=l[8],E=l[9],N=l[10],W=l[11],V=l[12],B=l[13],O=l[14],pe=l[15];return n[0].setComponents(g-u,S-_,W-R,pe-V).normalize(),n[1].setComponents(g+u,S+_,W+R,pe+V).normalize(),n[2].setComponents(g+h,S+b,W+E,pe+B).normalize(),n[3].setComponents(g-h,S-b,W-E,pe-B).normalize(),n[4].setComponents(g-p,S-A,W-N,pe-O).normalize(),n[5].setComponents(g+p,S+A,W+N,pe+O).normalize(),this}intersectsObject(i){const n=i.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Qu.copy(n.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(Qu)}intersectsSprite(i){return Qu.center.set(0,0,0),Qu.radius=.7071067811865476,Qu.applyMatrix4(i.matrixWorld),this.intersectsSphere(Qu)}intersectsSphere(i){const n=this.planes,l=i.center,u=-i.radius;for(let h=0;h<6;h++)if(n[h].distanceToPoint(l)<u)return!1;return!0}intersectsBox(i){const n=this.planes;for(let l=0;l<6;l++){const u=n[l];if(ap.x=u.normal.x>0?i.max.x:i.min.x,ap.y=u.normal.y>0?i.max.y:i.min.y,ap.z=u.normal.z>0?i.max.z:i.min.z,u.distanceToPoint(ap)<0)return!1}return!0}containsPoint(i){const n=this.planes;for(let l=0;l<6;l++)if(n[l].distanceToPoint(i)<0)return!1;return!0}}function m0(){let r=null,i=!1,n=null,l=null;function u(h,p){n(h,p),l=r.requestAnimationFrame(u)}return{start:function(){i!==!0&&n!==null&&(l=r.requestAnimationFrame(u),i=!0)},stop:function(){r.cancelAnimationFrame(l),i=!1},setAnimationLoop:function(h){n=h},setContext:function(h){r=h}}}function nM(r,i){const n=i.isWebGL2,l=new WeakMap;function u(b,A){const S=b.array,R=b.usage,E=r.createBuffer();r.bindBuffer(A,E),r.bufferData(A,S,R),b.onUploadCallback();let N=5126;return S instanceof Float32Array?N=5126:S instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):S instanceof Uint16Array?N=5123:S instanceof Int16Array?N=5122:S instanceof Uint32Array?N=5125:S instanceof Int32Array?N=5124:S instanceof Int8Array?N=5120:S instanceof Uint8Array&&(N=5121),{buffer:E,type:N,bytesPerElement:S.BYTES_PER_ELEMENT,version:b.version}}function h(b,A,S){const R=A.array,E=A.updateRange;r.bindBuffer(S,b),E.count===-1?r.bufferSubData(S,0,R):(n?r.bufferSubData(S,E.offset*R.BYTES_PER_ELEMENT,R,E.offset,E.count):r.bufferSubData(S,E.offset*R.BYTES_PER_ELEMENT,R.subarray(E.offset,E.offset+E.count)),E.count=-1)}function p(b){return b.isInterleavedBufferAttribute&&(b=b.data),l.get(b)}function g(b){b.isInterleavedBufferAttribute&&(b=b.data);const A=l.get(b);A&&(r.deleteBuffer(A.buffer),l.delete(b))}function _(b,A){if(b.isGLBufferAttribute){var S=l.get(b);(!S||S.version<b.version)&&l.set(b,{buffer:b.buffer,type:b.type,bytesPerElement:b.elementSize,version:b.version});return}b.isInterleavedBufferAttribute&&(b=b.data);const R=l.get(b);R===void 0?l.set(b,u(b,A)):R.version<b.version&&(h(R.buffer,b,A),R.version=b.version)}return{get:p,remove:g,update:_}}class iM extends Ni{constructor(i,n,l,u){super(),this.type="PlaneBufferGeometry",this.parameters={width:i,height:n,widthSegments:l,heightSegments:u},i=i||1,n=n||1;const h=i/2,p=n/2,g=Math.floor(l)||1,_=Math.floor(u)||1,b=g+1,A=_+1,S=i/g,R=n/_,E=[],N=[],W=[],V=[];for(let B=0;B<A;B++){const O=B*R-p;for(let pe=0;pe<b;pe++){const ge=pe*S-h;N.push(ge,-O,0),W.push(0,0,1),V.push(pe/g),V.push(1-B/_)}}for(let B=0;B<_;B++)for(let O=0;O<g;O++){const pe=O+b*B,ge=O+b*(B+1),ye=O+1+b*(B+1),$=O+1+b*B;E.push(pe,ge,$),E.push(ge,ye,$)}this.setIndex(E),this.setAttribute("position",new wi(N,3)),this.setAttribute("normal",new wi(W,3)),this.setAttribute("uv",new wi(V,2))}}var rM=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,aM=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sM=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,oM=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,lM=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cM="vec3 transformed = vec3( position );",uM=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hM=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,fM=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dM=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,pM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,mM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,gM=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,vM=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,yM=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,_M=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,xM=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,bM=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,wM=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,MM=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,SM=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,TM=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,EM=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,AM=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,LM="gl_FragColor = linearToOutputTexel( gl_FragColor );",RM=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,CM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PM=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,IM=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DM=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,OM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,NM=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,FM=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,BM=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UM=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,GM=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,zM=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,HM=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,kM=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,VM=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,WM=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,qM=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,XM=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,jM=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,YM=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,ZM=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,JM=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,KM=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,$M=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,QM=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,eS=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tS=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nS=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,iS=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,rS=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,aS=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,sS=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,oS=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lS=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cS=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,uS=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,hS=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,fS=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,dS=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,pS=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,mS=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,gS=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,vS=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,yS=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,_S=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,xS=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bS=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wS=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,MS=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,SS=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TS=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ES=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,AS=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,LS=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,RS=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,CS=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,PS=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,IS=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,DS=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,OS=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,NS=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,FS=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,BS=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,US=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,GS=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,zS=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,HS=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,kS=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,VS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,WS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,qS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,XS=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,jS=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,YS=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ZS=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JS=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KS=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,$S=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,QS=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,eT=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,tT=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,nT=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,iT=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,rT=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,aT=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sT=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,oT=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lT=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cT=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uT=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,hT=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fT=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dT=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pT=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mT=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gT=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vT=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,yT=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_T=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xT=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,bT=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,wT=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MT=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ST=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const ni={alphamap_fragment:rM,alphamap_pars_fragment:aM,alphatest_fragment:sM,aomap_fragment:oM,aomap_pars_fragment:lM,begin_vertex:cM,beginnormal_vertex:uM,bsdfs:hM,bumpmap_pars_fragment:fM,clipping_planes_fragment:dM,clipping_planes_pars_fragment:pM,clipping_planes_pars_vertex:mM,clipping_planes_vertex:gM,color_fragment:vM,color_pars_fragment:yM,color_pars_vertex:_M,color_vertex:xM,common:bM,cube_uv_reflection_fragment:wM,defaultnormal_vertex:MM,displacementmap_pars_vertex:SM,displacementmap_vertex:TM,emissivemap_fragment:EM,emissivemap_pars_fragment:AM,encodings_fragment:LM,encodings_pars_fragment:RM,envmap_fragment:CM,envmap_common_pars_fragment:PM,envmap_pars_fragment:IM,envmap_pars_vertex:DM,envmap_physical_pars_fragment:WM,envmap_vertex:OM,fog_vertex:NM,fog_pars_vertex:FM,fog_fragment:BM,fog_pars_fragment:UM,gradientmap_pars_fragment:GM,lightmap_fragment:zM,lightmap_pars_fragment:HM,lights_lambert_vertex:kM,lights_pars_begin:VM,lights_toon_fragment:qM,lights_toon_pars_fragment:XM,lights_phong_fragment:jM,lights_phong_pars_fragment:YM,lights_physical_fragment:ZM,lights_physical_pars_fragment:JM,lights_fragment_begin:KM,lights_fragment_maps:$M,lights_fragment_end:QM,logdepthbuf_fragment:eS,logdepthbuf_pars_fragment:tS,logdepthbuf_pars_vertex:nS,logdepthbuf_vertex:iS,map_fragment:rS,map_pars_fragment:aS,map_particle_fragment:sS,map_particle_pars_fragment:oS,metalnessmap_fragment:lS,metalnessmap_pars_fragment:cS,morphnormal_vertex:uS,morphtarget_pars_vertex:hS,morphtarget_vertex:fS,normal_fragment_begin:dS,normal_fragment_maps:pS,normalmap_pars_fragment:mS,clearcoat_normal_fragment_begin:gS,clearcoat_normal_fragment_maps:vS,clearcoat_pars_fragment:yS,packing:_S,premultiplied_alpha_fragment:xS,project_vertex:bS,dithering_fragment:wS,dithering_pars_fragment:MS,roughnessmap_fragment:SS,roughnessmap_pars_fragment:TS,shadowmap_pars_fragment:ES,shadowmap_pars_vertex:AS,shadowmap_vertex:LS,shadowmask_pars_fragment:RS,skinbase_vertex:CS,skinning_pars_vertex:PS,skinning_vertex:IS,skinnormal_vertex:DS,specularmap_fragment:OS,specularmap_pars_fragment:NS,tonemapping_fragment:FS,tonemapping_pars_fragment:BS,transmissionmap_fragment:US,transmissionmap_pars_fragment:GS,uv_pars_fragment:zS,uv_pars_vertex:HS,uv_vertex:kS,uv2_pars_fragment:VS,uv2_pars_vertex:WS,uv2_vertex:qS,worldpos_vertex:XS,background_frag:jS,background_vert:YS,cube_frag:ZS,cube_vert:JS,depth_frag:KS,depth_vert:$S,distanceRGBA_frag:QS,distanceRGBA_vert:eT,equirect_frag:tT,equirect_vert:nT,linedashed_frag:iT,linedashed_vert:rT,meshbasic_frag:aT,meshbasic_vert:sT,meshlambert_frag:oT,meshlambert_vert:lT,meshmatcap_frag:cT,meshmatcap_vert:uT,meshtoon_frag:hT,meshtoon_vert:fT,meshphong_frag:dT,meshphong_vert:pT,meshphysical_frag:mT,meshphysical_vert:gT,normal_frag:vT,normal_vert:yT,points_frag:_T,points_vert:xT,shadow_frag:bT,shadow_vert:wT,sprite_frag:MT,sprite_vert:ST},qt={common:{diffuse:{value:new Qt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ba},uv2Transform:{value:new Ba},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new bt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Qt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Qt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ba}},sprite:{diffuse:{value:new Qt(15658734)},opacity:{value:1},center:{value:new bt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ba}}},To={basic:{uniforms:fa([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.fog]),vertexShader:ni.meshbasic_vert,fragmentShader:ni.meshbasic_frag},lambert:{uniforms:fa([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.fog,qt.lights,{emissive:{value:new Qt(0)}}]),vertexShader:ni.meshlambert_vert,fragmentShader:ni.meshlambert_frag},phong:{uniforms:fa([qt.common,qt.specularmap,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,qt.lights,{emissive:{value:new Qt(0)},specular:{value:new Qt(1118481)},shininess:{value:30}}]),vertexShader:ni.meshphong_vert,fragmentShader:ni.meshphong_frag},standard:{uniforms:fa([qt.common,qt.envmap,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.roughnessmap,qt.metalnessmap,qt.fog,qt.lights,{emissive:{value:new Qt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag},toon:{uniforms:fa([qt.common,qt.aomap,qt.lightmap,qt.emissivemap,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.gradientmap,qt.fog,qt.lights,{emissive:{value:new Qt(0)}}]),vertexShader:ni.meshtoon_vert,fragmentShader:ni.meshtoon_frag},matcap:{uniforms:fa([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,qt.fog,{matcap:{value:null}}]),vertexShader:ni.meshmatcap_vert,fragmentShader:ni.meshmatcap_frag},points:{uniforms:fa([qt.points,qt.fog]),vertexShader:ni.points_vert,fragmentShader:ni.points_frag},dashed:{uniforms:fa([qt.common,qt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ni.linedashed_vert,fragmentShader:ni.linedashed_frag},depth:{uniforms:fa([qt.common,qt.displacementmap]),vertexShader:ni.depth_vert,fragmentShader:ni.depth_frag},normal:{uniforms:fa([qt.common,qt.bumpmap,qt.normalmap,qt.displacementmap,{opacity:{value:1}}]),vertexShader:ni.normal_vert,fragmentShader:ni.normal_frag},sprite:{uniforms:fa([qt.sprite,qt.fog]),vertexShader:ni.sprite_vert,fragmentShader:ni.sprite_frag},background:{uniforms:{uvTransform:{value:new Ba},t2D:{value:null}},vertexShader:ni.background_vert,fragmentShader:ni.background_frag},cube:{uniforms:fa([qt.envmap,{opacity:{value:1}}]),vertexShader:ni.cube_vert,fragmentShader:ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ni.equirect_vert,fragmentShader:ni.equirect_frag},distanceRGBA:{uniforms:fa([qt.common,qt.displacementmap,{referencePosition:{value:new _e},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ni.distanceRGBA_vert,fragmentShader:ni.distanceRGBA_frag},shadow:{uniforms:fa([qt.lights,qt.fog,{color:{value:new Qt(0)},opacity:{value:1}}]),vertexShader:ni.shadow_vert,fragmentShader:ni.shadow_frag}};To.physical={uniforms:fa([To.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new bt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Qt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag};function TT(r,i,n,l,u){const h=new Qt(0);let p=0,g,_,b=null,A=0,S=null;function R(N,W,V,B){let O=W.isScene===!0?W.background:null;O&&O.isTexture&&(O=i.get(O));const pe=r.xr,ge=pe.getSession&&pe.getSession();ge&&ge.environmentBlendMode==="additive"&&(O=null),O===null?E(h,p):O&&O.isColor&&(E(O,1),B=!0),(r.autoClear||B)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),O&&(O.isCubeTexture||O.isWebGLCubeRenderTarget||O.mapping===rf)?(_===void 0&&(_=new ra(new p0(1,1,1),new Ua({name:"BackgroundCubeMaterial",uniforms:Yu(To.cube.uniforms),vertexShader:To.cube.vertexShader,fragmentShader:To.cube.fragmentShader,side:ti,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(ye,$,Ie){this.matrixWorld.copyPosition(Ie.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),l.update(_)),O.isWebGLCubeRenderTarget&&(O=O.texture),_.material.uniforms.envMap.value=O,_.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O._needsFlipEnvMap?-1:1,(b!==O||A!==O.version||S!==r.toneMapping)&&(_.material.needsUpdate=!0,b=O,A=O.version,S=r.toneMapping),N.unshift(_,_.geometry,_.material,0,0,null)):O&&O.isTexture&&(g===void 0&&(g=new ra(new iM(2,2),new Ua({name:"BackgroundMaterial",uniforms:Yu(To.background.uniforms),vertexShader:To.background.vertexShader,fragmentShader:To.background.fragmentShader,side:Fs,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),l.update(g)),g.material.uniforms.t2D.value=O,O.matrixAutoUpdate===!0&&O.updateMatrix(),g.material.uniforms.uvTransform.value.copy(O.matrix),(b!==O||A!==O.version||S!==r.toneMapping)&&(g.material.needsUpdate=!0,b=O,A=O.version,S=r.toneMapping),N.unshift(g,g.geometry,g.material,0,0,null))}function E(N,W){n.buffers.color.setClear(N.r,N.g,N.b,W,u)}return{getClearColor:function(){return h},setClearColor:function(N,W){h.set(N),p=W!==void 0?W:1,E(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(N){p=N,E(h,p)},render:R}}function ET(r,i,n,l){const u=r.getParameter(34921),h=l.isWebGL2?null:i.get("OES_vertex_array_object"),p=l.isWebGL2||h!==null,g={},_=W(null);let b=_;function A(Ue,Le,Te,Ve,We){let at=!1;if(p){const Tt=N(Ve,Te,Le);b!==Tt&&(b=Tt,R(b.object)),at=V(Ve,We),at&&B(Ve,We)}else{const Tt=Le.wireframe===!0;(b.geometry!==Ve.id||b.program!==Te.id||b.wireframe!==Tt)&&(b.geometry=Ve.id,b.program=Te.id,b.wireframe=Tt,at=!0)}Ue.isInstancedMesh===!0&&(at=!0),We!==null&&n.update(We,34963),at&&(Ie(Ue,Le,Te,Ve),We!==null&&r.bindBuffer(34963,n.get(We).buffer))}function S(){return l.isWebGL2?r.createVertexArray():h.createVertexArrayOES()}function R(Ue){return l.isWebGL2?r.bindVertexArray(Ue):h.bindVertexArrayOES(Ue)}function E(Ue){return l.isWebGL2?r.deleteVertexArray(Ue):h.deleteVertexArrayOES(Ue)}function N(Ue,Le,Te){const Ve=Te.wireframe===!0;let We=g[Ue.id];We===void 0&&(We={},g[Ue.id]=We);let at=We[Le.id];at===void 0&&(at={},We[Le.id]=at);let Tt=at[Ve];return Tt===void 0&&(Tt=W(S()),at[Ve]=Tt),Tt}function W(Ue){const Le=[],Te=[],Ve=[];for(let We=0;We<u;We++)Le[We]=0,Te[We]=0,Ve[We]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Le,enabledAttributes:Te,attributeDivisors:Ve,object:Ue,attributes:{},index:null}}function V(Ue,Le){const Te=b.attributes,Ve=Ue.attributes;if(Object.keys(Te).length!==Object.keys(Ve).length)return!0;for(const We in Ve){const at=Te[We],Tt=Ve[We];if(at===void 0||at.attribute!==Tt||at.data!==Tt.data)return!0}return b.index!==Le}function B(Ue,Le){const Te={},Ve=Ue.attributes;for(const We in Ve){const at=Ve[We],Tt={};Tt.attribute=at,at.data&&(Tt.data=at.data),Te[We]=Tt}b.attributes=Te,b.index=Le}function O(){const Ue=b.newAttributes;for(let Le=0,Te=Ue.length;Le<Te;Le++)Ue[Le]=0}function pe(Ue){ge(Ue,0)}function ge(Ue,Le){const Te=b.newAttributes,Ve=b.enabledAttributes,We=b.attributeDivisors;Te[Ue]=1,Ve[Ue]===0&&(r.enableVertexAttribArray(Ue),Ve[Ue]=1),We[Ue]!==Le&&((l.isWebGL2?r:i.get("ANGLE_instanced_arrays"))[l.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ue,Le),We[Ue]=Le)}function ye(){const Ue=b.newAttributes,Le=b.enabledAttributes;for(let Te=0,Ve=Le.length;Te<Ve;Te++)Le[Te]!==Ue[Te]&&(r.disableVertexAttribArray(Te),Le[Te]=0)}function $(Ue,Le,Te,Ve,We,at){l.isWebGL2===!0&&(Te===5124||Te===5125)?r.vertexAttribIPointer(Ue,Le,Te,We,at):r.vertexAttribPointer(Ue,Le,Te,Ve,We,at)}function Ie(Ue,Le,Te,Ve){if(l.isWebGL2===!1&&(Ue.isInstancedMesh||Ve.isInstancedBufferGeometry)&&i.get("ANGLE_instanced_arrays")===null)return;O();const We=Ve.attributes,at=Te.getAttributes(),Tt=Le.defaultAttributeValues;for(const nt in at){const At=at[nt];if(At>=0){const nn=We[nt];if(nn!==void 0){const Yt=nn.normalized,K=nn.itemSize,H=n.get(nn);if(H===void 0)continue;const xe=H.buffer,te=H.type,de=H.bytesPerElement;if(nn.isInterleavedBufferAttribute){const be=nn.data,Re=be.stride,we=nn.offset;be&&be.isInstancedInterleavedBuffer?(ge(At,be.meshPerAttribute),Ve._maxInstanceCount===void 0&&(Ve._maxInstanceCount=be.meshPerAttribute*be.count)):pe(At),r.bindBuffer(34962,xe),$(At,K,te,Yt,Re*de,we*de)}else nn.isInstancedBufferAttribute?(ge(At,nn.meshPerAttribute),Ve._maxInstanceCount===void 0&&(Ve._maxInstanceCount=nn.meshPerAttribute*nn.count)):pe(At),r.bindBuffer(34962,xe),$(At,K,te,Yt,0,0)}else if(nt==="instanceMatrix"){const Yt=n.get(Ue.instanceMatrix);if(Yt===void 0)continue;const K=Yt.buffer,H=Yt.type;ge(At+0,1),ge(At+1,1),ge(At+2,1),ge(At+3,1),r.bindBuffer(34962,K),r.vertexAttribPointer(At+0,4,H,!1,64,0),r.vertexAttribPointer(At+1,4,H,!1,64,16),r.vertexAttribPointer(At+2,4,H,!1,64,32),r.vertexAttribPointer(At+3,4,H,!1,64,48)}else if(nt==="instanceColor"){const Yt=n.get(Ue.instanceColor);if(Yt===void 0)continue;const K=Yt.buffer,H=Yt.type;ge(At,1),r.bindBuffer(34962,K),r.vertexAttribPointer(At,3,H,!1,12,0)}else if(Tt!==void 0){const Yt=Tt[nt];if(Yt!==void 0)switch(Yt.length){case 2:r.vertexAttrib2fv(At,Yt);break;case 3:r.vertexAttrib3fv(At,Yt);break;case 4:r.vertexAttrib4fv(At,Yt);break;default:r.vertexAttrib1fv(At,Yt)}}}}ye()}function tt(){je();for(const Ue in g){const Le=g[Ue];for(const Te in Le){const Ve=Le[Te];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Le[Te]}delete g[Ue]}}function qe(Ue){if(g[Ue.id]===void 0)return;const Le=g[Ue.id];for(const Te in Le){const Ve=Le[Te];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Le[Te]}delete g[Ue.id]}function ft(Ue){for(const Le in g){const Te=g[Le];if(Te[Ue.id]===void 0)continue;const Ve=Te[Ue.id];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Te[Ue.id]}}function je(){Ne(),b!==_&&(b=_,R(b.object))}function Ne(){_.geometry=null,_.program=null,_.wireframe=!1}return{setup:A,reset:je,resetDefaultState:Ne,dispose:tt,releaseStatesOfGeometry:qe,releaseStatesOfProgram:ft,initAttributes:O,enableAttribute:pe,disableUnusedAttributes:ye}}function AT(r,i,n,l){const u=l.isWebGL2;let h;function p(b){h=b}function g(b,A){r.drawArrays(h,b,A),n.update(A,h,1)}function _(b,A,S){if(S===0)return;let R,E;if(u)R=r,E="drawArraysInstanced";else if(R=i.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[E](h,b,A,S),n.update(A,h,S)}this.setMode=p,this.render=g,this.renderInstances=_}function LT(r,i,n){let l;function u(){if(l!==void 0)return l;const $=i.get("EXT_texture_filter_anisotropic");return $!==null?l=r.getParameter($.MAX_TEXTURE_MAX_ANISOTROPY_EXT):l=0,l}function h($){if($==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";$="mediump"}return $==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const p=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&r instanceof WebGL2ComputeRenderingContext;let g=n.precision!==void 0?n.precision:"highp";const _=h(g);_!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",_,"instead."),g=_);const b=n.logarithmicDepthBuffer===!0,A=r.getParameter(34930),S=r.getParameter(35660),R=r.getParameter(3379),E=r.getParameter(34076),N=r.getParameter(34921),W=r.getParameter(36347),V=r.getParameter(36348),B=r.getParameter(36349),O=S>0,pe=p||!!i.get("OES_texture_float"),ge=O&&pe,ye=p?r.getParameter(36183):0;return{isWebGL2:p,getMaxAnisotropy:u,getMaxPrecision:h,precision:g,logarithmicDepthBuffer:b,maxTextures:A,maxVertexTextures:S,maxTextureSize:R,maxCubemapSize:E,maxAttributes:N,maxVertexUniforms:W,maxVaryings:V,maxFragmentUniforms:B,vertexTextures:O,floatFragmentTextures:pe,floatVertexTextures:ge,maxSamples:ye}}function RT(r){const i=this;let n=null,l=0,u=!1,h=!1;const p=new al,g=new Ba,_={value:null,needsUpdate:!1};this.uniform=_,this.numPlanes=0,this.numIntersection=0,this.init=function(S,R,E){const N=S.length!==0||R||l!==0||u;return u=R,n=A(S,E,0),l=S.length,N},this.beginShadows=function(){h=!0,A(null)},this.endShadows=function(){h=!1,b()},this.setState=function(S,R,E){const N=S.clippingPlanes,W=S.clipIntersection,V=S.clipShadows,B=r.get(S);if(!u||N===null||N.length===0||h&&!V)h?A(null):b();else{const O=h?0:l,pe=O*4;let ge=B.clippingState||null;_.value=ge,ge=A(N,R,pe,E);for(let ye=0;ye!==pe;++ye)ge[ye]=n[ye];B.clippingState=ge,this.numIntersection=W?this.numPlanes:0,this.numPlanes+=O}};function b(){_.value!==n&&(_.value=n,_.needsUpdate=l>0),i.numPlanes=l,i.numIntersection=0}function A(S,R,E,N){const W=S!==null?S.length:0;let V=null;if(W!==0){if(V=_.value,N!==!0||V===null){const B=E+W*4,O=R.matrixWorldInverse;g.getNormalMatrix(O),(V===null||V.length<B)&&(V=new Float32Array(B));for(let pe=0,ge=E;pe!==W;++pe,ge+=4)p.copy(S[pe]).applyMatrix4(O,g),p.normal.toArray(V,ge),V[ge+3]=p.constant}_.value=V,_.needsUpdate=!0}return i.numPlanes=W,i.numIntersection=0,V}}function CT(r){let i=new WeakMap;function n(h,p){return p===Cu?h.mapping=wo:p===Gd&&(h.mapping=Qo),h}function l(h){if(h&&h.isTexture){const p=h.mapping;if(p===Cu||p===Gd)if(i.has(h)){const g=i.get(h).texture;return n(g,h.mapping)}else{const g=h.image;if(g&&g.height>0){const _=r.getRenderList(),b=r.getRenderTarget(),A=r.getRenderState(),S=new Ku(g.height/2);return S.fromEquirectangularTexture(r,h),i.set(h,S),r.setRenderTarget(b),r.setRenderList(_),r.setRenderState(A),n(S.texture,h.mapping)}else return null}}return h}function u(){i=new WeakMap}return{get:l,dispose:u}}function PT(r){const i={};return{has:function(n){if(i[n]!==void 0)return i[n]!==null;let l;switch(n){case"WEBGL_depth_texture":l=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":l=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":l=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":l=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=r.getExtension(n)}return i[n]=l,l!==null},get:function(n){return this.has(n)||console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i[n]}}}function IT(r,i,n,l){const u=new WeakMap,h=new WeakMap;function p(S){const R=S.target,E=u.get(R);E.index!==null&&i.remove(E.index);for(const W in E.attributes)i.remove(E.attributes[W]);R.removeEventListener("dispose",p),u.delete(R);const N=h.get(E);N&&(i.remove(N),h.delete(E)),l.releaseStatesOfGeometry(R),R.isInstancedBufferGeometry===!0&&delete R._maxInstanceCount,n.memory.geometries--}function g(S,R){let E=u.get(R);return E||(R.addEventListener("dispose",p),R.isBufferGeometry?E=R:R.isGeometry&&(R._bufferGeometry===void 0&&(R._bufferGeometry=new Ni().setFromObject(S)),E=R._bufferGeometry),u.set(R,E),n.memory.geometries++,E)}function _(S){const R=S.attributes;for(const N in R)i.update(R[N],34962);const E=S.morphAttributes;for(const N in E){const W=E[N];for(let V=0,B=W.length;V<B;V++)i.update(W[V],34962)}}function b(S){const R=[],E=S.index,N=S.attributes.position;let W=0;if(E!==null){const O=E.array;W=E.version;for(let pe=0,ge=O.length;pe<ge;pe+=3){const ye=O[pe+0],$=O[pe+1],Ie=O[pe+2];R.push(ye,$,$,Ie,Ie,ye)}}else{const O=N.array;W=N.version;for(let pe=0,ge=O.length/3-1;pe<ge;pe+=3){const ye=pe+0,$=pe+1,Ie=pe+2;R.push(ye,$,$,Ie,Ie,ye)}}const V=new(h0(R)>65535?mf:pf)(R,1);V.version=W;const B=h.get(S);B&&i.remove(B),h.set(S,V)}function A(S){const R=h.get(S);if(R){const E=S.index;E!==null&&R.version<E.version&&b(S)}else b(S);return h.get(S)}return{get:g,update:_,getWireframeAttribute:A}}function DT(r,i,n,l){const u=l.isWebGL2;let h;function p(R){h=R}let g,_;function b(R){g=R.type,_=R.bytesPerElement}function A(R,E){r.drawElements(h,E,g,R*_),n.update(E,h,1)}function S(R,E,N){if(N===0)return;let W,V;if(u)W=r,V="drawElementsInstanced";else if(W=i.get("ANGLE_instanced_arrays"),V="drawElementsInstancedANGLE",W===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}W[V](h,E,g,R*_,N),n.update(E,h,N)}this.setMode=p,this.setIndex=b,this.render=A,this.renderInstances=S}function OT(r){const i={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function l(h,p,g){switch(n.calls++,p){case 4:n.triangles+=g*(h/3);break;case 1:n.lines+=g*(h/2);break;case 3:n.lines+=g*(h-1);break;case 2:n.lines+=g*h;break;case 0:n.points+=g*h;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",p);break}}function u(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:i,render:n,programs:null,autoReset:!0,reset:u,update:l}}function NT(r,i){return r[0]-i[0]}function FT(r,i){return Math.abs(i[1])-Math.abs(r[1])}function BT(r){const i={},n=new Float32Array(8),l=[];for(let h=0;h<8;h++)l[h]=[h,0];function u(h,p,g,_){const b=h.morphTargetInfluences,A=b===void 0?0:b.length;let S=i[p.id];if(S===void 0){S=[];for(let V=0;V<A;V++)S[V]=[V,0];i[p.id]=S}for(let V=0;V<A;V++){const B=S[V];B[0]=V,B[1]=b[V]}S.sort(FT);for(let V=0;V<8;V++)V<A&&S[V][1]?(l[V][0]=S[V][0],l[V][1]=S[V][1]):(l[V][0]=Number.MAX_SAFE_INTEGER,l[V][1]=0);l.sort(NT);const R=g.morphTargets&&p.morphAttributes.position,E=g.morphNormals&&p.morphAttributes.normal;let N=0;for(let V=0;V<8;V++){const B=l[V],O=B[0],pe=B[1];O!==Number.MAX_SAFE_INTEGER&&pe?(R&&p.getAttribute("morphTarget"+V)!==R[O]&&p.setAttribute("morphTarget"+V,R[O]),E&&p.getAttribute("morphNormal"+V)!==E[O]&&p.setAttribute("morphNormal"+V,E[O]),n[V]=pe,N+=pe):(R&&p.getAttribute("morphTarget"+V)!==void 0&&p.deleteAttribute("morphTarget"+V),E&&p.getAttribute("morphNormal"+V)!==void 0&&p.deleteAttribute("morphNormal"+V),n[V]=0)}const W=p.morphTargetsRelative?1:1-N;_.getUniforms().setValue(r,"morphTargetBaseInfluence",W),_.getUniforms().setValue(r,"morphTargetInfluences",n)}return{update:u}}function UT(r,i,n,l){let u=new WeakMap;function h(g){const _=l.render.frame,b=g.geometry,A=i.get(g,b);return u.get(A)!==_&&(b.isGeometry&&A.updateFromObject(g),i.update(A),u.set(A,_)),g.isInstancedMesh&&(n.update(g.instanceMatrix,34962),g.instanceColor!==null&&n.update(g.instanceColor,34962)),A}function p(){u=new WeakMap}return{update:h,dispose:p}}function _f(r,i,n,l){qi.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:l||1},this.magFilter=Et,this.minFilter=Et,this.wrapR=na,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}_f.prototype=Object.create(qi.prototype),_f.prototype.constructor=_f,_f.prototype.isDataTexture2DArray=!0;function xf(r,i,n,l){qi.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:l||1},this.magFilter=Et,this.minFilter=Et,this.wrapR=na,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}xf.prototype=Object.create(qi.prototype),xf.prototype.constructor=xf,xf.prototype.isDataTexture3D=!0;const g0=new qi,GT=new _f,zT=new xf,v0=new Yl,y0=[],_0=[],x0=new Float32Array(16),b0=new Float32Array(9),w0=new Float32Array(4);function eh(r,i,n){const l=r[0];if(l<=0||l>0)return r;const u=i*n;let h=y0[u];if(h===void 0&&(h=new Float32Array(u),y0[u]=h),i!==0){l.toArray(h,0);for(let p=1,g=0;p!==i;++p)g+=n,r[p].toArray(h,g)}return h}function _s(r,i){if(r.length!==i.length)return!1;for(let n=0,l=r.length;n<l;n++)if(r[n]!==i[n])return!1;return!0}function $a(r,i){for(let n=0,l=i.length;n<l;n++)r[n]=i[n]}function M0(r,i){let n=_0[i];n===void 0&&(n=new Int32Array(i),_0[i]=n);for(let l=0;l!==i;++l)n[l]=r.allocateTextureUnit();return n}function HT(r,i){const n=this.cache;n[0]!==i&&(r.uniform1f(this.addr,i),n[0]=i)}function kT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y)&&(r.uniform2f(this.addr,i.x,i.y),n[0]=i.x,n[1]=i.y);else{if(_s(n,i))return;r.uniform2fv(this.addr,i),$a(n,i)}}function VT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z)&&(r.uniform3f(this.addr,i.x,i.y,i.z),n[0]=i.x,n[1]=i.y,n[2]=i.z);else if(i.r!==void 0)(n[0]!==i.r||n[1]!==i.g||n[2]!==i.b)&&(r.uniform3f(this.addr,i.r,i.g,i.b),n[0]=i.r,n[1]=i.g,n[2]=i.b);else{if(_s(n,i))return;r.uniform3fv(this.addr,i),$a(n,i)}}function WT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z||n[3]!==i.w)&&(r.uniform4f(this.addr,i.x,i.y,i.z,i.w),n[0]=i.x,n[1]=i.y,n[2]=i.z,n[3]=i.w);else{if(_s(n,i))return;r.uniform4fv(this.addr,i),$a(n,i)}}function qT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(_s(n,i))return;r.uniformMatrix2fv(this.addr,!1,i),$a(n,i)}else{if(_s(n,l))return;w0.set(l),r.uniformMatrix2fv(this.addr,!1,w0),$a(n,l)}}function XT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(_s(n,i))return;r.uniformMatrix3fv(this.addr,!1,i),$a(n,i)}else{if(_s(n,l))return;b0.set(l),r.uniformMatrix3fv(this.addr,!1,b0),$a(n,l)}}function jT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(_s(n,i))return;r.uniformMatrix4fv(this.addr,!1,i),$a(n,i)}else{if(_s(n,l))return;x0.set(l),r.uniformMatrix4fv(this.addr,!1,x0),$a(n,l)}}function YT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.safeSetTexture2D(i||g0,u)}function ZT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.setTexture2DArray(i||GT,u)}function JT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.setTexture3D(i||zT,u)}function KT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.safeSetTextureCube(i||v0,u)}function $T(r,i){const n=this.cache;n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i)}function QT(r,i){const n=this.cache;_s(n,i)||(r.uniform2iv(this.addr,i),$a(n,i))}function eE(r,i){const n=this.cache;_s(n,i)||(r.uniform3iv(this.addr,i),$a(n,i))}function tE(r,i){const n=this.cache;_s(n,i)||(r.uniform4iv(this.addr,i),$a(n,i))}function nE(r,i){const n=this.cache;n[0]!==i&&(r.uniform1ui(this.addr,i),n[0]=i)}function iE(r){switch(r){case 5126:return HT;case 35664:return kT;case 35665:return VT;case 35666:return WT;case 35674:return qT;case 35675:return XT;case 35676:return jT;case 5124:case 35670:return $T;case 35667:case 35671:return QT;case 35668:case 35672:return eE;case 35669:case 35673:return tE;case 5125:return nE;case 35678:case 36198:case 36298:case 36306:case 35682:return YT;case 35679:case 36299:case 36307:return JT;case 35680:case 36300:case 36308:case 36293:return KT;case 36289:case 36303:case 36311:case 36292:return ZT}}function rE(r,i){r.uniform1fv(this.addr,i)}function aE(r,i){r.uniform1iv(this.addr,i)}function sE(r,i){r.uniform2iv(this.addr,i)}function oE(r,i){r.uniform3iv(this.addr,i)}function lE(r,i){r.uniform4iv(this.addr,i)}function cE(r,i){const n=eh(i,this.size,2);r.uniform2fv(this.addr,n)}function uE(r,i){const n=eh(i,this.size,3);r.uniform3fv(this.addr,n)}function hE(r,i){const n=eh(i,this.size,4);r.uniform4fv(this.addr,n)}function fE(r,i){const n=eh(i,this.size,4);r.uniformMatrix2fv(this.addr,!1,n)}function dE(r,i){const n=eh(i,this.size,9);r.uniformMatrix3fv(this.addr,!1,n)}function pE(r,i){const n=eh(i,this.size,16);r.uniformMatrix4fv(this.addr,!1,n)}function mE(r,i,n){const l=i.length,u=M0(n,l);r.uniform1iv(this.addr,u);for(let h=0;h!==l;++h)n.safeSetTexture2D(i[h]||g0,u[h])}function gE(r,i,n){const l=i.length,u=M0(n,l);r.uniform1iv(this.addr,u);for(let h=0;h!==l;++h)n.safeSetTextureCube(i[h]||v0,u[h])}function vE(r){switch(r){case 5126:return rE;case 35664:return cE;case 35665:return uE;case 35666:return hE;case 35674:return fE;case 35675:return dE;case 35676:return pE;case 5124:case 35670:return aE;case 35667:case 35671:return sE;case 35668:case 35672:return oE;case 35669:case 35673:return lE;case 35678:case 36198:case 36298:case 36306:case 35682:return mE;case 35680:case 36300:case 36308:case 36293:return gE}}function yE(r,i,n){this.id=r,this.addr=n,this.cache=[],this.setValue=iE(i.type)}function S0(r,i,n){this.id=r,this.addr=n,this.cache=[],this.size=i.size,this.setValue=vE(i.type)}S0.prototype.updateCache=function(r){const i=this.cache;r instanceof Float32Array&&i.length!==r.length&&(this.cache=new Float32Array(r.length)),$a(i,r)};function T0(r){this.id=r,this.seq=[],this.map={}}T0.prototype.setValue=function(r,i,n){const l=this.seq;for(let u=0,h=l.length;u!==h;++u){const p=l[u];p.setValue(r,i[p.id],n)}};const Ng=/([\w\d_]+)(\])?(\[|\.)?/g;function E0(r,i){r.seq.push(i),r.map[i.id]=i}function _E(r,i,n){const l=r.name,u=l.length;for(Ng.lastIndex=0;;){const h=Ng.exec(l),p=Ng.lastIndex;let g=h[1];const _=h[2]==="]",b=h[3];if(_&&(g=g|0),b===void 0||b==="["&&p+2===u){E0(n,b===void 0?new yE(g,r,i):new S0(g,r,i));break}else{let S=n.map[g];S===void 0&&(S=new T0(g),E0(n,S)),n=S}}}function Zl(r,i){this.seq=[],this.map={};const n=r.getProgramParameter(i,35718);for(let l=0;l<n;++l){const u=r.getActiveUniform(i,l),h=r.getUniformLocation(i,u.name);_E(u,h,this)}}Zl.prototype.setValue=function(r,i,n,l){const u=this.map[i];u!==void 0&&u.setValue(r,n,l)},Zl.prototype.setOptional=function(r,i,n){const l=i[n];l!==void 0&&this.setValue(r,n,l)},Zl.upload=function(r,i,n,l){for(let u=0,h=i.length;u!==h;++u){const p=i[u],g=n[p.id];g.needsUpdate!==!1&&p.setValue(r,g.value,l)}},Zl.seqWithValue=function(r,i){const n=[];for(let l=0,u=r.length;l!==u;++l){const h=r[l];h.id in i&&n.push(h)}return n};function A0(r,i,n){const l=r.createShader(i);return r.shaderSource(l,n),r.compileShader(l),l}let xE=0;function bE(r){const i=r.split(`
`);for(let n=0;n<i.length;n++)i[n]=n+1+": "+i[n];return i.join(`
`)}function L0(r){switch(r){case Fc:return["Linear","( value )"];case Vd:return["sRGB","( value )"];case $y:return["RGBE","( value )"];case Iw:return["RGBM","( value, 7.0 )"];case Dw:return["RGBM","( value, 16.0 )"];case Ow:return["RGBD","( value, 256.0 )"];case Cw:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Pw:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function R0(r,i,n){const l=r.getShaderParameter(i,35713),u=r.getShaderInfoLog(i).trim();if(l&&u==="")return"";const h=r.getShaderSource(i);return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+u+bE(h)}function bf(r,i){const n=L0(i);return"vec4 "+r+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function wE(r,i){const n=L0(i);return"vec4 "+r+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function ME(r,i){let n;switch(i){case Yr:n="Linear";break;case ua:n="Reinhard";break;case Ar:n="OptimizedCineon";break;case Fa:n="ACESFilmic";break;case gs:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",i),n="Linear"}return"vec3 "+r+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function SE(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(wf).join(`
`)}function TE(r){const i=[];for(const n in r){const l=r[n];l!==!1&&i.push("#define "+n+" "+l)}return i.join(`
`)}function EE(r,i){const n={},l=r.getProgramParameter(i,35721);for(let u=0;u<l;u++){const p=r.getActiveAttrib(i,u).name;n[p]=r.getAttribLocation(i,p)}return n}function wf(r){return r!==""}function C0(r,i){return r.replace(/NUM_DIR_LIGHTS/g,i.numDirLights).replace(/NUM_SPOT_LIGHTS/g,i.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,i.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,i.numPointLights).replace(/NUM_HEMI_LIGHTS/g,i.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,i.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,i.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,i.numPointLightShadows)}function P0(r,i){return r.replace(/NUM_CLIPPING_PLANES/g,i.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,i.numClippingPlanes-i.numClipIntersection)}const AE=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fg(r){return r.replace(AE,LE)}function LE(r,i){const n=ni[i];if(n===void 0)throw new Error("Can not resolve #include <"+i+">");return Fg(n)}const RE=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,CE=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function I0(r){return r.replace(CE,D0).replace(RE,PE)}function PE(r,i,n,l){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),D0(r,i,n,l)}function D0(r,i,n,l){let u="";for(let h=parseInt(i);h<parseInt(n);h++)u+=l.replace(/\[\s*i\s*\]/g,"[ "+h+" ]").replace(/UNROLLED_LOOP_INDEX/g,h);return u}function O0(r){let i="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?i+=`
#define HIGH_PRECISION`:r.precision==="mediump"?i+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(i+=`
#define LOW_PRECISION`),i}function IE(r){let i="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===ei?i="SHADOWMAP_TYPE_PCF":r.shadowMapType===Fl?i="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Ya&&(i="SHADOWMAP_TYPE_VSM"),i}function DE(r){let i="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case wo:case Qo:i="ENVMAP_TYPE_CUBE";break;case rf:case Ul:i="ENVMAP_TYPE_CUBE_UV";break}return i}function OE(r){let i="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case Qo:case Ul:i="ENVMAP_MODE_REFRACTION";break}return i}function NE(r){let i="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case mi:i="ENVMAP_BLENDING_MULTIPLY";break;case jn:i="ENVMAP_BLENDING_MIX";break;case si:i="ENVMAP_BLENDING_ADD";break}return i}function FE(r,i,n,l){const u=r.getContext(),h=n.defines;let p=n.vertexShader,g=n.fragmentShader;const _=IE(n),b=DE(n),A=OE(n),S=NE(n),R=r.gammaFactor>0?r.gammaFactor:1,E=n.isWebGL2?"":SE(n),N=TE(h),W=u.createProgram();let V,B,O=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(V=[N].filter(wf).join(`
`),V.length>0&&(V+=`
`),B=[E,N].filter(wf).join(`
`),B.length>0&&(B+=`
`)):(V=[O0(n),"#define SHADER_NAME "+n.shaderName,N,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+R,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+A:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(wf).join(`
`),B=[E,O0(n),"#define SHADER_NAME "+n.shaderName,N,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+R,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+b:"",n.envMap?"#define "+A:"",n.envMap?"#define "+S:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Jt?"#define TONE_MAPPING":"",n.toneMapping!==Jt?ni.tonemapping_pars_fragment:"",n.toneMapping!==Jt?ME("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",ni.encodings_pars_fragment,n.map?bf("mapTexelToLinear",n.mapEncoding):"",n.matcap?bf("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?bf("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?bf("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?bf("lightMapTexelToLinear",n.lightMapEncoding):"",wE("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(wf).join(`
`)),p=Fg(p),p=C0(p,n),p=P0(p,n),g=Fg(g),g=C0(g,n),g=P0(g,n),p=I0(p),g=I0(g),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,V=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+V,B=["#define varying in",n.glslVersion===Qy?"":"out highp vec4 pc_fragColor;",n.glslVersion===Qy?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+B);const pe=O+V+p,ge=O+B+g,ye=A0(u,35633,pe),$=A0(u,35632,ge);if(u.attachShader(W,ye),u.attachShader(W,$),n.index0AttributeName!==void 0?u.bindAttribLocation(W,0,n.index0AttributeName):n.morphTargets===!0&&u.bindAttribLocation(W,0,"position"),u.linkProgram(W),r.debug.checkShaderErrors){const qe=u.getProgramInfoLog(W).trim(),ft=u.getShaderInfoLog(ye).trim(),je=u.getShaderInfoLog($).trim();let Ne=!0,Ue=!0;if(u.getProgramParameter(W,35714)===!1){Ne=!1;const Le=R0(u,ye,"vertex"),Te=R0(u,$,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(W,35715),"gl.getProgramInfoLog",qe,Le,Te)}else qe!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",qe):(ft===""||je==="")&&(Ue=!1);Ue&&(this.diagnostics={runnable:Ne,programLog:qe,vertexShader:{log:ft,prefix:V},fragmentShader:{log:je,prefix:B}})}u.deleteShader(ye),u.deleteShader($);let Ie;this.getUniforms=function(){return Ie===void 0&&(Ie=new Zl(u,W)),Ie};let tt;return this.getAttributes=function(){return tt===void 0&&(tt=EE(u,W)),tt},this.destroy=function(){l.releaseStatesOfProgram(this),u.deleteProgram(W),this.program=void 0},this.name=n.shaderName,this.id=xE++,this.cacheKey=i,this.usedTimes=1,this.program=W,this.vertexShader=ye,this.fragmentShader=$,this}function BE(r,i,n,l,u,h){const p=[],g=l.isWebGL2,_=l.logarithmicDepthBuffer,b=l.floatVertexTextures,A=l.maxVertexUniforms,S=l.vertexTextures;let R=l.precision;const E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},N=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function W($){const tt=$.skeleton.bones;if(b)return 1024;{const ft=Math.floor((A-20)/4),je=Math.min(ft,tt.length);return je<tt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+tt.length+" bones. This GPU supports "+je+"."),0):je}}function V($){let Ie;return $?$.isTexture?Ie=$.encoding:$.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Ie=$.texture.encoding):Ie=Fc,Ie}function B($,Ie,tt,qe,ft){const je=qe.fog,Ne=$.isMeshStandardMaterial?qe.environment:null,Ue=i.get($.envMap||Ne),Le=E[$.type],Te=ft.isSkinnedMesh?W(ft):0;$.precision!==null&&(R=l.getMaxPrecision($.precision),R!==$.precision&&console.warn("THREE.WebGLProgram.getParameters:",$.precision,"not supported, using",R,"instead."));let Ve,We;if(Le){const nt=To[Le];Ve=nt.vertexShader,We=nt.fragmentShader}else Ve=$.vertexShader,We=$.fragmentShader;const at=r.getRenderTarget();return{isWebGL2:g,shaderID:Le,shaderName:$.type,vertexShader:Ve,fragmentShader:We,defines:$.defines,isRawShaderMaterial:$.isRawShaderMaterial===!0,glslVersion:$.glslVersion,precision:R,instancing:ft.isInstancedMesh===!0,instancingColor:ft.isInstancedMesh===!0&&ft.instanceColor!==null,supportsVertexTextures:S,outputEncoding:at!==null?V(at.texture):r.outputEncoding,map:!!$.map,mapEncoding:V($.map),matcap:!!$.matcap,matcapEncoding:V($.matcap),envMap:!!Ue,envMapMode:Ue&&Ue.mapping,envMapEncoding:V(Ue),envMapCubeUV:!!Ue&&(Ue.mapping===rf||Ue.mapping===Ul),lightMap:!!$.lightMap,lightMapEncoding:V($.lightMap),aoMap:!!$.aoMap,emissiveMap:!!$.emissiveMap,emissiveMapEncoding:V($.emissiveMap),bumpMap:!!$.bumpMap,normalMap:!!$.normalMap,objectSpaceNormalMap:$.normalMapType===Bw,tangentSpaceNormalMap:$.normalMapType===Bc,clearcoatMap:!!$.clearcoatMap,clearcoatRoughnessMap:!!$.clearcoatRoughnessMap,clearcoatNormalMap:!!$.clearcoatNormalMap,displacementMap:!!$.displacementMap,roughnessMap:!!$.roughnessMap,metalnessMap:!!$.metalnessMap,specularMap:!!$.specularMap,alphaMap:!!$.alphaMap,gradientMap:!!$.gradientMap,sheen:!!$.sheen,transmissionMap:!!$.transmissionMap,combine:$.combine,vertexTangents:$.normalMap&&$.vertexTangents,vertexColors:$.vertexColors,vertexUvs:!!$.map||!!$.bumpMap||!!$.normalMap||!!$.specularMap||!!$.alphaMap||!!$.emissiveMap||!!$.roughnessMap||!!$.metalnessMap||!!$.clearcoatMap||!!$.clearcoatRoughnessMap||!!$.clearcoatNormalMap||!!$.displacementMap||!!$.transmissionMap,uvsVertexOnly:!(!!$.map||!!$.bumpMap||!!$.normalMap||!!$.specularMap||!!$.alphaMap||!!$.emissiveMap||!!$.roughnessMap||!!$.metalnessMap||!!$.clearcoatNormalMap||!!$.transmissionMap)&&!!$.displacementMap,fog:!!je,useFog:$.fog,fogExp2:je&&je.isFogExp2,flatShading:$.flatShading,sizeAttenuation:$.sizeAttenuation,logarithmicDepthBuffer:_,skinning:$.skinning&&Te>0,maxBones:Te,useVertexTexture:b,morphTargets:$.morphTargets,morphNormals:$.morphNormals,maxMorphTargets:r.maxMorphTargets,maxMorphNormals:r.maxMorphNormals,numDirLights:Ie.directional.length,numPointLights:Ie.point.length,numSpotLights:Ie.spot.length,numRectAreaLights:Ie.rectArea.length,numHemiLights:Ie.hemi.length,numDirLightShadows:Ie.directionalShadowMap.length,numPointLightShadows:Ie.pointShadowMap.length,numSpotLightShadows:Ie.spotShadowMap.length,numClippingPlanes:h.numPlanes,numClipIntersection:h.numIntersection,dithering:$.dithering,shadowMapEnabled:r.shadowMap.enabled&&tt.length>0,shadowMapType:r.shadowMap.type,toneMapping:$.toneMapped?r.toneMapping:Jt,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:$.premultipliedAlpha,alphaTest:$.alphaTest,doubleSided:$.side===jr,flipSided:$.side===ti,depthPacking:$.depthPacking!==void 0?$.depthPacking:!1,index0AttributeName:$.index0AttributeName,extensionDerivatives:$.extensions&&$.extensions.derivatives,extensionFragDepth:$.extensions&&$.extensions.fragDepth,extensionDrawBuffers:$.extensions&&$.extensions.drawBuffers,extensionShaderTextureLOD:$.extensions&&$.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||n.has("EXT_shader_texture_lod"),customProgramCacheKey:$.customProgramCacheKey()}}function O($){const Ie=[];if($.shaderID?Ie.push($.shaderID):(Ie.push($.fragmentShader),Ie.push($.vertexShader)),$.defines!==void 0)for(const tt in $.defines)Ie.push(tt),Ie.push($.defines[tt]);if($.isRawShaderMaterial===!1){for(let tt=0;tt<N.length;tt++)Ie.push($[N[tt]]);Ie.push(r.outputEncoding),Ie.push(r.gammaFactor)}return Ie.push($.customProgramCacheKey),Ie.join()}function pe($){const Ie=E[$.type];let tt;if(Ie){const qe=To[Ie];tt=Qw.clone(qe.uniforms)}else tt=$.uniforms;return tt}function ge($,Ie){let tt;for(let qe=0,ft=p.length;qe<ft;qe++){const je=p[qe];if(je.cacheKey===Ie){tt=je,++tt.usedTimes;break}}return tt===void 0&&(tt=new FE(r,Ie,$,u),p.push(tt)),tt}function ye($){if(--$.usedTimes===0){const Ie=p.indexOf($);p[Ie]=p[p.length-1],p.pop(),$.destroy()}}return{getParameters:B,getProgramCacheKey:O,getUniforms:pe,acquireProgram:ge,releaseProgram:ye,programs:p}}function UE(){let r=new WeakMap;function i(h){let p=r.get(h);return p===void 0&&(p={},r.set(h,p)),p}function n(h){r.delete(h)}function l(h,p,g){r.get(h)[p]=g}function u(){r=new WeakMap}return{get:i,remove:n,update:l,dispose:u}}function GE(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.program!==i.program?r.program.id-i.program.id:r.material.id!==i.material.id?r.material.id-i.material.id:r.z!==i.z?r.z-i.z:r.id-i.id}function zE(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.z!==i.z?i.z-r.z:r.id-i.id}function N0(r){const i=[];let n=0;const l=[],u=[],h={id:-1};function p(){n=0,l.length=0,u.length=0}function g(R,E,N,W,V,B){let O=i[n];const pe=r.get(N);return O===void 0?(O={id:R.id,object:R,geometry:E,material:N,program:pe.program||h,groupOrder:W,renderOrder:R.renderOrder,z:V,group:B},i[n]=O):(O.id=R.id,O.object=R,O.geometry=E,O.material=N,O.program=pe.program||h,O.groupOrder=W,O.renderOrder=R.renderOrder,O.z=V,O.group=B),n++,O}function _(R,E,N,W,V,B){const O=g(R,E,N,W,V,B);(N.transparent===!0?u:l).push(O)}function b(R,E,N,W,V,B){const O=g(R,E,N,W,V,B);(N.transparent===!0?u:l).unshift(O)}function A(R,E){l.length>1&&l.sort(R||GE),u.length>1&&u.sort(E||zE)}function S(){for(let R=n,E=i.length;R<E;R++){const N=i[R];if(N.id===null)break;N.id=null,N.object=null,N.geometry=null,N.material=null,N.program=null,N.group=null}}return{opaque:l,transparent:u,init:p,push:_,unshift:b,finish:S,sort:A}}function HE(r){let i=new WeakMap;function n(u,h){const p=i.get(u);let g;return p===void 0?(g=new N0(r),i.set(u,new WeakMap),i.get(u).set(h,g)):(g=p.get(h),g===void 0&&(g=new N0(r),p.set(h,g))),g}function l(){i=new WeakMap}return{get:n,dispose:l}}function kE(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={direction:new _e,color:new Qt};break;case"SpotLight":n={position:new _e,direction:new _e,color:new Qt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new _e,color:new Qt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new _e,skyColor:new Qt,groundColor:new Qt};break;case"RectAreaLight":n={color:new Qt,position:new _e,halfWidth:new _e,halfHeight:new _e};break}return r[i.id]=n,n}}}function VE(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new bt,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[i.id]=n,n}}}let WE=0;function qE(r,i){return(i.castShadow?1:0)-(r.castShadow?1:0)}function XE(){const r=new kE,i=VE(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let g=0;g<9;g++)n.probe.push(new _e);const l=new _e,u=new Wn,h=new Wn;function p(g,_,b){let A=0,S=0,R=0;for(let Ie=0;Ie<9;Ie++)n.probe[Ie].set(0,0,0);let E=0,N=0,W=0,V=0,B=0,O=0,pe=0,ge=0;const ye=b.matrixWorldInverse;g.sort(qE);for(let Ie=0,tt=g.length;Ie<tt;Ie++){const qe=g[Ie],ft=qe.color,je=qe.intensity,Ne=qe.distance,Ue=qe.shadow&&qe.shadow.map?qe.shadow.map.texture:null;if(qe.isAmbientLight)A+=ft.r*je,S+=ft.g*je,R+=ft.b*je;else if(qe.isLightProbe)for(let Le=0;Le<9;Le++)n.probe[Le].addScaledVector(qe.sh.coefficients[Le],je);else if(qe.isDirectionalLight){const Le=r.get(qe);if(Le.color.copy(qe.color).multiplyScalar(qe.intensity),Le.direction.setFromMatrixPosition(qe.matrixWorld),l.setFromMatrixPosition(qe.target.matrixWorld),Le.direction.sub(l),Le.direction.transformDirection(ye),qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,n.directionalShadow[E]=Ve,n.directionalShadowMap[E]=Ue,n.directionalShadowMatrix[E]=qe.shadow.matrix,O++}n.directional[E]=Le,E++}else if(qe.isSpotLight){const Le=r.get(qe);if(Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),Le.color.copy(ft).multiplyScalar(je),Le.distance=Ne,Le.direction.setFromMatrixPosition(qe.matrixWorld),l.setFromMatrixPosition(qe.target.matrixWorld),Le.direction.sub(l),Le.direction.transformDirection(ye),Le.coneCos=Math.cos(qe.angle),Le.penumbraCos=Math.cos(qe.angle*(1-qe.penumbra)),Le.decay=qe.decay,qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,n.spotShadow[W]=Ve,n.spotShadowMap[W]=Ue,n.spotShadowMatrix[W]=qe.shadow.matrix,ge++}n.spot[W]=Le,W++}else if(qe.isRectAreaLight){const Le=r.get(qe);Le.color.copy(ft).multiplyScalar(je),Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),h.identity(),u.copy(qe.matrixWorld),u.premultiply(ye),h.extractRotation(u),Le.halfWidth.set(qe.width*.5,0,0),Le.halfHeight.set(0,qe.height*.5,0),Le.halfWidth.applyMatrix4(h),Le.halfHeight.applyMatrix4(h),n.rectArea[V]=Le,V++}else if(qe.isPointLight){const Le=r.get(qe);if(Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),Le.color.copy(qe.color).multiplyScalar(qe.intensity),Le.distance=qe.distance,Le.decay=qe.decay,qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,Ve.shadowCameraNear=Te.camera.near,Ve.shadowCameraFar=Te.camera.far,n.pointShadow[N]=Ve,n.pointShadowMap[N]=Ue,n.pointShadowMatrix[N]=qe.shadow.matrix,pe++}n.point[N]=Le,N++}else if(qe.isHemisphereLight){const Le=r.get(qe);Le.direction.setFromMatrixPosition(qe.matrixWorld),Le.direction.transformDirection(ye),Le.direction.normalize(),Le.skyColor.copy(qe.color).multiplyScalar(je),Le.groundColor.copy(qe.groundColor).multiplyScalar(je),n.hemi[B]=Le,B++}}V>0&&(n.rectAreaLTC1=qt.LTC_1,n.rectAreaLTC2=qt.LTC_2),n.ambient[0]=A,n.ambient[1]=S,n.ambient[2]=R;const $=n.hash;($.directionalLength!==E||$.pointLength!==N||$.spotLength!==W||$.rectAreaLength!==V||$.hemiLength!==B||$.numDirectionalShadows!==O||$.numPointShadows!==pe||$.numSpotShadows!==ge)&&(n.directional.length=E,n.spot.length=W,n.rectArea.length=V,n.point.length=N,n.hemi.length=B,n.directionalShadow.length=O,n.directionalShadowMap.length=O,n.pointShadow.length=pe,n.pointShadowMap.length=pe,n.spotShadow.length=ge,n.spotShadowMap.length=ge,n.directionalShadowMatrix.length=O,n.pointShadowMatrix.length=pe,n.spotShadowMatrix.length=ge,$.directionalLength=E,$.pointLength=N,$.spotLength=W,$.rectAreaLength=V,$.hemiLength=B,$.numDirectionalShadows=O,$.numPointShadows=pe,$.numSpotShadows=ge,n.version=WE++)}return{setup:p,state:n}}function F0(){const r=new XE,i=[],n=[];function l(){i.length=0,n.length=0}function u(_){i.push(_)}function h(_){n.push(_)}function p(_){r.setup(i,n,_)}return{init:l,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:p,pushLight:u,pushShadow:h}}function jE(){let r=new WeakMap;function i(l,u){let h;return r.has(l)===!1?(h=new F0,r.set(l,new WeakMap),r.get(l).set(u,h)):r.get(l).has(u)===!1?(h=new F0,r.get(l).set(u,h)):h=r.get(l).get(u),h}function n(){r=new WeakMap}return{get:i,dispose:n}}function kc(r){Tn.call(this),this.type="MeshDepthMaterial",this.depthPacking=Nw,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(r)}kc.prototype=Object.create(Tn.prototype),kc.prototype.constructor=kc,kc.prototype.isMeshDepthMaterial=!0,kc.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.depthPacking=r.depthPacking,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this};function Vc(r){Tn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new _e,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(r)}Vc.prototype=Object.create(Tn.prototype),Vc.prototype.constructor=Vc,Vc.prototype.isMeshDistanceMaterial=!0,Vc.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.referencePosition.copy(r.referencePosition),this.nearDistance=r.nearDistance,this.farDistance=r.farDistance,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this};var YE=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,ZE=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function B0(r,i,n){let l=new sp;const u=new bt,h=new bt,p=new Hi,g=[],_=[],b={},A={0:ti,1:Fs,2:jr},S=new Ua({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new bt},radius:{value:4}},vertexShader:ZE,fragmentShader:YE}),R=S.clone();R.defines.HORIZONAL_PASS=1;const E=new Ni;E.setAttribute("position",new Fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new ra(E,S),W=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ei,this.render=function(ye,$,Ie){if(W.enabled===!1||W.autoUpdate===!1&&W.needsUpdate===!1||ye.length===0)return;const tt=r.getRenderTarget(),qe=r.getActiveCubeFace(),ft=r.getActiveMipmapLevel(),je=r.state;je.setBlending(Za),je.buffers.color.setClear(1,1,1,1),je.buffers.depth.setTest(!0),je.setScissorTest(!1);for(let Ne=0,Ue=ye.length;Ne<Ue;Ne++){const Le=ye[Ne],Te=Le.shadow;if(Te===void 0){console.warn("THREE.WebGLShadowMap:",Le,"has no shadow.");continue}if(Te.autoUpdate===!1&&Te.needsUpdate===!1)continue;u.copy(Te.mapSize);const Ve=Te.getFrameExtents();if(u.multiply(Ve),h.copy(Te.mapSize),(u.x>n||u.y>n)&&(u.x>n&&(h.x=Math.floor(n/Ve.x),u.x=h.x*Ve.x,Te.mapSize.x=h.x),u.y>n&&(h.y=Math.floor(n/Ve.y),u.y=h.y*Ve.y,Te.mapSize.y=h.y)),Te.map===null&&!Te.isPointLightShadow&&this.type===Ya){const at={minFilter:Rn,magFilter:Rn,format:vs};Te.map=new Gs(u.x,u.y,at),Te.map.texture.name=Le.name+".shadowMap",Te.mapPass=new Gs(u.x,u.y,at),Te.camera.updateProjectionMatrix()}if(Te.map===null){const at={minFilter:Et,magFilter:Et,format:vs};Te.map=new Gs(u.x,u.y,at),Te.map.texture.name=Le.name+".shadowMap",Te.camera.updateProjectionMatrix()}r.setRenderTarget(Te.map),r.clear();const We=Te.getViewportCount();for(let at=0;at<We;at++){const Tt=Te.getViewport(at);p.set(h.x*Tt.x,h.y*Tt.y,h.x*Tt.z,h.y*Tt.w),je.viewport(p),Te.updateMatrices(Le,at),l=Te.getFrustum(),ge($,Ie,Te.camera,Le,this.type)}!Te.isPointLightShadow&&this.type===Ya&&V(Te,Ie),Te.needsUpdate=!1}W.needsUpdate=!1,r.setRenderTarget(tt,qe,ft)};function V(ye,$){const Ie=i.update(N);S.uniforms.shadow_pass.value=ye.map.texture,S.uniforms.resolution.value=ye.mapSize,S.uniforms.radius.value=ye.radius,r.setRenderTarget(ye.mapPass),r.clear(),r.renderBufferDirect($,null,Ie,S,N,null),R.uniforms.shadow_pass.value=ye.mapPass.texture,R.uniforms.resolution.value=ye.mapSize,R.uniforms.radius.value=ye.radius,r.setRenderTarget(ye.map),r.clear(),r.renderBufferDirect($,null,Ie,R,N,null)}function B(ye,$,Ie){const tt=ye<<0|$<<1|Ie<<2;let qe=g[tt];return qe===void 0&&(qe=new kc({depthPacking:Fw,morphTargets:ye,skinning:$}),g[tt]=qe),qe}function O(ye,$,Ie){const tt=ye<<0|$<<1|Ie<<2;let qe=_[tt];return qe===void 0&&(qe=new Vc({morphTargets:ye,skinning:$}),_[tt]=qe),qe}function pe(ye,$,Ie,tt,qe,ft,je){let Ne=null,Ue=B,Le=ye.customDepthMaterial;if(tt.isPointLight===!0&&(Ue=O,Le=ye.customDistanceMaterial),Le===void 0){let Te=!1;Ie.morphTargets===!0&&(Te=$.morphAttributes&&$.morphAttributes.position&&$.morphAttributes.position.length>0);let Ve=!1;ye.isSkinnedMesh===!0&&(Ie.skinning===!0?Ve=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",ye));const We=ye.isInstancedMesh===!0;Ne=Ue(Te,Ve,We)}else Ne=Le;if(r.localClippingEnabled&&Ie.clipShadows===!0&&Ie.clippingPlanes.length!==0){const Te=Ne.uuid,Ve=Ie.uuid;let We=b[Te];We===void 0&&(We={},b[Te]=We);let at=We[Ve];at===void 0&&(at=Ne.clone(),We[Ve]=at),Ne=at}return Ne.visible=Ie.visible,Ne.wireframe=Ie.wireframe,je===Ya?Ne.side=Ie.shadowSide!==null?Ie.shadowSide:Ie.side:Ne.side=Ie.shadowSide!==null?Ie.shadowSide:A[Ie.side],Ne.clipShadows=Ie.clipShadows,Ne.clippingPlanes=Ie.clippingPlanes,Ne.clipIntersection=Ie.clipIntersection,Ne.wireframeLinewidth=Ie.wireframeLinewidth,Ne.linewidth=Ie.linewidth,tt.isPointLight===!0&&Ne.isMeshDistanceMaterial===!0&&(Ne.referencePosition.setFromMatrixPosition(tt.matrixWorld),Ne.nearDistance=qe,Ne.farDistance=ft),Ne}function ge(ye,$,Ie,tt,qe){if(ye.visible===!1)return;if(ye.layers.test($.layers)&&(ye.isMesh||ye.isLine||ye.isPoints)&&(ye.castShadow||ye.receiveShadow&&qe===Ya)&&(!ye.frustumCulled||l.intersectsObject(ye))){ye.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,ye.matrixWorld);const Ne=i.update(ye),Ue=ye.material;if(Array.isArray(Ue)){const Le=Ne.groups;for(let Te=0,Ve=Le.length;Te<Ve;Te++){const We=Le[Te],at=Ue[We.materialIndex];if(at&&at.visible){const Tt=pe(ye,Ne,at,tt,Ie.near,Ie.far,qe);r.renderBufferDirect(Ie,null,Ne,Tt,ye,We)}}}else if(Ue.visible){const Le=pe(ye,Ne,Ue,tt,Ie.near,Ie.far,qe);r.renderBufferDirect(Ie,null,Ne,Le,ye,null)}}const je=ye.children;for(let Ne=0,Ue=je.length;Ne<Ue;Ne++)ge(je[Ne],$,Ie,tt,qe)}}function JE(r,i,n){const l=n.isWebGL2;function u(){let ue=!1;const Je=new Hi;let ct=null;const Ft=new Hi(0,0,0,0);return{setMask:function(ut){ct!==ut&&!ue&&(r.colorMask(ut,ut,ut,ut),ct=ut)},setLocked:function(ut){ue=ut},setClear:function(ut,me,it,Rt,mt){mt===!0&&(ut*=Rt,me*=Rt,it*=Rt),Je.set(ut,me,it,Rt),Ft.equals(Je)===!1&&(r.clearColor(ut,me,it,Rt),Ft.copy(Je))},reset:function(){ue=!1,ct=null,Ft.set(-1,0,0,0)}}}function h(){let ue=!1,Je=null,ct=null,Ft=null;return{setTest:function(ut){ut?nt(2929):At(2929)},setMask:function(ut){Je!==ut&&!ue&&(r.depthMask(ut),Je=ut)},setFunc:function(ut){if(ct!==ut){if(ut)switch(ut){case Ai:r.depthFunc(512);break;case Xn:r.depthFunc(519);break;case Li:r.depthFunc(513);break;case zi:r.depthFunc(515);break;case or:r.depthFunc(514);break;case tn:r.depthFunc(518);break;case Nn:r.depthFunc(516);break;case Wi:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);ct=ut}},setLocked:function(ut){ue=ut},setClear:function(ut){Ft!==ut&&(r.clearDepth(ut),Ft=ut)},reset:function(){ue=!1,Je=null,ct=null,Ft=null}}}function p(){let ue=!1,Je=null,ct=null,Ft=null,ut=null,me=null,it=null,Rt=null,mt=null;return{setTest:function(Nt){ue||(Nt?nt(2960):At(2960))},setMask:function(Nt){Je!==Nt&&!ue&&(r.stencilMask(Nt),Je=Nt)},setFunc:function(Nt,gn,gi){(ct!==Nt||Ft!==gn||ut!==gi)&&(r.stencilFunc(Nt,gn,gi),ct=Nt,Ft=gn,ut=gi)},setOp:function(Nt,gn,gi){(me!==Nt||it!==gn||Rt!==gi)&&(r.stencilOp(Nt,gn,gi),me=Nt,it=gn,Rt=gi)},setLocked:function(Nt){ue=Nt},setClear:function(Nt){mt!==Nt&&(r.clearStencil(Nt),mt=Nt)},reset:function(){ue=!1,Je=null,ct=null,Ft=null,ut=null,me=null,it=null,Rt=null,mt=null}}}const g=new u,_=new h,b=new p;let A={},S=null,R=null,E=null,N=null,W=null,V=null,B=null,O=null,pe=null,ge=!1,ye=null,$=null,Ie=null,tt=null,qe=null;const ft=r.getParameter(35661);let je=!1,Ne=0;const Ue=r.getParameter(7938);Ue.indexOf("WebGL")!==-1?(Ne=parseFloat(/^WebGL\ ([0-9])/.exec(Ue)[1]),je=Ne>=1):Ue.indexOf("OpenGL ES")!==-1&&(Ne=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Ue)[1]),je=Ne>=2);let Le=null,Te={};const Ve=new Hi,We=new Hi;function at(ue,Je,ct){const Ft=new Uint8Array(4),ut=r.createTexture();r.bindTexture(ue,ut),r.texParameteri(ue,10241,9728),r.texParameteri(ue,10240,9728);for(let me=0;me<ct;me++)r.texImage2D(Je+me,0,6408,1,1,0,6408,5121,Ft);return ut}const Tt={};Tt[3553]=at(3553,3553,1),Tt[34067]=at(34067,34069,6),g.setClear(0,0,0,1),_.setClear(1),b.setClear(0),nt(2929),_.setFunc(zi),te(!1),de(_o),nt(2884),H(Za);function nt(ue){A[ue]!==!0&&(r.enable(ue),A[ue]=!0)}function At(ue){A[ue]!==!1&&(r.disable(ue),A[ue]=!1)}function nn(ue){return S!==ue?(r.useProgram(ue),S=ue,!0):!1}const Yt={[bo]:32774,[Ru]:32778,[En]:32779};if(l)Yt[Pn]=32775,Yt[Pr]=32776;else{const ue=i.get("EXT_blend_minmax");ue!==null&&(Yt[Pn]=ue.MIN_EXT,Yt[Pr]=ue.MAX_EXT)}const K={[sr]:0,[bn]:1,[rt]:768,[ln]:770,[Ir]:776,[$i]:774,[Gi]:772,[It]:769,[cn]:771,[Di]:775,[pi]:773};function H(ue,Je,ct,Ft,ut,me,it,Rt){if(ue===Za){R&&(At(3042),R=!1);return}if(R||(nt(3042),R=!0),ue!==Dc){if(ue!==E||Rt!==ge){if((N!==bo||B!==bo)&&(r.blendEquation(32774),N=bo,B=bo),Rt)switch(ue){case Na:r.blendFuncSeparate(1,771,1,771);break;case Ic:r.blendFunc(1,1);break;case Lu:r.blendFuncSeparate(0,0,769,771);break;case xo:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}else switch(ue){case Na:r.blendFuncSeparate(770,771,1,771);break;case Ic:r.blendFunc(770,1);break;case Lu:r.blendFunc(0,769);break;case xo:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}W=null,V=null,O=null,pe=null,E=ue,ge=Rt}return}ut=ut||Je,me=me||ct,it=it||Ft,(Je!==N||ut!==B)&&(r.blendEquationSeparate(Yt[Je],Yt[ut]),N=Je,B=ut),(ct!==W||Ft!==V||me!==O||it!==pe)&&(r.blendFuncSeparate(K[ct],K[Ft],K[me],K[it]),W=ct,V=Ft,O=me,pe=it),E=ue,ge=null}function xe(ue,Je){ue.side===jr?At(2884):nt(2884);let ct=ue.side===ti;Je&&(ct=!ct),te(ct),ue.blending===Na&&ue.transparent===!1?H(Za):H(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.premultipliedAlpha),_.setFunc(ue.depthFunc),_.setTest(ue.depthTest),_.setMask(ue.depthWrite),g.setMask(ue.colorWrite);const Ft=ue.stencilWrite;b.setTest(Ft),Ft&&(b.setMask(ue.stencilWriteMask),b.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),b.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),Re(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits)}function te(ue){ye!==ue&&(ue?r.frontFace(2304):r.frontFace(2305),ye=ue)}function de(ue){ue!==yo?(nt(2884),ue!==$&&(ue===_o?r.cullFace(1029):ue===Er?r.cullFace(1028):r.cullFace(1032))):At(2884),$=ue}function be(ue){ue!==Ie&&(je&&r.lineWidth(ue),Ie=ue)}function Re(ue,Je,ct){ue?(nt(32823),(tt!==Je||qe!==ct)&&(r.polygonOffset(Je,ct),tt=Je,qe=ct)):At(32823)}function we(ue){ue?nt(3089):At(3089)}function Se(ue){ue===void 0&&(ue=33984+ft-1),Le!==ue&&(r.activeTexture(ue),Le=ue)}function Pe(ue,Je){Le===null&&Se();let ct=Te[Le];ct===void 0&&(ct={type:void 0,texture:void 0},Te[Le]=ct),(ct.type!==ue||ct.texture!==Je)&&(r.bindTexture(ue,Je||Tt[ue]),ct.type=ue,ct.texture=Je)}function ze(){const ue=Te[Le];ue!==void 0&&ue.type!==void 0&&(r.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function Ze(){try{r.compressedTexImage2D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Xe(){try{r.texImage2D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Q(){try{r.texImage3D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Y(ue){Ve.equals(ue)===!1&&(r.scissor(ue.x,ue.y,ue.z,ue.w),Ve.copy(ue))}function He(ue){We.equals(ue)===!1&&(r.viewport(ue.x,ue.y,ue.z,ue.w),We.copy(ue))}function Ge(){A={},Le=null,Te={},S=null,E=null,ye=null,$=null,g.reset(),_.reset(),b.reset()}return{buffers:{color:g,depth:_,stencil:b},enable:nt,disable:At,useProgram:nn,setBlending:H,setMaterial:xe,setFlipSided:te,setCullFace:de,setLineWidth:be,setPolygonOffset:Re,setScissorTest:we,activeTexture:Se,bindTexture:Pe,unbindTexture:ze,compressedTexImage2D:Ze,texImage2D:Xe,texImage3D:Q,scissor:Y,viewport:He,reset:Ge}}function KE(r,i,n,l,u,h,p){const g=u.isWebGL2,_=u.maxTextures,b=u.maxCubemapSize,A=u.maxTextureSize,S=u.maxSamples,R=new WeakMap;let E,N=!1;try{N=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function W(Q,Y){return N?new OffscreenCanvas(Q,Y):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function V(Q,Y,He,Ge){let ue=1;if((Q.width>Ge||Q.height>Ge)&&(ue=Ge/Math.max(Q.width,Q.height)),ue<1||Y===!0)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap){const Je=Y?zn.floorPowerOfTwo:Math.floor,ct=Je(ue*Q.width),Ft=Je(ue*Q.height);E===void 0&&(E=W(ct,Ft));const ut=He?W(ct,Ft):E;return ut.width=ct,ut.height=Ft,ut.getContext("2d").drawImage(Q,0,0,ct,Ft),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Q.width+"x"+Q.height+") to ("+ct+"x"+Ft+")."),ut}else return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Q.width+"x"+Q.height+")."),Q;return Q}function B(Q){return zn.isPowerOfTwo(Q.width)&&zn.isPowerOfTwo(Q.height)}function O(Q){return g?!1:Q.wrapS!==na||Q.wrapT!==na||Q.minFilter!==Et&&Q.minFilter!==Rn}function pe(Q,Y){return Q.generateMipmaps&&Y&&Q.minFilter!==Et&&Q.minFilter!==Rn}function ge(Q,Y,He,Ge){r.generateMipmap(Q);const ue=l.get(Y);ue.__maxMipLevel=Math.log(Math.max(He,Ge))*Math.LOG2E}function ye(Q,Y,He){if(g===!1)return Y;if(Q!==null){if(r[Q]!==void 0)return r[Q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let Ge=Y;return Y===6403&&(He===5126&&(Ge=33326),He===5131&&(Ge=33325),He===5121&&(Ge=33321)),Y===6407&&(He===5126&&(Ge=34837),He===5131&&(Ge=34843),He===5121&&(Ge=32849)),Y===6408&&(He===5126&&(Ge=34836),He===5131&&(Ge=34842),He===5121&&(Ge=32856)),(Ge===33325||Ge===33326||Ge===34842||Ge===34836)&&i.get("EXT_color_buffer_float"),Ge}function $(Q){return Q===Et||Q===Vn||Q===Oi?9728:9729}function Ie(Q){const Y=Q.target;Y.removeEventListener("dispose",Ie),qe(Y),Y.isVideoTexture&&R.delete(Y),p.memory.textures--}function tt(Q){const Y=Q.target;Y.removeEventListener("dispose",tt),ft(Y),p.memory.textures--}function qe(Q){const Y=l.get(Q);Y.__webglInit!==void 0&&(r.deleteTexture(Y.__webglTexture),l.remove(Q))}function ft(Q){const Y=l.get(Q),He=l.get(Q.texture);if(!!Q){if(He.__webglTexture!==void 0&&r.deleteTexture(He.__webglTexture),Q.depthTexture&&Q.depthTexture.dispose(),Q.isWebGLCubeRenderTarget)for(let Ge=0;Ge<6;Ge++)r.deleteFramebuffer(Y.__webglFramebuffer[Ge]),Y.__webglDepthbuffer&&r.deleteRenderbuffer(Y.__webglDepthbuffer[Ge]);else r.deleteFramebuffer(Y.__webglFramebuffer),Y.__webglDepthbuffer&&r.deleteRenderbuffer(Y.__webglDepthbuffer),Y.__webglMultisampledFramebuffer&&r.deleteFramebuffer(Y.__webglMultisampledFramebuffer),Y.__webglColorRenderbuffer&&r.deleteRenderbuffer(Y.__webglColorRenderbuffer),Y.__webglDepthRenderbuffer&&r.deleteRenderbuffer(Y.__webglDepthRenderbuffer);l.remove(Q.texture),l.remove(Q)}}let je=0;function Ne(){je=0}function Ue(){const Q=je;return Q>=_&&console.warn("THREE.WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+_),je+=1,Q}function Le(Q,Y){const He=l.get(Q);if(Q.isVideoTexture&&Se(Q),Q.version>0&&He.__version!==Q.version){const Ge=Q.image;if(Ge===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{nn(He,Q,Y);return}}n.activeTexture(33984+Y),n.bindTexture(3553,He.__webglTexture)}function Te(Q,Y){const He=l.get(Q);if(Q.version>0&&He.__version!==Q.version){nn(He,Q,Y);return}n.activeTexture(33984+Y),n.bindTexture(35866,He.__webglTexture)}function Ve(Q,Y){const He=l.get(Q);if(Q.version>0&&He.__version!==Q.version){nn(He,Q,Y);return}n.activeTexture(33984+Y),n.bindTexture(32879,He.__webglTexture)}function We(Q,Y){const He=l.get(Q);if(Q.version>0&&He.__version!==Q.version){Yt(He,Q,Y);return}n.activeTexture(33984+Y),n.bindTexture(34067,He.__webglTexture)}const at={[Gl]:10497,[na]:33071,[wt]:33648},Tt={[Et]:9728,[Vn]:9984,[Oi]:9986,[Rn]:9729,[Dr]:9985,[Pu]:9987};function nt(Q,Y,He){He?(r.texParameteri(Q,10242,at[Y.wrapS]),r.texParameteri(Q,10243,at[Y.wrapT]),(Q===32879||Q===35866)&&r.texParameteri(Q,32882,at[Y.wrapR]),r.texParameteri(Q,10240,Tt[Y.magFilter]),r.texParameteri(Q,10241,Tt[Y.minFilter])):(r.texParameteri(Q,10242,33071),r.texParameteri(Q,10243,33071),(Q===32879||Q===35866)&&r.texParameteri(Q,32882,33071),(Y.wrapS!==na||Y.wrapT!==na)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(Q,10240,$(Y.magFilter)),r.texParameteri(Q,10241,$(Y.minFilter)),Y.minFilter!==Et&&Y.minFilter!==Rn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Ge=i.get("EXT_texture_filter_anisotropic");if(Ge){if(Y.type===Bs&&i.get("OES_texture_float_linear")===null||Y.type===Nc&&(g||i.get("OES_texture_half_float_linear"))===null)return;(Y.anisotropy>1||l.get(Y).__currentAnisotropy)&&(r.texParameterf(Q,Ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Y.anisotropy,u.getMaxAnisotropy())),l.get(Y).__currentAnisotropy=Y.anisotropy)}}function At(Q,Y){Q.__webglInit===void 0&&(Q.__webglInit=!0,Y.addEventListener("dispose",Ie),Q.__webglTexture=r.createTexture(),p.memory.textures++)}function nn(Q,Y,He){let Ge=3553;Y.isDataTexture2DArray&&(Ge=35866),Y.isDataTexture3D&&(Ge=32879),At(Q,Y),n.activeTexture(33984+He),n.bindTexture(Ge,Q.__webglTexture),r.pixelStorei(37440,Y.flipY),r.pixelStorei(37441,Y.premultiplyAlpha),r.pixelStorei(3317,Y.unpackAlignment);const ue=O(Y)&&B(Y.image)===!1,Je=V(Y.image,ue,!1,A),ct=B(Je)||g,Ft=h.convert(Y.format);let ut=h.convert(Y.type),me=ye(Y.internalFormat,Ft,ut);nt(Ge,Y,ct);let it;const Rt=Y.mipmaps;if(Y.isDepthTexture)me=6402,g?Y.type===Bs?me=36012:Y.type===Hd?me=33190:Y.type===af?me=35056:me=33189:Y.type===Bs&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Y.format===Iu&&me===6402&&Y.type!==zd&&Y.type!==Hd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Y.type=zd,ut=h.convert(Y.type)),Y.format===sf&&me===6402&&(me=34041,Y.type!==af&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Y.type=af,ut=h.convert(Y.type))),n.texImage2D(3553,0,me,Je.width,Je.height,0,Ft,ut,null);else if(Y.isDataTexture)if(Rt.length>0&&ct){for(let mt=0,Nt=Rt.length;mt<Nt;mt++)it=Rt[mt],n.texImage2D(3553,mt,me,it.width,it.height,0,Ft,ut,it.data);Y.generateMipmaps=!1,Q.__maxMipLevel=Rt.length-1}else n.texImage2D(3553,0,me,Je.width,Je.height,0,Ft,ut,Je.data),Q.__maxMipLevel=0;else if(Y.isCompressedTexture){for(let mt=0,Nt=Rt.length;mt<Nt;mt++)it=Rt[mt],Y.format!==vs&&Y.format!==Mo?Ft!==null?n.compressedTexImage2D(3553,mt,me,it.width,it.height,0,it.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,mt,me,it.width,it.height,0,Ft,ut,it.data);Q.__maxMipLevel=Rt.length-1}else if(Y.isDataTexture2DArray)n.texImage3D(35866,0,me,Je.width,Je.height,Je.depth,0,Ft,ut,Je.data),Q.__maxMipLevel=0;else if(Y.isDataTexture3D)n.texImage3D(32879,0,me,Je.width,Je.height,Je.depth,0,Ft,ut,Je.data),Q.__maxMipLevel=0;else if(Rt.length>0&&ct){for(let mt=0,Nt=Rt.length;mt<Nt;mt++)it=Rt[mt],n.texImage2D(3553,mt,me,Ft,ut,it);Y.generateMipmaps=!1,Q.__maxMipLevel=Rt.length-1}else n.texImage2D(3553,0,me,Ft,ut,Je),Q.__maxMipLevel=0;pe(Y,ct)&&ge(Ge,Y,Je.width,Je.height),Q.__version=Y.version,Y.onUpdate&&Y.onUpdate(Y)}function Yt(Q,Y,He){if(Y.image.length!==6)return;At(Q,Y),n.activeTexture(33984+He),n.bindTexture(34067,Q.__webglTexture),r.pixelStorei(37440,Y.flipY);const Ge=Y&&(Y.isCompressedTexture||Y.image[0].isCompressedTexture),ue=Y.image[0]&&Y.image[0].isDataTexture,Je=[];for(let mt=0;mt<6;mt++)!Ge&&!ue?Je[mt]=V(Y.image[mt],!1,!0,b):Je[mt]=ue?Y.image[mt].image:Y.image[mt];const ct=Je[0],Ft=B(ct)||g,ut=h.convert(Y.format),me=h.convert(Y.type),it=ye(Y.internalFormat,ut,me);nt(34067,Y,Ft);let Rt;if(Ge){for(let mt=0;mt<6;mt++){Rt=Je[mt].mipmaps;for(let Nt=0;Nt<Rt.length;Nt++){const gn=Rt[Nt];Y.format!==vs&&Y.format!==Mo?ut!==null?n.compressedTexImage2D(34069+mt,Nt,it,gn.width,gn.height,0,gn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+mt,Nt,it,gn.width,gn.height,0,ut,me,gn.data)}}Q.__maxMipLevel=Rt.length-1}else{Rt=Y.mipmaps;for(let mt=0;mt<6;mt++)if(ue){n.texImage2D(34069+mt,0,it,Je[mt].width,Je[mt].height,0,ut,me,Je[mt].data);for(let Nt=0;Nt<Rt.length;Nt++){const gi=Rt[Nt].image[mt].image;n.texImage2D(34069+mt,Nt+1,it,gi.width,gi.height,0,ut,me,gi.data)}}else{n.texImage2D(34069+mt,0,it,ut,me,Je[mt]);for(let Nt=0;Nt<Rt.length;Nt++){const gn=Rt[Nt];n.texImage2D(34069+mt,Nt+1,it,ut,me,gn.image[mt])}}Q.__maxMipLevel=Rt.length}pe(Y,Ft)&&ge(34067,Y,ct.width,ct.height),Q.__version=Y.version,Y.onUpdate&&Y.onUpdate(Y)}function K(Q,Y,He,Ge){const ue=h.convert(Y.texture.format),Je=h.convert(Y.texture.type),ct=ye(Y.texture.internalFormat,ue,Je);n.texImage2D(Ge,0,ct,Y.width,Y.height,0,ue,Je,null),r.bindFramebuffer(36160,Q),r.framebufferTexture2D(36160,He,Ge,l.get(Y.texture).__webglTexture,0),r.bindFramebuffer(36160,null)}function H(Q,Y,He){if(r.bindRenderbuffer(36161,Q),Y.depthBuffer&&!Y.stencilBuffer){let Ge=33189;if(He){const ue=Y.depthTexture;ue&&ue.isDepthTexture&&(ue.type===Bs?Ge=36012:ue.type===Hd&&(Ge=33190));const Je=we(Y);r.renderbufferStorageMultisample(36161,Je,Ge,Y.width,Y.height)}else r.renderbufferStorage(36161,Ge,Y.width,Y.height);r.framebufferRenderbuffer(36160,36096,36161,Q)}else if(Y.depthBuffer&&Y.stencilBuffer){if(He){const Ge=we(Y);r.renderbufferStorageMultisample(36161,Ge,35056,Y.width,Y.height)}else r.renderbufferStorage(36161,34041,Y.width,Y.height);r.framebufferRenderbuffer(36160,33306,36161,Q)}else{const Ge=h.convert(Y.texture.format),ue=h.convert(Y.texture.type),Je=ye(Y.texture.internalFormat,Ge,ue);if(He){const ct=we(Y);r.renderbufferStorageMultisample(36161,ct,Je,Y.width,Y.height)}else r.renderbufferStorage(36161,Je,Y.width,Y.height)}r.bindRenderbuffer(36161,null)}function xe(Q,Y){if(Y&&Y.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,Q),!(Y.depthTexture&&Y.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!l.get(Y.depthTexture).__webglTexture||Y.depthTexture.image.width!==Y.width||Y.depthTexture.image.height!==Y.height)&&(Y.depthTexture.image.width=Y.width,Y.depthTexture.image.height=Y.height,Y.depthTexture.needsUpdate=!0),Le(Y.depthTexture,0);const Ge=l.get(Y.depthTexture).__webglTexture;if(Y.depthTexture.format===Iu)r.framebufferTexture2D(36160,36096,3553,Ge,0);else if(Y.depthTexture.format===sf)r.framebufferTexture2D(36160,33306,3553,Ge,0);else throw new Error("Unknown depthTexture format")}function te(Q){const Y=l.get(Q),He=Q.isWebGLCubeRenderTarget===!0;if(Q.depthTexture){if(He)throw new Error("target.depthTexture not supported in Cube render targets");xe(Y.__webglFramebuffer,Q)}else if(He){Y.__webglDepthbuffer=[];for(let Ge=0;Ge<6;Ge++)r.bindFramebuffer(36160,Y.__webglFramebuffer[Ge]),Y.__webglDepthbuffer[Ge]=r.createRenderbuffer(),H(Y.__webglDepthbuffer[Ge],Q,!1)}else r.bindFramebuffer(36160,Y.__webglFramebuffer),Y.__webglDepthbuffer=r.createRenderbuffer(),H(Y.__webglDepthbuffer,Q,!1);r.bindFramebuffer(36160,null)}function de(Q){const Y=l.get(Q),He=l.get(Q.texture);Q.addEventListener("dispose",tt),He.__webglTexture=r.createTexture(),p.memory.textures++;const Ge=Q.isWebGLCubeRenderTarget===!0,ue=Q.isWebGLMultisampleRenderTarget===!0,Je=B(Q)||g;if(g&&Q.texture.format===Mo&&(Q.texture.type===Bs||Q.texture.type===Nc)&&(Q.texture.format=vs,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Ge){Y.__webglFramebuffer=[];for(let ct=0;ct<6;ct++)Y.__webglFramebuffer[ct]=r.createFramebuffer()}else if(Y.__webglFramebuffer=r.createFramebuffer(),ue)if(g){Y.__webglMultisampledFramebuffer=r.createFramebuffer(),Y.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,Y.__webglColorRenderbuffer);const ct=h.convert(Q.texture.format),Ft=h.convert(Q.texture.type),ut=ye(Q.texture.internalFormat,ct,Ft),me=we(Q);r.renderbufferStorageMultisample(36161,me,ut,Q.width,Q.height),r.bindFramebuffer(36160,Y.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,Y.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),Q.depthBuffer&&(Y.__webglDepthRenderbuffer=r.createRenderbuffer(),H(Y.__webglDepthRenderbuffer,Q,!0)),r.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Ge){n.bindTexture(34067,He.__webglTexture),nt(34067,Q.texture,Je);for(let ct=0;ct<6;ct++)K(Y.__webglFramebuffer[ct],Q,36064,34069+ct);pe(Q.texture,Je)&&ge(34067,Q.texture,Q.width,Q.height),n.bindTexture(34067,null)}else n.bindTexture(3553,He.__webglTexture),nt(3553,Q.texture,Je),K(Y.__webglFramebuffer,Q,36064,3553),pe(Q.texture,Je)&&ge(3553,Q.texture,Q.width,Q.height),n.bindTexture(3553,null);Q.depthBuffer&&te(Q)}function be(Q){const Y=Q.texture,He=B(Q)||g;if(pe(Y,He)){const Ge=Q.isWebGLCubeRenderTarget?34067:3553,ue=l.get(Y).__webglTexture;n.bindTexture(Ge,ue),ge(Ge,Y,Q.width,Q.height),n.bindTexture(Ge,null)}}function Re(Q){if(Q.isWebGLMultisampleRenderTarget)if(g){const Y=l.get(Q);r.bindFramebuffer(36008,Y.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Y.__webglFramebuffer);const He=Q.width,Ge=Q.height;let ue=16384;Q.depthBuffer&&(ue|=256),Q.stencilBuffer&&(ue|=1024),r.blitFramebuffer(0,0,He,Ge,0,0,He,Ge,ue,9728),r.bindFramebuffer(36160,Y.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function we(Q){return g&&Q.isWebGLMultisampleRenderTarget?Math.min(S,Q.samples):0}function Se(Q){const Y=p.render.frame;R.get(Q)!==Y&&(R.set(Q,Y),Q.update())}let Pe=!1,ze=!1;function Ze(Q,Y){Q&&Q.isWebGLRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Pe=!0),Q=Q.texture),Le(Q,Y)}function Xe(Q,Y){Q&&Q.isWebGLCubeRenderTarget&&(ze===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ze=!0),Q=Q.texture),We(Q,Y)}this.allocateTextureUnit=Ue,this.resetTextureUnits=Ne,this.setTexture2D=Le,this.setTexture2DArray=Te,this.setTexture3D=Ve,this.setTextureCube=We,this.setupRenderTarget=de,this.updateRenderTargetMipmap=be,this.updateMultisampleRenderTarget=Re,this.safeSetTexture2D=Ze,this.safeSetTextureCube=Xe}function $E(r,i,n){const l=n.isWebGL2;function u(h){let p;if(h===Oc)return 5121;if(h===Fb)return 32819;if(h===Bb)return 32820;if(h===Ub)return 33635;if(h===Db)return 5120;if(h===Ob)return 5122;if(h===zd)return 5123;if(h===Nb)return 5124;if(h===Hd)return 5125;if(h===Bs)return 5126;if(h===Nc)return l?5131:(p=i.get("OES_texture_half_float"),p!==null?p.HALF_FLOAT_OES:null);if(h===Gb)return 6406;if(h===Mo)return 6407;if(h===vs)return 6408;if(h===zb)return 6409;if(h===Hb)return 6410;if(h===Iu)return 6402;if(h===sf)return 34041;if(h===Vb)return 6403;if(h===Wb)return 36244;if(h===qb)return 33319;if(h===Xb)return 33320;if(h===jb)return 36248;if(h===Yb)return 36249;if(h===zy||h===Hy||h===ky||h===Vy)if(p=i.get("WEBGL_compressed_texture_s3tc"),p!==null){if(h===zy)return p.COMPRESSED_RGB_S3TC_DXT1_EXT;if(h===Hy)return p.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(h===ky)return p.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(h===Vy)return p.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(h===Wy||h===qy||h===Xy||h===jy)if(p=i.get("WEBGL_compressed_texture_pvrtc"),p!==null){if(h===Wy)return p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(h===qy)return p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(h===Xy)return p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(h===jy)return p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(h===Zb)return p=i.get("WEBGL_compressed_texture_etc1"),p!==null?p.COMPRESSED_RGB_ETC1_WEBGL:null;if((h===Yy||h===Zy)&&(p=i.get("WEBGL_compressed_texture_etc"),p!==null)){if(h===Yy)return p.COMPRESSED_RGB8_ETC2;if(h===Zy)return p.COMPRESSED_RGBA8_ETC2_EAC}if(h===Jb||h===Kb||h===$b||h===Qb||h===ew||h===tw||h===nw||h===iw||h===rw||h===aw||h===sw||h===ow||h===lw||h===cw||h===hw||h===fw||h===dw||h===pw||h===mw||h===gw||h===vw||h===yw||h===_w||h===xw||h===bw||h===ww||h===Mw||h===Sw)return p=i.get("WEBGL_compressed_texture_astc"),p!==null?h:null;if(h===uw)return p=i.get("EXT_texture_compression_bptc"),p!==null?h:null;if(h===af)return l?34042:(p=i.get("WEBGL_depth_texture"),p!==null?p.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:u}}function Bg(r){Jr.call(this),this.cameras=r||[]}Bg.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Bg,isArrayCamera:!0});function ll(){yn.call(this),this.type="Group"}ll.prototype=Object.assign(Object.create(yn.prototype),{constructor:ll,isGroup:!0});function Mf(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(Mf.prototype,{constructor:Mf,getHandSpace:function(){if(this._hand===null&&(this._hand=new ll,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let r=0;r<=window.XRHand.LITTLE_PHALANX_TIP;r++){const i=new ll;i.matrixAutoUpdate=!1,i.visible=!1,this._hand.joints.push(i),this._hand.add(i)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new ll,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new ll,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this},disconnect:function(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(r,i,n){let l=null,u=null,h=null;const p=this._targetRay,g=this._grip,_=this._hand;if(r)if(_&&r.hand){h=!0;for(let b=0;b<=window.XRHand.LITTLE_PHALANX_TIP;b++)if(r.hand[b]){const A=i.getJointPose(r.hand[b],n),S=_.joints[b];A!==null&&(S.matrix.fromArray(A.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=A.radius),S.visible=A!==null;const R=_.joints[window.XRHand.INDEX_PHALANX_TIP],E=_.joints[window.XRHand.THUMB_PHALANX_TIP],N=R.position.distanceTo(E.position),W=.02,V=.005;_.inputState.pinching&&N>W+V?(_.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!_.inputState.pinching&&N<=W-V&&(_.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}}else p!==null&&(l=i.getPose(r.targetRaySpace,n),l!==null&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale))),g!==null&&r.gripSpace&&(u=i.getPose(r.gripSpace,n),u!==null&&(g.matrix.fromArray(u.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale)));return p!==null&&(p.visible=l!==null),g!==null&&(g.visible=u!==null),_!==null&&(_.visible=h!==null),this}});function U0(r,i){const n=this;let l=null,u=1,h=null,p="local-floor",g=null;const _=[],b=new Map,A=new Jr;A.layers.enable(1),A.viewport=new Hi;const S=new Jr;S.layers.enable(2),S.viewport=new Hi;const R=[A,S],E=new Bg;E.layers.enable(1),E.layers.enable(2);let N=null,W=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(je){let Ne=_[je];return Ne===void 0&&(Ne=new Mf,_[je]=Ne),Ne.getTargetRaySpace()},this.getControllerGrip=function(je){let Ne=_[je];return Ne===void 0&&(Ne=new Mf,_[je]=Ne),Ne.getGripSpace()},this.getHand=function(je){let Ne=_[je];return Ne===void 0&&(Ne=new Mf,_[je]=Ne),Ne.getHandSpace()};function V(je){const Ne=b.get(je.inputSource);Ne&&Ne.dispatchEvent({type:je.type,data:je.inputSource})}function B(){b.forEach(function(je,Ne){je.disconnect(Ne)}),b.clear(),r.setFramebuffer(null),r.setRenderTarget(r.getRenderTarget()),ft.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function O(je){h=je,ft.setContext(l),ft.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(je){u=je,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(je){p=je,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h},this.getSession=function(){return l},this.setSession=function(je){if(l=je,l!==null){l.addEventListener("select",V),l.addEventListener("selectstart",V),l.addEventListener("selectend",V),l.addEventListener("squeeze",V),l.addEventListener("squeezestart",V),l.addEventListener("squeezeend",V),l.addEventListener("end",B);const Ne=i.getContextAttributes();Ne.xrCompatible!==!0&&i.makeXRCompatible();const Ue={antialias:Ne.antialias,alpha:Ne.alpha,depth:Ne.depth,stencil:Ne.stencil,framebufferScaleFactor:u},Le=new XRWebGLLayer(l,i,Ue);l.updateRenderState({baseLayer:Le}),l.requestReferenceSpace(p).then(O),l.addEventListener("inputsourceschange",pe)}};function pe(je){const Ne=l.inputSources;for(let Ue=0;Ue<_.length;Ue++)b.set(Ne[Ue],_[Ue]);for(let Ue=0;Ue<je.removed.length;Ue++){const Le=je.removed[Ue],Te=b.get(Le);Te&&(Te.dispatchEvent({type:"disconnected",data:Le}),b.delete(Le))}for(let Ue=0;Ue<je.added.length;Ue++){const Le=je.added[Ue],Te=b.get(Le);Te&&Te.dispatchEvent({type:"connected",data:Le})}}const ge=new _e,ye=new _e;function $(je,Ne,Ue){ge.setFromMatrixPosition(Ne.matrixWorld),ye.setFromMatrixPosition(Ue.matrixWorld);const Le=ge.distanceTo(ye),Te=Ne.projectionMatrix.elements,Ve=Ue.projectionMatrix.elements,We=Te[14]/(Te[10]-1),at=Te[14]/(Te[10]+1),Tt=(Te[9]+1)/Te[5],nt=(Te[9]-1)/Te[5],At=(Te[8]-1)/Te[0],nn=(Ve[8]+1)/Ve[0],Yt=We*At,K=We*nn,H=Le/(-At+nn),xe=H*-At;Ne.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(xe),je.translateZ(H),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.getInverse(je.matrixWorld);const te=We+H,de=at+H,be=Yt-xe,Re=K+(Le-xe),we=Tt*at/de*te,Se=nt*at/de*te;je.projectionMatrix.makePerspective(be,Re,we,Se,te,de)}function Ie(je,Ne){Ne===null?je.matrixWorld.copy(je.matrix):je.matrixWorld.multiplyMatrices(Ne.matrixWorld,je.matrix),je.matrixWorldInverse.getInverse(je.matrixWorld)}this.getCamera=function(je){E.near=S.near=A.near=je.near,E.far=S.far=A.far=je.far,(N!==E.near||W!==E.far)&&(l.updateRenderState({depthNear:E.near,depthFar:E.far}),N=E.near,W=E.far);const Ne=je.parent,Ue=E.cameras;Ie(E,Ne);for(let Te=0;Te<Ue.length;Te++)Ie(Ue[Te],Ne);je.matrixWorld.copy(E.matrixWorld);const Le=je.children;for(let Te=0,Ve=Le.length;Te<Ve;Te++)Le[Te].updateMatrixWorld(!0);return Ue.length===2?$(E,A,S):E.projectionMatrix.copy(A.projectionMatrix),E};let tt=null;function qe(je,Ne){if(g=Ne.getViewerPose(h),g!==null){const Le=g.views,Te=l.renderState.baseLayer;r.setFramebuffer(Te.framebuffer);let Ve=!1;Le.length!==E.cameras.length&&(E.cameras.length=0,Ve=!0);for(let We=0;We<Le.length;We++){const at=Le[We],Tt=Te.getViewport(at),nt=R[We];nt.matrix.fromArray(at.transform.matrix),nt.projectionMatrix.fromArray(at.projectionMatrix),nt.viewport.set(Tt.x,Tt.y,Tt.width,Tt.height),We===0&&E.matrix.copy(nt.matrix),Ve===!0&&E.cameras.push(nt)}}const Ue=l.inputSources;for(let Le=0;Le<_.length;Le++){const Te=_[Le],Ve=Ue[Le];Te.update(Ve,Ne,h)}tt&&tt(je,Ne)}const ft=new m0;ft.setAnimationLoop(qe),this.setAnimationLoop=function(je){tt=je},this.dispose=function(){}}Object.assign(U0.prototype,Us.prototype);function QE(r){function i(B,O){B.fogColor.value.copy(O.color),O.isFog?(B.fogNear.value=O.near,B.fogFar.value=O.far):O.isFogExp2&&(B.fogDensity.value=O.density)}function n(B,O,pe,ge){O.isMeshBasicMaterial?l(B,O):O.isMeshLambertMaterial?(l(B,O),_(B,O)):O.isMeshToonMaterial?(l(B,O),A(B,O)):O.isMeshPhongMaterial?(l(B,O),b(B,O)):O.isMeshStandardMaterial?(l(B,O),O.isMeshPhysicalMaterial?R(B,O):S(B,O)):O.isMeshMatcapMaterial?(l(B,O),E(B,O)):O.isMeshDepthMaterial?(l(B,O),N(B,O)):O.isMeshDistanceMaterial?(l(B,O),W(B,O)):O.isMeshNormalMaterial?(l(B,O),V(B,O)):O.isLineBasicMaterial?(u(B,O),O.isLineDashedMaterial&&h(B,O)):O.isPointsMaterial?p(B,O,pe,ge):O.isSpriteMaterial?g(B,O):O.isShadowMaterial?(B.color.value.copy(O.color),B.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}function l(B,O){B.opacity.value=O.opacity,O.color&&B.diffuse.value.copy(O.color),O.emissive&&B.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap),O.specularMap&&(B.specularMap.value=O.specularMap);const pe=r.get(O).envMap;if(pe){B.envMap.value=pe,B.flipEnvMap.value=pe.isCubeTexture&&pe._needsFlipEnvMap?-1:1,B.reflectivity.value=O.reflectivity,B.refractionRatio.value=O.refractionRatio;const $=r.get(pe).__maxMipLevel;$!==void 0&&(B.maxMipLevel.value=$)}O.lightMap&&(B.lightMap.value=O.lightMap,B.lightMapIntensity.value=O.lightMapIntensity),O.aoMap&&(B.aoMap.value=O.aoMap,B.aoMapIntensity.value=O.aoMapIntensity);let ge;O.map?ge=O.map:O.specularMap?ge=O.specularMap:O.displacementMap?ge=O.displacementMap:O.normalMap?ge=O.normalMap:O.bumpMap?ge=O.bumpMap:O.roughnessMap?ge=O.roughnessMap:O.metalnessMap?ge=O.metalnessMap:O.alphaMap?ge=O.alphaMap:O.emissiveMap?ge=O.emissiveMap:O.clearcoatMap?ge=O.clearcoatMap:O.clearcoatNormalMap?ge=O.clearcoatNormalMap:O.clearcoatRoughnessMap&&(ge=O.clearcoatRoughnessMap),ge!==void 0&&(ge.isWebGLRenderTarget&&(ge=ge.texture),ge.matrixAutoUpdate===!0&&ge.updateMatrix(),B.uvTransform.value.copy(ge.matrix));let ye;O.aoMap?ye=O.aoMap:O.lightMap&&(ye=O.lightMap),ye!==void 0&&(ye.isWebGLRenderTarget&&(ye=ye.texture),ye.matrixAutoUpdate===!0&&ye.updateMatrix(),B.uv2Transform.value.copy(ye.matrix))}function u(B,O){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity}function h(B,O){B.dashSize.value=O.dashSize,B.totalSize.value=O.dashSize+O.gapSize,B.scale.value=O.scale}function p(B,O,pe,ge){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity,B.size.value=O.size*pe,B.scale.value=ge*.5,O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap);let ye;O.map?ye=O.map:O.alphaMap&&(ye=O.alphaMap),ye!==void 0&&(ye.matrixAutoUpdate===!0&&ye.updateMatrix(),B.uvTransform.value.copy(ye.matrix))}function g(B,O){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity,B.rotation.value=O.rotation,O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap);let pe;O.map?pe=O.map:O.alphaMap&&(pe=O.alphaMap),pe!==void 0&&(pe.matrixAutoUpdate===!0&&pe.updateMatrix(),B.uvTransform.value.copy(pe.matrix))}function _(B,O){O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap)}function b(B,O){B.specular.value.copy(O.specular),B.shininess.value=Math.max(O.shininess,1e-4),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ti&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ti&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function A(B,O){O.gradientMap&&(B.gradientMap.value=O.gradientMap),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ti&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ti&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function S(B,O){B.roughness.value=O.roughness,B.metalness.value=O.metalness,O.roughnessMap&&(B.roughnessMap.value=O.roughnessMap),O.metalnessMap&&(B.metalnessMap.value=O.metalnessMap),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ti&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ti&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias),r.get(O).envMap&&(B.envMapIntensity.value=O.envMapIntensity)}function R(B,O){S(B,O),B.reflectivity.value=O.reflectivity,B.clearcoat.value=O.clearcoat,B.clearcoatRoughness.value=O.clearcoatRoughness,O.sheen&&B.sheen.value.copy(O.sheen),O.clearcoatMap&&(B.clearcoatMap.value=O.clearcoatMap),O.clearcoatRoughnessMap&&(B.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap),O.clearcoatNormalMap&&(B.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),B.clearcoatNormalMap.value=O.clearcoatNormalMap,O.side===ti&&B.clearcoatNormalScale.value.negate()),B.transmission.value=O.transmission,O.transmissionMap&&(B.transmissionMap.value=O.transmissionMap)}function E(B,O){O.matcap&&(B.matcap.value=O.matcap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ti&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ti&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function N(B,O){O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function W(B,O){O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias),B.referencePosition.value.copy(O.referencePosition),B.nearDistance.value=O.nearDistance,B.farDistance.value=O.farDistance}function V(B,O){O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ti&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ti&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function op(r){r=r||{};const i=r.canvas!==void 0?r.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=r.context!==void 0?r.context:null,l=r.alpha!==void 0?r.alpha:!1,u=r.depth!==void 0?r.depth:!0,h=r.stencil!==void 0?r.stencil:!0,p=r.antialias!==void 0?r.antialias:!1,g=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,_=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,b=r.powerPreference!==void 0?r.powerPreference:"default",A=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let S=null,R=null;this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Fc,this.physicallyCorrectLights=!1,this.toneMapping=Jt,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const E=this;let N=!1,W=null,V=0,B=0,O=null,pe=null,ge=-1,ye=null,$=null;const Ie=new Hi,tt=new Hi;let qe=null,ft=i.width,je=i.height,Ne=1,Ue=null,Le=null;const Te=new Hi(0,0,ft,je),Ve=new Hi(0,0,ft,je);let We=!1;const at=new sp;let Tt=!1,nt=!1;const At=new Wn,nn=new _e,Yt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function K(){return O===null?Ne:1}let H=n;function xe(re,$e){for(let Ke=0;Ke<re.length;Ke++){const ht=re[Ke],Bt=i.getContext(ht,$e);if(Bt!==null)return Bt}return null}try{const re={alpha:l,depth:u,stencil:h,antialias:p,premultipliedAlpha:g,preserveDrawingBuffer:_,powerPreference:b,failIfMajorPerformanceCaveat:A};if(i.addEventListener("webglcontextlost",gn,!1),i.addEventListener("webglcontextrestored",gi,!1),H===null){const $e=["webgl2","webgl","experimental-webgl"];if(E.isWebGL1Renderer===!0&&$e.shift(),H=xe($e,re),H===null)throw xe($e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(re){throw console.error("THREE.WebGLRenderer: "+re.message),re}let te,de,be,Re,we,Se,Pe,ze,Ze,Xe,Q,Y,He,Ge,ue,Je,ct,Ft,ut,me,it;function Rt(){te=new PT(H),de=new LT(H,te,r),de.isWebGL2===!1&&(te.get("WEBGL_depth_texture"),te.get("OES_texture_float"),te.get("OES_texture_half_float"),te.get("OES_texture_half_float_linear"),te.get("OES_standard_derivatives"),te.get("OES_element_index_uint"),te.get("OES_vertex_array_object"),te.get("ANGLE_instanced_arrays")),te.get("OES_texture_float_linear"),me=new $E(H,te,de),be=new JE(H,te,de),be.scissor(tt.copy(Ve).multiplyScalar(Ne).floor()),be.viewport(Ie.copy(Te).multiplyScalar(Ne).floor()),Re=new OT(H),we=new UE,Se=new KE(H,te,be,we,de,me,Re),Pe=new CT(E),ze=new nM(H,de),it=new ET(H,te,ze,de),Ze=new IT(H,ze,Re,it),Xe=new UT(H,Ze,ze,Re),ct=new BT(H),ue=new RT(we),Q=new BE(E,Pe,te,de,it,ue),Y=new QE(we),He=new HE(we),Ge=new jE,Je=new TT(E,Pe,be,Xe,g),Ft=new AT(H,te,Re,de),ut=new DT(H,te,Re,de),Re.programs=Q.programs,E.capabilities=de,E.extensions=te,E.properties=we,E.renderLists=He,E.state=be,E.info=Re}Rt();const mt=new U0(E,H);this.xr=mt;const Nt=new B0(E,Xe,de.maxTextureSize);this.shadowMap=Nt,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const re=te.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){const re=te.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return Ne},this.setPixelRatio=function(re){re!==void 0&&(Ne=re,this.setSize(ft,je,!1))},this.getSize=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),re=new bt),re.set(ft,je)},this.setSize=function(re,$e,Ke){if(mt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ft=re,je=$e,i.width=Math.floor(re*Ne),i.height=Math.floor($e*Ne),Ke!==!1&&(i.style.width=re+"px",i.style.height=$e+"px"),this.setViewport(0,0,re,$e)},this.getDrawingBufferSize=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),re=new bt),re.set(ft*Ne,je*Ne).floor()},this.setDrawingBufferSize=function(re,$e,Ke){ft=re,je=$e,Ne=Ke,i.width=Math.floor(re*Ke),i.height=Math.floor($e*Ke),this.setViewport(0,0,re,$e)},this.getCurrentViewport=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),re=new Hi),re.copy(Ie)},this.getViewport=function(re){return re.copy(Te)},this.setViewport=function(re,$e,Ke,ht){re.isVector4?Te.set(re.x,re.y,re.z,re.w):Te.set(re,$e,Ke,ht),be.viewport(Ie.copy(Te).multiplyScalar(Ne).floor())},this.getScissor=function(re){return re.copy(Ve)},this.setScissor=function(re,$e,Ke,ht){re.isVector4?Ve.set(re.x,re.y,re.z,re.w):Ve.set(re,$e,Ke,ht),be.scissor(tt.copy(Ve).multiplyScalar(Ne).floor())},this.getScissorTest=function(){return We},this.setScissorTest=function(re){be.setScissorTest(We=re)},this.setOpaqueSort=function(re){Ue=re},this.setTransparentSort=function(re){Le=re},this.getClearColor=function(){return Je.getClearColor()},this.setClearColor=function(){Je.setClearColor.apply(Je,arguments)},this.getClearAlpha=function(){return Je.getClearAlpha()},this.setClearAlpha=function(){Je.setClearAlpha.apply(Je,arguments)},this.clear=function(re,$e,Ke){let ht=0;(re===void 0||re)&&(ht|=16384),($e===void 0||$e)&&(ht|=256),(Ke===void 0||Ke)&&(ht|=1024),H.clear(ht)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",gn,!1),i.removeEventListener("webglcontextrestored",gi,!1),He.dispose(),Ge.dispose(),we.dispose(),Pe.dispose(),Xe.dispose(),it.dispose(),mt.dispose(),Ci.stop()};function gn(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),N=!0}function gi(){console.log("THREE.WebGLRenderer: Context Restored."),N=!1,Rt()}function Or(re){const $e=re.target;$e.removeEventListener("dispose",Or),er($e)}function er(re){Vr(re),we.remove(re)}function Vr(re){const $e=we.get(re).program;$e!==void 0&&Q.releaseProgram($e)}function Ys(re,$e){re.render(function(Ke){E.renderBufferImmediate(Ke,$e)})}this.renderBufferImmediate=function(re,$e){it.initAttributes();const Ke=we.get(re);re.hasPositions&&!Ke.position&&(Ke.position=H.createBuffer()),re.hasNormals&&!Ke.normal&&(Ke.normal=H.createBuffer()),re.hasUvs&&!Ke.uv&&(Ke.uv=H.createBuffer()),re.hasColors&&!Ke.color&&(Ke.color=H.createBuffer());const ht=$e.getAttributes();re.hasPositions&&(H.bindBuffer(34962,Ke.position),H.bufferData(34962,re.positionArray,35048),it.enableAttribute(ht.position),H.vertexAttribPointer(ht.position,3,5126,!1,0,0)),re.hasNormals&&(H.bindBuffer(34962,Ke.normal),H.bufferData(34962,re.normalArray,35048),it.enableAttribute(ht.normal),H.vertexAttribPointer(ht.normal,3,5126,!1,0,0)),re.hasUvs&&(H.bindBuffer(34962,Ke.uv),H.bufferData(34962,re.uvArray,35048),it.enableAttribute(ht.uv),H.vertexAttribPointer(ht.uv,2,5126,!1,0,0)),re.hasColors&&(H.bindBuffer(34962,Ke.color),H.bufferData(34962,re.colorArray,35048),it.enableAttribute(ht.color),H.vertexAttribPointer(ht.color,3,5126,!1,0,0)),it.disableUnusedAttributes(),H.drawArrays(4,0,re.count),re.count=0},this.renderBufferDirect=function(re,$e,Ke,ht,Bt,Cn){$e===null&&($e=Yt);const In=Bt.isMesh&&Bt.matrixWorld.determinant()<0,Yn=va(re,$e,ht,Bt);be.setMaterial(ht,In);let An=Ke.index;const Yi=Ke.attributes.position;if(An===null){if(Yi===void 0||Yi.count===0)return}else if(An.count===0)return;let Zi=1;ht.wireframe===!0&&(An=Ze.getWireframeAttribute(Ke),Zi=2),(ht.morphTargets||ht.morphNormals)&&ct.update(Bt,Ke,ht,Yn),it.setup(Bt,ht,Yn,Ke,An);let on,oi=Ft;An!==null&&(on=ze.get(An),oi=ut,oi.setIndex(on));const xr=An!==null?An.count:Yi.count,li=Ke.drawRange.start*Zi,tr=Ke.drawRange.count*Zi,cr=Cn!==null?Cn.start*Zi:0,Zs=Cn!==null?Cn.count*Zi:1/0,Lr=Math.max(li,cr),Js=Math.min(xr,li+tr,cr+Zs)-1,br=Math.max(0,Js-Lr+1);if(br!==0){if(Bt.isMesh)ht.wireframe===!0?(be.setLineWidth(ht.wireframeLinewidth*K()),oi.setMode(1)):oi.setMode(4);else if(Bt.isLine){let Ks=ht.linewidth;Ks===void 0&&(Ks=1),be.setLineWidth(Ks*K()),Bt.isLineSegments?oi.setMode(1):Bt.isLineLoop?oi.setMode(2):oi.setMode(3)}else Bt.isPoints?oi.setMode(0):Bt.isSprite&&oi.setMode(4);if(Bt.isInstancedMesh)oi.renderInstances(Lr,br,Bt.count);else if(Ke.isInstancedBufferGeometry){const Ks=Math.min(Ke.instanceCount,Ke._maxInstanceCount);oi.renderInstances(Lr,br,Ks)}else oi.render(Lr,br)}},this.compile=function(re,$e){R=Ge.get(re,$e),R.init(),re.traverse(function(ht){ht.isLight&&(R.pushLight(ht),ht.castShadow&&R.pushShadow(ht))}),R.setupLights($e);const Ke=new WeakMap;re.traverse(function(ht){const Bt=ht.material;if(Bt)if(Array.isArray(Bt))for(let Cn=0;Cn<Bt.length;Cn++){const In=Bt[Cn];Ke.has(In)===!1&&(mr(In,re,ht),Ke.set(In))}else Ke.has(Bt)===!1&&(mr(Bt,re,ht),Ke.set(Bt))})};let ma=null;function ji(re){mt.isPresenting||ma&&ma(re)}const Ci=new m0;Ci.setAnimationLoop(ji),typeof window<"u"&&Ci.setContext(window),this.setAnimationLoop=function(re){ma=re,mt.setAnimationLoop(re),re===null?Ci.stop():Ci.start()},this.render=function(re,$e){let Ke,ht;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ke=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),ht=arguments[3]),$e!==void 0&&$e.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(N===!0)return;it.resetDefaultState(),ge=-1,ye=null,re.autoUpdate===!0&&re.updateMatrixWorld(),$e.parent===null&&$e.updateMatrixWorld(),mt.enabled===!0&&mt.isPresenting===!0&&($e=mt.getCamera($e)),re.isScene===!0&&re.onBeforeRender(E,re,$e,Ke||O),R=Ge.get(re,$e),R.init(),At.multiplyMatrices($e.projectionMatrix,$e.matrixWorldInverse),at.setFromProjectionMatrix(At),nt=this.localClippingEnabled,Tt=ue.init(this.clippingPlanes,nt,$e),S=He.get(re,$e),S.init(),ns(re,$e,0,E.sortObjects),S.finish(),E.sortObjects===!0&&S.sort(Ue,Le),Tt===!0&&ue.beginShadows();const Bt=R.state.shadowsArray;Nt.render(Bt,re,$e),R.setupLights($e),Tt===!0&&ue.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ke!==void 0&&this.setRenderTarget(Ke),Je.render(S,re,$e,ht);const Cn=S.opaque,In=S.transparent;Cn.length>0&&ga(Cn,re,$e),In.length>0&&ga(In,re,$e),re.isScene===!0&&re.onAfterRender(E,re,$e),O!==null&&(Se.updateRenderTargetMipmap(O),Se.updateMultisampleRenderTarget(O)),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1),S=null,R=null};function ns(re,$e,Ke,ht){if(re.visible===!1)return;if(re.layers.test($e.layers)){if(re.isGroup)Ke=re.renderOrder;else if(re.isLOD)re.autoUpdate===!0&&re.update($e);else if(re.isLight)R.pushLight(re),re.castShadow&&R.pushShadow(re);else if(re.isSprite){if(!re.frustumCulled||at.intersectsSprite(re)){ht&&nn.setFromMatrixPosition(re.matrixWorld).applyMatrix4(At);const In=Xe.update(re),Yn=re.material;Yn.visible&&S.push(re,In,Yn,Ke,nn.z,null)}}else if(re.isImmediateRenderObject)ht&&nn.setFromMatrixPosition(re.matrixWorld).applyMatrix4(At),S.push(re,null,re.material,Ke,nn.z,null);else if((re.isMesh||re.isLine||re.isPoints)&&(re.isSkinnedMesh&&re.skeleton.frame!==Re.render.frame&&(re.skeleton.update(),re.skeleton.frame=Re.render.frame),!re.frustumCulled||at.intersectsObject(re))){ht&&nn.setFromMatrixPosition(re.matrixWorld).applyMatrix4(At);const In=Xe.update(re),Yn=re.material;if(Array.isArray(Yn)){const An=In.groups;for(let Yi=0,Zi=An.length;Yi<Zi;Yi++){const on=An[Yi],oi=Yn[on.materialIndex];oi&&oi.visible&&S.push(re,In,oi,Ke,nn.z,on)}}else Yn.visible&&S.push(re,In,Yn,Ke,nn.z,null)}}const Cn=re.children;for(let In=0,Yn=Cn.length;In<Yn;In++)ns(Cn[In],$e,Ke,ht)}function ga(re,$e,Ke){const ht=$e.isScene===!0?$e.overrideMaterial:null;for(let Bt=0,Cn=re.length;Bt<Cn;Bt++){const In=re[Bt],Yn=In.object,An=In.geometry,Yi=ht===null?In.material:ht,Zi=In.group;if(Ke.isArrayCamera){$=Ke;const on=Ke.cameras;for(let oi=0,xr=on.length;oi<xr;oi++){const li=on[oi];Yn.layers.test(li.layers)&&(be.viewport(Ie.copy(li.viewport)),R.setupLights(li),bs(Yn,$e,li,An,Yi,Zi))}}else $=null,bs(Yn,$e,Ke,An,Yi,Zi)}}function bs(re,$e,Ke,ht,Bt,Cn){if(re.onBeforeRender(E,$e,Ke,ht,Bt,Cn),R=Ge.get($e,$||Ke),re.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),re.isImmediateRenderObject){const In=va(Ke,$e,Bt,re);be.setMaterial(Bt),it.reset(),Ys(re,In)}else E.renderBufferDirect(Ke,$e,ht,Bt,re,Cn);re.onAfterRender(E,$e,Ke,ht,Bt,Cn),R=Ge.get($e,$||Ke)}function mr(re,$e,Ke){$e.isScene!==!0&&($e=Yt);const ht=we.get(re),Bt=R.state.lights,Cn=R.state.shadowsArray,In=Bt.state.version,Yn=Q.getParameters(re,Bt.state,Cn,$e,Ke),An=Q.getProgramCacheKey(Yn);let Yi=ht.program,Zi=!0;if(Yi===void 0)re.addEventListener("dispose",Or);else if(Yi.cacheKey!==An)Vr(re);else if(ht.lightsStateVersion!==In)Zi=!1;else if(Yn.shaderID!==void 0){const li=re.isMeshStandardMaterial?$e.environment:null;ht.envMap=Pe.get(re.envMap||li);return}else Zi=!1;Zi&&(Yn.uniforms=Q.getUniforms(re),re.onBeforeCompile(Yn,E),Yi=Q.acquireProgram(Yn,An),ht.program=Yi,ht.uniforms=Yn.uniforms,ht.outputEncoding=Yn.outputEncoding);const on=ht.uniforms;(!re.isShaderMaterial&&!re.isRawShaderMaterial||re.clipping===!0)&&(ht.numClippingPlanes=ue.numPlanes,ht.numIntersection=ue.numIntersection,on.clippingPlanes=ue.uniform),ht.environment=re.isMeshStandardMaterial?$e.environment:null,ht.fog=$e.fog,ht.envMap=Pe.get(re.envMap||ht.environment),ht.needsLights=is(re),ht.lightsStateVersion=In,ht.needsLights&&(on.ambientLightColor.value=Bt.state.ambient,on.lightProbe.value=Bt.state.probe,on.directionalLights.value=Bt.state.directional,on.directionalLightShadows.value=Bt.state.directionalShadow,on.spotLights.value=Bt.state.spot,on.spotLightShadows.value=Bt.state.spotShadow,on.rectAreaLights.value=Bt.state.rectArea,on.ltc_1.value=Bt.state.rectAreaLTC1,on.ltc_2.value=Bt.state.rectAreaLTC2,on.pointLights.value=Bt.state.point,on.pointLightShadows.value=Bt.state.pointShadow,on.hemisphereLights.value=Bt.state.hemi,on.directionalShadowMap.value=Bt.state.directionalShadowMap,on.directionalShadowMatrix.value=Bt.state.directionalShadowMatrix,on.spotShadowMap.value=Bt.state.spotShadowMap,on.spotShadowMatrix.value=Bt.state.spotShadowMatrix,on.pointShadowMap.value=Bt.state.pointShadowMap,on.pointShadowMatrix.value=Bt.state.pointShadowMatrix);const oi=ht.program.getUniforms(),xr=Zl.seqWithValue(oi.seq,on);ht.uniformsList=xr}function va(re,$e,Ke,ht){$e.isScene!==!0&&($e=Yt),Se.resetTextureUnits();const Bt=$e.fog,Cn=Ke.isMeshStandardMaterial?$e.environment:null,In=O===null?E.outputEncoding:O.texture.encoding,Yn=Pe.get(Ke.envMap||Cn),An=we.get(Ke),Yi=R.state.lights;if(Tt===!0&&(nt===!0||re!==ye)){const cr=re===ye&&Ke.id===ge;ue.setState(Ke,re,cr)}Ke.version===An.__version?(Ke.fog&&An.fog!==Bt||An.environment!==Cn||An.needsLights&&An.lightsStateVersion!==Yi.state.version||An.numClippingPlanes!==void 0&&(An.numClippingPlanes!==ue.numPlanes||An.numIntersection!==ue.numIntersection)||An.outputEncoding!==In||An.envMap!==Yn)&&mr(Ke,$e,ht):(mr(Ke,$e,ht),An.__version=Ke.version);let Zi=!1,on=!1,oi=!1;const xr=An.program,li=xr.getUniforms(),tr=An.uniforms;if(be.useProgram(xr.program)&&(Zi=!0,on=!0,oi=!0),Ke.id!==ge&&(ge=Ke.id,on=!0),Zi||ye!==re){if(li.setValue(H,"projectionMatrix",re.projectionMatrix),de.logarithmicDepthBuffer&&li.setValue(H,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),ye!==re&&(ye=re,on=!0,oi=!0),Ke.isShaderMaterial||Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshStandardMaterial||Ke.envMap){const cr=li.map.cameraPosition;cr!==void 0&&cr.setValue(H,nn.setFromMatrixPosition(re.matrixWorld))}(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial)&&li.setValue(H,"isOrthographic",re.isOrthographicCamera===!0),(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial||Ke.isShadowMaterial||Ke.skinning)&&li.setValue(H,"viewMatrix",re.matrixWorldInverse)}if(Ke.skinning){li.setOptional(H,ht,"bindMatrix"),li.setOptional(H,ht,"bindMatrixInverse");const cr=ht.skeleton;if(cr){const Zs=cr.bones;if(de.floatVertexTextures){if(cr.boneTexture===void 0){let Lr=Math.sqrt(Zs.length*4);Lr=zn.ceilPowerOfTwo(Lr),Lr=Math.max(Lr,4);const Js=new Float32Array(Lr*Lr*4);Js.set(cr.boneMatrices);const br=new $u(Js,Lr,Lr,vs,Bs);cr.boneMatrices=Js,cr.boneTexture=br,cr.boneTextureSize=Lr}li.setValue(H,"boneTexture",cr.boneTexture,Se),li.setValue(H,"boneTextureSize",cr.boneTextureSize)}else li.setOptional(H,cr,"boneMatrices")}}return(on||An.receiveShadow!==ht.receiveShadow)&&(An.receiveShadow=ht.receiveShadow,li.setValue(H,"receiveShadow",ht.receiveShadow)),on&&(li.setValue(H,"toneMappingExposure",E.toneMappingExposure),An.needsLights&&Ea(tr,oi),Bt&&Ke.fog&&Y.refreshFogUniforms(tr,Bt),Y.refreshMaterialUniforms(tr,Ke,Ne,je),Zl.upload(H,An.uniformsList,tr,Se)),Ke.isShaderMaterial&&Ke.uniformsNeedUpdate===!0&&(Zl.upload(H,An.uniformsList,tr,Se),Ke.uniformsNeedUpdate=!1),Ke.isSpriteMaterial&&li.setValue(H,"center",ht.center),li.setValue(H,"modelViewMatrix",ht.modelViewMatrix),li.setValue(H,"normalMatrix",ht.normalMatrix),li.setValue(H,"modelMatrix",ht.matrixWorld),xr}function Ea(re,$e){re.ambientLightColor.needsUpdate=$e,re.lightProbe.needsUpdate=$e,re.directionalLights.needsUpdate=$e,re.directionalLightShadows.needsUpdate=$e,re.pointLights.needsUpdate=$e,re.pointLightShadows.needsUpdate=$e,re.spotLights.needsUpdate=$e,re.spotLightShadows.needsUpdate=$e,re.rectAreaLights.needsUpdate=$e,re.hemisphereLights.needsUpdate=$e}function is(re){return re.isMeshLambertMaterial||re.isMeshToonMaterial||re.isMeshPhongMaterial||re.isMeshStandardMaterial||re.isShadowMaterial||re.isShaderMaterial&&re.lights===!0}this.setFramebuffer=function(re){W!==re&&O===null&&H.bindFramebuffer(36160,re),W=re},this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return B},this.getRenderList=function(){return S},this.setRenderList=function(re){S=re},this.getRenderState=function(){return R},this.setRenderState=function(re){R=re},this.getRenderTarget=function(){return O},this.setRenderTarget=function(re,$e=0,Ke=0){O=re,V=$e,B=Ke,re&&we.get(re).__webglFramebuffer===void 0&&Se.setupRenderTarget(re);let ht=W,Bt=!1;if(re){const Cn=we.get(re).__webglFramebuffer;re.isWebGLCubeRenderTarget?(ht=Cn[$e],Bt=!0):re.isWebGLMultisampleRenderTarget?ht=we.get(re).__webglMultisampledFramebuffer:ht=Cn,Ie.copy(re.viewport),tt.copy(re.scissor),qe=re.scissorTest}else Ie.copy(Te).multiplyScalar(Ne).floor(),tt.copy(Ve).multiplyScalar(Ne).floor(),qe=We;if(pe!==ht&&(H.bindFramebuffer(36160,ht),pe=ht),be.viewport(Ie),be.scissor(tt),be.setScissorTest(qe),Bt){const Cn=we.get(re.texture);H.framebufferTexture2D(36160,36064,34069+$e,Cn.__webglTexture,Ke)}},this.readRenderTargetPixels=function(re,$e,Ke,ht,Bt,Cn,In){if(!(re&&re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Yn=we.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&In!==void 0&&(Yn=Yn[In]),Yn){let An=!1;Yn!==pe&&(H.bindFramebuffer(36160,Yn),An=!0);try{const Yi=re.texture,Zi=Yi.format,on=Yi.type;if(Zi!==vs&&me.convert(Zi)!==H.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(on!==Oc&&me.convert(on)!==H.getParameter(35738)&&!(on===Bs&&(de.isWebGL2||te.get("OES_texture_float")||te.get("WEBGL_color_buffer_float")))&&!(on===Nc&&(de.isWebGL2?te.get("EXT_color_buffer_float"):te.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}H.checkFramebufferStatus(36160)===36053?$e>=0&&$e<=re.width-ht&&Ke>=0&&Ke<=re.height-Bt&&H.readPixels($e,Ke,ht,Bt,me.convert(Zi),me.convert(on),Cn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{An&&H.bindFramebuffer(36160,pe)}}},this.copyFramebufferToTexture=function(re,$e,Ke){Ke===void 0&&(Ke=0);const ht=Math.pow(2,-Ke),Bt=Math.floor($e.image.width*ht),Cn=Math.floor($e.image.height*ht),In=me.convert($e.format);Se.setTexture2D($e,0),H.copyTexImage2D(3553,Ke,In,re.x,re.y,Bt,Cn,0),be.unbindTexture()},this.copyTextureToTexture=function(re,$e,Ke,ht){ht===void 0&&(ht=0);const Bt=$e.image.width,Cn=$e.image.height,In=me.convert(Ke.format),Yn=me.convert(Ke.type);Se.setTexture2D(Ke,0),H.pixelStorei(37440,Ke.flipY),H.pixelStorei(37441,Ke.premultiplyAlpha),H.pixelStorei(3317,Ke.unpackAlignment),$e.isDataTexture?H.texSubImage2D(3553,ht,re.x,re.y,Bt,Cn,In,Yn,$e.image.data):$e.isCompressedTexture?H.compressedTexSubImage2D(3553,ht,re.x,re.y,$e.mipmaps[0].width,$e.mipmaps[0].height,In,$e.mipmaps[0].data):H.texSubImage2D(3553,ht,re.x,re.y,In,Yn,$e.image),ht===0&&Ke.generateMipmaps&&H.generateMipmap(3553),be.unbindTexture()},this.initTexture=function(re){Se.setTexture2D(re,0),be.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function G0(r){op.call(this,r)}G0.prototype=Object.assign(Object.create(op.prototype),{constructor:G0,isWebGL1Renderer:!0});class e1 extends yn{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(i,n){return super.copy(i,n),i.background!==null&&(this.background=i.background.clone()),i.environment!==null&&(this.environment=i.environment.clone()),i.fog!==null&&(this.fog=i.fog.clone()),i.overrideMaterial!==null&&(this.overrideMaterial=i.overrideMaterial.clone()),this.autoUpdate=i.autoUpdate,this.matrixAutoUpdate=i.matrixAutoUpdate,this}toJSON(i){const n=super.toJSON(i);return this.background!==null&&(n.object.background=this.background.toJSON(i)),this.environment!==null&&(n.object.environment=this.environment.toJSON(i)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n}}function Qa(r,i){this.array=r,this.stride=i,this.count=r!==void 0?r.length/i:0,this.usage=Wd,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=zn.generateUUID()}Object.defineProperty(Qa.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Qa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.stride,n*=i.stride;for(let l=0,u=this.stride;l<u;l++)this.array[r+l]=i.array[n+l];return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},clone:function(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zn.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),n=new Qa(i,this.stride);return n.setUsage(this.usage),n},onUpload:function(r){return this.onUploadCallback=r,this},toJSON:function(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zn.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Wc=new _e;function Jl(r,i,n,l){this.name="",this.data=r,this.itemSize=i,this.offset=n,this.normalized=l===!0}Object.defineProperties(Jl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(r){this.data.needsUpdate=r}}}),Object.assign(Jl.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(r){for(let i=0,n=this.data.count;i<n;i++)Wc.x=this.getX(i),Wc.y=this.getY(i),Wc.z=this.getZ(i),Wc.applyMatrix4(r),this.setXYZ(i,Wc.x,Wc.y,Wc.z);return this},setX:function(r,i){return this.data.array[r*this.data.stride+this.offset]=i,this},setY:function(r,i){return this.data.array[r*this.data.stride+this.offset+1]=i,this},setZ:function(r,i){return this.data.array[r*this.data.stride+this.offset+2]=i,this},setW:function(r,i){return this.data.array[r*this.data.stride+this.offset+3]=i,this},getX:function(r){return this.data.array[r*this.data.stride+this.offset]},getY:function(r){return this.data.array[r*this.data.stride+this.offset+1]},getZ:function(r){return this.data.array[r*this.data.stride+this.offset+2]},getW:function(r){return this.data.array[r*this.data.stride+this.offset+3]},setXY:function(r,i,n){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this},setXYZ:function(r,i,n,l){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=l,this},setXYZW:function(r,i,n,l,u){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=l,this.data.array[r+3]=u,this},clone:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const l=n*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)i.push(this.data.array[l+u])}return new Fn(new this.array.constructor(i),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new Jl(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const l=n*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)i.push(this.data.array[l+u])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function qc(r){Tn.call(this),this.type="SpriteMaterial",this.color=new Qt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(r)}qc.prototype=Object.create(Tn.prototype),qc.prototype.constructor=qc,qc.prototype.isSpriteMaterial=!0,qc.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this};let th;const Sf=new _e,nh=new _e,ih=new _e,rh=new bt,Tf=new bt,z0=new Wn,lp=new _e,Ef=new _e,cp=new _e,H0=new bt,Ug=new bt,k0=new bt;function V0(r){if(yn.call(this),this.type="Sprite",th===void 0){th=new Ni;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Qa(i,5);th.setIndex([0,1,2,0,2,3]),th.setAttribute("position",new Jl(n,3,0,!1)),th.setAttribute("uv",new Jl(n,2,3,!1))}this.geometry=th,this.material=r!==void 0?r:new qc,this.center=new bt(.5,.5)}V0.prototype=Object.assign(Object.create(yn.prototype),{constructor:V0,isSprite:!0,raycast:function(r,i){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),nh.setFromMatrixScale(this.matrixWorld),z0.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),ih.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&nh.multiplyScalar(-ih.z);const n=this.material.rotation;let l,u;n!==0&&(u=Math.cos(n),l=Math.sin(n));const h=this.center;up(lp.set(-.5,-.5,0),ih,h,nh,l,u),up(Ef.set(.5,-.5,0),ih,h,nh,l,u),up(cp.set(.5,.5,0),ih,h,nh,l,u),H0.set(0,0),Ug.set(1,0),k0.set(1,1);let p=r.ray.intersectTriangle(lp,Ef,cp,!1,Sf);if(p===null&&(up(Ef.set(-.5,.5,0),ih,h,nh,l,u),Ug.set(0,1),p=r.ray.intersectTriangle(lp,cp,Ef,!1,Sf),p===null))return;const g=r.ray.origin.distanceTo(Sf);g<r.near||g>r.far||i.push({distance:g,point:Sf.clone(),uv:ha.getUV(Sf,lp,Ef,cp,H0,Ug,k0,new bt),face:null,object:this})},copy:function(r){return yn.prototype.copy.call(this,r),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}});function up(r,i,n,l,u,h){rh.subVectors(r,n).addScalar(.5).multiply(l),u!==void 0?(Tf.x=h*rh.x-u*rh.y,Tf.y=u*rh.x+h*rh.y):Tf.copy(rh),r.copy(i),r.x+=Tf.x,r.y+=Tf.y,r.applyMatrix4(z0)}const hp=new _e,W0=new _e;function Gg(){yn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Gg.prototype=Object.assign(Object.create(yn.prototype),{constructor:Gg,isLOD:!0,copy:function(r){yn.prototype.copy.call(this,r,!1);const i=r.levels;for(let n=0,l=i.length;n<l;n++){const u=i[n];this.addLevel(u.object.clone(),u.distance)}return this.autoUpdate=r.autoUpdate,this},addLevel:function(r,i){i===void 0&&(i=0),i=Math.abs(i);const n=this.levels;let l;for(l=0;l<n.length&&!(i<n[l].distance);l++);return n.splice(l,0,{distance:i,object:r}),this.add(r),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(r){const i=this.levels;if(i.length>0){let n,l;for(n=1,l=i.length;n<l&&!(r<i[n].distance);n++);return i[n-1].object}return null},raycast:function(r,i){if(this.levels.length>0){hp.setFromMatrixPosition(this.matrixWorld);const l=r.ray.origin.distanceTo(hp);this.getObjectForDistance(l).raycast(r,i)}},update:function(r){const i=this.levels;if(i.length>1){hp.setFromMatrixPosition(r.matrixWorld),W0.setFromMatrixPosition(this.matrixWorld);const n=hp.distanceTo(W0)/r.zoom;i[0].object.visible=!0;let l,u;for(l=1,u=i.length;l<u&&n>=i[l].distance;l++)i[l-1].object.visible=!1,i[l].object.visible=!0;for(this._currentLevel=l-1;l<u;l++)i[l].object.visible=!1}},toJSON:function(r){const i=yn.prototype.toJSON.call(this,r);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let l=0,u=n.length;l<u;l++){const h=n[l];i.object.levels.push({object:h.object.uuid,distance:h.distance})}return i}});function fp(r,i){r&&r.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ra.call(this,r,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Wn,this.bindMatrixInverse=new Wn}fp.prototype=Object.assign(Object.create(ra.prototype),{constructor:fp,isSkinnedMesh:!0,copy:function(r){return ra.prototype.copy.call(this,r),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,this},bind:function(r,i){this.skeleton=r,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.getInverse(i)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const r=new Hi,i=this.geometry.attributes.skinWeight;for(let n=0,l=i.count;n<l;n++){r.x=i.getX(n),r.y=i.getY(n),r.z=i.getZ(n),r.w=i.getW(n);const u=1/r.manhattanLength();u!==1/0?r.multiplyScalar(u):r.set(1,0,0,0),i.setXYZW(n,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(r){ra.prototype.updateMatrixWorld.call(this,r),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const r=new _e,i=new Hi,n=new Hi,l=new _e,u=new Wn;return function(h,p){const g=this.skeleton,_=this.geometry;i.fromBufferAttribute(_.attributes.skinIndex,h),n.fromBufferAttribute(_.attributes.skinWeight,h),r.fromBufferAttribute(_.attributes.position,h).applyMatrix4(this.bindMatrix),p.set(0,0,0);for(let b=0;b<4;b++){const A=n.getComponent(b);if(A!==0){const S=i.getComponent(b);u.multiplyMatrices(g.bones[S].matrixWorld,g.boneInverses[S]),p.addScaledVector(l.copy(r).applyMatrix4(u),A)}}return p.applyMatrix4(this.bindMatrixInverse)}}()});const q0=new Wn,t1=new Wn;function dp(r,i){if(r=r||[],this.bones=r.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,i===void 0)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let n=0,l=this.bones.length;n<l;n++)this.boneInverses.push(new Wn)}}Object.assign(dp.prototype,{calculateInverses:function(){this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++){const n=new Wn;this.bones[r]&&n.getInverse(this.bones[r].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&n.matrixWorld.getInverse(this.boneInverses[r])}for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&(n.parent&&n.parent.isBone?(n.matrix.getInverse(n.parent.matrixWorld),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}},update:function(){const r=this.bones,i=this.boneInverses,n=this.boneMatrices,l=this.boneTexture;for(let u=0,h=r.length;u<h;u++){const p=r[u]?r[u].matrixWorld:t1;q0.multiplyMatrices(p,i[u]),q0.toArray(n,u*16)}l!==void 0&&(l.needsUpdate=!0)},clone:function(){return new dp(this.bones,this.boneInverses)},getBoneByName:function(r){for(let i=0,n=this.bones.length;i<n;i++){const l=this.bones[i];if(l.name===r)return l}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function zg(){yn.call(this),this.type="Bone"}zg.prototype=Object.assign(Object.create(yn.prototype),{constructor:zg,isBone:!0});const X0=new Wn,j0=new Wn,pp=[],Af=new ra;function Y0(r,i,n){ra.call(this,r,i),this.instanceMatrix=new Fn(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}Y0.prototype=Object.assign(Object.create(ra.prototype),{constructor:Y0,isInstancedMesh:!0,copy:function(r){return ra.prototype.copy.call(this,r),this.instanceMatrix.copy(r.instanceMatrix),this.count=r.count,this},setColorAt:function(r,i){this.instanceColor===null&&(this.instanceColor=new Fn(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,r*3)},getMatrixAt:function(r,i){i.fromArray(this.instanceMatrix.array,r*16)},raycast:function(r,i){const n=this.matrixWorld,l=this.count;if(Af.geometry=this.geometry,Af.material=this.material,Af.material!==void 0)for(let u=0;u<l;u++){this.getMatrixAt(u,X0),j0.multiplyMatrices(n,X0),Af.matrixWorld=j0,Af.raycast(r,pp);for(let h=0,p=pp.length;h<p;h++){const g=pp[h];g.instanceId=u,g.object=this,i.push(g)}pp.length=0}},setMatrixAt:function(r,i){i.toArray(this.instanceMatrix.array,r*16)},updateMorphTargets:function(){}});function es(r){Tn.call(this),this.type="LineBasicMaterial",this.color=new Qt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(r)}es.prototype=Object.create(Tn.prototype),es.prototype.constructor=es,es.prototype.isLineBasicMaterial=!0,es.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.morphTargets=r.morphTargets,this};const Z0=new _e,J0=new _e,K0=new Wn,mp=new hf,gp=new nl;function Xc(r,i,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),yn.call(this),this.type="Line",this.geometry=r!==void 0?r:new Ni,this.material=i!==void 0?i:new es,this.updateMorphTargets()}Xc.prototype=Object.assign(Object.create(yn.prototype),{constructor:Xc,isLine:!0,copy:function(r){return yn.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[0];for(let l=1,u=i.count;l<u;l++)Z0.fromBufferAttribute(i,l-1),J0.fromBufferAttribute(i,l),n[l]=n[l-1],n[l]+=Z0.distanceTo(J0);r.setAttribute("lineDistance",new wi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;n[0]=0;for(let l=1,u=i.length;l<u;l++)n[l]=n[l-1],n[l]+=i[l-1].distanceTo(i[l])}return this},raycast:function(r,i){const n=this.geometry,l=this.matrixWorld,u=r.params.Line.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),gp.copy(n.boundingSphere),gp.applyMatrix4(l),gp.radius+=u,r.ray.intersectsSphere(gp)===!1)return;K0.getInverse(l),mp.copy(r.ray).applyMatrix4(K0);const h=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,g=new _e,_=new _e,b=new _e,A=new _e,S=this.isLineSegments?2:1;if(n.isBufferGeometry){const R=n.index,N=n.attributes.position;if(R!==null){const W=R.array;for(let V=0,B=W.length-1;V<B;V+=S){const O=W[V],pe=W[V+1];if(g.fromBufferAttribute(N,O),_.fromBufferAttribute(N,pe),mp.distanceSqToSegment(g,_,A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const ye=r.ray.origin.distanceTo(A);ye<r.near||ye>r.far||i.push({distance:ye,point:b.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}else for(let W=0,V=N.count-1;W<V;W+=S){if(g.fromBufferAttribute(N,W),_.fromBufferAttribute(N,W+1),mp.distanceSqToSegment(g,_,A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const O=r.ray.origin.distanceTo(A);O<r.near||O>r.far||i.push({distance:O,point:b.clone().applyMatrix4(this.matrixWorld),index:W,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const R=n.vertices,E=R.length;for(let N=0;N<E-1;N+=S){if(mp.distanceSqToSegment(R[N],R[N+1],A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const V=r.ray.origin.distanceTo(A);V<r.near||V>r.far||i.push({distance:V,point:b.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const vp=new _e,yp=new _e;function Lf(r,i){Xc.call(this,r,i),this.type="LineSegments"}Lf.prototype=Object.assign(Object.create(Xc.prototype),{constructor:Lf,isLineSegments:!0,computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[];for(let l=0,u=i.count;l<u;l+=2)vp.fromBufferAttribute(i,l),yp.fromBufferAttribute(i,l+1),n[l]=l===0?0:n[l-1],n[l+1]=n[l]+vp.distanceTo(yp);r.setAttribute("lineDistance",new wi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;for(let l=0,u=i.length;l<u;l+=2)vp.copy(i[l]),yp.copy(i[l+1]),n[l]=l===0?0:n[l-1],n[l+1]=n[l]+vp.distanceTo(yp)}return this}});function Hg(r,i){Xc.call(this,r,i),this.type="LineLoop"}Hg.prototype=Object.assign(Object.create(Xc.prototype),{constructor:Hg,isLineLoop:!0});function Kl(r){Tn.call(this),this.type="PointsMaterial",this.color=new Qt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(r)}Kl.prototype=Object.create(Tn.prototype),Kl.prototype.constructor=Kl,Kl.prototype.isPointsMaterial=!0,Kl.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.morphTargets=r.morphTargets,this};const $0=new Wn,kg=new hf,_p=new nl,xp=new _e;function Vg(r,i){yn.call(this),this.type="Points",this.geometry=r!==void 0?r:new Ni,this.material=i!==void 0?i:new Kl,this.updateMorphTargets()}Vg.prototype=Object.assign(Object.create(yn.prototype),{constructor:Vg,isPoints:!0,copy:function(r){return yn.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},raycast:function(r,i){const n=this.geometry,l=this.matrixWorld,u=r.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),_p.copy(n.boundingSphere),_p.applyMatrix4(l),_p.radius+=u,r.ray.intersectsSphere(_p)===!1)return;$0.getInverse(l),kg.copy(r.ray).applyMatrix4($0);const h=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h;if(n.isBufferGeometry){const g=n.index,b=n.attributes.position;if(g!==null){const A=g.array;for(let S=0,R=A.length;S<R;S++){const E=A[S];xp.fromBufferAttribute(b,E),Wg(xp,E,p,l,r,i,this)}}else for(let A=0,S=b.count;A<S;A++)xp.fromBufferAttribute(b,A),Wg(xp,A,p,l,r,i,this)}else{const g=n.vertices;for(let _=0,b=g.length;_<b;_++)Wg(g[_],_,p,l,r,i,this)}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Wg(r,i,n,l,u,h,p){const g=kg.distanceSqToPoint(r);if(g<n){const _=new _e;kg.closestPointToPoint(r,_),_.applyMatrix4(l);const b=u.ray.origin.distanceTo(_);if(b<u.near||b>u.far)return;h.push({distance:b,distanceToRay:Math.sqrt(g),point:_,index:i,face:null,object:p})}}function Q0(r,i,n,l,u,h,p,g,_){qi.call(this,r,i,n,l,u,h,p,g,_),this.format=p!==void 0?p:Mo,this.minFilter=h!==void 0?h:Rn,this.magFilter=u!==void 0?u:Rn,this.generateMipmaps=!1;const b=this;function A(){b.needsUpdate=!0,r.requestVideoFrameCallback(A)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(A)}Q0.prototype=Object.assign(Object.create(qi.prototype),{constructor:Q0,isVideoTexture:!0,update:function(){const r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Rf(r,i,n,l,u,h,p,g,_,b,A,S){qi.call(this,null,h,p,g,_,b,l,u,A,S),this.image={width:i,height:n},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}Rf.prototype=Object.create(qi.prototype),Rf.prototype.constructor=Rf,Rf.prototype.isCompressedTexture=!0;function Cf(r,i,n,l,u,h,p,g,_){qi.call(this,r,i,n,l,u,h,p,g,_),this.needsUpdate=!0}Cf.prototype=Object.create(qi.prototype),Cf.prototype.constructor=Cf,Cf.prototype.isCanvasTexture=!0;function bp(r,i,n,l,u,h,p,g,_,b){if(b=b!==void 0?b:Iu,b!==Iu&&b!==sf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&b===Iu&&(n=zd),n===void 0&&b===sf&&(n=af),qi.call(this,null,l,u,h,p,g,b,n,_),this.image={width:r,height:i},this.magFilter=p!==void 0?p:Et,this.minFilter=g!==void 0?g:Et,this.flipY=!1,this.generateMipmaps=!1}bp.prototype=Object.create(qi.prototype),bp.prototype.constructor=bp,bp.prototype.isDepthTexture=!0;let n1=0;const Eo=new Wn,qg=new yn,wp=new _e;function Vs(){Object.defineProperty(this,"id",{value:n1+=2}),this.uuid=zn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Vs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Vs,isGeometry:!0,applyMatrix4:function(r){const i=new Ba().getNormalMatrix(r);for(let n=0,l=this.vertices.length;n<l;n++)this.vertices[n].applyMatrix4(r);for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n];u.normal.applyMatrix3(i).normalize();for(let h=0,p=u.vertexNormals.length;h<p;h++)u.vertexNormals[h].applyMatrix3(i).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(r){return Eo.makeRotationX(r),this.applyMatrix4(Eo),this},rotateY:function(r){return Eo.makeRotationY(r),this.applyMatrix4(Eo),this},rotateZ:function(r){return Eo.makeRotationZ(r),this.applyMatrix4(Eo),this},translate:function(r,i,n){return Eo.makeTranslation(r,i,n),this.applyMatrix4(Eo),this},scale:function(r,i,n){return Eo.makeScale(r,i,n),this.applyMatrix4(Eo),this},lookAt:function(r){return qg.lookAt(r),qg.updateMatrix(),this.applyMatrix4(qg.matrix),this},fromBufferGeometry:function(r){const i=this,n=r.index!==null?r.index:void 0,l=r.attributes;if(l.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const u=l.position,h=l.normal,p=l.color,g=l.uv,_=l.uv2;_!==void 0&&(this.faceVertexUvs[1]=[]);for(let S=0;S<u.count;S++)i.vertices.push(new _e().fromBufferAttribute(u,S)),p!==void 0&&i.colors.push(new Qt().fromBufferAttribute(p,S));function b(S,R,E,N){const W=p===void 0?[]:[i.colors[S].clone(),i.colors[R].clone(),i.colors[E].clone()],V=h===void 0?[]:[new _e().fromBufferAttribute(h,S),new _e().fromBufferAttribute(h,R),new _e().fromBufferAttribute(h,E)],B=new Mg(S,R,E,V,W,N);i.faces.push(B),g!==void 0&&i.faceVertexUvs[0].push([new bt().fromBufferAttribute(g,S),new bt().fromBufferAttribute(g,R),new bt().fromBufferAttribute(g,E)]),_!==void 0&&i.faceVertexUvs[1].push([new bt().fromBufferAttribute(_,S),new bt().fromBufferAttribute(_,R),new bt().fromBufferAttribute(_,E)])}const A=r.groups;if(A.length>0)for(let S=0;S<A.length;S++){const R=A[S],E=R.start,N=R.count;for(let W=E,V=E+N;W<V;W+=3)n!==void 0?b(n.getX(W),n.getX(W+1),n.getX(W+2),R.materialIndex):b(W,W+1,W+2,R.materialIndex)}else if(n!==void 0)for(let S=0;S<n.count;S+=3)b(n.getX(S),n.getX(S+1),n.getX(S+2));else for(let S=0;S<u.count;S+=3)b(S,S+1,S+2);return this.computeFaceNormals(),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(wp).negate(),this.translate(wp.x,wp.y,wp.z),this},normalize:function(){this.computeBoundingSphere();const r=this.boundingSphere.center,i=this.boundingSphere.radius,n=i===0?1:1/i,l=new Wn;return l.set(n,0,0,-n*r.x,0,n,0,-n*r.y,0,0,n,-n*r.z,0,0,0,1),this.applyMatrix4(l),this},computeFaceNormals:function(){const r=new _e,i=new _e;for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n],h=this.vertices[u.a],p=this.vertices[u.b],g=this.vertices[u.c];r.subVectors(g,p),i.subVectors(h,p),r.cross(i),r.normalize(),u.normal.copy(r)}},computeVertexNormals:function(r){r===void 0&&(r=!0);const i=new Array(this.vertices.length);for(let n=0,l=this.vertices.length;n<l;n++)i[n]=new _e;if(r){const n=new _e,l=new _e;for(let u=0,h=this.faces.length;u<h;u++){const p=this.faces[u],g=this.vertices[p.a],_=this.vertices[p.b],b=this.vertices[p.c];n.subVectors(b,_),l.subVectors(g,_),n.cross(l),i[p.a].add(n),i[p.b].add(n),i[p.c].add(n)}}else{this.computeFaceNormals();for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n];i[u.a].add(u.normal),i[u.b].add(u.normal),i[u.c].add(u.normal)}}for(let n=0,l=this.vertices.length;n<l;n++)i[n].normalize();for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n],h=u.vertexNormals;h.length===3?(h[0].copy(i[u.a]),h[1].copy(i[u.b]),h[2].copy(i[u.c])):(h[0]=i[u.a].clone(),h[1]=i[u.b].clone(),h[2]=i[u.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){const n=this.faces[r],l=n.vertexNormals;l.length===3?(l[0].copy(n.normal),l[1].copy(n.normal),l[2].copy(n.normal)):(l[0]=n.normal.clone(),l[1]=n.normal.clone(),l[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let i=0,n=this.faces.length;i<n;i++){const l=this.faces[i];l.__originalFaceNormal?l.__originalFaceNormal.copy(l.normal):l.__originalFaceNormal=l.normal.clone(),l.__originalVertexNormals||(l.__originalVertexNormals=[]);for(let u=0,h=l.vertexNormals.length;u<h;u++)l.__originalVertexNormals[u]?l.__originalVertexNormals[u].copy(l.vertexNormals[u]):l.__originalVertexNormals[u]=l.vertexNormals[u].clone()}const r=new Vs;r.faces=this.faces;for(let i=0,n=this.morphTargets.length;i<n;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[];const u=this.morphNormals[i].faceNormals,h=this.morphNormals[i].vertexNormals;for(let p=0,g=this.faces.length;p<g;p++){const _=new _e,b={a:new _e,b:new _e,c:new _e};u.push(_),h.push(b)}}const l=this.morphNormals[i];r.vertices=this.morphTargets[i].vertices,r.computeFaceNormals(),r.computeVertexNormals();for(let u=0,h=this.faces.length;u<h;u++){const p=this.faces[u],g=l.faceNormals[u],_=l.vertexNormals[u];g.copy(p.normal),_.a.copy(p.vertexNormals[0]),_.b.copy(p.vertexNormals[1]),_.c.copy(p.vertexNormals[2])}}for(let i=0,n=this.faces.length;i<n;i++){const l=this.faces[i];l.normal=l.__originalFaceNormal,l.vertexNormals=l.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new el),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new nl),this.boundingSphere.setFromPoints(this.vertices)},merge:function(r,i,n){if(!(r&&r.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",r);return}let l;const u=this.vertices.length,h=this.vertices,p=r.vertices,g=this.faces,_=r.faces,b=this.colors,A=r.colors;n===void 0&&(n=0),i!==void 0&&(l=new Ba().getNormalMatrix(i));for(let S=0,R=p.length;S<R;S++){const N=p[S].clone();i!==void 0&&N.applyMatrix4(i),h.push(N)}for(let S=0,R=A.length;S<R;S++)b.push(A[S].clone());for(let S=0,R=_.length;S<R;S++){const E=_[S];let N,W;const V=E.vertexNormals,B=E.vertexColors,O=new Mg(E.a+u,E.b+u,E.c+u);O.normal.copy(E.normal),l!==void 0&&O.normal.applyMatrix3(l).normalize();for(let pe=0,ge=V.length;pe<ge;pe++)N=V[pe].clone(),l!==void 0&&N.applyMatrix3(l).normalize(),O.vertexNormals.push(N);O.color.copy(E.color);for(let pe=0,ge=B.length;pe<ge;pe++)W=B[pe],O.vertexColors.push(W.clone());O.materialIndex=E.materialIndex+n,g.push(O)}for(let S=0,R=r.faceVertexUvs.length;S<R;S++){const E=r.faceVertexUvs[S];this.faceVertexUvs[S]===void 0&&(this.faceVertexUvs[S]=[]);for(let N=0,W=E.length;N<W;N++){const V=E[N],B=[];for(let O=0,pe=V.length;O<pe;O++)B.push(V[O].clone());this.faceVertexUvs[S].push(B)}}},mergeMesh:function(r){if(!(r&&r.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",r);return}r.matrixAutoUpdate&&r.updateMatrix(),this.merge(r.geometry,r.matrix)},mergeVertices:function(){const r={},i=[],n=[],u=Math.pow(10,4);for(let g=0,_=this.vertices.length;g<_;g++){const b=this.vertices[g],A=Math.round(b.x*u)+"_"+Math.round(b.y*u)+"_"+Math.round(b.z*u);r[A]===void 0?(r[A]=g,i.push(this.vertices[g]),n[g]=i.length-1):n[g]=n[r[A]]}const h=[];for(let g=0,_=this.faces.length;g<_;g++){const b=this.faces[g];b.a=n[b.a],b.b=n[b.b],b.c=n[b.c];const A=[b.a,b.b,b.c];for(let S=0;S<3;S++)if(A[S]===A[(S+1)%3]){h.push(g);break}}for(let g=h.length-1;g>=0;g--){const _=h[g];this.faces.splice(_,1);for(let b=0,A=this.faceVertexUvs.length;b<A;b++)this.faceVertexUvs[b].splice(_,1)}const p=this.vertices.length-i.length;return this.vertices=i,p},setFromPoints:function(r){this.vertices=[];for(let i=0,n=r.length;i<n;i++){const l=r[i];this.vertices.push(new _e(l.x,l.y,l.z||0))}return this},sortFacesByMaterialIndex:function(){const r=this.faces,i=r.length;for(let g=0;g<i;g++)r[g]._id=g;function n(g,_){return g.materialIndex-_.materialIndex}r.sort(n);const l=this.faceVertexUvs[0],u=this.faceVertexUvs[1];let h,p;l&&l.length===i&&(h=[]),u&&u.length===i&&(p=[]);for(let g=0;g<i;g++){const _=r[g]._id;h&&h.push(l[_]),p&&p.push(u[_])}h&&(this.faceVertexUvs[0]=h),p&&(this.faceVertexUvs[1]=p)},toJSON:function(){const r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){const E=this.parameters;for(const N in E)E[N]!==void 0&&(r[N]=E[N]);return r}const i=[];for(let E=0;E<this.vertices.length;E++){const N=this.vertices[E];i.push(N.x,N.y,N.z)}const n=[],l=[],u={},h=[],p={},g=[],_={};for(let E=0;E<this.faces.length;E++){const N=this.faces[E],W=!0,V=!1,B=this.faceVertexUvs[0][E]!==void 0,O=N.normal.length()>0,pe=N.vertexNormals.length>0,ge=N.color.r!==1||N.color.g!==1||N.color.b!==1,ye=N.vertexColors.length>0;let $=0;if($=b($,0,0),$=b($,1,W),$=b($,2,V),$=b($,3,B),$=b($,4,O),$=b($,5,pe),$=b($,6,ge),$=b($,7,ye),n.push($),n.push(N.a,N.b,N.c),n.push(N.materialIndex),B){const Ie=this.faceVertexUvs[0][E];n.push(R(Ie[0]),R(Ie[1]),R(Ie[2]))}if(O&&n.push(A(N.normal)),pe){const Ie=N.vertexNormals;n.push(A(Ie[0]),A(Ie[1]),A(Ie[2]))}if(ge&&n.push(S(N.color)),ye){const Ie=N.vertexColors;n.push(S(Ie[0]),S(Ie[1]),S(Ie[2]))}}function b(E,N,W){return W?E|1<<N:E&~(1<<N)}function A(E){const N=E.x.toString()+E.y.toString()+E.z.toString();return u[N]!==void 0||(u[N]=l.length/3,l.push(E.x,E.y,E.z)),u[N]}function S(E){const N=E.r.toString()+E.g.toString()+E.b.toString();return p[N]!==void 0||(p[N]=h.length,h.push(E.getHex())),p[N]}function R(E){const N=E.x.toString()+E.y.toString();return _[N]!==void 0||(_[N]=g.length/2,g.push(E.x,E.y)),_[N]}return r.data={},r.data.vertices=i,r.data.normals=l,h.length>0&&(r.data.colors=h),g.length>0&&(r.data.uvs=[g]),r.data.faces=n,r},clone:function(){return new Vs().copy(this)},copy:function(r){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;const i=r.vertices;for(let S=0,R=i.length;S<R;S++)this.vertices.push(i[S].clone());const n=r.colors;for(let S=0,R=n.length;S<R;S++)this.colors.push(n[S].clone());const l=r.faces;for(let S=0,R=l.length;S<R;S++)this.faces.push(l[S].clone());for(let S=0,R=r.faceVertexUvs.length;S<R;S++){const E=r.faceVertexUvs[S];this.faceVertexUvs[S]===void 0&&(this.faceVertexUvs[S]=[]);for(let N=0,W=E.length;N<W;N++){const V=E[N],B=[];for(let O=0,pe=V.length;O<pe;O++){const ge=V[O];B.push(ge.clone())}this.faceVertexUvs[S].push(B)}}const u=r.morphTargets;for(let S=0,R=u.length;S<R;S++){const E={};if(E.name=u[S].name,u[S].vertices!==void 0){E.vertices=[];for(let N=0,W=u[S].vertices.length;N<W;N++)E.vertices.push(u[S].vertices[N].clone())}if(u[S].normals!==void 0){E.normals=[];for(let N=0,W=u[S].normals.length;N<W;N++)E.normals.push(u[S].normals[N].clone())}this.morphTargets.push(E)}const h=r.morphNormals;for(let S=0,R=h.length;S<R;S++){const E={};if(h[S].vertexNormals!==void 0){E.vertexNormals=[];for(let N=0,W=h[S].vertexNormals.length;N<W;N++){const V=h[S].vertexNormals[N],B={};B.a=V.a.clone(),B.b=V.b.clone(),B.c=V.c.clone(),E.vertexNormals.push(B)}}if(h[S].faceNormals!==void 0){E.faceNormals=[];for(let N=0,W=h[S].faceNormals.length;N<W;N++)E.faceNormals.push(h[S].faceNormals[N].clone())}this.morphNormals.push(E)}const p=r.skinWeights;for(let S=0,R=p.length;S<R;S++)this.skinWeights.push(p[S].clone());const g=r.skinIndices;for(let S=0,R=g.length;S<R;S++)this.skinIndices.push(g[S].clone());const _=r.lineDistances;for(let S=0,R=_.length;S<R;S++)this.lineDistances.push(_[S]);const b=r.boundingBox;b!==null&&(this.boundingBox=b.clone());const A=r.boundingSphere;return A!==null&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=r.elementsNeedUpdate,this.verticesNeedUpdate=r.verticesNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.lineDistancesNeedUpdate=r.lineDistancesNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),new _e,new _e,new _e,new ha;const i1={triangulate:function(r,i,n){n=n||2;const l=i&&i.length,u=l?i[0]*n:r.length;let h=e_(r,0,u,n,!0);const p=[];if(!h||h.next===h.prev)return p;let g,_,b,A,S,R,E;if(l&&(h=l1(r,i,h,n)),r.length>80*n){g=b=r[0],_=A=r[1];for(let N=n;N<u;N+=n)S=r[N],R=r[N+1],S<g&&(g=S),R<_&&(_=R),S>b&&(b=S),R>A&&(A=R);E=Math.max(b-g,A-_),E=E!==0?1/E:0}return Pf(h,p,n,g,_,E),p}};function e_(r,i,n,l,u){let h,p;if(u===_1(r,i,n,l)>0)for(h=i;h<n;h+=l)p=i_(h,r[h],r[h+1],p);else for(h=n-l;h>=i;h-=l)p=i_(h,r[h],r[h+1],p);return p&&Mp(p,p.next)&&(Df(p),p=p.next),p}function $l(r,i){if(!r)return r;i||(i=r);let n=r,l;do if(l=!1,!n.steiner&&(Mp(n,n.next)||pr(n.prev,n,n.next)===0)){if(Df(n),n=i=n.prev,n===n.next)break;l=!0}else n=n.next;while(l||n!==i);return i}function Pf(r,i,n,l,u,h,p){if(!r)return;!p&&h&&d1(r,l,u,h);let g=r,_,b;for(;r.prev!==r.next;){if(_=r.prev,b=r.next,h?a1(r,l,u,h):r1(r)){i.push(_.i/n),i.push(r.i/n),i.push(b.i/n),Df(r),r=b.next,g=b.next;continue}if(r=b,r===g){p?p===1?(r=s1($l(r),i,n),Pf(r,i,n,l,u,h,2)):p===2&&o1(r,i,n,l,u,h):Pf($l(r),i,n,l,u,h,1);break}}}function r1(r){const i=r.prev,n=r,l=r.next;if(pr(i,n,l)>=0)return!1;let u=r.next.next;for(;u!==r.prev;){if(ah(i.x,i.y,n.x,n.y,l.x,l.y,u.x,u.y)&&pr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function a1(r,i,n,l){const u=r.prev,h=r,p=r.next;if(pr(u,h,p)>=0)return!1;const g=u.x<h.x?u.x<p.x?u.x:p.x:h.x<p.x?h.x:p.x,_=u.y<h.y?u.y<p.y?u.y:p.y:h.y<p.y?h.y:p.y,b=u.x>h.x?u.x>p.x?u.x:p.x:h.x>p.x?h.x:p.x,A=u.y>h.y?u.y>p.y?u.y:p.y:h.y>p.y?h.y:p.y,S=Xg(g,_,i,n,l),R=Xg(b,A,i,n,l);let E=r.prevZ,N=r.nextZ;for(;E&&E.z>=S&&N&&N.z<=R;){if(E!==r.prev&&E!==r.next&&ah(u.x,u.y,h.x,h.y,p.x,p.y,E.x,E.y)&&pr(E.prev,E,E.next)>=0||(E=E.prevZ,N!==r.prev&&N!==r.next&&ah(u.x,u.y,h.x,h.y,p.x,p.y,N.x,N.y)&&pr(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;E&&E.z>=S;){if(E!==r.prev&&E!==r.next&&ah(u.x,u.y,h.x,h.y,p.x,p.y,E.x,E.y)&&pr(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;N&&N.z<=R;){if(N!==r.prev&&N!==r.next&&ah(u.x,u.y,h.x,h.y,p.x,p.y,N.x,N.y)&&pr(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function s1(r,i,n){let l=r;do{const u=l.prev,h=l.next.next;!Mp(u,h)&&t_(u,l,l.next,h)&&If(u,h)&&If(h,u)&&(i.push(u.i/n),i.push(l.i/n),i.push(h.i/n),Df(l),Df(l.next),l=r=h),l=l.next}while(l!==r);return $l(l)}function o1(r,i,n,l,u,h){let p=r;do{let g=p.next.next;for(;g!==p.prev;){if(p.i!==g.i&&g1(p,g)){let _=n_(p,g);p=$l(p,p.next),_=$l(_,_.next),Pf(p,i,n,l,u,h),Pf(_,i,n,l,u,h);return}g=g.next}p=p.next}while(p!==r)}function l1(r,i,n,l){const u=[];let h,p,g,_,b;for(h=0,p=i.length;h<p;h++)g=i[h]*l,_=h<p-1?i[h+1]*l:r.length,b=e_(r,g,_,l,!1),b===b.next&&(b.steiner=!0),u.push(m1(b));for(u.sort(c1),h=0;h<u.length;h++)u1(u[h],n),n=$l(n,n.next);return n}function c1(r,i){return r.x-i.x}function u1(r,i){if(i=h1(r,i),i){const n=n_(i,r);$l(i,i.next),$l(n,n.next)}}function h1(r,i){let n=i;const l=r.x,u=r.y;let h=-1/0,p;do{if(u<=n.y&&u>=n.next.y&&n.next.y!==n.y){const R=n.x+(u-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(R<=l&&R>h){if(h=R,R===l){if(u===n.y)return n;if(u===n.next.y)return n.next}p=n.x<n.next.x?n:n.next}}n=n.next}while(n!==i);if(!p)return null;if(l===h)return p;const g=p,_=p.x,b=p.y;let A=1/0,S;n=p;do l>=n.x&&n.x>=_&&l!==n.x&&ah(u<b?l:h,u,_,b,u<b?h:l,u,n.x,n.y)&&(S=Math.abs(u-n.y)/(l-n.x),If(n,r)&&(S<A||S===A&&(n.x>p.x||n.x===p.x&&f1(p,n)))&&(p=n,A=S)),n=n.next;while(n!==g);return p}function f1(r,i){return pr(r.prev,r,i.prev)<0&&pr(i.next,r,r.next)<0}function d1(r,i,n,l){let u=r;do u.z===null&&(u.z=Xg(u.x,u.y,i,n,l)),u.prevZ=u.prev,u.nextZ=u.next,u=u.next;while(u!==r);u.prevZ.nextZ=null,u.prevZ=null,p1(u)}function p1(r){let i,n,l,u,h,p,g,_,b=1;do{for(n=r,r=null,h=null,p=0;n;){for(p++,l=n,g=0,i=0;i<b&&(g++,l=l.nextZ,!!l);i++);for(_=b;g>0||_>0&&l;)g!==0&&(_===0||!l||n.z<=l.z)?(u=n,n=n.nextZ,g--):(u=l,l=l.nextZ,_--),h?h.nextZ=u:r=u,u.prevZ=h,h=u;n=l}h.nextZ=null,b*=2}while(p>1);return r}function Xg(r,i,n,l,u){return r=32767*(r-n)*u,i=32767*(i-l)*u,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,r|i<<1}function m1(r){let i=r,n=r;do(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),i=i.next;while(i!==r);return n}function ah(r,i,n,l,u,h,p,g){return(u-p)*(i-g)-(r-p)*(h-g)>=0&&(r-p)*(l-g)-(n-p)*(i-g)>=0&&(n-p)*(h-g)-(u-p)*(l-g)>=0}function g1(r,i){return r.next.i!==i.i&&r.prev.i!==i.i&&!v1(r,i)&&(If(r,i)&&If(i,r)&&y1(r,i)&&(pr(r.prev,r,i.prev)||pr(r,i.prev,i))||Mp(r,i)&&pr(r.prev,r,r.next)>0&&pr(i.prev,i,i.next)>0)}function pr(r,i,n){return(i.y-r.y)*(n.x-i.x)-(i.x-r.x)*(n.y-i.y)}function Mp(r,i){return r.x===i.x&&r.y===i.y}function t_(r,i,n,l){const u=Tp(pr(r,i,n)),h=Tp(pr(r,i,l)),p=Tp(pr(n,l,r)),g=Tp(pr(n,l,i));return!!(u!==h&&p!==g||u===0&&Sp(r,n,i)||h===0&&Sp(r,l,i)||p===0&&Sp(n,r,l)||g===0&&Sp(n,i,l))}function Sp(r,i,n){return i.x<=Math.max(r.x,n.x)&&i.x>=Math.min(r.x,n.x)&&i.y<=Math.max(r.y,n.y)&&i.y>=Math.min(r.y,n.y)}function Tp(r){return r>0?1:r<0?-1:0}function v1(r,i){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==i.i&&n.next.i!==i.i&&t_(n,n.next,r,i))return!0;n=n.next}while(n!==r);return!1}function If(r,i){return pr(r.prev,r,r.next)<0?pr(r,i,r.next)>=0&&pr(r,r.prev,i)>=0:pr(r,i,r.prev)<0||pr(r,r.next,i)<0}function y1(r,i){let n=r,l=!1;const u=(r.x+i.x)/2,h=(r.y+i.y)/2;do n.y>h!=n.next.y>h&&n.next.y!==n.y&&u<(n.next.x-n.x)*(h-n.y)/(n.next.y-n.y)+n.x&&(l=!l),n=n.next;while(n!==r);return l}function n_(r,i){const n=new jg(r.i,r.x,r.y),l=new jg(i.i,i.x,i.y),u=r.next,h=i.prev;return r.next=i,i.prev=r,n.next=u,u.prev=n,l.next=n,n.prev=l,h.next=l,l.prev=h,l}function i_(r,i,n,l){const u=new jg(r,i,n);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function Df(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function jg(r,i,n){this.i=r,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _1(r,i,n,l){let u=0;for(let h=i,p=n-l;h<n;h+=l)u+=(r[p]-r[h])*(r[h+1]+r[p+1]),p=h;return u}const Ql={area:function(r){const i=r.length;let n=0;for(let l=i-1,u=0;u<i;l=u++)n+=r[l].x*r[u].y-r[u].x*r[l].y;return n*.5},isClockWise:function(r){return Ql.area(r)<0},triangulateShape:function(r,i){const n=[],l=[],u=[];r_(r),a_(n,r);let h=r.length;i.forEach(r_);for(let g=0;g<i.length;g++)l.push(h),h+=i[g].length,a_(n,i[g]);const p=i1.triangulate(n,l);for(let g=0;g<p.length;g+=3)u.push(p.slice(g,g+3));return u}};function r_(r){const i=r.length;i>2&&r[i-1].equals(r[0])&&r.pop()}function a_(r,i){for(let n=0;n<i.length;n++)r.push(i[n].x),r.push(i[n].y)}class s_ extends Ni{constructor(i,n){super(),this.type="ExtrudeBufferGeometry",this.parameters={shapes:i,options:n},i=Array.isArray(i)?i:[i];const l=this,u=[],h=[];for(let g=0,_=i.length;g<_;g++){const b=i[g];p(b)}this.setAttribute("position",new wi(u,3)),this.setAttribute("uv",new wi(h,2)),this.computeVertexNormals();function p(g){const _=[],b=n.curveSegments!==void 0?n.curveSegments:12,A=n.steps!==void 0?n.steps:1;let S=n.depth!==void 0?n.depth:100,R=n.bevelEnabled!==void 0?n.bevelEnabled:!0,E=n.bevelThickness!==void 0?n.bevelThickness:6,N=n.bevelSize!==void 0?n.bevelSize:E-2,W=n.bevelOffset!==void 0?n.bevelOffset:0,V=n.bevelSegments!==void 0?n.bevelSegments:3;const B=n.extrudePath,O=n.UVGenerator!==void 0?n.UVGenerator:x1;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),S=n.amount);let pe,ge=!1,ye,$,Ie,tt;B&&(pe=B.getSpacedPoints(A),ge=!0,R=!1,ye=B.computeFrenetFrames(A,!1),$=new _e,Ie=new _e,tt=new _e),R||(V=0,E=0,N=0,W=0);const qe=g.extractPoints(b);let ft=qe.shape;const je=qe.holes;if(!Ql.isClockWise(ft)){ft=ft.reverse();for(let Se=0,Pe=je.length;Se<Pe;Se++){const ze=je[Se];Ql.isClockWise(ze)&&(je[Se]=ze.reverse())}}const Ue=Ql.triangulateShape(ft,je),Le=ft;for(let Se=0,Pe=je.length;Se<Pe;Se++){const ze=je[Se];ft=ft.concat(ze)}function Te(Se,Pe,ze){return Pe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().multiplyScalar(ze).add(Se)}const Ve=ft.length,We=Ue.length;function at(Se,Pe,ze){let Ze,Xe,Q;const Y=Se.x-Pe.x,He=Se.y-Pe.y,Ge=ze.x-Se.x,ue=ze.y-Se.y,Je=Y*Y+He*He,ct=Y*ue-He*Ge;if(Math.abs(ct)>Number.EPSILON){const Ft=Math.sqrt(Je),ut=Math.sqrt(Ge*Ge+ue*ue),me=Pe.x-He/Ft,it=Pe.y+Y/Ft,Rt=ze.x-ue/ut,mt=ze.y+Ge/ut,Nt=((Rt-me)*ue-(mt-it)*Ge)/(Y*ue-He*Ge);Ze=me+Y*Nt-Se.x,Xe=it+He*Nt-Se.y;const gn=Ze*Ze+Xe*Xe;if(gn<=2)return new bt(Ze,Xe);Q=Math.sqrt(gn/2)}else{let Ft=!1;Y>Number.EPSILON?Ge>Number.EPSILON&&(Ft=!0):Y<-Number.EPSILON?Ge<-Number.EPSILON&&(Ft=!0):Math.sign(He)===Math.sign(ue)&&(Ft=!0),Ft?(Ze=-He,Xe=Y,Q=Math.sqrt(Je)):(Ze=Y,Xe=He,Q=Math.sqrt(Je/2))}return new bt(Ze/Q,Xe/Q)}const Tt=[];for(let Se=0,Pe=Le.length,ze=Pe-1,Ze=Se+1;Se<Pe;Se++,ze++,Ze++)ze===Pe&&(ze=0),Ze===Pe&&(Ze=0),Tt[Se]=at(Le[Se],Le[ze],Le[Ze]);const nt=[];let At,nn=Tt.concat();for(let Se=0,Pe=je.length;Se<Pe;Se++){const ze=je[Se];At=[];for(let Ze=0,Xe=ze.length,Q=Xe-1,Y=Ze+1;Ze<Xe;Ze++,Q++,Y++)Q===Xe&&(Q=0),Y===Xe&&(Y=0),At[Ze]=at(ze[Ze],ze[Q],ze[Y]);nt.push(At),nn=nn.concat(At)}for(let Se=0;Se<V;Se++){const Pe=Se/V,ze=E*Math.cos(Pe*Math.PI/2),Ze=N*Math.sin(Pe*Math.PI/2)+W;for(let Xe=0,Q=Le.length;Xe<Q;Xe++){const Y=Te(Le[Xe],Tt[Xe],Ze);te(Y.x,Y.y,-ze)}for(let Xe=0,Q=je.length;Xe<Q;Xe++){const Y=je[Xe];At=nt[Xe];for(let He=0,Ge=Y.length;He<Ge;He++){const ue=Te(Y[He],At[He],Ze);te(ue.x,ue.y,-ze)}}}const Yt=N+W;for(let Se=0;Se<Ve;Se++){const Pe=R?Te(ft[Se],nn[Se],Yt):ft[Se];ge?(Ie.copy(ye.normals[0]).multiplyScalar(Pe.x),$.copy(ye.binormals[0]).multiplyScalar(Pe.y),tt.copy(pe[0]).add(Ie).add($),te(tt.x,tt.y,tt.z)):te(Pe.x,Pe.y,0)}for(let Se=1;Se<=A;Se++)for(let Pe=0;Pe<Ve;Pe++){const ze=R?Te(ft[Pe],nn[Pe],Yt):ft[Pe];ge?(Ie.copy(ye.normals[Se]).multiplyScalar(ze.x),$.copy(ye.binormals[Se]).multiplyScalar(ze.y),tt.copy(pe[Se]).add(Ie).add($),te(tt.x,tt.y,tt.z)):te(ze.x,ze.y,S/A*Se)}for(let Se=V-1;Se>=0;Se--){const Pe=Se/V,ze=E*Math.cos(Pe*Math.PI/2),Ze=N*Math.sin(Pe*Math.PI/2)+W;for(let Xe=0,Q=Le.length;Xe<Q;Xe++){const Y=Te(Le[Xe],Tt[Xe],Ze);te(Y.x,Y.y,S+ze)}for(let Xe=0,Q=je.length;Xe<Q;Xe++){const Y=je[Xe];At=nt[Xe];for(let He=0,Ge=Y.length;He<Ge;He++){const ue=Te(Y[He],At[He],Ze);ge?te(ue.x,ue.y+pe[A-1].y,pe[A-1].x+ze):te(ue.x,ue.y,S+ze)}}}K(),H();function K(){const Se=u.length/3;if(R){let Pe=0,ze=Ve*Pe;for(let Ze=0;Ze<We;Ze++){const Xe=Ue[Ze];de(Xe[2]+ze,Xe[1]+ze,Xe[0]+ze)}Pe=A+V*2,ze=Ve*Pe;for(let Ze=0;Ze<We;Ze++){const Xe=Ue[Ze];de(Xe[0]+ze,Xe[1]+ze,Xe[2]+ze)}}else{for(let Pe=0;Pe<We;Pe++){const ze=Ue[Pe];de(ze[2],ze[1],ze[0])}for(let Pe=0;Pe<We;Pe++){const ze=Ue[Pe];de(ze[0]+Ve*A,ze[1]+Ve*A,ze[2]+Ve*A)}}l.addGroup(Se,u.length/3-Se,0)}function H(){const Se=u.length/3;let Pe=0;xe(Le,Pe),Pe+=Le.length;for(let ze=0,Ze=je.length;ze<Ze;ze++){const Xe=je[ze];xe(Xe,Pe),Pe+=Xe.length}l.addGroup(Se,u.length/3-Se,1)}function xe(Se,Pe){let ze=Se.length;for(;--ze>=0;){const Ze=ze;let Xe=ze-1;Xe<0&&(Xe=Se.length-1);for(let Q=0,Y=A+V*2;Q<Y;Q++){const He=Ve*Q,Ge=Ve*(Q+1),ue=Pe+Ze+He,Je=Pe+Xe+He,ct=Pe+Xe+Ge,Ft=Pe+Ze+Ge;be(ue,Je,ct,Ft)}}}function te(Se,Pe,ze){_.push(Se),_.push(Pe),_.push(ze)}function de(Se,Pe,ze){Re(Se),Re(Pe),Re(ze);const Ze=u.length/3,Xe=O.generateTopUV(l,u,Ze-3,Ze-2,Ze-1);we(Xe[0]),we(Xe[1]),we(Xe[2])}function be(Se,Pe,ze,Ze){Re(Se),Re(Pe),Re(Ze),Re(Pe),Re(ze),Re(Ze);const Xe=u.length/3,Q=O.generateSideWallUV(l,u,Xe-6,Xe-3,Xe-2,Xe-1);we(Q[0]),we(Q[1]),we(Q[3]),we(Q[1]),we(Q[2]),we(Q[3])}function Re(Se){u.push(_[Se*3+0]),u.push(_[Se*3+1]),u.push(_[Se*3+2])}function we(Se){h.push(Se.x),h.push(Se.y)}}}toJSON(){const i=Ni.prototype.toJSON.call(this),n=this.parameters.shapes,l=this.parameters.options;return b1(n,l,i)}}const x1={generateTopUV:function(r,i,n,l,u){const h=i[n*3],p=i[n*3+1],g=i[l*3],_=i[l*3+1],b=i[u*3],A=i[u*3+1];return[new bt(h,p),new bt(g,_),new bt(b,A)]},generateSideWallUV:function(r,i,n,l,u,h){const p=i[n*3],g=i[n*3+1],_=i[n*3+2],b=i[l*3],A=i[l*3+1],S=i[l*3+2],R=i[u*3],E=i[u*3+1],N=i[u*3+2],W=i[h*3],V=i[h*3+1],B=i[h*3+2];return Math.abs(g-A)<.01?[new bt(p,1-_),new bt(b,1-S),new bt(R,1-N),new bt(W,1-B)]:[new bt(g,1-_),new bt(A,1-S),new bt(E,1-N),new bt(V,1-B)]}};function b1(r,i,n){if(n.shapes=[],Array.isArray(r))for(let l=0,u=r.length;l<u;l++){const h=r[l];n.shapes.push(h.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}class w1 extends Vs{constructor(i,n){super(),this.type="ExtrudeGeometry",this.parameters={shapes:i,options:n},this.fromBufferGeometry(new s_(i,n)),this.mergeVertices()}toJSON(){const i=super.toJSON(),n=this.parameters.shapes,l=this.parameters.options;return M1(n,l,i)}}function M1(r,i,n){if(n.shapes=[],Array.isArray(r))for(let l=0,u=r.length;l<u;l++){const h=r[l];n.shapes.push(h.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}function Ep(r,i,n){Ni.call(this),this.type="ParametricBufferGeometry",this.parameters={func:r,slices:i,stacks:n};const l=[],u=[],h=[],p=[],g=1e-5,_=new _e,b=new _e,A=new _e,S=new _e,R=new _e;r.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const E=i+1;for(let N=0;N<=n;N++){const W=N/n;for(let V=0;V<=i;V++){const B=V/i;r(B,W,b),u.push(b.x,b.y,b.z),B-g>=0?(r(B-g,W,A),S.subVectors(b,A)):(r(B+g,W,A),S.subVectors(A,b)),W-g>=0?(r(B,W-g,A),R.subVectors(b,A)):(r(B,W+g,A),R.subVectors(A,b)),_.crossVectors(S,R).normalize(),h.push(_.x,_.y,_.z),p.push(B,W)}}for(let N=0;N<n;N++)for(let W=0;W<i;W++){const V=N*E+W,B=N*E+W+1,O=(N+1)*E+W+1,pe=(N+1)*E+W;l.push(V,B,pe),l.push(B,O,pe)}this.setIndex(l),this.setAttribute("position",new wi(u,3)),this.setAttribute("normal",new wi(h,3)),this.setAttribute("uv",new wi(p,2))}Ep.prototype=Object.create(Ni.prototype),Ep.prototype.constructor=Ep;function Yg(r,i,n){Vs.call(this),this.type="ParametricGeometry",this.parameters={func:r,slices:i,stacks:n},this.fromBufferGeometry(new Ep(r,i,n)),this.mergeVertices()}Yg.prototype=Object.create(Vs.prototype),Yg.prototype.constructor=Yg;class S1 extends Ni{constructor(i,n){super(),this.type="ShapeBufferGeometry",this.parameters={shapes:i,curveSegments:n},n=n||12;const l=[],u=[],h=[],p=[];let g=0,_=0;if(Array.isArray(i)===!1)b(i);else for(let A=0;A<i.length;A++)b(i[A]),this.addGroup(g,_,A),g+=_,_=0;this.setIndex(l),this.setAttribute("position",new wi(u,3)),this.setAttribute("normal",new wi(h,3)),this.setAttribute("uv",new wi(p,2));function b(A){const S=u.length/3,R=A.extractPoints(n);let E=R.shape;const N=R.holes;Ql.isClockWise(E)===!1&&(E=E.reverse());for(let V=0,B=N.length;V<B;V++){const O=N[V];Ql.isClockWise(O)===!0&&(N[V]=O.reverse())}const W=Ql.triangulateShape(E,N);for(let V=0,B=N.length;V<B;V++){const O=N[V];E=E.concat(O)}for(let V=0,B=E.length;V<B;V++){const O=E[V];u.push(O.x,O.y,0),h.push(0,0,1),p.push(O.x,O.y)}for(let V=0,B=W.length;V<B;V++){const O=W[V],pe=O[0]+S,ge=O[1]+S,ye=O[2]+S;l.push(pe,ge,ye),_+=3}}}toJSON(){const i=Ni.prototype.toJSON.call(this),n=this.parameters.shapes;return T1(n,i)}}function T1(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,l=r.length;n<l;n++){const u=r[n];i.shapes.push(u.uuid)}else i.shapes.push(r.uuid);return i}class E1 extends Vs{constructor(i,n){super(),this.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:i,curveSegments:n},this.fromBufferGeometry(new S1(i,n)),this.mergeVertices()}toJSON(){const i=Vs.prototype.toJSON.call(this),n=this.parameters.shapes;return A1(n,i)}}function A1(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,l=r.length;n<l;n++){const u=r[n];i.shapes.push(u.uuid)}else i.shapes.push(r.uuid);return i}function sh(r){Tn.call(this),this.type="ShadowMaterial",this.color=new Qt(0),this.transparent=!0,this.setValues(r)}sh.prototype=Object.create(Tn.prototype),sh.prototype.constructor=sh,sh.prototype.isShadowMaterial=!0,sh.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this};function Of(r){Ua.call(this,r),this.type="RawShaderMaterial"}Of.prototype=Object.create(Ua.prototype),Of.prototype.constructor=Of,Of.prototype.isRawShaderMaterial=!0;function Ga(r){Tn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Qt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bc,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(r)}Ga.prototype=Object.create(Tn.prototype),Ga.prototype.constructor=Ga,Ga.prototype.isMeshStandardMaterial=!0,Ga.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.vertexTangents=r.vertexTangents,this};function cl(r){Ga.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new bt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=zn.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(r)}cl.prototype=Object.create(Ga.prototype),cl.prototype.constructor=cl,cl.prototype.isMeshPhysicalMaterial=!0,cl.prototype.copy=function(r){return Ga.prototype.copy.call(this,r),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.reflectivity=r.reflectivity,r.sheen?this.sheen=(this.sheen||new Qt).copy(r.sheen):this.sheen=null,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this};function jc(r){Tn.call(this),this.type="MeshPhongMaterial",this.color=new Qt(16777215),this.specular=new Qt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bc,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=mi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}jc.prototype=Object.create(Tn.prototype),jc.prototype.constructor=jc,jc.prototype.isMeshPhongMaterial=!0,jc.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function oh(r){Tn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Qt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bc,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}oh.prototype=Object.create(Tn.prototype),oh.prototype.constructor=oh,oh.prototype.isMeshToonMaterial=!0,oh.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function lh(r){Tn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bc,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}lh.prototype=Object.create(Tn.prototype),lh.prototype.constructor=lh,lh.prototype.isMeshNormalMaterial=!0,lh.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function ch(r){Tn.call(this),this.type="MeshLambertMaterial",this.color=new Qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=mi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}ch.prototype=Object.create(Tn.prototype),ch.prototype.constructor=ch,ch.prototype.isMeshLambertMaterial=!0,ch.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function uh(r){Tn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Qt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bc,this.normalScale=new bt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}uh.prototype=Object.create(Tn.prototype),uh.prototype.constructor=uh,uh.prototype.isMeshMatcapMaterial=!0,uh.prototype.copy=function(r){return Tn.prototype.copy.call(this,r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function hh(r){es.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}hh.prototype=Object.create(es.prototype),hh.prototype.constructor=hh,hh.prototype.isLineDashedMaterial=!0,hh.prototype.copy=function(r){return es.prototype.copy.call(this,r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this};var L1=Object.freeze({__proto__:null,ShadowMaterial:sh,SpriteMaterial:qc,RawShaderMaterial:Of,ShaderMaterial:Ua,PointsMaterial:Kl,MeshPhysicalMaterial:cl,MeshStandardMaterial:Ga,MeshPhongMaterial:jc,MeshToonMaterial:oh,MeshNormalMaterial:lh,MeshLambertMaterial:ch,MeshDepthMaterial:kc,MeshDistanceMaterial:Vc,MeshBasicMaterial:ys,MeshMatcapMaterial:uh,LineDashedMaterial:hh,LineBasicMaterial:es,Material:Tn});const lr={arraySlice:function(r,i,n){return lr.isTypedArray(r)?new r.constructor(r.subarray(i,n!==void 0?n:r.length)):r.slice(i,n)},convertArray:function(r,i,n){return!r||!n&&r.constructor===i?r:typeof i.BYTES_PER_ELEMENT=="number"?new i(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function i(u,h){return r[u]-r[h]}const n=r.length,l=new Array(n);for(let u=0;u!==n;++u)l[u]=u;return l.sort(i),l},sortedArray:function(r,i,n){const l=r.length,u=new r.constructor(l);for(let h=0,p=0;p!==l;++h){const g=n[h]*i;for(let _=0;_!==i;++_)u[p++]=r[g+_]}return u},flattenJSON:function(r,i,n,l){let u=1,h=r[0];for(;h!==void 0&&h[l]===void 0;)h=r[u++];if(h===void 0)return;let p=h[l];if(p!==void 0)if(Array.isArray(p))do p=h[l],p!==void 0&&(i.push(h.time),n.push.apply(n,p)),h=r[u++];while(h!==void 0);else if(p.toArray!==void 0)do p=h[l],p!==void 0&&(i.push(h.time),p.toArray(n,n.length)),h=r[u++];while(h!==void 0);else do p=h[l],p!==void 0&&(i.push(h.time),n.push(p)),h=r[u++];while(h!==void 0)},subclip:function(r,i,n,l,u){u=u||30;const h=r.clone();h.name=i;const p=[];for(let _=0;_<h.tracks.length;++_){const b=h.tracks[_],A=b.getValueSize(),S=[],R=[];for(let E=0;E<b.times.length;++E){const N=b.times[E]*u;if(!(N<n||N>=l)){S.push(b.times[E]);for(let W=0;W<A;++W)R.push(b.values[E*A+W])}}S.length!==0&&(b.times=lr.convertArray(S,b.times.constructor),b.values=lr.convertArray(R,b.values.constructor),p.push(b))}h.tracks=p;let g=1/0;for(let _=0;_<h.tracks.length;++_)g>h.tracks[_].times[0]&&(g=h.tracks[_].times[0]);for(let _=0;_<h.tracks.length;++_)h.tracks[_].shift(-1*g);return h.resetDuration(),h},makeClipAdditive:function(r,i,n,l){i===void 0&&(i=0),n===void 0&&(n=r),(l===void 0||l<=0)&&(l=30);const u=n.tracks.length,h=i/l;for(let p=0;p<u;++p){const g=n.tracks[p],_=g.ValueTypeName;if(_==="bool"||_==="string")continue;const b=r.tracks.find(function(B){return B.name===g.name&&B.ValueTypeName===_});if(b===void 0)continue;let A=0;const S=g.getValueSize();g.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=S/3);let R=0;const E=b.getValueSize();b.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(R=E/3);const N=g.times.length-1;let W;if(h<=g.times[0]){const B=A,O=S-A;W=lr.arraySlice(g.values,B,O)}else if(h>=g.times[N]){const B=N*S+A,O=B+S-A;W=lr.arraySlice(g.values,B,O)}else{const B=g.createInterpolant(),O=A,pe=S-A;B.evaluate(h),W=lr.arraySlice(B.resultBuffer,O,pe)}_==="quaternion"&&new Ta().fromArray(W).normalize().conjugate().toArray(W);const V=b.times.length;for(let B=0;B<V;++B){const O=B*E+R;if(_==="quaternion")Ta.multiplyQuaternionsFlat(b.values,O,W,0,b.values,O);else{const pe=E-R*2;for(let ge=0;ge<pe;++ge)b.values[O+ge]-=W[ge]}}}return r.blendMode=Jy,r}};function za(r,i,n,l){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=l!==void 0?l:new i.constructor(n),this.sampleValues=i,this.valueSize=n}Object.assign(za.prototype,{evaluate:function(r){const i=this.parameterPositions;let n=this._cachedIndex,l=i[n],u=i[n-1];e:{t:{let h;n:{i:if(!(r<l)){for(let p=n+2;;){if(l===void 0){if(r<u)break i;return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,r,u)}if(n===p)break;if(u=l,l=i[++n],r<l)break t}h=i.length;break n}if(!(r>=u)){const p=i[1];r<p&&(n=2,u=p);for(let g=n-2;;){if(u===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,l);if(n===g)break;if(l=u,u=i[--n-1],r>=u)break t}h=n,n=0;break n}break e}for(;n<h;){const p=n+h>>>1;r<i[p]?h=p:n=p+1}if(l=i[n],u=i[n-1],u===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,l);if(l===void 0)return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,u,r)}this._cachedIndex=n,this.intervalChanged_(n,u,l)}return this.interpolate_(n,u,r,l)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(r){const i=this.resultBuffer,n=this.sampleValues,l=this.valueSize,u=r*l;for(let h=0;h!==l;++h)i[h]=n[u+h];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(za.prototype,{beforeStart_:za.prototype.copySampleValue_,afterEnd_:za.prototype.copySampleValue_});function Zg(r,i,n,l){za.call(this,r,i,n,l),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Zg.prototype=Object.assign(Object.create(za.prototype),{constructor:Zg,DefaultSettings_:{endingStart:Ou,endingEnd:Ou},intervalChanged_:function(r,i,n){const l=this.parameterPositions;let u=r-2,h=r+1,p=l[u],g=l[h];if(p===void 0)switch(this.getSettings_().endingStart){case Nu:u=r,p=2*i-n;break;case kd:u=l.length-2,p=i+l[u]-l[u+1];break;default:u=r,p=n}if(g===void 0)switch(this.getSettings_().endingEnd){case Nu:h=r,g=2*n-i;break;case kd:h=1,g=n+l[1]-l[0];break;default:h=r-1,g=i}const _=(n-i)*.5,b=this.valueSize;this._weightPrev=_/(i-p),this._weightNext=_/(g-n),this._offsetPrev=u*b,this._offsetNext=h*b},interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=r*p,_=g-p,b=this._offsetPrev,A=this._offsetNext,S=this._weightPrev,R=this._weightNext,E=(n-i)/(l-i),N=E*E,W=N*E,V=-S*W+2*S*N-S*E,B=(1+S)*W+(-1.5-2*S)*N+(-.5+S)*E+1,O=(-1-R)*W+(1.5+R)*N+.5*E,pe=R*W-R*N;for(let ge=0;ge!==p;++ge)u[ge]=V*h[b+ge]+B*h[_+ge]+O*h[g+ge]+pe*h[A+ge];return u}});function Ap(r,i,n,l){za.call(this,r,i,n,l)}Ap.prototype=Object.assign(Object.create(za.prototype),{constructor:Ap,interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=r*p,_=g-p,b=(n-i)/(l-i),A=1-b;for(let S=0;S!==p;++S)u[S]=h[_+S]*A+h[g+S]*b;return u}});function Jg(r,i,n,l){za.call(this,r,i,n,l)}Jg.prototype=Object.assign(Object.create(za.prototype),{constructor:Jg,interpolate_:function(r){return this.copySampleValue_(r-1)}});function da(r,i,n,l){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=lr.convertArray(i,this.TimeBufferType),this.values=lr.convertArray(n,this.ValueBufferType),this.setInterpolation(l||this.DefaultInterpolation)}Object.assign(da,{toJSON:function(r){const i=r.constructor;let n;if(i.toJSON!==void 0)n=i.toJSON(r);else{n={name:r.name,times:lr.convertArray(r.times,Array),values:lr.convertArray(r.values,Array)};const l=r.getInterpolation();l!==r.DefaultInterpolation&&(n.interpolation=l)}return n.type=r.ValueTypeName,n}}),Object.assign(da.prototype,{constructor:da,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Du,InterpolantFactoryMethodDiscrete:function(r){return new Jg(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodLinear:function(r){return new Ap(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:function(r){return new Zg(this.times,this.values,this.getValueSize(),r)},setInterpolation:function(r){let i;switch(r){case of:i=this.InterpolantFactoryMethodDiscrete;break;case Du:i=this.InterpolantFactoryMethodLinear;break;case sg:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return of;case this.InterpolantFactoryMethodLinear:return Du;case this.InterpolantFactoryMethodSmooth:return sg}},getValueSize:function(){return this.values.length/this.times.length},shift:function(r){if(r!==0){const i=this.times;for(let n=0,l=i.length;n!==l;++n)i[n]+=r}return this},scale:function(r){if(r!==1){const i=this.times;for(let n=0,l=i.length;n!==l;++n)i[n]*=r}return this},trim:function(r,i){const n=this.times,l=n.length;let u=0,h=l-1;for(;u!==l&&n[u]<r;)++u;for(;h!==-1&&n[h]>i;)--h;if(++h,u!==0||h!==l){u>=h&&(h=Math.max(h,1),u=h-1);const p=this.getValueSize();this.times=lr.arraySlice(n,u,h),this.values=lr.arraySlice(this.values,u*p,h*p)}return this},validate:function(){let r=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);const n=this.times,l=this.values,u=n.length;u===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let h=null;for(let p=0;p!==u;p++){const g=n[p];if(typeof g=="number"&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,p,g),r=!1;break}if(h!==null&&h>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,p,g,h),r=!1;break}h=g}if(l!==void 0&&lr.isTypedArray(l))for(let p=0,g=l.length;p!==g;++p){const _=l[p];if(isNaN(_)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,_),r=!1;break}}return r},optimize:function(){const r=lr.arraySlice(this.times),i=lr.arraySlice(this.values),n=this.getValueSize(),l=this.getInterpolation()===sg,u=r.length-1;let h=1;for(let p=1;p<u;++p){let g=!1;const _=r[p],b=r[p+1];if(_!==b&&(p!==1||_!==_[0]))if(l)g=!0;else{const A=p*n,S=A-n,R=A+n;for(let E=0;E!==n;++E){const N=i[A+E];if(N!==i[S+E]||N!==i[R+E]){g=!0;break}}}if(g){if(p!==h){r[h]=r[p];const A=p*n,S=h*n;for(let R=0;R!==n;++R)i[S+R]=i[A+R]}++h}}if(u>0){r[h]=r[u];for(let p=u*n,g=h*n,_=0;_!==n;++_)i[g+_]=i[p+_];++h}return h!==r.length?(this.times=lr.arraySlice(r,0,h),this.values=lr.arraySlice(i,0,h*n)):(this.times=r,this.values=i),this},clone:function(){const r=lr.arraySlice(this.times,0),i=lr.arraySlice(this.values,0),n=this.constructor,l=new n(this.name,r,i);return l.createInterpolant=this.createInterpolant,l}});function Kg(r,i,n){da.call(this,r,i,n)}Kg.prototype=Object.assign(Object.create(da.prototype),{constructor:Kg,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:of,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function $g(r,i,n,l){da.call(this,r,i,n,l)}$g.prototype=Object.assign(Object.create(da.prototype),{constructor:$g,ValueTypeName:"color"});function fh(r,i,n,l){da.call(this,r,i,n,l)}fh.prototype=Object.assign(Object.create(da.prototype),{constructor:fh,ValueTypeName:"number"});function Qg(r,i,n,l){za.call(this,r,i,n,l)}Qg.prototype=Object.assign(Object.create(za.prototype),{constructor:Qg,interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=(n-i)/(l-i);let _=r*p;for(let b=_+p;_!==b;_+=4)Ta.slerpFlat(u,0,h,_-p,h,_,g);return u}});function Nf(r,i,n,l){da.call(this,r,i,n,l)}Nf.prototype=Object.assign(Object.create(da.prototype),{constructor:Nf,ValueTypeName:"quaternion",DefaultInterpolation:Du,InterpolantFactoryMethodLinear:function(r){return new Qg(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:void 0});function ev(r,i,n,l){da.call(this,r,i,n,l)}ev.prototype=Object.assign(Object.create(da.prototype),{constructor:ev,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:of,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function dh(r,i,n,l){da.call(this,r,i,n,l)}dh.prototype=Object.assign(Object.create(da.prototype),{constructor:dh,ValueTypeName:"vector"});function Ws(r,i,n,l){this.name=r,this.tracks=n,this.duration=i!==void 0?i:-1,this.blendMode=l!==void 0?l:og,this.uuid=zn.generateUUID(),this.duration<0&&this.resetDuration()}function R1(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return fh;case"vector":case"vector2":case"vector3":case"vector4":return dh;case"color":return $g;case"quaternion":return Nf;case"bool":case"boolean":return Kg;case"string":return ev}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function C1(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const i=R1(r.type);if(r.times===void 0){const n=[],l=[];lr.flattenJSON(r.keys,n,l,"value"),r.times=n,r.values=l}return i.parse!==void 0?i.parse(r):new i(r.name,r.times,r.values,r.interpolation)}Object.assign(Ws,{parse:function(r){const i=[],n=r.tracks,l=1/(r.fps||1);for(let u=0,h=n.length;u!==h;++u)i.push(C1(n[u]).scale(l));return new Ws(r.name,r.duration,i,r.blendMode)},toJSON:function(r){const i=[],n=r.tracks,l={name:r.name,duration:r.duration,tracks:i,uuid:r.uuid,blendMode:r.blendMode};for(let u=0,h=n.length;u!==h;++u)i.push(da.toJSON(n[u]));return l},CreateFromMorphTargetSequence:function(r,i,n,l){const u=i.length,h=[];for(let p=0;p<u;p++){let g=[],_=[];g.push((p+u-1)%u,p,(p+1)%u),_.push(0,1,0);const b=lr.getKeyframeOrder(g);g=lr.sortedArray(g,1,b),_=lr.sortedArray(_,1,b),!l&&g[0]===0&&(g.push(u),_.push(_[0])),h.push(new fh(".morphTargetInfluences["+i[p].name+"]",g,_).scale(1/n))}return new Ws(r,-1,h)},findByName:function(r,i){let n=r;if(!Array.isArray(r)){const l=r;n=l.geometry&&l.geometry.animations||l.animations}for(let l=0;l<n.length;l++)if(n[l].name===i)return n[l];return null},CreateClipsFromMorphTargetSequences:function(r,i,n){const l={},u=/^([\w-]*?)([\d]+)$/;for(let p=0,g=r.length;p<g;p++){const _=r[p],b=_.name.match(u);if(b&&b.length>1){const A=b[1];let S=l[A];S||(l[A]=S=[]),S.push(_)}}const h=[];for(const p in l)h.push(Ws.CreateFromMorphTargetSequence(p,l[p],i,n));return h},parseAnimation:function(r,i){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(A,S,R,E,N){if(R.length!==0){const W=[],V=[];lr.flattenJSON(R,W,V,E),W.length!==0&&N.push(new A(S,W,V))}},l=[],u=r.name||"default",h=r.fps||30,p=r.blendMode;let g=r.length||-1;const _=r.hierarchy||[];for(let A=0;A<_.length;A++){const S=_[A].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const R={};let E;for(E=0;E<S.length;E++)if(S[E].morphTargets)for(let N=0;N<S[E].morphTargets.length;N++)R[S[E].morphTargets[N]]=-1;for(const N in R){const W=[],V=[];for(let B=0;B!==S[E].morphTargets.length;++B){const O=S[E];W.push(O.time),V.push(O.morphTarget===N?1:0)}l.push(new fh(".morphTargetInfluence["+N+"]",W,V))}g=R.length*(h||1)}else{const R=".bones["+i[A].name+"]";n(dh,R+".position",S,"pos",l),n(Nf,R+".quaternion",S,"rot",l),n(dh,R+".scale",S,"scl",l)}}return l.length===0?null:new Ws(u,g,l,p)}}),Object.assign(Ws.prototype,{resetDuration:function(){const r=this.tracks;let i=0;for(let n=0,l=r.length;n!==l;++n){const u=this.tracks[n];i=Math.max(i,u.times[u.times.length-1])}return this.duration=i,this},trim:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this},validate:function(){let r=!0;for(let i=0;i<this.tracks.length;i++)r=r&&this.tracks[i].validate();return r},optimize:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this},clone:function(){const r=[];for(let i=0;i<this.tracks.length;i++)r.push(this.tracks[i].clone());return new Ws(this.name,this.duration,r,this.blendMode)}});const ph={enabled:!1,files:{},add:function(r,i){this.enabled!==!1&&(this.files[r]=i)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};function P1(r,i,n){const l=this;let u=!1,h=0,p=0,g;const _=[];this.onStart=void 0,this.onLoad=r,this.onProgress=i,this.onError=n,this.itemStart=function(b){p++,u===!1&&l.onStart!==void 0&&l.onStart(b,h,p),u=!0},this.itemEnd=function(b){h++,l.onProgress!==void 0&&l.onProgress(b,h,p),h===p&&(u=!1,l.onLoad!==void 0&&l.onLoad())},this.itemError=function(b){l.onError!==void 0&&l.onError(b)},this.resolveURL=function(b){return g?g(b):b},this.setURLModifier=function(b){return g=b,this},this.addHandler=function(b,A){return _.push(b,A),this},this.removeHandler=function(b){const A=_.indexOf(b);return A!==-1&&_.splice(A,2),this},this.getHandler=function(b){for(let A=0,S=_.length;A<S;A+=2){const R=_[A],E=_[A+1];if(R.global&&(R.lastIndex=0),R.test(b))return E}return null}}const I1=new P1;function Ri(r){this.manager=r!==void 0?r:I1,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ri.prototype,{load:function(){},loadAsync:function(r,i){const n=this;return new Promise(function(l,u){n.load(r,l,i,u)})},parse:function(){},setCrossOrigin:function(r){return this.crossOrigin=r,this},setWithCredentials:function(r){return this.withCredentials=r,this},setPath:function(r){return this.path=r,this},setResourcePath:function(r){return this.resourcePath=r,this},setRequestHeader:function(r){return this.requestHeader=r,this}});const qs={};function Xs(r){Ri.call(this,r)}Xs.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Xs,load:function(r,i,n,l){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=ph.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;if(qs[r]!==void 0){qs[r].push({onLoad:i,onProgress:n,onError:l});return}const p=/^data:(.*?)(;base64)?,(.*)$/,g=r.match(p);let _;if(g){const b=g[1],A=!!g[2];let S=g[3];S=decodeURIComponent(S),A&&(S=atob(S));try{let R;const E=(this.responseType||"").toLowerCase();switch(E){case"arraybuffer":case"blob":const N=new Uint8Array(S.length);for(let V=0;V<S.length;V++)N[V]=S.charCodeAt(V);E==="blob"?R=new Blob([N.buffer],{type:b}):R=N.buffer;break;case"document":R=new DOMParser().parseFromString(S,b);break;case"json":R=JSON.parse(S);break;default:R=S;break}setTimeout(function(){i&&i(R),u.manager.itemEnd(r)},0)}catch(R){setTimeout(function(){l&&l(R),u.manager.itemError(r),u.manager.itemEnd(r)},0)}}else{qs[r]=[],qs[r].push({onLoad:i,onProgress:n,onError:l}),_=new XMLHttpRequest,_.open("GET",r,!0),_.addEventListener("load",function(b){const A=this.response,S=qs[r];if(delete qs[r],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ph.add(r,A);for(let R=0,E=S.length;R<E;R++){const N=S[R];N.onLoad&&N.onLoad(A)}u.manager.itemEnd(r)}else{for(let R=0,E=S.length;R<E;R++){const N=S[R];N.onError&&N.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)}},!1),_.addEventListener("progress",function(b){const A=qs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onProgress&&E.onProgress(b)}},!1),_.addEventListener("error",function(b){const A=qs[r];delete qs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onError&&E.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)},!1),_.addEventListener("abort",function(b){const A=qs[r];delete qs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onError&&E.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)},!1),this.responseType!==void 0&&(_.responseType=this.responseType),this.withCredentials!==void 0&&(_.withCredentials=this.withCredentials),_.overrideMimeType&&_.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const b in this.requestHeader)_.setRequestHeader(b,this.requestHeader[b]);_.send(null)}return u.manager.itemStart(r),_},setResponseType:function(r){return this.responseType=r,this},setMimeType:function(r){return this.mimeType=r,this}});function o_(r){Ri.call(this,r)}o_.prototype=Object.assign(Object.create(Ri.prototype),{constructor:o_,load:function(r,i,n,l){const u=this,h=new Xs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i=[];for(let n=0;n<r.length;n++){const l=Ws.parse(r[n]);i.push(l)}return i}});function l_(r){Ri.call(this,r)}l_.prototype=Object.assign(Object.create(Ri.prototype),{constructor:l_,load:function(r,i,n,l){const u=this,h=[],p=new Rf;p.image=h;const g=new Xs(this.manager);g.setPath(this.path),g.setResponseType("arraybuffer"),g.setRequestHeader(this.requestHeader),g.setWithCredentials(u.withCredentials);let _=0;function b(A){g.load(r[A],function(S){const R=u.parse(S,!0);h[A]={width:R.width,height:R.height,format:R.format,mipmaps:R.mipmaps},_+=1,_===6&&(R.mipmapCount===1&&(p.minFilter=Rn),p.format=R.format,p.needsUpdate=!0,i&&i(p))},n,l)}if(Array.isArray(r))for(let A=0,S=r.length;A<S;++A)b(A);else g.load(r,function(A){const S=u.parse(A,!0);if(S.isCubemap){const R=S.mipmaps.length/S.mipmapCount;for(let E=0;E<R;E++){h[E]={mipmaps:[]};for(let N=0;N<S.mipmapCount;N++)h[E].mipmaps.push(S.mipmaps[E*S.mipmapCount+N]),h[E].format=S.format,h[E].width=S.width,h[E].height=S.height}}else p.image.width=S.width,p.image.height=S.height,p.mipmaps=S.mipmaps;S.mipmapCount===1&&(p.minFilter=Rn),p.format=S.format,p.needsUpdate=!0,i&&i(p)},n,l);return p}});function Lp(r){Ri.call(this,r)}Lp.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Lp,load:function(r,i,n,l){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=ph.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;const p=document.createElementNS("http://www.w3.org/1999/xhtml","img");function g(){p.removeEventListener("load",g,!1),p.removeEventListener("error",_,!1),ph.add(r,this),i&&i(this),u.manager.itemEnd(r)}function _(b){p.removeEventListener("load",g,!1),p.removeEventListener("error",_,!1),l&&l(b),u.manager.itemError(r),u.manager.itemEnd(r)}return p.addEventListener("load",g,!1),p.addEventListener("error",_,!1),r.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(p.crossOrigin=this.crossOrigin),u.manager.itemStart(r),p.src=r,p}});function tv(r){Ri.call(this,r)}tv.prototype=Object.assign(Object.create(Ri.prototype),{constructor:tv,load:function(r,i,n,l){const u=new Yl,h=new Lp(this.manager);h.setCrossOrigin(this.crossOrigin),h.setPath(this.path);let p=0;function g(_){h.load(r[_],function(b){u.images[_]=b,p++,p===6&&(u.needsUpdate=!0,i&&i(u))},void 0,l)}for(let _=0;_<r.length;++_)g(_);return u}});function Ff(r){Ri.call(this,r)}Ff.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Ff,load:function(r,i,n,l){const u=this,h=new $u,p=new Xs(this.manager);return p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setPath(this.path),p.setWithCredentials(u.withCredentials),p.load(r,function(g){const _=u.parse(g);!_||(_.image!==void 0?h.image=_.image:_.data!==void 0&&(h.image.width=_.width,h.image.height=_.height,h.image.data=_.data),h.wrapS=_.wrapS!==void 0?_.wrapS:na,h.wrapT=_.wrapT!==void 0?_.wrapT:na,h.magFilter=_.magFilter!==void 0?_.magFilter:Rn,h.minFilter=_.minFilter!==void 0?_.minFilter:Rn,h.anisotropy=_.anisotropy!==void 0?_.anisotropy:1,_.format!==void 0&&(h.format=_.format),_.type!==void 0&&(h.type=_.type),_.mipmaps!==void 0&&(h.mipmaps=_.mipmaps,h.minFilter=Pu),_.mipmapCount===1&&(h.minFilter=Rn),h.needsUpdate=!0,i&&i(h,_))},n,l),h}});function Rp(r){Ri.call(this,r)}Rp.prototype=Object.assign(Object.create(Ri.prototype),{constructor:Rp,load:function(r,i,n,l){const u=new qi,h=new Lp(this.manager);return h.setCrossOrigin(this.crossOrigin),h.setPath(this.path),h.load(r,function(p){u.image=p;const g=r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0;u.format=g?Mo:vs,u.needsUpdate=!0,i!==void 0&&i(u)},n,l),u}});function mn(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(mn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(r,i){const n=this.getUtoTmapping(r);return this.getPoint(n,i)},getPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return i},getSpacedPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPointAt(n/r));return i},getLength:function(){const r=this.getLengths();return r[r.length-1]},getLengths:function(r){if(r===void 0&&(r=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,l=this.getPoint(0),u=0;i.push(0);for(let h=1;h<=r;h++)n=this.getPoint(h/r),u+=n.distanceTo(l),i.push(u),l=n;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(r,i){const n=this.getLengths();let l=0;const u=n.length;let h;i?h=i:h=r*n[u-1];let p=0,g=u-1,_;for(;p<=g;)if(l=Math.floor(p+(g-p)/2),_=n[l]-h,_<0)p=l+1;else if(_>0)g=l-1;else{g=l;break}if(l=g,n[l]===h)return l/(u-1);const b=n[l],S=n[l+1]-b,R=(h-b)/S;return(l+R)/(u-1)},getTangent:function(r,i){let l=r-1e-4,u=r+1e-4;l<0&&(l=0),u>1&&(u=1);const h=this.getPoint(l),p=this.getPoint(u),g=i||(h.isVector2?new bt:new _e);return g.copy(p).sub(h).normalize(),g},getTangentAt:function(r,i){const n=this.getUtoTmapping(r);return this.getTangent(n,i)},computeFrenetFrames:function(r,i){const n=new _e,l=[],u=[],h=[],p=new _e,g=new Wn;for(let R=0;R<=r;R++){const E=R/r;l[R]=this.getTangentAt(E,new _e),l[R].normalize()}u[0]=new _e,h[0]=new _e;let _=Number.MAX_VALUE;const b=Math.abs(l[0].x),A=Math.abs(l[0].y),S=Math.abs(l[0].z);b<=_&&(_=b,n.set(1,0,0)),A<=_&&(_=A,n.set(0,1,0)),S<=_&&n.set(0,0,1),p.crossVectors(l[0],n).normalize(),u[0].crossVectors(l[0],p),h[0].crossVectors(l[0],u[0]);for(let R=1;R<=r;R++){if(u[R]=u[R-1].clone(),h[R]=h[R-1].clone(),p.crossVectors(l[R-1],l[R]),p.length()>Number.EPSILON){p.normalize();const E=Math.acos(zn.clamp(l[R-1].dot(l[R]),-1,1));u[R].applyMatrix4(g.makeRotationAxis(p,E))}h[R].crossVectors(l[R],u[R])}if(i===!0){let R=Math.acos(zn.clamp(u[0].dot(u[r]),-1,1));R/=r,l[0].dot(p.crossVectors(u[0],u[r]))>0&&(R=-R);for(let E=1;E<=r;E++)u[E].applyMatrix4(g.makeRotationAxis(l[E],R*E)),h[E].crossVectors(l[E],u[E])}return{tangents:l,normals:u,binormals:h}},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this},toJSON:function(){const r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r},fromJSON:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}});function xs(r,i,n,l,u,h,p,g){mn.call(this),this.type="EllipseCurve",this.aX=r||0,this.aY=i||0,this.xRadius=n||1,this.yRadius=l||1,this.aStartAngle=u||0,this.aEndAngle=h||2*Math.PI,this.aClockwise=p||!1,this.aRotation=g||0}xs.prototype=Object.create(mn.prototype),xs.prototype.constructor=xs,xs.prototype.isEllipseCurve=!0,xs.prototype.getPoint=function(r,i){const n=i||new bt,l=Math.PI*2;let u=this.aEndAngle-this.aStartAngle;const h=Math.abs(u)<Number.EPSILON;for(;u<0;)u+=l;for(;u>l;)u-=l;u<Number.EPSILON&&(h?u=0:u=l),this.aClockwise===!0&&!h&&(u===l?u=-l:u=u-l);const p=this.aStartAngle+r*u;let g=this.aX+this.xRadius*Math.cos(p),_=this.aY+this.yRadius*Math.sin(p);if(this.aRotation!==0){const b=Math.cos(this.aRotation),A=Math.sin(this.aRotation),S=g-this.aX,R=_-this.aY;g=S*b-R*A+this.aX,_=S*A+R*b+this.aY}return n.set(g,_)},xs.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this},xs.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r},xs.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this};function Bf(r,i,n,l,u,h){xs.call(this,r,i,n,n,l,u,h),this.type="ArcCurve"}Bf.prototype=Object.create(xs.prototype),Bf.prototype.constructor=Bf,Bf.prototype.isArcCurve=!0;function nv(){let r=0,i=0,n=0,l=0;function u(h,p,g,_){r=h,i=g,n=-3*h+3*p-2*g-_,l=2*h-2*p+g+_}return{initCatmullRom:function(h,p,g,_,b){u(p,g,b*(g-h),b*(_-p))},initNonuniformCatmullRom:function(h,p,g,_,b,A,S){let R=(p-h)/b-(g-h)/(b+A)+(g-p)/A,E=(g-p)/A-(_-p)/(A+S)+(_-g)/S;R*=A,E*=A,u(p,g,R,E)},calc:function(h){const p=h*h,g=p*h;return r+i*h+n*p+l*g}}}const Cp=new _e,iv=new nv,rv=new nv,av=new nv;function js(r,i,n,l){mn.call(this),this.type="CatmullRomCurve3",this.points=r||[],this.closed=i||!1,this.curveType=n||"centripetal",this.tension=l!==void 0?l:.5}js.prototype=Object.create(mn.prototype),js.prototype.constructor=js,js.prototype.isCatmullRomCurve3=!0,js.prototype.getPoint=function(r,i){const n=i||new _e,l=this.points,u=l.length,h=(u-(this.closed?0:1))*r;let p=Math.floor(h),g=h-p;this.closed?p+=p>0?0:(Math.floor(Math.abs(p)/u)+1)*u:g===0&&p===u-1&&(p=u-2,g=1);let _,b;this.closed||p>0?_=l[(p-1)%u]:(Cp.subVectors(l[0],l[1]).add(l[0]),_=Cp);const A=l[p%u],S=l[(p+1)%u];if(this.closed||p+2<u?b=l[(p+2)%u]:(Cp.subVectors(l[u-1],l[u-2]).add(l[u-1]),b=Cp),this.curveType==="centripetal"||this.curveType==="chordal"){const R=this.curveType==="chordal"?.5:.25;let E=Math.pow(_.distanceToSquared(A),R),N=Math.pow(A.distanceToSquared(S),R),W=Math.pow(S.distanceToSquared(b),R);N<1e-4&&(N=1),E<1e-4&&(E=N),W<1e-4&&(W=N),iv.initNonuniformCatmullRom(_.x,A.x,S.x,b.x,E,N,W),rv.initNonuniformCatmullRom(_.y,A.y,S.y,b.y,E,N,W),av.initNonuniformCatmullRom(_.z,A.z,S.z,b.z,E,N,W)}else this.curveType==="catmullrom"&&(iv.initCatmullRom(_.x,A.x,S.x,b.x,this.tension),rv.initCatmullRom(_.y,A.y,S.y,b.y,this.tension),av.initCatmullRom(_.z,A.z,S.z,b.z,this.tension));return n.set(iv.calc(g),rv.calc(g),av.calc(g)),n},js.prototype.copy=function(r){mn.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(l.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this},js.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const l=this.points[i];r.points.push(l.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r},js.prototype.fromJSON=function(r){mn.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(new _e().fromArray(l))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this};function c_(r,i,n,l,u){const h=(l-i)*.5,p=(u-n)*.5,g=r*r,_=r*g;return(2*n-2*l+h+p)*_+(-3*n+3*l-2*h-p)*g+h*r+n}function D1(r,i){const n=1-r;return n*n*i}function O1(r,i){return 2*(1-r)*r*i}function N1(r,i){return r*r*i}function Uf(r,i,n,l){return D1(r,i)+O1(r,n)+N1(r,l)}function F1(r,i){const n=1-r;return n*n*n*i}function B1(r,i){const n=1-r;return 3*n*n*r*i}function U1(r,i){return 3*(1-r)*r*r*i}function G1(r,i){return r*r*r*i}function Gf(r,i,n,l,u){return F1(r,i)+B1(r,n)+U1(r,l)+G1(r,u)}function Ao(r,i,n,l){mn.call(this),this.type="CubicBezierCurve",this.v0=r||new bt,this.v1=i||new bt,this.v2=n||new bt,this.v3=l||new bt}Ao.prototype=Object.create(mn.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isCubicBezierCurve=!0,Ao.prototype.getPoint=function(r,i){const n=i||new bt,l=this.v0,u=this.v1,h=this.v2,p=this.v3;return n.set(Gf(r,l.x,u.x,h.x,p.x),Gf(r,l.y,u.y,h.y,p.y)),n},Ao.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},Ao.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},Ao.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function ul(r,i,n,l){mn.call(this),this.type="CubicBezierCurve3",this.v0=r||new _e,this.v1=i||new _e,this.v2=n||new _e,this.v3=l||new _e}ul.prototype=Object.create(mn.prototype),ul.prototype.constructor=ul,ul.prototype.isCubicBezierCurve3=!0,ul.prototype.getPoint=function(r,i){const n=i||new _e,l=this.v0,u=this.v1,h=this.v2,p=this.v3;return n.set(Gf(r,l.x,u.x,h.x,p.x),Gf(r,l.y,u.y,h.y,p.y),Gf(r,l.z,u.z,h.z,p.z)),n},ul.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},ul.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},ul.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function ts(r,i){mn.call(this),this.type="LineCurve",this.v1=r||new bt,this.v2=i||new bt}ts.prototype=Object.create(mn.prototype),ts.prototype.constructor=ts,ts.prototype.isLineCurve=!0,ts.prototype.getPoint=function(r,i){const n=i||new bt;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},ts.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},ts.prototype.getTangent=function(r,i){const n=i||new bt;return n.copy(this.v2).sub(this.v1).normalize(),n},ts.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},ts.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},ts.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Lo(r,i){mn.call(this),this.type="LineCurve3",this.v1=r||new _e,this.v2=i||new _e}Lo.prototype=Object.create(mn.prototype),Lo.prototype.constructor=Lo,Lo.prototype.isLineCurve3=!0,Lo.prototype.getPoint=function(r,i){const n=i||new _e;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},Lo.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},Lo.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Lo.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Lo.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Ro(r,i,n){mn.call(this),this.type="QuadraticBezierCurve",this.v0=r||new bt,this.v1=i||new bt,this.v2=n||new bt}Ro.prototype=Object.create(mn.prototype),Ro.prototype.constructor=Ro,Ro.prototype.isQuadraticBezierCurve=!0,Ro.prototype.getPoint=function(r,i){const n=i||new bt,l=this.v0,u=this.v1,h=this.v2;return n.set(Uf(r,l.x,u.x,h.x),Uf(r,l.y,u.y,h.y)),n},Ro.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Ro.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Ro.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function hl(r,i,n){mn.call(this),this.type="QuadraticBezierCurve3",this.v0=r||new _e,this.v1=i||new _e,this.v2=n||new _e}hl.prototype=Object.create(mn.prototype),hl.prototype.constructor=hl,hl.prototype.isQuadraticBezierCurve3=!0,hl.prototype.getPoint=function(r,i){const n=i||new _e,l=this.v0,u=this.v1,h=this.v2;return n.set(Uf(r,l.x,u.x,h.x),Uf(r,l.y,u.y,h.y),Uf(r,l.z,u.z,h.z)),n},hl.prototype.copy=function(r){return mn.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},hl.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},hl.prototype.fromJSON=function(r){return mn.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Co(r){mn.call(this),this.type="SplineCurve",this.points=r||[]}Co.prototype=Object.create(mn.prototype),Co.prototype.constructor=Co,Co.prototype.isSplineCurve=!0,Co.prototype.getPoint=function(r,i){const n=i||new bt,l=this.points,u=(l.length-1)*r,h=Math.floor(u),p=u-h,g=l[h===0?h:h-1],_=l[h],b=l[h>l.length-2?l.length-1:h+1],A=l[h>l.length-3?l.length-1:h+2];return n.set(c_(p,g.x,_.x,b.x,A.x),c_(p,g.y,_.y,b.y,A.y)),n},Co.prototype.copy=function(r){mn.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(l.clone())}return this},Co.prototype.toJSON=function(){const r=mn.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const l=this.points[i];r.points.push(l.toArray())}return r},Co.prototype.fromJSON=function(r){mn.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(new bt().fromArray(l))}return this};var z1=Object.freeze({__proto__:null,ArcCurve:Bf,CatmullRomCurve3:js,CubicBezierCurve:Ao,CubicBezierCurve3:ul,EllipseCurve:xs,LineCurve:ts,LineCurve3:Lo,QuadraticBezierCurve:Ro,QuadraticBezierCurve3:hl,SplineCurve:Co});function ec(){mn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}ec.prototype=Object.assign(Object.create(mn.prototype),{constructor:ec,add:function(r){this.curves.push(r)},closePath:function(){const r=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);r.equals(i)||this.curves.push(new ts(i,r))},getPoint:function(r){const i=r*this.getLength(),n=this.getCurveLengths();let l=0;for(;l<n.length;){if(n[l]>=i){const u=n[l]-i,h=this.curves[l],p=h.getLength(),g=p===0?0:1-u/p;return h.getPointAt(g)}l++}return null},getLength:function(){const r=this.getCurveLengths();return r[r.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const r=[];let i=0;for(let n=0,l=this.curves.length;n<l;n++)i+=this.curves[n].getLength(),r.push(i);return this.cacheLengths=r,r},getSpacedPoints:function(r){r===void 0&&(r=40);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return this.autoClose&&i.push(i[0]),i},getPoints:function(r){r=r||12;const i=[];let n;for(let l=0,u=this.curves;l<u.length;l++){const h=u[l],p=h&&h.isEllipseCurve?r*2:h&&(h.isLineCurve||h.isLineCurve3)?1:h&&h.isSplineCurve?r*h.points.length:r,g=h.getPoints(p);for(let _=0;_<g.length;_++){const b=g[_];n&&n.equals(b)||(i.push(b),n=b)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(r){mn.prototype.copy.call(this,r),this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const l=r.curves[i];this.curves.push(l.clone())}return this.autoClose=r.autoClose,this},toJSON:function(){const r=mn.prototype.toJSON.call(this);r.autoClose=this.autoClose,r.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const l=this.curves[i];r.curves.push(l.toJSON())}return r},fromJSON:function(r){mn.prototype.fromJSON.call(this,r),this.autoClose=r.autoClose,this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const l=r.curves[i];this.curves.push(new z1[l.type]().fromJSON(l))}return this}});function Po(r){ec.call(this),this.type="Path",this.currentPoint=new bt,r&&this.setFromPoints(r)}Po.prototype=Object.assign(Object.create(ec.prototype),{constructor:Po,setFromPoints:function(r){this.moveTo(r[0].x,r[0].y);for(let i=1,n=r.length;i<n;i++)this.lineTo(r[i].x,r[i].y);return this},moveTo:function(r,i){return this.currentPoint.set(r,i),this},lineTo:function(r,i){const n=new ts(this.currentPoint.clone(),new bt(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this},quadraticCurveTo:function(r,i,n,l){const u=new Ro(this.currentPoint.clone(),new bt(r,i),new bt(n,l));return this.curves.push(u),this.currentPoint.set(n,l),this},bezierCurveTo:function(r,i,n,l,u,h){const p=new Ao(this.currentPoint.clone(),new bt(r,i),new bt(n,l),new bt(u,h));return this.curves.push(p),this.currentPoint.set(u,h),this},splineThru:function(r){const i=[this.currentPoint.clone()].concat(r),n=new Co(i);return this.curves.push(n),this.currentPoint.copy(r[r.length-1]),this},arc:function(r,i,n,l,u,h){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absarc(r+p,i+g,n,l,u,h),this},absarc:function(r,i,n,l,u,h){return this.absellipse(r,i,n,n,l,u,h),this},ellipse:function(r,i,n,l,u,h,p,g){const _=this.currentPoint.x,b=this.currentPoint.y;return this.absellipse(r+_,i+b,n,l,u,h,p,g),this},absellipse:function(r,i,n,l,u,h,p,g){const _=new xs(r,i,n,l,u,h,p,g);if(this.curves.length>0){const A=_.getPoint(0);A.equals(this.currentPoint)||this.lineTo(A.x,A.y)}this.curves.push(_);const b=_.getPoint(1);return this.currentPoint.copy(b),this},copy:function(r){return ec.prototype.copy.call(this,r),this.currentPoint.copy(r.currentPoint),this},toJSON:function(){const r=ec.prototype.toJSON.call(this);return r.currentPoint=this.currentPoint.toArray(),r},fromJSON:function(r){return ec.prototype.fromJSON.call(this,r),this.currentPoint.fromArray(r.currentPoint),this}});function mh(r){Po.call(this,r),this.uuid=zn.generateUUID(),this.type="Shape",this.holes=[]}mh.prototype=Object.assign(Object.create(Po.prototype),{constructor:mh,getPointsHoles:function(r){const i=[];for(let n=0,l=this.holes.length;n<l;n++)i[n]=this.holes[n].getPoints(r);return i},extractPoints:function(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}},copy:function(r){Po.prototype.copy.call(this,r),this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const l=r.holes[i];this.holes.push(l.clone())}return this},toJSON:function(){const r=Po.prototype.toJSON.call(this);r.uuid=this.uuid,r.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const l=this.holes[i];r.holes.push(l.toJSON())}return r},fromJSON:function(r){Po.prototype.fromJSON.call(this,r),this.uuid=r.uuid,this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const l=r.holes[i];this.holes.push(new Po().fromJSON(l))}return this}});function Qi(r,i){yn.call(this),this.type="Light",this.color=new Qt(r),this.intensity=i!==void 0?i:1}Qi.prototype=Object.assign(Object.create(yn.prototype),{constructor:Qi,isLight:!0,copy:function(r){return yn.prototype.copy.call(this,r),this.color.copy(r.color),this.intensity=r.intensity,this},toJSON:function(r){const i=yn.prototype.toJSON.call(this,r);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function u_(r,i,n){Qi.call(this,r,n),this.type="HemisphereLight",this.position.copy(yn.DefaultUp),this.updateMatrix(),this.groundColor=new Qt(i)}u_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:u_,isHemisphereLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.groundColor.copy(r.groundColor),this}});function fl(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new bt(512,512),this.map=null,this.mapPass=null,this.matrix=new Wn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sp,this._frameExtents=new bt(1,1),this._viewportCount=1,this._viewports=[new Hi(0,0,1,1)]}Object.assign(fl.prototype,{_projScreenMatrix:new Wn,_lightPositionWorld:new _e,_lookTarget:new _e,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(r){const i=this.camera,n=this.matrix,l=this._projScreenMatrix,u=this._lookTarget,h=this._lightPositionWorld;h.setFromMatrixPosition(r.matrixWorld),i.position.copy(h),u.setFromMatrixPosition(r.target.matrixWorld),i.lookAt(u),i.updateMatrixWorld(),l.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(i.projectionMatrix),n.multiply(i.matrixWorldInverse)},getViewport:function(r){return this._viewports[r]},getFrameExtents:function(){return this._frameExtents},copy:function(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}});function sv(){fl.call(this,new Jr(50,1,.5,500)),this.focus=1}sv.prototype=Object.assign(Object.create(fl.prototype),{constructor:sv,isSpotLightShadow:!0,updateMatrices:function(r){const i=this.camera,n=zn.RAD2DEG*2*r.angle*this.focus,l=this.mapSize.width/this.mapSize.height,u=r.distance||i.far;(n!==i.fov||l!==i.aspect||u!==i.far)&&(i.fov=n,i.aspect=l,i.far=u,i.updateProjectionMatrix()),fl.prototype.updateMatrices.call(this,r)}});function ov(r,i,n,l,u,h){Qi.call(this,r,i),this.type="SpotLight",this.position.copy(yn.DefaultUp),this.updateMatrix(),this.target=new yn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(p){this.intensity=p/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=l!==void 0?l:Math.PI/3,this.penumbra=u!==void 0?u:0,this.decay=h!==void 0?h:1,this.shadow=new sv}ov.prototype=Object.assign(Object.create(Qi.prototype),{constructor:ov,isSpotLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function lv(){fl.call(this,new Jr(90,1,.5,500)),this._frameExtents=new bt(4,2),this._viewportCount=6,this._viewports=[new Hi(2,1,1,1),new Hi(0,1,1,1),new Hi(3,1,1,1),new Hi(1,1,1,1),new Hi(3,0,1,1),new Hi(1,0,1,1)],this._cubeDirections=[new _e(1,0,0),new _e(-1,0,0),new _e(0,0,1),new _e(0,0,-1),new _e(0,1,0),new _e(0,-1,0)],this._cubeUps=[new _e(0,1,0),new _e(0,1,0),new _e(0,1,0),new _e(0,1,0),new _e(0,0,1),new _e(0,0,-1)]}lv.prototype=Object.assign(Object.create(fl.prototype),{constructor:lv,isPointLightShadow:!0,updateMatrices:function(r,i){i===void 0&&(i=0);const n=this.camera,l=this.matrix,u=this._lightPositionWorld,h=this._lookTarget,p=this._projScreenMatrix;u.setFromMatrixPosition(r.matrixWorld),n.position.copy(u),h.copy(n.position),h.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(h),n.updateMatrixWorld(),l.makeTranslation(-u.x,-u.y,-u.z),p.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(p)}});function cv(r,i,n,l){Qi.call(this,r,i),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(u){this.intensity=u/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=l!==void 0?l:1,this.shadow=new lv}cv.prototype=Object.assign(Object.create(Qi.prototype),{constructor:cv,isPointLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}});function Pp(r,i,n,l,u,h){jl.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r!==void 0?r:-1,this.right=i!==void 0?i:1,this.top=n!==void 0?n:1,this.bottom=l!==void 0?l:-1,this.near=u!==void 0?u:.1,this.far=h!==void 0?h:2e3,this.updateProjectionMatrix()}Pp.prototype=Object.assign(Object.create(jl.prototype),{constructor:Pp,isOrthographicCamera:!0,copy:function(r,i){return jl.prototype.copy.call(this,r,i),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this},setViewOffset:function(r,i,n,l,u,h){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=l,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,l=(this.top+this.bottom)/2;let u=n-r,h=n+r,p=l+i,g=l-i;if(this.view!==null&&this.view.enabled){const _=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u+=_*this.view.offsetX,h=u+_*this.view.width,p-=b*this.view.offsetY,g=p-b*this.view.height}this.projectionMatrix.makeOrthographic(u,h,p,g,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=yn.prototype.toJSON.call(this,r);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function uv(){fl.call(this,new Pp(-5,5,5,-5,.5,500))}uv.prototype=Object.assign(Object.create(fl.prototype),{constructor:uv,isDirectionalLightShadow:!0,updateMatrices:function(r){fl.prototype.updateMatrices.call(this,r)}});function hv(r,i){Qi.call(this,r,i),this.type="DirectionalLight",this.position.copy(yn.DefaultUp),this.updateMatrix(),this.target=new yn,this.shadow=new uv}hv.prototype=Object.assign(Object.create(Qi.prototype),{constructor:hv,isDirectionalLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function h_(r,i){Qi.call(this,r,i),this.type="AmbientLight"}h_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:h_,isAmbientLight:!0});function f_(r,i,n,l){Qi.call(this,r,i),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=l!==void 0?l:10}f_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:f_,isRectAreaLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.width=r.width,this.height=r.height,this},toJSON:function(r){const i=Qi.prototype.toJSON.call(this,r);return i.object.width=this.width,i.object.height=this.height,i}});class H1{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let i=0;i<9;i++)this.coefficients.push(new _e)}set(i){for(let n=0;n<9;n++)this.coefficients[n].copy(i[n]);return this}zero(){for(let i=0;i<9;i++)this.coefficients[i].set(0,0,0);return this}getAt(i,n){const l=i.x,u=i.y,h=i.z,p=this.coefficients;return n.copy(p[0]).multiplyScalar(.282095),n.addScaledVector(p[1],.488603*u),n.addScaledVector(p[2],.488603*h),n.addScaledVector(p[3],.488603*l),n.addScaledVector(p[4],1.092548*(l*u)),n.addScaledVector(p[5],1.092548*(u*h)),n.addScaledVector(p[6],.315392*(3*h*h-1)),n.addScaledVector(p[7],1.092548*(l*h)),n.addScaledVector(p[8],.546274*(l*l-u*u)),n}getIrradianceAt(i,n){const l=i.x,u=i.y,h=i.z,p=this.coefficients;return n.copy(p[0]).multiplyScalar(.886227),n.addScaledVector(p[1],2*.511664*u),n.addScaledVector(p[2],2*.511664*h),n.addScaledVector(p[3],2*.511664*l),n.addScaledVector(p[4],2*.429043*l*u),n.addScaledVector(p[5],2*.429043*u*h),n.addScaledVector(p[6],.743125*h*h-.247708),n.addScaledVector(p[7],2*.429043*l*h),n.addScaledVector(p[8],.429043*(l*l-u*u)),n}add(i){for(let n=0;n<9;n++)this.coefficients[n].add(i.coefficients[n]);return this}addScaledSH(i,n){for(let l=0;l<9;l++)this.coefficients[l].addScaledVector(i.coefficients[l],n);return this}scale(i){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(i);return this}lerp(i,n){for(let l=0;l<9;l++)this.coefficients[l].lerp(i.coefficients[l],n);return this}equals(i){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(i.coefficients[n]))return!1;return!0}copy(i){return this.set(i.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(i,n){n===void 0&&(n=0);const l=this.coefficients;for(let u=0;u<9;u++)l[u].fromArray(i,n+u*3);return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.coefficients;for(let u=0;u<9;u++)l[u].toArray(i,n+u*3);return i}static getBasisAt(i,n){const l=i.x,u=i.y,h=i.z;n[0]=.282095,n[1]=.488603*u,n[2]=.488603*h,n[3]=.488603*l,n[4]=1.092548*l*u,n[5]=1.092548*u*h,n[6]=.315392*(3*h*h-1),n[7]=1.092548*l*h,n[8]=.546274*(l*l-u*u)}}function Io(r,i){Qi.call(this,void 0,i),this.type="LightProbe",this.sh=r!==void 0?r:new H1}Io.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Io,isLightProbe:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.sh.copy(r.sh),this},fromJSON:function(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this},toJSON:function(r){const i=Qi.prototype.toJSON.call(this,r);return i.object.sh=this.sh.toArray(),i}});function d_(r){Ri.call(this,r),this.textures={}}d_.prototype=Object.assign(Object.create(Ri.prototype),{constructor:d_,load:function(r,i,n,l){const u=this,h=new Xs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i=this.textures;function n(u){return i[u]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",u),i[u]}const l=new L1[r.type];if(r.uuid!==void 0&&(l.uuid=r.uuid),r.name!==void 0&&(l.name=r.name),r.color!==void 0&&l.color.setHex(r.color),r.roughness!==void 0&&(l.roughness=r.roughness),r.metalness!==void 0&&(l.metalness=r.metalness),r.sheen!==void 0&&(l.sheen=new Qt().setHex(r.sheen)),r.emissive!==void 0&&l.emissive.setHex(r.emissive),r.specular!==void 0&&l.specular.setHex(r.specular),r.shininess!==void 0&&(l.shininess=r.shininess),r.clearcoat!==void 0&&(l.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(l.clearcoatRoughness=r.clearcoatRoughness),r.fog!==void 0&&(l.fog=r.fog),r.flatShading!==void 0&&(l.flatShading=r.flatShading),r.blending!==void 0&&(l.blending=r.blending),r.combine!==void 0&&(l.combine=r.combine),r.side!==void 0&&(l.side=r.side),r.opacity!==void 0&&(l.opacity=r.opacity),r.transparent!==void 0&&(l.transparent=r.transparent),r.alphaTest!==void 0&&(l.alphaTest=r.alphaTest),r.depthTest!==void 0&&(l.depthTest=r.depthTest),r.depthWrite!==void 0&&(l.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(l.colorWrite=r.colorWrite),r.stencilWrite!==void 0&&(l.stencilWrite=r.stencilWrite),r.stencilWriteMask!==void 0&&(l.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(l.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(l.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(l.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(l.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(l.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(l.stencilZPass=r.stencilZPass),r.wireframe!==void 0&&(l.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(l.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(l.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(l.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(l.rotation=r.rotation),r.linewidth!==1&&(l.linewidth=r.linewidth),r.dashSize!==void 0&&(l.dashSize=r.dashSize),r.gapSize!==void 0&&(l.gapSize=r.gapSize),r.scale!==void 0&&(l.scale=r.scale),r.polygonOffset!==void 0&&(l.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(l.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(l.polygonOffsetUnits=r.polygonOffsetUnits),r.skinning!==void 0&&(l.skinning=r.skinning),r.morphTargets!==void 0&&(l.morphTargets=r.morphTargets),r.morphNormals!==void 0&&(l.morphNormals=r.morphNormals),r.dithering!==void 0&&(l.dithering=r.dithering),r.vertexTangents!==void 0&&(l.vertexTangents=r.vertexTangents),r.visible!==void 0&&(l.visible=r.visible),r.toneMapped!==void 0&&(l.toneMapped=r.toneMapped),r.userData!==void 0&&(l.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?l.vertexColors=r.vertexColors>0:l.vertexColors=r.vertexColors),r.uniforms!==void 0)for(const u in r.uniforms){const h=r.uniforms[u];switch(l.uniforms[u]={},h.type){case"t":l.uniforms[u].value=n(h.value);break;case"c":l.uniforms[u].value=new Qt().setHex(h.value);break;case"v2":l.uniforms[u].value=new bt().fromArray(h.value);break;case"v3":l.uniforms[u].value=new _e().fromArray(h.value);break;case"v4":l.uniforms[u].value=new Hi().fromArray(h.value);break;case"m3":l.uniforms[u].value=new Ba().fromArray(h.value);break;case"m4":l.uniforms[u].value=new Wn().fromArray(h.value);break;default:l.uniforms[u].value=h.value}}if(r.defines!==void 0&&(l.defines=r.defines),r.vertexShader!==void 0&&(l.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(l.fragmentShader=r.fragmentShader),r.extensions!==void 0)for(const u in r.extensions)l.extensions[u]=r.extensions[u];if(r.shading!==void 0&&(l.flatShading=r.shading===1),r.size!==void 0&&(l.size=r.size),r.sizeAttenuation!==void 0&&(l.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(l.map=n(r.map)),r.matcap!==void 0&&(l.matcap=n(r.matcap)),r.alphaMap!==void 0&&(l.alphaMap=n(r.alphaMap)),r.bumpMap!==void 0&&(l.bumpMap=n(r.bumpMap)),r.bumpScale!==void 0&&(l.bumpScale=r.bumpScale),r.normalMap!==void 0&&(l.normalMap=n(r.normalMap)),r.normalMapType!==void 0&&(l.normalMapType=r.normalMapType),r.normalScale!==void 0){let u=r.normalScale;Array.isArray(u)===!1&&(u=[u,u]),l.normalScale=new bt().fromArray(u)}return r.displacementMap!==void 0&&(l.displacementMap=n(r.displacementMap)),r.displacementScale!==void 0&&(l.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(l.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(l.roughnessMap=n(r.roughnessMap)),r.metalnessMap!==void 0&&(l.metalnessMap=n(r.metalnessMap)),r.emissiveMap!==void 0&&(l.emissiveMap=n(r.emissiveMap)),r.emissiveIntensity!==void 0&&(l.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(l.specularMap=n(r.specularMap)),r.envMap!==void 0&&(l.envMap=n(r.envMap)),r.envMapIntensity!==void 0&&(l.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(l.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(l.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(l.lightMap=n(r.lightMap)),r.lightMapIntensity!==void 0&&(l.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(l.aoMap=n(r.aoMap)),r.aoMapIntensity!==void 0&&(l.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(l.gradientMap=n(r.gradientMap)),r.clearcoatMap!==void 0&&(l.clearcoatMap=n(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(l.clearcoatRoughnessMap=n(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(l.clearcoatNormalMap=n(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(l.clearcoatNormalScale=new bt().fromArray(r.clearcoatNormalScale)),r.transmission!==void 0&&(l.transmission=r.transmission),r.transmissionMap!==void 0&&(l.transmissionMap=n(r.transmissionMap)),l},setTextures:function(r){return this.textures=r,this}});const gh={decodeText:function(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let i="";for(let n=0,l=r.length;n<l;n++)i+=String.fromCharCode(r[n]);try{return decodeURIComponent(escape(i))}catch{return i}},extractUrlBase:function(r){const i=r.lastIndexOf("/");return i===-1?"./":r.substr(0,i+1)}};function Ip(){Ni.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Ip.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Ip,isInstancedBufferGeometry:!0,copy:function(r){return Ni.prototype.copy.call(this,r),this.instanceCount=r.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r=Ni.prototype.toJSON.call(this);return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}});function fv(r,i,n,l){typeof n=="number"&&(l=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Fn.call(this,r,i,n),this.meshPerAttribute=l||1}fv.prototype=Object.assign(Object.create(Fn.prototype),{constructor:fv,isInstancedBufferAttribute:!0,copy:function(r){return Fn.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},toJSON:function(){const r=Fn.prototype.toJSON.call(this);return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}});function p_(r){Ri.call(this,r)}p_.prototype=Object.assign(Object.create(Ri.prototype),{constructor:p_,load:function(r,i,n,l){const u=this,h=new Xs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i={},n={};function l(R,E){if(i[E]!==void 0)return i[E];const W=R.interleavedBuffers[E],V=u(R,W.buffer),B=new Dp[W.type](V),O=new Qa(B,W.stride);return O.uuid=W.uuid,i[E]=O,O}function u(R,E){if(n[E]!==void 0)return n[E];const W=R.arrayBuffers[E],V=new Uint32Array(W).buffer;return n[E]=V,V}const h=r.isInstancedBufferGeometry?new Ip:new Ni,p=r.data.index;if(p!==void 0){const R=new Dp[p.type](p.array);h.setIndex(new Fn(R,1))}const g=r.data.attributes;for(const R in g){const E=g[R];let N;if(E.isInterleavedBufferAttribute){const W=l(r.data,E.data);N=new Jl(W,E.itemSize,E.offset,E.normalized)}else{const W=new Dp[E.type](E.array),V=E.isInstancedBufferAttribute?fv:Fn;N=new V(W,E.itemSize,E.normalized)}E.name!==void 0&&(N.name=E.name),h.setAttribute(R,N)}const _=r.data.morphAttributes;if(_)for(const R in _){const E=_[R],N=[];for(let W=0,V=E.length;W<V;W++){const B=E[W];let O;if(B.isInterleavedBufferAttribute){const pe=l(r.data,B.data);O=new Jl(pe,B.itemSize,B.offset,B.normalized)}else{const pe=new Dp[B.type](B.array);O=new Fn(pe,B.itemSize,B.normalized)}B.name!==void 0&&(O.name=B.name),N.push(O)}h.morphAttributes[R]=N}r.data.morphTargetsRelative&&(h.morphTargetsRelative=!0);const A=r.data.groups||r.data.drawcalls||r.data.offsets;if(A!==void 0)for(let R=0,E=A.length;R!==E;++R){const N=A[R];h.addGroup(N.start,N.count,N.materialIndex)}const S=r.data.boundingSphere;if(S!==void 0){const R=new _e;S.center!==void 0&&R.fromArray(S.center),h.boundingSphere=new nl(R,S.radius)}return r.name&&(h.name=r.name),r.userData&&(h.userData=r.userData),h}});const Dp={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dv(r){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ri.call(this,r),this.options={premultiplyAlpha:"none"}}dv.prototype=Object.assign(Object.create(Ri.prototype),{constructor:dv,isImageBitmapLoader:!0,setOptions:function(i){return this.options=i,this},load:function(r,i,n,l){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=ph.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;const p={};p.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(r,p).then(function(g){return g.blob()}).then(function(g){return createImageBitmap(g,u.options)}).then(function(g){ph.add(r,g),i&&i(g),u.manager.itemEnd(r)}).catch(function(g){l&&l(g),u.manager.itemError(r),u.manager.itemEnd(r)}),u.manager.itemStart(r)}});function m_(){this.type="ShapePath",this.color=new Qt,this.subPaths=[],this.currentPath=null}Object.assign(m_.prototype,{moveTo:function(r,i){return this.currentPath=new Po,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,i),this},lineTo:function(r,i){return this.currentPath.lineTo(r,i),this},quadraticCurveTo:function(r,i,n,l){return this.currentPath.quadraticCurveTo(r,i,n,l),this},bezierCurveTo:function(r,i,n,l,u,h){return this.currentPath.bezierCurveTo(r,i,n,l,u,h),this},splineThru:function(r){return this.currentPath.splineThru(r),this},toShapes:function(r,i){function n(B){const O=[];for(let pe=0,ge=B.length;pe<ge;pe++){const ye=B[pe],$=new mh;$.curves=ye.curves,O.push($)}return O}function l(B,O){const pe=O.length;let ge=!1;for(let ye=pe-1,$=0;$<pe;ye=$++){let Ie=O[ye],tt=O[$],qe=tt.x-Ie.x,ft=tt.y-Ie.y;if(Math.abs(ft)>Number.EPSILON){if(ft<0&&(Ie=O[$],qe=-qe,tt=O[ye],ft=-ft),B.y<Ie.y||B.y>tt.y)continue;if(B.y===Ie.y){if(B.x===Ie.x)return!0}else{const je=ft*(B.x-Ie.x)-qe*(B.y-Ie.y);if(je===0)return!0;if(je<0)continue;ge=!ge}}else{if(B.y!==Ie.y)continue;if(tt.x<=B.x&&B.x<=Ie.x||Ie.x<=B.x&&B.x<=tt.x)return!0}}return ge}const u=Ql.isClockWise,h=this.subPaths;if(h.length===0)return[];if(i===!0)return n(h);let p,g,_;const b=[];if(h.length===1)return g=h[0],_=new mh,_.curves=g.curves,b.push(_),b;let A=!u(h[0].getPoints());A=r?!A:A;const S=[],R=[];let E=[],N=0,W;R[N]=void 0,E[N]=[];for(let B=0,O=h.length;B<O;B++)g=h[B],W=g.getPoints(),p=u(W),p=r?!p:p,p?(!A&&R[N]&&N++,R[N]={s:new mh,p:W},R[N].s.curves=g.curves,A&&N++,E[N]=[]):E[N].push({h:g,p:W[0]});if(!R[0])return n(h);if(R.length>1){let B=!1;const O=[];for(let pe=0,ge=R.length;pe<ge;pe++)S[pe]=[];for(let pe=0,ge=R.length;pe<ge;pe++){const ye=E[pe];for(let $=0;$<ye.length;$++){const Ie=ye[$];let tt=!0;for(let qe=0;qe<R.length;qe++)l(Ie.p,R[qe].p)&&(pe!==qe&&O.push({froms:pe,tos:qe,hole:$}),tt?(tt=!1,S[qe].push(Ie)):B=!0);tt&&S[pe].push(Ie)}}O.length>0&&(B||(E=S))}let V;for(let B=0,O=R.length;B<O;B++){_=R[B].s,b.push(_),V=E[B];for(let pe=0,ge=V.length;pe<ge;pe++)_.holes.push(V[pe].h)}return b}});function g_(r){this.type="Font",this.data=r}Object.assign(g_.prototype,{isFont:!0,generateShapes:function(r,i){i===void 0&&(i=100);const n=[],l=k1(r,i,this.data);for(let u=0,h=l.length;u<h;u++)Array.prototype.push.apply(n,l[u].toShapes());return n}});function k1(r,i,n){const l=Array.from?Array.from(r):String(r).split(""),u=i/n.resolution,h=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*u,p=[];let g=0,_=0;for(let b=0;b<l.length;b++){const A=l[b];if(A===`
`)g=0,_-=h;else{const S=V1(A,u,g,_,n);g+=S.offsetX,p.push(S.path)}}return p}function V1(r,i,n,l,u){const h=u.glyphs[r]||u.glyphs["?"];if(!h){console.error('THREE.Font: character "'+r+'" does not exists in font family '+u.familyName+".");return}const p=new m_;let g,_,b,A,S,R,E,N;if(h.o){const W=h._cachedOutline||(h._cachedOutline=h.o.split(" "));for(let V=0,B=W.length;V<B;)switch(W[V++]){case"m":g=W[V++]*i+n,_=W[V++]*i+l,p.moveTo(g,_);break;case"l":g=W[V++]*i+n,_=W[V++]*i+l,p.lineTo(g,_);break;case"q":b=W[V++]*i+n,A=W[V++]*i+l,S=W[V++]*i+n,R=W[V++]*i+l,p.quadraticCurveTo(S,R,b,A);break;case"b":b=W[V++]*i+n,A=W[V++]*i+l,S=W[V++]*i+n,R=W[V++]*i+l,E=W[V++]*i+n,N=W[V++]*i+l,p.bezierCurveTo(S,R,E,N,b,A);break}}return{offsetX:h.ha*i,path:p}}function v_(r){Ri.call(this,r)}v_.prototype=Object.assign(Object.create(Ri.prototype),{constructor:v_,load:function(r,i,n,l){const u=this,h=new Xs(this.manager);h.setPath(this.path),h.setRequestHeader(this.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){let g;try{g=JSON.parse(p)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),g=JSON.parse(p.substring(65,p.length-2))}const _=u.parse(g);i&&i(_)},n,l)},parse:function(r){return new g_(r)}});let Op;const W1={getContext:function(){return Op===void 0&&(Op=new(window.AudioContext||window.webkitAudioContext)),Op},setContext:function(r){Op=r}};function pv(r){Ri.call(this,r)}pv.prototype=Object.assign(Object.create(Ri.prototype),{constructor:pv,load:function(r,i,n,l){const u=this,h=new Xs(u.manager);h.setResponseType("arraybuffer"),h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{const g=p.slice(0);W1.getContext().decodeAudioData(g,function(b){i(b)})}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)}});function y_(r,i,n){Io.call(this,void 0,n);const l=new Qt().set(r),u=new Qt().set(i),h=new _e(l.r,l.g,l.b),p=new _e(u.r,u.g,u.b),g=Math.sqrt(Math.PI),_=g*Math.sqrt(.75);this.sh.coefficients[0].copy(h).add(p).multiplyScalar(g),this.sh.coefficients[1].copy(h).sub(p).multiplyScalar(_)}y_.prototype=Object.assign(Object.create(Io.prototype),{constructor:y_,isHemisphereLightProbe:!0,copy:function(r){return Io.prototype.copy.call(this,r),this},toJSON:function(r){return Io.prototype.toJSON.call(this,r)}});function __(r,i){Io.call(this,void 0,i);const n=new Qt().set(r);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}__.prototype=Object.assign(Object.create(Io.prototype),{constructor:__,isAmbientLightProbe:!0,copy:function(r){return Io.prototype.copy.call(this,r),this},toJSON:function(r){return Io.prototype.toJSON.call(this,r)}});const x_=new Wn,b_=new Wn;function q1(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Jr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Jr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(q1.prototype,{update:function(r){const i=this._cache;if(i.focus!==r.focus||i.fov!==r.fov||i.aspect!==r.aspect*this.aspect||i.near!==r.near||i.far!==r.far||i.zoom!==r.zoom||i.eyeSep!==this.eyeSep){i.focus=r.focus,i.fov=r.fov,i.aspect=r.aspect*this.aspect,i.near=r.near,i.far=r.far,i.zoom=r.zoom,i.eyeSep=this.eyeSep;const l=r.projectionMatrix.clone(),u=i.eyeSep/2,h=u*i.near/i.focus,p=i.near*Math.tan(zn.DEG2RAD*i.fov*.5)/i.zoom;let g,_;b_.elements[12]=-u,x_.elements[12]=u,g=-p*i.aspect+h,_=p*i.aspect+h,l.elements[0]=2*i.near/(_-g),l.elements[8]=(_+g)/(_-g),this.cameraL.projectionMatrix.copy(l),g=-p*i.aspect-h,_=p*i.aspect-h,l.elements[0]=2*i.near/(_-g),l.elements[8]=(_+g)/(_-g),this.cameraR.projectionMatrix.copy(l)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(b_),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(x_)}});class X1 extends yn{constructor(i){super(),this.type="Audio",this.listener=i,this.context=i.context,this.gain=this.context.createGain(),this.gain.connect(i.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(i){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=i,this.connect(),this}setMediaElementSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(i),this.connect(),this}setMediaStreamSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(i),this.connect(),this}setBuffer(i){return this.buffer=i,this.sourceType="buffer",this.autoplay&&this.play(),this}play(i){if(i===void 0&&(i=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+i;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(i){return i||(i=[]),this._connected===!0?(this.disconnect(),this.filters=i,this.connect()):this.filters=i,this}setDetune(i){if(this.detune=i,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(i){return this.setFilters(i?[i]:[])}setPlaybackRate(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=i,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=i,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(i){return this.loopStart=i,this}setLoopEnd(i){return this.loopEnd=i,this}getVolume(){return this.gain.gain.value}setVolume(i){return this.gain.gain.setTargetAtTime(i,this.context.currentTime,.01),this}}function w_(r,i,n){this.binding=r,this.valueSize=n;let l,u,h;switch(i){case"quaternion":l=this._slerp,u=this._slerpAdditive,h=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":l=this._select,u=this._select,h=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:l=this._lerp,u=this._lerpAdditive,h=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=l,this._mixBufferRegionAdditive=u,this._setIdentity=h,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(w_.prototype,{accumulate:function(r,i){const n=this.buffer,l=this.valueSize,u=r*l+l;let h=this.cumulativeWeight;if(h===0){for(let p=0;p!==l;++p)n[u+p]=n[p];h=i}else{h+=i;const p=i/h;this._mixBufferRegion(n,u,0,p,l)}this.cumulativeWeight=h},accumulateAdditive:function(r){const i=this.buffer,n=this.valueSize,l=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,l,0,r,n),this.cumulativeWeightAdditive+=r},apply:function(r){const i=this.valueSize,n=this.buffer,l=r*i+i,u=this.cumulativeWeight,h=this.cumulativeWeightAdditive,p=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,u<1){const g=i*this._origIndex;this._mixBufferRegion(n,l,g,1-u,i)}h>0&&this._mixBufferRegionAdditive(n,l,this._addIndex*i,1,i);for(let g=i,_=i+i;g!==_;++g)if(n[g]!==n[g+i]){p.setValue(n,l);break}},saveOriginalState:function(){const r=this.binding,i=this.buffer,n=this.valueSize,l=n*this._origIndex;r.getValue(i,l);for(let u=n,h=l;u!==h;++u)i[u]=i[l+u%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const r=this.valueSize*3;this.binding.setValue(this.buffer,r)},_setAdditiveIdentityNumeric:function(){const r=this._addIndex*this.valueSize,i=r+this.valueSize;for(let n=r;n<i;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const r=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[r+n]},_select:function(r,i,n,l,u){if(l>=.5)for(let h=0;h!==u;++h)r[i+h]=r[n+h]},_slerp:function(r,i,n,l){Ta.slerpFlat(r,i,r,i,r,n,l)},_slerpAdditive:function(r,i,n,l,u){const h=this._workIndex*u;Ta.multiplyQuaternionsFlat(r,h,r,i,r,n),Ta.slerpFlat(r,i,r,i,r,h,l)},_lerp:function(r,i,n,l,u){const h=1-l;for(let p=0;p!==u;++p){const g=i+p;r[g]=r[g]*h+r[n+p]*l}},_lerpAdditive:function(r,i,n,l,u){for(let h=0;h!==u;++h){const p=i+h;r[p]=r[p]+r[n+h]*l}}});const mv="\\[\\]\\.:\\/",j1=new RegExp("["+mv+"]","g"),gv="[^"+mv+"]",Y1="[^"+mv.replace("\\.","")+"]",Z1=/((?:WC+[\/:])*)/.source.replace("WC",gv),J1=/(WCOD+)?/.source.replace("WCOD",Y1),K1=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gv),$1=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gv),Q1=new RegExp("^"+Z1+J1+K1+$1+"$"),eA=["material","materials","bones"];function M_(r,i,n){const l=n||pa.parseTrackName(i);this._targetGroup=r,this._bindings=r.subscribe_(i,l)}Object.assign(M_.prototype,{getValue:function(r,i){this.bind();const n=this._targetGroup.nCachedObjects_,l=this._bindings[n];l!==void 0&&l.getValue(r,i)},setValue:function(r,i){const n=this._bindings;for(let l=this._targetGroup.nCachedObjects_,u=n.length;l!==u;++l)n[l].setValue(r,i)},bind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].bind()},unbind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].unbind()}});function pa(r,i,n){this.path=i,this.parsedPath=n||pa.parseTrackName(i),this.node=pa.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r}Object.assign(pa,{Composite:M_,create:function(r,i,n){return r&&r.isAnimationObjectGroup?new pa.Composite(r,i,n):new pa(r,i,n)},sanitizeNodeName:function(r){return r.replace(/\s/g,"_").replace(j1,"")},parseTrackName:function(r){const i=Q1.exec(r);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},l=n.nodeName&&n.nodeName.lastIndexOf(".");if(l!==void 0&&l!==-1){const u=n.nodeName.substring(l+1);eA.indexOf(u)!==-1&&(n.nodeName=n.nodeName.substring(0,l),n.objectName=u)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return n},findNode:function(r,i){if(!i||i===""||i==="."||i===-1||i===r.name||i===r.uuid)return r;if(r.skeleton){const n=r.skeleton.getBoneByName(i);if(n!==void 0)return n}if(r.children){const n=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===i||p.uuid===i)return p;const g=n(p.children);if(g)return g}return null},l=n(r.children);if(l)return l}return null}}),Object.assign(pa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(i,n){i[n]=this.node[this.propertyName]},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)i[n++]=l[u]},function(i,n){i[n]=this.resolvedProperty[this.propertyIndex]},function(i,n){this.resolvedProperty.toArray(i,n)}],SetterByBindingTypeAndVersioning:[[function(i,n){this.targetObject[this.propertyName]=i[n]},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++]},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++];this.targetObject.needsUpdate=!0},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty[this.propertyIndex]=i[n]},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty.fromArray(i,n)},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(i,n){this.bind(),this.getValue(i,n)},setValue:function(i,n){this.bind(),this.setValue(i,n)},bind:function(){let r=this.node;const i=this.parsedPath,n=i.objectName,l=i.propertyName;let u=i.propertyIndex;if(r||(r=pa.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let _=i.objectIndex;switch(n){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(let b=0;b<r.length;b++)if(r[b].name===_){_=b;break}break;default:if(r[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[n]}if(_!==void 0){if(r[_]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[_]}}const h=r[l];if(h===void 0){const _=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+_+"."+l+" but it wasn't found.",r);return}let p=this.Versioning.None;this.targetObject=r,r.needsUpdate!==void 0?p=this.Versioning.NeedsUpdate:r.matrixWorldNeedsUpdate!==void 0&&(p=this.Versioning.MatrixWorldNeedsUpdate);let g=this.BindingType.Direct;if(u!==void 0){if(l==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(r.geometry.isBufferGeometry){if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}r.morphTargetDictionary[u]!==void 0&&(u=r.morphTargetDictionary[u])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}g=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else h.fromArray!==void 0&&h.toArray!==void 0?(g=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(g=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[g],this.setValue=this.SetterByBindingTypeAndVersioning[g][p]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(pa.prototype,{_getValue_unbound:pa.prototype.getValue,_setValue_unbound:pa.prototype.setValue});function tA(){this.uuid=zn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const r={};this._indicesByUUID=r;for(let n=0,l=arguments.length;n!==l;++n)r[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(tA.prototype,{isAnimationObjectGroup:!0,add:function(){const r=this._objects,i=this._indicesByUUID,n=this._paths,l=this._parsedPaths,u=this._bindings,h=u.length;let p,g=r.length,_=this.nCachedObjects_;for(let b=0,A=arguments.length;b!==A;++b){const S=arguments[b],R=S.uuid;let E=i[R];if(E===void 0){E=g++,i[R]=E,r.push(S);for(let N=0,W=h;N!==W;++N)u[N].push(new pa(S,n[N],l[N]))}else if(E<_){p=r[E];const N=--_,W=r[N];i[W.uuid]=E,r[E]=W,i[R]=N,r[N]=S;for(let V=0,B=h;V!==B;++V){const O=u[V],pe=O[N];let ge=O[E];O[E]=pe,ge===void 0&&(ge=new pa(S,n[V],l[V])),O[N]=ge}}else r[E]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=_},remove:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,l=n.length;let u=this.nCachedObjects_;for(let h=0,p=arguments.length;h!==p;++h){const g=arguments[h],_=g.uuid,b=i[_];if(b!==void 0&&b>=u){const A=u++,S=r[A];i[S.uuid]=b,r[b]=S,i[_]=A,r[A]=g;for(let R=0,E=l;R!==E;++R){const N=n[R],W=N[A],V=N[b];N[b]=W,N[A]=V}}}this.nCachedObjects_=u},uncache:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,l=n.length;let u=this.nCachedObjects_,h=r.length;for(let p=0,g=arguments.length;p!==g;++p){const _=arguments[p],b=_.uuid,A=i[b];if(A!==void 0)if(delete i[b],A<u){const S=--u,R=r[S],E=--h,N=r[E];i[R.uuid]=A,r[A]=R,i[N.uuid]=S,r[S]=N,r.pop();for(let W=0,V=l;W!==V;++W){const B=n[W],O=B[S],pe=B[E];B[A]=O,B[S]=pe,B.pop()}}else{const S=--h,R=r[S];i[R.uuid]=A,r[A]=R,r.pop();for(let E=0,N=l;E!==N;++E){const W=n[E];W[A]=W[S],W.pop()}}}this.nCachedObjects_=u},subscribe_:function(r,i){const n=this._bindingsIndicesByPath;let l=n[r];const u=this._bindings;if(l!==void 0)return u[l];const h=this._paths,p=this._parsedPaths,g=this._objects,_=g.length,b=this.nCachedObjects_,A=new Array(_);l=u.length,n[r]=l,h.push(r),p.push(i),u.push(A);for(let S=b,R=g.length;S!==R;++S){const E=g[S];A[S]=new pa(E,r,i)}return A},unsubscribe_:function(r){const i=this._bindingsIndicesByPath,n=i[r];if(n!==void 0){const l=this._paths,u=this._parsedPaths,h=this._bindings,p=h.length-1,g=h[p],_=r[p];i[_]=n,h[n]=g,h.pop(),u[n]=u[p],u.pop(),l[n]=l[p],l.pop()}}});class nA{constructor(i,n,l,u){this._mixer=i,this._clip=n,this._localRoot=l||null,this.blendMode=u||n.blendMode;const h=n.tracks,p=h.length,g=new Array(p),_={endingStart:Ou,endingEnd:Ou};for(let b=0;b!==p;++b){const A=h[b].createInterpolant(null);g[b]=A,A.settings=_}this._interpolantSettings=_,this._interpolants=g,this._propertyBindings=new Array(p),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ew,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,n){return this.loop=i,this.repetitions=n,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,n,l){if(i.fadeOut(n),this.fadeIn(n),l){const u=this._clip.duration,h=i._clip.duration,p=h/u,g=u/h;i.warp(1,p,n),this.warp(g,1,n)}return this}crossFadeTo(i,n,l){return i.crossFadeFrom(this,n,l)}stopFading(){const i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,n,l){const u=this._mixer,h=u.time,p=this.timeScale;let g=this._timeScaleInterpolant;g===null&&(g=u._lendControlInterpolant(),this._timeScaleInterpolant=g);const _=g.parameterPositions,b=g.sampleValues;return _[0]=h,_[1]=h+l,b[0]=i/p,b[1]=n/p,this}stopWarping(){const i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,n,l,u){if(!this.enabled){this._updateWeight(i);return}const h=this._startTime;if(h!==null){const _=(i-h)*l;if(_<0||l===0)return;this._startTime=null,n=l*_}n*=this._updateTimeScale(i);const p=this._updateTime(n),g=this._updateWeight(i);if(g>0){const _=this._interpolants,b=this._propertyBindings;switch(this.blendMode){case Jy:for(let A=0,S=_.length;A!==S;++A)_[A].evaluate(p),b[A].accumulateAdditive(g);break;case og:default:for(let A=0,S=_.length;A!==S;++A)_[A].evaluate(p),b[A].accumulate(u,g)}}}_updateWeight(i){let n=0;if(this.enabled){n=this.weight;const l=this._weightInterpolant;if(l!==null){const u=l.evaluate(i)[0];n*=u,i>l.parameterPositions[1]&&(this.stopFading(),u===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(i){let n=0;if(!this.paused){n=this.timeScale;const l=this._timeScaleInterpolant;l!==null&&(n*=l.evaluate(i)[0],i>l.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n}_updateTime(i){const n=this._clip.duration,l=this.loop;let u=this.time+i,h=this._loopCount;const p=l===Aw;if(i===0)return h===-1?u:p&&(h&1)===1?n-u:u;if(l===Tw){h===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(u>=n)u=n;else if(u<0)u=0;else{this.time=u;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(h===-1&&(i>=0?(h=0,this._setEndings(!0,this.repetitions===0,p)):this._setEndings(this.repetitions===0,!0,p)),u>=n||u<0){const g=Math.floor(u/n);u-=n*g,h+=Math.abs(g);const _=this.repetitions-h;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,u=i>0?n:0,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(_===1){const b=i<0;this._setEndings(b,!b,p)}else this._setEndings(!1,!1,p);this._loopCount=h,this.time=u,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:g})}}else this.time=u;if(p&&(h&1)===1)return n-u}return u}_setEndings(i,n,l){const u=this._interpolantSettings;l?(u.endingStart=Nu,u.endingEnd=Nu):(i?u.endingStart=this.zeroSlopeAtStart?Nu:Ou:u.endingStart=kd,n?u.endingEnd=this.zeroSlopeAtEnd?Nu:Ou:u.endingEnd=kd)}_scheduleFading(i,n,l){const u=this._mixer,h=u.time;let p=this._weightInterpolant;p===null&&(p=u._lendControlInterpolant(),this._weightInterpolant=p);const g=p.parameterPositions,_=p.sampleValues;return g[0]=h,_[0]=n,g[1]=h+i,_[1]=l,this}}function S_(r){this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}S_.prototype=Object.assign(Object.create(Us.prototype),{constructor:S_,_bindAction:function(r,i){const n=r._localRoot||this._root,l=r._clip.tracks,u=l.length,h=r._propertyBindings,p=r._interpolants,g=n.uuid,_=this._bindingsByRootAndName;let b=_[g];b===void 0&&(b={},_[g]=b);for(let A=0;A!==u;++A){const S=l[A],R=S.name;let E=b[R];if(E!==void 0)h[A]=E;else{if(E=h[A],E!==void 0){E._cacheIndex===null&&(++E.referenceCount,this._addInactiveBinding(E,g,R));continue}const N=i&&i._propertyBindings[A].binding.parsedPath;E=new w_(pa.create(n,R,N),S.ValueTypeName,S.getValueSize()),++E.referenceCount,this._addInactiveBinding(E,g,R),h[A]=E}p[A].resultBuffer=E.buffer}},_activateAction:function(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){const n=(r._localRoot||this._root).uuid,l=r._clip.uuid,u=this._actionsByClip[l];this._bindAction(r,u&&u.knownActions[0]),this._addInactiveAction(r,l,n)}const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];u.useCount++===0&&(this._lendBinding(u),u.saveOriginalState())}this._lendAction(r)}},_deactivateAction:function(r){if(this._isActiveAction(r)){const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];--u.useCount===0&&(u.restoreOriginalState(),this._takeBackBinding(u))}this._takeBackAction(r)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}},_isActiveAction:function(r){const i=r._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(r,i,n){const l=this._actions,u=this._actionsByClip;let h=u[i];if(h===void 0)h={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,u[i]=h;else{const p=h.knownActions;r._byClipCacheIndex=p.length,p.push(r)}r._cacheIndex=l.length,l.push(r),h.actionByRoot[n]=r},_removeInactiveAction:function(r){const i=this._actions,n=i[i.length-1],l=r._cacheIndex;n._cacheIndex=l,i[l]=n,i.pop(),r._cacheIndex=null;const u=r._clip.uuid,h=this._actionsByClip,p=h[u],g=p.knownActions,_=g[g.length-1],b=r._byClipCacheIndex;_._byClipCacheIndex=b,g[b]=_,g.pop(),r._byClipCacheIndex=null;const A=p.actionByRoot,S=(r._localRoot||this._root).uuid;delete A[S],g.length===0&&delete h[u],this._removeInactiveBindingsForAction(r)},_removeInactiveBindingsForAction:function(r){const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];--u.referenceCount===0&&this._removeInactiveBinding(u)}},_lendAction:function(r){const i=this._actions,n=r._cacheIndex,l=this._nActiveActions++,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_takeBackAction:function(r){const i=this._actions,n=r._cacheIndex,l=--this._nActiveActions,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_addInactiveBinding:function(r,i,n){const l=this._bindingsByRootAndName,u=this._bindings;let h=l[i];h===void 0&&(h={},l[i]=h),h[n]=r,r._cacheIndex=u.length,u.push(r)},_removeInactiveBinding:function(r){const i=this._bindings,n=r.binding,l=n.rootNode.uuid,u=n.path,h=this._bindingsByRootAndName,p=h[l],g=i[i.length-1],_=r._cacheIndex;g._cacheIndex=_,i[_]=g,i.pop(),delete p[u],Object.keys(p).length===0&&delete h[l]},_lendBinding:function(r){const i=this._bindings,n=r._cacheIndex,l=this._nActiveBindings++,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_takeBackBinding:function(r){const i=this._bindings,n=r._cacheIndex,l=--this._nActiveBindings,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_lendControlInterpolant:function(){const r=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=r[i];return n===void 0&&(n=new Ap(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=i,r[i]=n),n},_takeBackControlInterpolant:function(r){const i=this._controlInterpolants,n=r.__cacheIndex,l=--this._nActiveControlInterpolants,u=i[l];r.__cacheIndex=l,i[l]=r,u.__cacheIndex=n,i[n]=u},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(r,i,n){const l=i||this._root,u=l.uuid;let h=typeof r=="string"?Ws.findByName(l,r):r;const p=h!==null?h.uuid:r,g=this._actionsByClip[p];let _=null;if(n===void 0&&(h!==null?n=h.blendMode:n=og),g!==void 0){const A=g.actionByRoot[u];if(A!==void 0&&A.blendMode===n)return A;_=g.knownActions[0],h===null&&(h=_._clip)}if(h===null)return null;const b=new nA(this,h,i,n);return this._bindAction(b,_),this._addInactiveAction(b,p,u),b},existingAction:function(r,i){const n=i||this._root,l=n.uuid,u=typeof r=="string"?Ws.findByName(n,r):r,h=u?u.uuid:r,p=this._actionsByClip[h];return p!==void 0&&p.actionByRoot[l]||null},stopAllAction:function(){const r=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)r[n].stop();return this},update:function(r){r*=this.timeScale;const i=this._actions,n=this._nActiveActions,l=this.time+=r,u=Math.sign(r),h=this._accuIndex^=1;for(let _=0;_!==n;++_)i[_]._update(l,r,u,h);const p=this._bindings,g=this._nActiveBindings;for(let _=0;_!==g;++_)p[_].apply(h);return this},setTime:function(r){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(r)},getRoot:function(){return this._root},uncacheClip:function(r){const i=this._actions,n=r.uuid,l=this._actionsByClip,u=l[n];if(u!==void 0){const h=u.knownActions;for(let p=0,g=h.length;p!==g;++p){const _=h[p];this._deactivateAction(_);const b=_._cacheIndex,A=i[i.length-1];_._cacheIndex=null,_._byClipCacheIndex=null,A._cacheIndex=b,i[b]=A,i.pop(),this._removeInactiveBindingsForAction(_)}delete l[n]}},uncacheRoot:function(r){const i=r.uuid,n=this._actionsByClip;for(const h in n){const p=n[h].actionByRoot,g=p[i];g!==void 0&&(this._deactivateAction(g),this._removeInactiveAction(g))}const l=this._bindingsByRootAndName,u=l[i];if(u!==void 0)for(const h in u){const p=u[h];p.restoreOriginalState(),this._removeInactiveBinding(p)}},uncacheAction:function(r,i){const n=this.existingAction(r,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});class vv{constructor(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}clone(){return new vv(this.value.clone===void 0?this.value:this.value.clone())}}function T_(r,i,n){Qa.call(this,r,i),this.meshPerAttribute=n||1}T_.prototype=Object.assign(Object.create(Qa.prototype),{constructor:T_,isInstancedInterleavedBuffer:!0,copy:function(r){return Qa.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},clone:function(r){const i=Qa.prototype.clone.call(this,r);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(r){const i=Qa.prototype.toJSON.call(this,r);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function E_(r,i,n,l,u){this.buffer=r,this.type=i,this.itemSize=n,this.elementSize=l,this.count=u,this.version=0}Object.defineProperty(E_.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(E_.prototype,{isGLBufferAttribute:!0,setBuffer:function(r){return this.buffer=r,this},setType:function(r,i){return this.type=r,this.elementSize=i,this},setItemSize:function(r){return this.itemSize=r,this},setCount:function(r){return this.count=r,this}});function A_(r,i,n,l){this.ray=new hf(r,i),this.near=n||0,this.far=l||1/0,this.camera=null,this.layers=new r0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function L_(r,i){return r.distance-i.distance}function yv(r,i,n,l){if(r.layers.test(i.layers)&&r.raycast(i,n),l===!0){const u=r.children;for(let h=0,p=u.length;h<p;h++)yv(u[h],i,n,!0)}}Object.assign(A_.prototype,{set:function(r,i){this.ray.set(r,i)},setFromCamera:function(r,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(r,i,n){const l=n||[];return yv(r,this,l,i),l.sort(L_),l},intersectObjects:function(r,i,n){const l=n||[];if(Array.isArray(r)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),l;for(let u=0,h=r.length;u<h;u++)yv(r[u],this,l,i);return l.sort(L_),l}});class R_{constructor(i=1,n=0,l=0){return this.radius=i,this.phi=n,this.theta=l,this}set(i,n,l){return this.radius=i,this.phi=n,this.theta=l,this}clone(){return new this.constructor().copy(this)}copy(i){return this.radius=i.radius,this.phi=i.phi,this.theta=i.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(i){return this.setFromCartesianCoords(i.x,i.y,i.z)}setFromCartesianCoords(i,n,l){return this.radius=Math.sqrt(i*i+n*n+l*l),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(i,l),this.phi=Math.acos(zn.clamp(n/this.radius,-1,1))),this}}const C_=new bt;class iA{constructor(i,n){Object.defineProperty(this,"isBox2",{value:!0}),this.min=i!==void 0?i:new bt(1/0,1/0),this.max=n!==void 0?n:new bt(-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromPoints(i){this.makeEmpty();for(let n=0,l=i.length;n<l;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const l=C_.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(l),this.max.copy(i).add(l),this}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(i){return i===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),i=new bt),this.isEmpty()?i.set(0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),i=new bt),this.isEmpty()?i.set(0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new bt),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y)}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new bt),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return C_.copy(i).clamp(this.min,this.max).sub(i).length()}intersect(i){return this.min.max(i.min),this.max.min(i.max),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function Np(r){yn.call(this),this.material=r,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Np.prototype=Object.create(yn.prototype),Np.prototype.constructor=Np,Np.prototype.isImmediateRenderObject=!0;const tc=new _e,Fp=new Wn,_v=new Wn;class rA extends Lf{constructor(i){const n=P_(i),l=new Ni,u=[],h=[],p=new Qt(0,0,1),g=new Qt(0,1,0);for(let b=0;b<n.length;b++){const A=n[b];A.parent&&A.parent.isBone&&(u.push(0,0,0),u.push(0,0,0),h.push(p.r,p.g,p.b),h.push(g.r,g.g,g.b))}l.setAttribute("position",new wi(u,3)),l.setAttribute("color",new wi(h,3));const _=new es({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(l,_),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=n,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const n=this.bones,l=this.geometry,u=l.getAttribute("position");_v.getInverse(this.root.matrixWorld);for(let h=0,p=0;h<n.length;h++){const g=n[h];g.parent&&g.parent.isBone&&(Fp.multiplyMatrices(_v,g.matrixWorld),tc.setFromMatrixPosition(Fp),u.setXYZ(p,tc.x,tc.y,tc.z),Fp.multiplyMatrices(_v,g.parent.matrixWorld),tc.setFromMatrixPosition(Fp),u.setXYZ(p+1,tc.x,tc.y,tc.z),p+=2)}l.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}function P_(r){const i=[];r&&r.isBone&&i.push(r);for(let n=0;n<r.children.length;n++)i.push.apply(i,P_(r.children[n]));return i}class aA extends Lf{constructor(i,n,l,u){i=i||10,n=n||10,l=new Qt(l!==void 0?l:4473924),u=new Qt(u!==void 0?u:8947848);const h=n/2,p=i/n,g=i/2,_=[],b=[];for(let R=0,E=0,N=-g;R<=n;R++,N+=p){_.push(-g,0,N,g,0,N),_.push(N,0,-g,N,0,g);const W=R===h?l:u;W.toArray(b,E),E+=3,W.toArray(b,E),E+=3,W.toArray(b,E),E+=3,W.toArray(b,E),E+=3}const A=new Ni;A.setAttribute("position",new wi(_,3)),A.setAttribute("color",new wi(b,3));const S=new es({vertexColors:!0,toneMapped:!1});super(A,S),this.type="GridHelper"}}mn.create=function(r,i){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(mn.prototype),r.prototype.constructor=r,r.prototype.getPoint=i,r},Object.assign(ec.prototype,{createPointsGeometry:function(r){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getPoints(r);return this.createGeometry(i)},createSpacedPointsGeometry:function(r){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getSpacedPoints(r);return this.createGeometry(i)},createGeometry:function(r){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=new Vs;for(let n=0,l=r.length;n<l;n++){const u=r[n];i.vertices.push(new _e(u.x,u.y,u.z||0))}return i}}),Object.assign(Po.prototype,{fromPoints:function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)}});function I_(r){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),js.call(this,r),this.type="catmullrom"}I_.prototype=Object.create(js.prototype),Object.assign(I_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),aA.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},rA.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ri.prototype,{extractUrlBase:function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),gh.extractUrlBase(r)}}),Ri.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(iA.prototype,{center:function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},size:function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(el.prototype,{center:function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionSphere:function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},size:function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(nl.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),sp.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)},Object.assign(zn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(r){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),zn.floorPowerOfTwo(r)},nextPowerOfTwo:function(r){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),zn.ceilPowerOfTwo(r)}}),Object.assign(Ba.prototype,{flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},multiplyVector3:function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Wn.prototype,{extractPosition:function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)},flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new _e().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector4:function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)},crossVector:function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(r,i,n,l,u,h){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,i,l,n,u,h)}}),al.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)},Ta.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)},Object.assign(hf.prototype,{isIntersectionBox:function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionPlane:function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)},isIntersectionSphere:function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)}}),Object.assign(ha.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,i)},midpoint:function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)},normal:function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)},plane:function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)}}),Object.assign(ha,{barycoordFromPoint:function(r,i,n,l,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ha.getBarycoord(r,i,n,l,u)},normal:function(r,i,n,l){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ha.getNormal(r,i,n,l)}}),Object.assign(mh.prototype,{extractAllPoints:function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)},extrude:function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new w1(this,r)},makeGeometry:function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new E1(this,r)}}),Object.assign(bt.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_e.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)},getScaleFromMatrix:function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)},getColumnFromMatrix:function(r,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,r)},applyProjection:function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)},fromAttribute:function(r,i,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Hi.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Vs.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(r){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.assign(yn.prototype,{getChildByName:function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(r,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,r)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(yn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(ra.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(ra.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Lw},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Gg.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(dp.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),fp.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(mn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(r){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=r}}),Jr.prototype.setLens=function(r,i){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),i!==void 0&&(this.filmGauge=i),this.setFocalLength(r)},Object.defineProperties(Qi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}}),Object.defineProperties(Fn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===lf},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(lf)}}}),Object.assign(Fn.prototype,{setDynamic:function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?lf:Wd),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ni.prototype,{addIndex:function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)},addAttribute:function(r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new Fn(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(r,i)},addDrawCall:function(r,i,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)},applyMatrix:function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(Ni.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Ip.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(r){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=r}}}),Object.defineProperties(A_.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(r){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=r}}}),Object.defineProperties(Qa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===lf},set:function(r){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(r)}}}),Object.assign(Qa.prototype,{setDynamic:function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?lf:Wd),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(s_.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(e1.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(vv.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Tn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Qt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===$o}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}}}),Object.defineProperties(jc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(cl.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(r){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=r}}}),Object.defineProperties(Ua.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}}),Object.assign(op.prototype,{clearTarget:function(r,i,n,l){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(i,n,l)},animate:function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(op.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?Vd:Fc}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(B0.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Gs.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}}),Object.defineProperties(X1.prototype,{load:{value:function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const i=this;return new pv().load(r,function(l){i.setBuffer(l)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),yf.prototype.updateCubeMap=function(r,i){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,i)},Uc.crossOrigin=void 0,Uc.loadTexture=function(r,i,n,l){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const u=new Rp;u.setCrossOrigin(this.crossOrigin);const h=u.load(r,n,void 0,l);return i&&(h.mapping=i),h},Uc.loadTextureCube=function(r,i,n,l){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const u=new tv;u.setCrossOrigin(this.crossOrigin);const h=u.load(r,n,void 0,l);return i&&(h.mapping=i),h},Uc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Uc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Hr}}));var zf=function(r,i){i===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=r,this.domElement=i,this.enabled=!0,this.target=new _e,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:kr.ROTATE,MIDDLE:kr.DOLLY,RIGHT:kr.PAN},this.touches={ONE:ta.ROTATE,TWO:ta.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return b.phi},this.getAzimuthalAngle=function(){return b.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(l),n.update(),g=p.NONE},this.update=function(){var me=new _e,it=new Ta().setFromUnitVectors(r.up,new _e(0,1,0)),Rt=it.clone().inverse(),mt=new _e,Nt=new Ta,gn=2*Math.PI;return function(){var Or=n.object.position;me.copy(Or).sub(n.target),me.applyQuaternion(it),b.setFromVector3(me),n.autoRotate&&g===p.NONE&&qe(Ie()),n.enableDamping?(b.theta+=A.theta*n.dampingFactor,b.phi+=A.phi*n.dampingFactor):(b.theta+=A.theta,b.phi+=A.phi);var er=n.minAzimuthAngle,Vr=n.maxAzimuthAngle;return isFinite(er)&&isFinite(Vr)&&(er<-Math.PI?er+=gn:er>Math.PI&&(er-=gn),Vr<-Math.PI?Vr+=gn:Vr>Math.PI&&(Vr-=gn),er<Vr?b.theta=Math.max(er,Math.min(Vr,b.theta)):b.theta=b.theta>(er+Vr)/2?Math.max(er,b.theta):Math.min(Vr,b.theta)),b.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,b.phi)),b.makeSafe(),b.radius*=S,b.radius=Math.max(n.minDistance,Math.min(n.maxDistance,b.radius)),n.enableDamping===!0?n.target.addScaledVector(R,n.dampingFactor):n.target.add(R),me.setFromSpherical(b),me.applyQuaternion(Rt),Or.copy(n.target).add(me),n.object.lookAt(n.target),n.enableDamping===!0?(A.theta*=1-n.dampingFactor,A.phi*=1-n.dampingFactor,R.multiplyScalar(1-n.dampingFactor)):(A.set(0,0,0),R.set(0,0,0)),S=1,E||mt.distanceToSquared(n.object.position)>_||8*(1-Nt.dot(n.object.quaternion))>_?(n.dispatchEvent(l),mt.copy(n.object.position),Nt.copy(n.object.quaternion),E=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ut,!1),n.domElement.removeEventListener("pointerdown",ze,!1),n.domElement.removeEventListener("wheel",Ge,!1),n.domElement.removeEventListener("touchstart",Je,!1),n.domElement.removeEventListener("touchend",Ft,!1),n.domElement.removeEventListener("touchmove",ct,!1),n.domElement.ownerDocument.removeEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Xe,!1),n.domElement.removeEventListener("keydown",ue,!1)};var n=this,l={type:"change"},u={type:"start"},h={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},g=p.NONE,_=1e-6,b=new R_,A=new R_,S=1,R=new _e,E=!1,N=new bt,W=new bt,V=new bt,B=new bt,O=new bt,pe=new bt,ge=new bt,ye=new bt,$=new bt;function Ie(){return 2*Math.PI/60/60*n.autoRotateSpeed}function tt(){return Math.pow(.95,n.zoomSpeed)}function qe(me){A.theta-=me}function ft(me){A.phi-=me}var je=function(){var me=new _e;return function(Rt,mt){me.setFromMatrixColumn(mt,0),me.multiplyScalar(-Rt),R.add(me)}}(),Ne=function(){var me=new _e;return function(Rt,mt){n.screenSpacePanning===!0?me.setFromMatrixColumn(mt,1):(me.setFromMatrixColumn(mt,0),me.crossVectors(n.object.up,me)),me.multiplyScalar(Rt),R.add(me)}}(),Ue=function(){var me=new _e;return function(Rt,mt){var Nt=n.domElement;if(n.object.isPerspectiveCamera){var gn=n.object.position;me.copy(gn).sub(n.target);var gi=me.length();gi*=Math.tan(n.object.fov/2*Math.PI/180),je(2*Rt*gi/Nt.clientHeight,n.object.matrix),Ne(2*mt*gi/Nt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(je(Rt*(n.object.right-n.object.left)/n.object.zoom/Nt.clientWidth,n.object.matrix),Ne(mt*(n.object.top-n.object.bottom)/n.object.zoom/Nt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function Le(me){n.object.isPerspectiveCamera?S/=me:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*me)),n.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Te(me){n.object.isPerspectiveCamera?S*=me:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/me)),n.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Ve(me){N.set(me.clientX,me.clientY)}function We(me){ge.set(me.clientX,me.clientY)}function at(me){B.set(me.clientX,me.clientY)}function Tt(me){W.set(me.clientX,me.clientY),V.subVectors(W,N).multiplyScalar(n.rotateSpeed);var it=n.domElement;qe(2*Math.PI*V.x/it.clientHeight),ft(2*Math.PI*V.y/it.clientHeight),N.copy(W),n.update()}function nt(me){ye.set(me.clientX,me.clientY),$.subVectors(ye,ge),$.y>0?Le(tt()):$.y<0&&Te(tt()),ge.copy(ye),n.update()}function At(me){O.set(me.clientX,me.clientY),pe.subVectors(O,B).multiplyScalar(n.panSpeed),Ue(pe.x,pe.y),B.copy(O),n.update()}function nn(me){me.deltaY<0?Te(tt()):me.deltaY>0&&Le(tt()),n.update()}function Yt(me){var it=!1;switch(me.keyCode){case n.keys.UP:Ue(0,n.keyPanSpeed),it=!0;break;case n.keys.BOTTOM:Ue(0,-n.keyPanSpeed),it=!0;break;case n.keys.LEFT:Ue(n.keyPanSpeed,0),it=!0;break;case n.keys.RIGHT:Ue(-n.keyPanSpeed,0),it=!0;break}it&&(me.preventDefault(),n.update())}function K(me){if(me.touches.length==1)N.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Rt=.5*(me.touches[0].pageY+me.touches[1].pageY);N.set(it,Rt)}}function H(me){if(me.touches.length==1)B.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Rt=.5*(me.touches[0].pageY+me.touches[1].pageY);B.set(it,Rt)}}function xe(me){var it=me.touches[0].pageX-me.touches[1].pageX,Rt=me.touches[0].pageY-me.touches[1].pageY,mt=Math.sqrt(it*it+Rt*Rt);ge.set(0,mt)}function te(me){n.enableZoom&&xe(me),n.enablePan&&H(me)}function de(me){n.enableZoom&&xe(me),n.enableRotate&&K(me)}function be(me){if(me.touches.length==1)W.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Rt=.5*(me.touches[0].pageY+me.touches[1].pageY);W.set(it,Rt)}V.subVectors(W,N).multiplyScalar(n.rotateSpeed);var mt=n.domElement;qe(2*Math.PI*V.x/mt.clientHeight),ft(2*Math.PI*V.y/mt.clientHeight),N.copy(W)}function Re(me){if(me.touches.length==1)O.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Rt=.5*(me.touches[0].pageY+me.touches[1].pageY);O.set(it,Rt)}pe.subVectors(O,B).multiplyScalar(n.panSpeed),Ue(pe.x,pe.y),B.copy(O)}function we(me){var it=me.touches[0].pageX-me.touches[1].pageX,Rt=me.touches[0].pageY-me.touches[1].pageY,mt=Math.sqrt(it*it+Rt*Rt);ye.set(0,mt),$.set(0,Math.pow(ye.y/ge.y,n.zoomSpeed)),Le($.y),ge.copy(ye)}function Se(me){n.enableZoom&&we(me),n.enablePan&&Re(me)}function Pe(me){n.enableZoom&&we(me),n.enableRotate&&be(me)}function ze(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":Q(me);break}}function Ze(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":Y(me);break}}function Xe(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":He();break}}function Q(me){me.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus();var it;switch(me.button){case 0:it=n.mouseButtons.LEFT;break;case 1:it=n.mouseButtons.MIDDLE;break;case 2:it=n.mouseButtons.RIGHT;break;default:it=-1}switch(it){case kr.DOLLY:if(n.enableZoom===!1)return;We(me),g=p.DOLLY;break;case kr.ROTATE:if(me.ctrlKey||me.metaKey||me.shiftKey){if(n.enablePan===!1)return;at(me),g=p.PAN}else{if(n.enableRotate===!1)return;Ve(me),g=p.ROTATE}break;case kr.PAN:if(me.ctrlKey||me.metaKey||me.shiftKey){if(n.enableRotate===!1)return;Ve(me),g=p.ROTATE}else{if(n.enablePan===!1)return;at(me),g=p.PAN}break;default:g=p.NONE}g!==p.NONE&&(n.domElement.ownerDocument.addEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.addEventListener("pointerup",Xe,!1),n.dispatchEvent(u))}function Y(me){if(n.enabled!==!1)switch(me.preventDefault(),g){case p.ROTATE:if(n.enableRotate===!1)return;Tt(me);break;case p.DOLLY:if(n.enableZoom===!1)return;nt(me);break;case p.PAN:if(n.enablePan===!1)return;At(me);break}}function He(me){n.enabled!==!1&&(n.domElement.ownerDocument.removeEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Xe,!1),n.dispatchEvent(h),g=p.NONE)}function Ge(me){n.enabled===!1||n.enableZoom===!1||g!==p.NONE&&g!==p.ROTATE||(me.preventDefault(),me.stopPropagation(),n.dispatchEvent(u),nn(me),n.dispatchEvent(h))}function ue(me){n.enabled===!1||n.enableKeys===!1||n.enablePan===!1||Yt(me)}function Je(me){if(n.enabled!==!1){switch(me.preventDefault(),me.touches.length){case 1:switch(n.touches.ONE){case ta.ROTATE:if(n.enableRotate===!1)return;K(me),g=p.TOUCH_ROTATE;break;case ta.PAN:if(n.enablePan===!1)return;H(me),g=p.TOUCH_PAN;break;default:g=p.NONE}break;case 2:switch(n.touches.TWO){case ta.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;te(me),g=p.TOUCH_DOLLY_PAN;break;case ta.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;de(me),g=p.TOUCH_DOLLY_ROTATE;break;default:g=p.NONE}break;default:g=p.NONE}g!==p.NONE&&n.dispatchEvent(u)}}function ct(me){if(n.enabled!==!1)switch(me.preventDefault(),me.stopPropagation(),g){case p.TOUCH_ROTATE:if(n.enableRotate===!1)return;be(me),n.update();break;case p.TOUCH_PAN:if(n.enablePan===!1)return;Re(me),n.update();break;case p.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Se(me),n.update();break;case p.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Pe(me),n.update();break;default:g=p.NONE}}function Ft(me){n.enabled!==!1&&(n.dispatchEvent(h),g=p.NONE)}function ut(me){n.enabled!==!1&&me.preventDefault()}n.domElement.addEventListener("contextmenu",ut,!1),n.domElement.addEventListener("pointerdown",ze,!1),n.domElement.addEventListener("wheel",Ge,!1),n.domElement.addEventListener("touchstart",Je,!1),n.domElement.addEventListener("touchend",Ft,!1),n.domElement.addEventListener("touchmove",ct,!1),n.domElement.addEventListener("keydown",ue,!1),n.domElement.tabIndex===-1&&(n.domElement.tabIndex=0),this.update()};zf.prototype=Object.create(Us.prototype),zf.prototype.constructor=zf;var xv=function(r,i){zf.call(this,r,i),this.screenSpacePanning=!1,this.mouseButtons.LEFT=kr.PAN,this.mouseButtons.RIGHT=kr.ROTATE,this.touches.ONE=ta.PAN,this.touches.TWO=ta.DOLLY_ROTATE};xv.prototype=Object.create(Us.prototype),xv.prototype.constructor=xv;var sA=function(){function r(K){Ri.call(this,K),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.pluginCallbacks=[],this.register(function(H){return new p(H)}),this.register(function(H){return new _(H)}),this.register(function(H){return new g(H)}),this.register(function(H){return new u(H)})}r.prototype=Object.assign(Object.create(Ri.prototype),{constructor:r,load:function(K,H,xe,te){var de=this,be;this.resourcePath!==""?be=this.resourcePath:this.path!==""?be=this.path:be=gh.extractUrlBase(K),this.manager.itemStart(K);var Re=function(Se){te?te(Se):console.error(Se),de.manager.itemError(K),de.manager.itemEnd(K)},we=new Xs(this.manager);we.setPath(this.path),we.setResponseType("arraybuffer"),we.setRequestHeader(this.requestHeader),we.setWithCredentials(this.withCredentials),we.load(K,function(Se){try{de.parse(Se,be,function(Pe){H(Pe),de.manager.itemEnd(K)},Re)}catch(Pe){Re(Pe)}},xe,Re)},setDRACOLoader:function(K){return this.dracoLoader=K,this},setDDSLoader:function(K){return this.ddsLoader=K,this},setKTX2Loader:function(K){return this.ktx2Loader=K,this},register:function(K){return this.pluginCallbacks.indexOf(K)===-1&&this.pluginCallbacks.push(K),this},unregister:function(K){return this.pluginCallbacks.indexOf(K)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(K),1),this},parse:function(K,H,xe,te){var de,be={},Re={};if(typeof K=="string")de=K;else{var we=gh.decodeText(new Uint8Array(K,0,4));if(we===b){try{be[n.KHR_BINARY_GLTF]=new R(K)}catch(Y){te&&te(Y);return}de=be[n.KHR_BINARY_GLTF].content}else de=gh.decodeText(new Uint8Array(K))}var Se=JSON.parse(de);if(Se.asset===void 0||Se.asset.version[0]<2){te&&te(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var Pe=new nt(Se,{path:H||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader});Pe.fileLoader.setRequestHeader(this.requestHeader);for(var ze=0;ze<this.pluginCallbacks.length;ze++){var Ze=this.pluginCallbacks[ze](Pe);Re[Ze.name]=Ze,be[Ze.name]=!0}if(Se.extensionsUsed)for(var ze=0;ze<Se.extensionsUsed.length;++ze){var Xe=Se.extensionsUsed[ze],Q=Se.extensionsRequired||[];switch(Xe){case n.KHR_MATERIALS_UNLIT:be[Xe]=new h;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:be[Xe]=new V;break;case n.KHR_DRACO_MESH_COMPRESSION:be[Xe]=new E(Se,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:be[Xe]=new l(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:be[Xe]=new N;break;case n.KHR_MESH_QUANTIZATION:be[Xe]=new B;break;default:Q.indexOf(Xe)>=0&&Re[Xe]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Xe+'".')}}Pe.setExtensions(be),Pe.setPlugins(Re),Pe.parse(xe,te)}});function i(){var K={};return{get:function(H){return K[H]},add:function(H,xe){K[H]=xe},remove:function(H){delete K[H]},removeAll:function(){K={}}}}var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function l(K){if(!K)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=K}function u(K){this.parser=K,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}u.prototype._markDefs=function(){for(var K=this.parser,H=this.parser.json.nodes||[],xe=0,te=H.length;xe<te;xe++){var de=H[xe];de.extensions&&de.extensions[this.name]&&de.extensions[this.name].light!==void 0&&K._addNodeRef(this.cache,de.extensions[this.name].light)}},u.prototype._loadLight=function(K){var H=this.parser,xe="light:"+K,te=H.cache.get(xe);if(te)return te;var de=H.json,be=de.extensions&&de.extensions[this.name]||{},Re=be.lights||[],we=Re[K],Se,Pe=new Qt(16777215);we.color!==void 0&&Pe.fromArray(we.color);var ze=we.range!==void 0?we.range:0;switch(we.type){case"directional":Se=new hv(Pe),Se.target.position.set(0,0,-1),Se.add(Se.target);break;case"point":Se=new cv(Pe),Se.distance=ze;break;case"spot":Se=new ov(Pe),Se.distance=ze,we.spot=we.spot||{},we.spot.innerConeAngle=we.spot.innerConeAngle!==void 0?we.spot.innerConeAngle:0,we.spot.outerConeAngle=we.spot.outerConeAngle!==void 0?we.spot.outerConeAngle:Math.PI/4,Se.angle=we.spot.outerConeAngle,Se.penumbra=1-we.spot.innerConeAngle/we.spot.outerConeAngle,Se.target.position.set(0,0,-1),Se.add(Se.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+we.type+'".')}return Se.position.set(0,0,0),Se.decay=2,we.intensity!==void 0&&(Se.intensity=we.intensity),Se.name=H.createUniqueName(we.name||"light_"+K),te=Promise.resolve(Se),H.cache.add(xe,te),te},u.prototype.createNodeAttachment=function(K){var H=this,xe=this.parser,te=xe.json,de=te.nodes[K],be=de.extensions&&de.extensions[this.name]||{},Re=be.light;return Re===void 0?null:this._loadLight(Re).then(function(we){return xe._getNodeRef(H.cache,Re,we)})};function h(){this.name=n.KHR_MATERIALS_UNLIT}h.prototype.getMaterialType=function(){return ys},h.prototype.extendParams=function(K,H,xe){var te=[];K.color=new Qt(1,1,1),K.opacity=1;var de=H.pbrMetallicRoughness;if(de){if(Array.isArray(de.baseColorFactor)){var be=de.baseColorFactor;K.color.fromArray(be),K.opacity=be[3]}de.baseColorTexture!==void 0&&te.push(xe.assignTexture(K,"map",de.baseColorTexture))}return Promise.all(te)};function p(K){this.parser=K,this.name=n.KHR_MATERIALS_CLEARCOAT}p.prototype.getMaterialType=function(K){var H=this.parser,xe=H.json.materials[K];return!xe.extensions||!xe.extensions[this.name]?null:cl},p.prototype.extendMaterialParams=function(K,H){var xe=this.parser,te=xe.json.materials[K];if(!te.extensions||!te.extensions[this.name])return Promise.resolve();var de=[],be=te.extensions[this.name];if(be.clearcoatFactor!==void 0&&(H.clearcoat=be.clearcoatFactor),be.clearcoatTexture!==void 0&&de.push(xe.assignTexture(H,"clearcoatMap",be.clearcoatTexture)),be.clearcoatRoughnessFactor!==void 0&&(H.clearcoatRoughness=be.clearcoatRoughnessFactor),be.clearcoatRoughnessTexture!==void 0&&de.push(xe.assignTexture(H,"clearcoatRoughnessMap",be.clearcoatRoughnessTexture)),be.clearcoatNormalTexture!==void 0&&(de.push(xe.assignTexture(H,"clearcoatNormalMap",be.clearcoatNormalTexture)),be.clearcoatNormalTexture.scale!==void 0)){var Re=be.clearcoatNormalTexture.scale;H.clearcoatNormalScale=new bt(Re,Re)}return Promise.all(de)};function g(K){this.parser=K,this.name=n.KHR_MATERIALS_TRANSMISSION}g.prototype.getMaterialType=function(K){var H=this.parser,xe=H.json.materials[K];return!xe.extensions||!xe.extensions[this.name]?null:cl},g.prototype.extendMaterialParams=function(K,H){var xe=this.parser,te=xe.json.materials[K];if(!te.extensions||!te.extensions[this.name])return Promise.resolve();var de=[],be=te.extensions[this.name];return be.transmissionFactor!==void 0&&(H.transmission=be.transmissionFactor),be.transmissionTexture!==void 0&&de.push(xe.assignTexture(H,"transmissionMap",be.transmissionTexture)),Promise.all(de)};function _(K){this.parser=K,this.name=n.KHR_TEXTURE_BASISU}_.prototype.loadTexture=function(K){var H=this.parser,xe=H.json,te=xe.textures[K];if(!te.extensions||!te.extensions[this.name])return null;var de=te.extensions[this.name],be=xe.images[de.source],Re=H.options.ktx2Loader;if(!Re)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return H.loadTextureImage(K,be,Re)};var b="glTF",A=12,S={JSON:1313821514,BIN:5130562};function R(K){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var H=new DataView(K,0,A);if(this.header={magic:gh.decodeText(new Uint8Array(K.slice(0,4))),version:H.getUint32(4,!0),length:H.getUint32(8,!0)},this.header.magic!==b)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var xe=new DataView(K,A),te=0;te<xe.byteLength;){var de=xe.getUint32(te,!0);te+=4;var be=xe.getUint32(te,!0);if(te+=4,be===S.JSON){var Re=new Uint8Array(K,A+te,de);this.content=gh.decodeText(Re)}else if(be===S.BIN){var we=A+te;this.body=K.slice(we,we+de)}te+=de}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function E(K,H){if(!H)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=K,this.dracoLoader=H,this.dracoLoader.preload()}E.prototype.decodePrimitive=function(K,H){var xe=this.json,te=this.dracoLoader,de=K.extensions[this.name].bufferView,be=K.extensions[this.name].attributes,Re={},we={},Se={};for(var Pe in be){var ze=tt[Pe]||Pe.toLowerCase();Re[ze]=be[Pe]}for(Pe in K.attributes){var ze=tt[Pe]||Pe.toLowerCase();if(be[Pe]!==void 0){var Ze=xe.accessors[K.attributes[Pe]],Xe=ge[Ze.componentType];Se[ze]=Xe,we[ze]=Ze.normalized===!0}}return H.getDependency("bufferView",de).then(function(Q){return new Promise(function(Y){te.decodeDracoFile(Q,function(He){for(var Ge in He.attributes){var ue=He.attributes[Ge],Je=we[Ge];Je!==void 0&&(ue.normalized=Je)}Y(He)},Re,Se)})})};function N(){this.name=n.KHR_TEXTURE_TRANSFORM}N.prototype.extendTexture=function(K,H){return K=K.clone(),H.offset!==void 0&&K.offset.fromArray(H.offset),H.rotation!==void 0&&(K.rotation=H.rotation),H.scale!==void 0&&K.repeat.fromArray(H.scale),H.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),K.needsUpdate=!0,K};function W(K){Ga.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var H=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),xe=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),te=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),de=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),be=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),Re={specular:{value:new Qt().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Re,this.onBeforeCompile=function(we){for(var Se in Re)we.uniforms[Se]=Re[Se];we.fragmentShader=we.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",H).replace("#include <metalnessmap_pars_fragment>",xe).replace("#include <roughnessmap_fragment>",te).replace("#include <metalnessmap_fragment>",de).replace("#include <lights_physical_fragment>",be)},Object.defineProperties(this,{specular:{get:function(){return Re.specular.value},set:function(we){Re.specular.value=we}},specularMap:{get:function(){return Re.specularMap.value},set:function(we){Re.specularMap.value=we,we?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return Re.glossiness.value},set:function(we){Re.glossiness.value=we}},glossinessMap:{get:function(){return Re.glossinessMap.value},set:function(we){Re.glossinessMap.value=we,we?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(K)}W.prototype=Object.create(Ga.prototype),W.prototype.constructor=W,W.prototype.copy=function(K){return Ga.prototype.copy.call(this,K),this.specularMap=K.specularMap,this.specular.copy(K.specular),this.glossinessMap=K.glossinessMap,this.glossiness=K.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function V(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return W},extendParams:function(K,H,xe){var te=H.extensions[this.name];K.color=new Qt(1,1,1),K.opacity=1;var de=[];if(Array.isArray(te.diffuseFactor)){var be=te.diffuseFactor;K.color.fromArray(be),K.opacity=be[3]}if(te.diffuseTexture!==void 0&&de.push(xe.assignTexture(K,"map",te.diffuseTexture)),K.emissive=new Qt(0,0,0),K.glossiness=te.glossinessFactor!==void 0?te.glossinessFactor:1,K.specular=new Qt(1,1,1),Array.isArray(te.specularFactor)&&K.specular.fromArray(te.specularFactor),te.specularGlossinessTexture!==void 0){var Re=te.specularGlossinessTexture;de.push(xe.assignTexture(K,"glossinessMap",Re)),de.push(xe.assignTexture(K,"specularMap",Re))}return Promise.all(de)},createMaterial:function(K){var H=new W(K);return H.fog=!0,H.color=K.color,H.map=K.map===void 0?null:K.map,H.lightMap=null,H.lightMapIntensity=1,H.aoMap=K.aoMap===void 0?null:K.aoMap,H.aoMapIntensity=1,H.emissive=K.emissive,H.emissiveIntensity=1,H.emissiveMap=K.emissiveMap===void 0?null:K.emissiveMap,H.bumpMap=K.bumpMap===void 0?null:K.bumpMap,H.bumpScale=1,H.normalMap=K.normalMap===void 0?null:K.normalMap,H.normalMapType=Bc,K.normalScale&&(H.normalScale=K.normalScale),H.displacementMap=null,H.displacementScale=1,H.displacementBias=0,H.specularMap=K.specularMap===void 0?null:K.specularMap,H.specular=K.specular,H.glossinessMap=K.glossinessMap===void 0?null:K.glossinessMap,H.glossiness=K.glossiness,H.alphaMap=null,H.envMap=K.envMap===void 0?null:K.envMap,H.envMapIntensity=1,H.refractionRatio=.98,H}}}function B(){this.name=n.KHR_MESH_QUANTIZATION}function O(K,H,xe,te){za.call(this,K,H,xe,te)}O.prototype=Object.create(za.prototype),O.prototype.constructor=O,O.prototype.copySampleValue_=function(K){for(var H=this.resultBuffer,xe=this.sampleValues,te=this.valueSize,de=K*te*3+te,be=0;be!==te;be++)H[be]=xe[de+be];return H},O.prototype.beforeStart_=O.prototype.copySampleValue_,O.prototype.afterEnd_=O.prototype.copySampleValue_,O.prototype.interpolate_=function(K,H,xe,te){for(var de=this.resultBuffer,be=this.sampleValues,Re=this.valueSize,we=Re*2,Se=Re*3,Pe=te-H,ze=(xe-H)/Pe,Ze=ze*ze,Xe=Ze*ze,Q=K*Se,Y=Q-Se,He=-2*Xe+3*Ze,Ge=Xe-Ze,ue=1-He,Je=Ge-Ze+ze,ct=0;ct!==Re;ct++){var Ft=be[Y+ct+Re],ut=be[Y+ct+we]*Pe,me=be[Q+ct+Re],it=be[Q+ct]*Pe;de[ct]=ue*Ft+Je*ut+He*me+Ge*it}return de};var pe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ye={9728:Et,9729:Rn,9984:Vn,9985:Dr,9986:Oi,9987:Pu},$={33071:na,33648:wt,10497:Gl},Ie={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},tt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ft={CUBICSPLINE:void 0,LINEAR:Du,STEP:of},je={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ne(K,H){return typeof K!="string"||K===""?"":(/^https?:\/\//i.test(H)&&/^\//.test(K)&&(H=H.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(K)||/^data:.*,.*$/i.test(K)||/^blob:.*$/i.test(K)?K:H+K)}function Ue(K){return K.DefaultMaterial===void 0&&(K.DefaultMaterial=new Ga({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Fs})),K.DefaultMaterial}function Le(K,H,xe){for(var te in xe.extensions)K[te]===void 0&&(H.userData.gltfExtensions=H.userData.gltfExtensions||{},H.userData.gltfExtensions[te]=xe.extensions[te])}function Te(K,H){H.extras!==void 0&&(typeof H.extras=="object"?Object.assign(K.userData,H.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+H.extras))}function Ve(K,H,xe){for(var te=!1,de=!1,be=0,Re=H.length;be<Re;be++){var we=H[be];if(we.POSITION!==void 0&&(te=!0),we.NORMAL!==void 0&&(de=!0),te&&de)break}if(!te&&!de)return Promise.resolve(K);for(var Se=[],Pe=[],be=0,Re=H.length;be<Re;be++){var we=H[be];if(te){var ze=we.POSITION!==void 0?xe.getDependency("accessor",we.POSITION):K.attributes.position;Se.push(ze)}if(de){var ze=we.NORMAL!==void 0?xe.getDependency("accessor",we.NORMAL):K.attributes.normal;Pe.push(ze)}}return Promise.all([Promise.all(Se),Promise.all(Pe)]).then(function(Ze){var Xe=Ze[0],Q=Ze[1];return te&&(K.morphAttributes.position=Xe),de&&(K.morphAttributes.normal=Q),K.morphTargetsRelative=!0,K})}function We(K,H){if(K.updateMorphTargets(),H.weights!==void 0)for(var xe=0,te=H.weights.length;xe<te;xe++)K.morphTargetInfluences[xe]=H.weights[xe];if(H.extras&&Array.isArray(H.extras.targetNames)){var de=H.extras.targetNames;if(K.morphTargetInfluences.length===de.length){K.morphTargetDictionary={};for(var xe=0,te=de.length;xe<te;xe++)K.morphTargetDictionary[de[xe]]=xe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function at(K){var H=K.extensions&&K.extensions[n.KHR_DRACO_MESH_COMPRESSION],xe;return H?xe="draco:"+H.bufferView+":"+H.indices+":"+Tt(H.attributes):xe=K.indices+":"+Tt(K.attributes)+":"+K.mode,xe}function Tt(K){for(var H="",xe=Object.keys(K).sort(),te=0,de=xe.length;te<de;te++)H+=xe[te]+":"+K[xe[te]]+";";return H}function nt(K,H){this.json=K||{},this.extensions={},this.plugins={},this.options=H||{},this.cache=new i,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new dv(this.options.manager):this.textureLoader=new Rp(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Xs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}nt.prototype.setExtensions=function(K){this.extensions=K},nt.prototype.setPlugins=function(K){this.plugins=K},nt.prototype.parse=function(K,H){var xe=this,te=this.json,de=this.extensions;this.cache.removeAll(),this._invokeAll(function(be){return be._markDefs&&be._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(be){var Re={scene:be[0][te.scene||0],scenes:be[0],animations:be[1],cameras:be[2],asset:te.asset,parser:xe,userData:{}};Le(de,Re,te),Te(Re,te),K(Re)}).catch(H)},nt.prototype._markDefs=function(){for(var K=this.json.nodes||[],H=this.json.skins||[],xe=this.json.meshes||[],te=0,de=H.length;te<de;te++)for(var be=H[te].joints,Re=0,we=be.length;Re<we;Re++)K[be[Re]].isBone=!0;for(var Se=0,Pe=K.length;Se<Pe;Se++){var ze=K[Se];ze.mesh!==void 0&&(this._addNodeRef(this.meshCache,ze.mesh),ze.skin!==void 0&&(xe[ze.mesh].isSkinnedMesh=!0)),ze.camera!==void 0&&this._addNodeRef(this.cameraCache,ze.camera)}},nt.prototype._addNodeRef=function(K,H){H!==void 0&&(K.refs[H]===void 0&&(K.refs[H]=K.uses[H]=0),K.refs[H]++)},nt.prototype._getNodeRef=function(K,H,xe){if(K.refs[H]<=1)return xe;var te=xe.clone();return te.name+="_instance_"+K.uses[H]++,te},nt.prototype._invokeOne=function(K){var H=Object.values(this.plugins);H.push(this);for(var xe=0;xe<H.length;xe++){var te=K(H[xe]);if(te)return te}},nt.prototype._invokeAll=function(K){var H=Object.values(this.plugins);H.unshift(this);for(var xe=[],te=0;te<H.length;te++){var de=K(H[te]);de&&xe.push(de)}return xe},nt.prototype.getDependency=function(K,H){var xe=K+":"+H,te=this.cache.get(xe);if(!te){switch(K){case"scene":te=this.loadScene(H);break;case"node":te=this.loadNode(H);break;case"mesh":te=this._invokeOne(function(de){return de.loadMesh&&de.loadMesh(H)});break;case"accessor":te=this.loadAccessor(H);break;case"bufferView":te=this._invokeOne(function(de){return de.loadBufferView&&de.loadBufferView(H)});break;case"buffer":te=this.loadBuffer(H);break;case"material":te=this._invokeOne(function(de){return de.loadMaterial&&de.loadMaterial(H)});break;case"texture":te=this._invokeOne(function(de){return de.loadTexture&&de.loadTexture(H)});break;case"skin":te=this.loadSkin(H);break;case"animation":te=this.loadAnimation(H);break;case"camera":te=this.loadCamera(H);break;default:throw new Error("Unknown type: "+K)}this.cache.add(xe,te)}return te},nt.prototype.getDependencies=function(K){var H=this.cache.get(K);if(!H){var xe=this,te=this.json[K+(K==="mesh"?"es":"s")]||[];H=Promise.all(te.map(function(de,be){return xe.getDependency(K,be)})),this.cache.add(K,H)}return H},nt.prototype.loadBuffer=function(K){var H=this.json.buffers[K],xe=this.fileLoader;if(H.type&&H.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+H.type+" buffer type is not supported.");if(H.uri===void 0&&K===0)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var te=this.options;return new Promise(function(de,be){xe.load(Ne(H.uri,te.path),de,void 0,function(){be(new Error('THREE.GLTFLoader: Failed to load buffer "'+H.uri+'".'))})})},nt.prototype.loadBufferView=function(K){var H=this.json.bufferViews[K];return this.getDependency("buffer",H.buffer).then(function(xe){var te=H.byteLength||0,de=H.byteOffset||0;return xe.slice(de,de+te)})},nt.prototype.loadAccessor=function(K){var H=this,xe=this.json,te=this.json.accessors[K];if(te.bufferView===void 0&&te.sparse===void 0)return Promise.resolve(null);var de=[];return te.bufferView!==void 0?de.push(this.getDependency("bufferView",te.bufferView)):de.push(null),te.sparse!==void 0&&(de.push(this.getDependency("bufferView",te.sparse.indices.bufferView)),de.push(this.getDependency("bufferView",te.sparse.values.bufferView))),Promise.all(de).then(function(be){var Re=be[0],we=Ie[te.type],Se=ge[te.componentType],Pe=Se.BYTES_PER_ELEMENT,ze=Pe*we,Ze=te.byteOffset||0,Xe=te.bufferView!==void 0?xe.bufferViews[te.bufferView].byteStride:void 0,Q=te.normalized===!0,Y,He;if(Xe&&Xe!==ze){var Ge=Math.floor(Ze/Xe),ue="InterleavedBuffer:"+te.bufferView+":"+te.componentType+":"+Ge+":"+te.count,Je=H.cache.get(ue);Je||(Y=new Se(Re,Ge*Xe,te.count*Xe/Pe),Je=new Qa(Y,Xe/Pe),H.cache.add(ue,Je)),He=new Jl(Je,we,Ze%Xe/Pe,Q)}else Re===null?Y=new Se(te.count*we):Y=new Se(Re,Ze,te.count*we),He=new Fn(Y,we,Q);if(te.sparse!==void 0){var ct=Ie.SCALAR,Ft=ge[te.sparse.indices.componentType],ut=te.sparse.indices.byteOffset||0,me=te.sparse.values.byteOffset||0,it=new Ft(be[1],ut,te.sparse.count*ct),Rt=new Se(be[2],me,te.sparse.count*we);Re!==null&&(He=new Fn(He.array.slice(),He.itemSize,He.normalized));for(var mt=0,Nt=it.length;mt<Nt;mt++){var gn=it[mt];if(He.setX(gn,Rt[mt*we]),we>=2&&He.setY(gn,Rt[mt*we+1]),we>=3&&He.setZ(gn,Rt[mt*we+2]),we>=4&&He.setW(gn,Rt[mt*we+3]),we>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return He})},nt.prototype.loadTexture=function(K){var H=this,xe=this.json,te=this.options,de=xe.textures[K],be=de.extensions||{},Re;be[n.MSFT_TEXTURE_DDS]?Re=xe.images[be[n.MSFT_TEXTURE_DDS].source]:Re=xe.images[de.source];var we;return Re.uri&&(we=te.manager.getHandler(Re.uri)),we||(we=be[n.MSFT_TEXTURE_DDS]?H.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(K,Re,we)},nt.prototype.loadTextureImage=function(K,H,xe){var te=this,de=this.json,be=this.options,Re=de.textures[K],we=self.URL||self.webkitURL,Se=H.uri,Pe=!1,ze=!0;return H.mimeType==="image/jpeg"&&(ze=!1),H.bufferView!==void 0&&(Se=te.getDependency("bufferView",H.bufferView).then(function(Ze){if(H.mimeType==="image/png"){var Xe=new DataView(Ze,25,1).getUint8(0,!1);ze=Xe===6||Xe===4||Xe===3}Pe=!0;var Q=new Blob([Ze],{type:H.mimeType});return Se=we.createObjectURL(Q),Se})),Promise.resolve(Se).then(function(Ze){return new Promise(function(Xe,Q){var Y=Xe;xe.isImageBitmapLoader===!0&&(Y=function(He){Xe(new Cf(He))}),xe.load(Ne(Ze,be.path),Y,void 0,Q)})}).then(function(Ze){Pe===!0&&we.revokeObjectURL(Se),Ze.flipY=!1,Re.name&&(Ze.name=Re.name),ze||(Ze.format=Mo);var Xe=de.samplers||{},Q=Xe[Re.sampler]||{};return Ze.magFilter=ye[Q.magFilter]||Rn,Ze.minFilter=ye[Q.minFilter]||Pu,Ze.wrapS=$[Q.wrapS]||Gl,Ze.wrapT=$[Q.wrapT]||Gl,te.associations.set(Ze,{type:"textures",index:K}),Ze})},nt.prototype.assignTexture=function(K,H,xe){var te=this;return this.getDependency("texture",xe.index).then(function(de){if(xe.texCoord!==void 0&&xe.texCoord!=0&&!(H==="aoMap"&&xe.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+xe.texCoord+" for texture "+H+" not yet supported."),te.extensions[n.KHR_TEXTURE_TRANSFORM]){var be=xe.extensions!==void 0?xe.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(be){var Re=te.associations.get(de);de=te.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(de,be),te.associations.set(de,Re)}}K[H]=de})},nt.prototype.assignFinalMaterial=function(K){var H=K.geometry,xe=K.material,te=H.attributes.tangent!==void 0,de=H.attributes.color!==void 0,be=H.attributes.normal===void 0,Re=K.isSkinnedMesh===!0,we=Object.keys(H.morphAttributes).length>0,Se=we&&H.morphAttributes.normal!==void 0;if(K.isPoints){var Pe="PointsMaterial:"+xe.uuid,ze=this.cache.get(Pe);ze||(ze=new Kl,Tn.prototype.copy.call(ze,xe),ze.color.copy(xe.color),ze.map=xe.map,ze.sizeAttenuation=!1,this.cache.add(Pe,ze)),xe=ze}else if(K.isLine){var Pe="LineBasicMaterial:"+xe.uuid,Ze=this.cache.get(Pe);Ze||(Ze=new es,Tn.prototype.copy.call(Ze,xe),Ze.color.copy(xe.color),this.cache.add(Pe,Ze)),xe=Ze}if(te||de||be||Re||we){var Pe="ClonedMaterial:"+xe.uuid+":";xe.isGLTFSpecularGlossinessMaterial&&(Pe+="specular-glossiness:"),Re&&(Pe+="skinning:"),te&&(Pe+="vertex-tangents:"),de&&(Pe+="vertex-colors:"),be&&(Pe+="flat-shading:"),we&&(Pe+="morph-targets:"),Se&&(Pe+="morph-normals:");var Xe=this.cache.get(Pe);Xe||(Xe=xe.clone(),Re&&(Xe.skinning=!0),te&&(Xe.vertexTangents=!0),de&&(Xe.vertexColors=!0),be&&(Xe.flatShading=!0),we&&(Xe.morphTargets=!0),Se&&(Xe.morphNormals=!0),this.cache.add(Pe,Xe),this.associations.set(Xe,this.associations.get(xe))),xe=Xe}xe.aoMap&&H.attributes.uv2===void 0&&H.attributes.uv!==void 0&&H.setAttribute("uv2",H.attributes.uv),xe.normalScale&&!te&&(xe.normalScale.y=-xe.normalScale.y),xe.clearcoatNormalScale&&!te&&(xe.clearcoatNormalScale.y=-xe.clearcoatNormalScale.y),K.material=xe},nt.prototype.getMaterialType=function(){return Ga},nt.prototype.loadMaterial=function(K){var H=this,xe=this.json,te=this.extensions,de=xe.materials[K],be,Re={},we=de.extensions||{},Se=[];if(we[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Pe=te[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];be=Pe.getMaterialType(),Se.push(Pe.extendParams(Re,de,H))}else if(we[n.KHR_MATERIALS_UNLIT]){var ze=te[n.KHR_MATERIALS_UNLIT];be=ze.getMaterialType(),Se.push(ze.extendParams(Re,de,H))}else{var Ze=de.pbrMetallicRoughness||{};if(Re.color=new Qt(1,1,1),Re.opacity=1,Array.isArray(Ze.baseColorFactor)){var Xe=Ze.baseColorFactor;Re.color.fromArray(Xe),Re.opacity=Xe[3]}Ze.baseColorTexture!==void 0&&Se.push(H.assignTexture(Re,"map",Ze.baseColorTexture)),Re.metalness=Ze.metallicFactor!==void 0?Ze.metallicFactor:1,Re.roughness=Ze.roughnessFactor!==void 0?Ze.roughnessFactor:1,Ze.metallicRoughnessTexture!==void 0&&(Se.push(H.assignTexture(Re,"metalnessMap",Ze.metallicRoughnessTexture)),Se.push(H.assignTexture(Re,"roughnessMap",Ze.metallicRoughnessTexture))),be=this._invokeOne(function(Y){return Y.getMaterialType&&Y.getMaterialType(K)}),Se.push(Promise.all(this._invokeAll(function(Y){return Y.extendMaterialParams&&Y.extendMaterialParams(K,Re)})))}de.doubleSided===!0&&(Re.side=jr);var Q=de.alphaMode||je.OPAQUE;return Q===je.BLEND?(Re.transparent=!0,Re.depthWrite=!1):(Re.transparent=!1,Q===je.MASK&&(Re.alphaTest=de.alphaCutoff!==void 0?de.alphaCutoff:.5)),de.normalTexture!==void 0&&be!==ys&&(Se.push(H.assignTexture(Re,"normalMap",de.normalTexture)),Re.normalScale=new bt(1,1),de.normalTexture.scale!==void 0&&Re.normalScale.set(de.normalTexture.scale,de.normalTexture.scale)),de.occlusionTexture!==void 0&&be!==ys&&(Se.push(H.assignTexture(Re,"aoMap",de.occlusionTexture)),de.occlusionTexture.strength!==void 0&&(Re.aoMapIntensity=de.occlusionTexture.strength)),de.emissiveFactor!==void 0&&be!==ys&&(Re.emissive=new Qt().fromArray(de.emissiveFactor)),de.emissiveTexture!==void 0&&be!==ys&&Se.push(H.assignTexture(Re,"emissiveMap",de.emissiveTexture)),Promise.all(Se).then(function(){var Y;return be===W?Y=te[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Re):Y=new be(Re),de.name&&(Y.name=de.name),Y.map&&(Y.map.encoding=Vd),Y.emissiveMap&&(Y.emissiveMap.encoding=Vd),Te(Y,de),H.associations.set(Y,{type:"materials",index:K}),de.extensions&&Le(te,Y,de),Y})},nt.prototype.createUniqueName=function(K){for(var H=pa.sanitizeNodeName(K||""),xe=1;this.nodeNamesUsed[H];++xe)H=K+"_"+xe;return this.nodeNamesUsed[H]=!0,H};function At(K,H,xe){var te=H.attributes,de=new el;if(te.POSITION!==void 0){var be=xe.json.accessors[te.POSITION],Re=be.min,we=be.max;if(Re!==void 0&&we!==void 0)de.set(new _e(Re[0],Re[1],Re[2]),new _e(we[0],we[1],we[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Se=H.targets;if(Se!==void 0){for(var Pe=new _e,ze=new _e,Ze=0,Xe=Se.length;Ze<Xe;Ze++){var Q=Se[Ze];if(Q.POSITION!==void 0){var be=xe.json.accessors[Q.POSITION],Re=be.min,we=be.max;Re!==void 0&&we!==void 0?(ze.setX(Math.max(Math.abs(Re[0]),Math.abs(we[0]))),ze.setY(Math.max(Math.abs(Re[1]),Math.abs(we[1]))),ze.setZ(Math.max(Math.abs(Re[2]),Math.abs(we[2]))),Pe.max(ze)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}de.expandByVector(Pe)}K.boundingBox=de;var Y=new nl;de.getCenter(Y.center),Y.radius=de.min.distanceTo(de.max)/2,K.boundingSphere=Y}function nn(K,H,xe){var te=H.attributes,de=[];function be(Pe,ze){return xe.getDependency("accessor",Pe).then(function(Ze){K.setAttribute(ze,Ze)})}for(var Re in te){var we=tt[Re]||Re.toLowerCase();we in K.attributes||de.push(be(te[Re],we))}if(H.indices!==void 0&&!K.index){var Se=xe.getDependency("accessor",H.indices).then(function(Pe){K.setIndex(Pe)});de.push(Se)}return Te(K,H),At(K,H,xe),Promise.all(de).then(function(){return H.targets!==void 0?Ve(K,H.targets,xe):K})}function Yt(K,H){var xe=K.getIndex();if(xe===null){var te=[],de=K.getAttribute("position");if(de!==void 0){for(var be=0;be<de.count;be++)te.push(be);K.setIndex(te),xe=K.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),K}var Re=xe.count-2,we=[];if(H===Ky)for(var be=1;be<=Re;be++)we.push(xe.getX(0)),we.push(xe.getX(be)),we.push(xe.getX(be+1));else for(var be=0;be<Re;be++)be%2===0?(we.push(xe.getX(be)),we.push(xe.getX(be+1)),we.push(xe.getX(be+2))):(we.push(xe.getX(be+2)),we.push(xe.getX(be+1)),we.push(xe.getX(be)));we.length/3!==Re&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Se=K.clone();return Se.setIndex(we),Se}return nt.prototype.loadGeometries=function(K){var H=this,xe=this.extensions,te=this.primitiveCache;function de(Xe){return xe[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Xe,H).then(function(Q){return nn(Q,Xe,H)})}for(var be=[],Re=0,we=K.length;Re<we;Re++){var Se=K[Re],Pe=at(Se),ze=te[Pe];if(ze)be.push(ze.promise);else{var Ze;Se.extensions&&Se.extensions[n.KHR_DRACO_MESH_COMPRESSION]?Ze=de(Se):Ze=nn(new Ni,Se,H),te[Pe]={primitive:Se,promise:Ze},be.push(Ze)}}return Promise.all(be)},nt.prototype.loadMesh=function(K){for(var H=this,xe=this.json,te=xe.meshes[K],de=te.primitives,be=[],Re=0,we=de.length;Re<we;Re++){var Se=de[Re].material===void 0?Ue(this.cache):this.getDependency("material",de[Re].material);be.push(Se)}return be.push(H.loadGeometries(de)),Promise.all(be).then(function(Pe){for(var ze=Pe.slice(0,Pe.length-1),Ze=Pe[Pe.length-1],Xe=[],Q=0,Y=Ze.length;Q<Y;Q++){var He=Ze[Q],Ge=de[Q],ue,Je=ze[Q];if(Ge.mode===pe.TRIANGLES||Ge.mode===pe.TRIANGLE_STRIP||Ge.mode===pe.TRIANGLE_FAN||Ge.mode===void 0)ue=te.isSkinnedMesh===!0?new fp(He,Je):new ra(He,Je),ue.isSkinnedMesh===!0&&!ue.geometry.attributes.skinWeight.normalized&&ue.normalizeSkinWeights(),Ge.mode===pe.TRIANGLE_STRIP?ue.geometry=Yt(ue.geometry,Rw):Ge.mode===pe.TRIANGLE_FAN&&(ue.geometry=Yt(ue.geometry,Ky));else if(Ge.mode===pe.LINES)ue=new Lf(He,Je);else if(Ge.mode===pe.LINE_STRIP)ue=new Xc(He,Je);else if(Ge.mode===pe.LINE_LOOP)ue=new Hg(He,Je);else if(Ge.mode===pe.POINTS)ue=new Vg(He,Je);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Ge.mode);Object.keys(ue.geometry.morphAttributes).length>0&&We(ue,te),ue.name=H.createUniqueName(te.name||"mesh_"+K),Ze.length>1&&(ue.name+="_"+Q),Te(ue,te),H.assignFinalMaterial(ue),Xe.push(ue)}if(Xe.length===1)return Xe[0];for(var ct=new ll,Q=0,Y=Xe.length;Q<Y;Q++)ct.add(Xe[Q]);return ct})},nt.prototype.loadCamera=function(K){var H,xe=this.json.cameras[K],te=xe[xe.type];if(!te){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return xe.type==="perspective"?H=new Jr(zn.radToDeg(te.yfov),te.aspectRatio||1,te.znear||1,te.zfar||2e6):xe.type==="orthographic"&&(H=new Pp(-te.xmag,te.xmag,te.ymag,-te.ymag,te.znear,te.zfar)),xe.name&&(H.name=this.createUniqueName(xe.name)),Te(H,xe),Promise.resolve(H)},nt.prototype.loadSkin=function(K){var H=this.json.skins[K],xe={joints:H.joints};return H.inverseBindMatrices===void 0?Promise.resolve(xe):this.getDependency("accessor",H.inverseBindMatrices).then(function(te){return xe.inverseBindMatrices=te,xe})},nt.prototype.loadAnimation=function(K){for(var H=this.json,xe=H.animations[K],te=[],de=[],be=[],Re=[],we=[],Se=0,Pe=xe.channels.length;Se<Pe;Se++){var ze=xe.channels[Se],Ze=xe.samplers[ze.sampler],Xe=ze.target,Q=Xe.node!==void 0?Xe.node:Xe.id,Y=xe.parameters!==void 0?xe.parameters[Ze.input]:Ze.input,He=xe.parameters!==void 0?xe.parameters[Ze.output]:Ze.output;te.push(this.getDependency("node",Q)),de.push(this.getDependency("accessor",Y)),be.push(this.getDependency("accessor",He)),Re.push(Ze),we.push(Xe)}return Promise.all([Promise.all(te),Promise.all(de),Promise.all(be),Promise.all(Re),Promise.all(we)]).then(function(Ge){for(var ue=Ge[0],Je=Ge[1],ct=Ge[2],Ft=Ge[3],ut=Ge[4],me=[],it=0,Rt=ue.length;it<Rt;it++){var mt=ue[it],Nt=Je[it],gn=ct[it],gi=Ft[it],Or=ut[it];if(mt!==void 0){mt.updateMatrix(),mt.matrixAutoUpdate=!0;var er;switch(qe[Or.path]){case qe.weights:er=fh;break;case qe.rotation:er=Nf;break;case qe.position:case qe.scale:default:er=dh;break}var Vr=mt.name?mt.name:mt.uuid,Ys=gi.interpolation!==void 0?ft[gi.interpolation]:Du,ma=[];qe[Or.path]===qe.weights?mt.traverse(function(Ea){Ea.isMesh===!0&&Ea.morphTargetInfluences&&ma.push(Ea.name?Ea.name:Ea.uuid)}):ma.push(Vr);var ji=gn.array;if(gn.normalized){var Ci;if(ji.constructor===Int8Array)Ci=1/127;else if(ji.constructor===Uint8Array)Ci=1/255;else if(ji.constructor==Int16Array)Ci=1/32767;else if(ji.constructor===Uint16Array)Ci=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var ns=new Float32Array(ji.length),ga=0,bs=ji.length;ga<bs;ga++)ns[ga]=ji[ga]*Ci;ji=ns}for(var ga=0,bs=ma.length;ga<bs;ga++){var mr=new er(ma[ga]+"."+qe[Or.path],Nt.array,ji,Ys);gi.interpolation==="CUBICSPLINE"&&(mr.createInterpolant=function($e){return new O(this.times,this.values,this.getValueSize()/3,$e)},mr.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),me.push(mr)}}}var va=xe.name?xe.name:"animation_"+K;return new Ws(va,void 0,me)})},nt.prototype.loadNode=function(K){var H=this.json,xe=this.extensions,te=this,de=H.nodes[K],be=de.name?te.createUniqueName(de.name):"";return function(){var Re=[];return de.mesh!==void 0&&Re.push(te.getDependency("mesh",de.mesh).then(function(we){var Se=te._getNodeRef(te.meshCache,de.mesh,we);return de.weights!==void 0&&Se.traverse(function(Pe){if(!!Pe.isMesh)for(var ze=0,Ze=de.weights.length;ze<Ze;ze++)Pe.morphTargetInfluences[ze]=de.weights[ze]}),Se})),de.camera!==void 0&&Re.push(te.getDependency("camera",de.camera).then(function(we){return te._getNodeRef(te.cameraCache,de.camera,we)})),te._invokeAll(function(we){return we.createNodeAttachment&&we.createNodeAttachment(K)}).forEach(function(we){Re.push(we)}),Promise.all(Re)}().then(function(Re){var we;if(de.isBone===!0?we=new zg:Re.length>1?we=new ll:Re.length===1?we=Re[0]:we=new yn,we!==Re[0])for(var Se=0,Pe=Re.length;Se<Pe;Se++)we.add(Re[Se]);if(de.name&&(we.userData.name=de.name,we.name=be),Te(we,de),de.extensions&&Le(xe,we,de),de.matrix!==void 0){var ze=new Wn;ze.fromArray(de.matrix),we.applyMatrix4(ze)}else de.translation!==void 0&&we.position.fromArray(de.translation),de.rotation!==void 0&&we.quaternion.fromArray(de.rotation),de.scale!==void 0&&we.scale.fromArray(de.scale);return te.associations.set(we,{type:"nodes",index:K}),we})},nt.prototype.loadScene=function(){function K(H,xe,te,de){var be=te.nodes[H];return de.getDependency("node",H).then(function(Re){if(be.skin===void 0)return Re;var we;return de.getDependency("skin",be.skin).then(function(Se){we=Se;for(var Pe=[],ze=0,Ze=we.joints.length;ze<Ze;ze++)Pe.push(de.getDependency("node",we.joints[ze]));return Promise.all(Pe)}).then(function(Se){return Re.traverse(function(Pe){if(!!Pe.isMesh){for(var ze=[],Ze=[],Xe=0,Q=Se.length;Xe<Q;Xe++){var Y=Se[Xe];if(Y){ze.push(Y);var He=new Wn;we.inverseBindMatrices!==void 0&&He.fromArray(we.inverseBindMatrices.array,Xe*16),Ze.push(He)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',we.joints[Xe])}Pe.bind(new dp(ze,Ze),Pe.matrixWorld)}}),Re})}).then(function(Re){xe.add(Re);var we=[];if(be.children)for(var Se=be.children,Pe=0,ze=Se.length;Pe<ze;Pe++){var Ze=Se[Pe];we.push(K(Ze,Re,te,de))}return Promise.all(we)})}return function(xe){var te=this.json,de=this.extensions,be=this.json.scenes[xe],Re=this,we=new ll;be.name&&(we.name=Re.createUniqueName(be.name)),Te(we,be),be.extensions&&Le(de,we,be);for(var Se=be.nodes||[],Pe=[],ze=0,Ze=Se.length;ze<Ze;ze++)Pe.push(K(Se[ze],we,te,Re));return Promise.all(Pe).then(function(){return we})}}(),r}(),bv=function(r){Ff.call(this,r),this.type=Oc};bv.prototype=Object.assign(Object.create(Ff.prototype),{constructor:bv,parse:function(r){var i=-1,n=1,l=2,u=3,h=4,p=function(Ne,Ue){switch(Ne){case n:console.error("RGBELoader Read Error: "+(Ue||""));break;case l:console.error("RGBELoader Write Error: "+(Ue||""));break;case u:console.error("RGBELoader Bad File Format: "+(Ue||""));break;default:case h:console.error("RGBELoader: Error: "+(Ue||""))}return i},g=1,_=2,b=4,A=`
`,S=function(Ne,Ue,Le){Ue=Ue||1024;for(var Te=Ne.pos,Ve=-1,We=0,at="",Tt=128,nt=String.fromCharCode.apply(null,new Uint16Array(Ne.subarray(Te,Te+Tt)));0>(Ve=nt.indexOf(A))&&We<Ue&&Te<Ne.byteLength;)at+=nt,We+=nt.length,Te+=Tt,nt+=String.fromCharCode.apply(null,new Uint16Array(Ne.subarray(Te,Te+Tt)));return-1<Ve?(Le!==!1&&(Ne.pos+=We+Ve+1),at+nt.slice(0,Ve)):!1},R=function(Ne){var Ue,Le,Te=/^#\?(\S+)$/,Ve=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,We=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,at=/^\s*FORMAT=(\S+)\s*$/,Tt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,nt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(Ne.pos>=Ne.byteLength||!(Ue=S(Ne)))return p(n,"no header found");if(!(Le=Ue.match(Te)))return p(u,"bad initial token");for(nt.valid|=g,nt.programtype=Le[1],nt.string+=Ue+`
`;Ue=S(Ne),Ue!==!1;){if(nt.string+=Ue+`
`,Ue.charAt(0)==="#"){nt.comments+=Ue+`
`;continue}if((Le=Ue.match(Ve))&&(nt.gamma=parseFloat(Le[1],10)),(Le=Ue.match(We))&&(nt.exposure=parseFloat(Le[1],10)),(Le=Ue.match(at))&&(nt.valid|=_,nt.format=Le[1]),(Le=Ue.match(Tt))&&(nt.valid|=b,nt.height=parseInt(Le[1],10),nt.width=parseInt(Le[2],10)),nt.valid&_&&nt.valid&b)break}return nt.valid&_?nt.valid&b?nt:p(u,"missing image size specifier"):p(u,"missing format specifier")},E=function(Ne,Ue,Le){var Te,Ve,We,at,Tt,nt,At,nn,Yt,K,H,xe,te=Ue,de=Le,be;if(te<8||te>32767||Ne[0]!==2||Ne[1]!==2||Ne[2]&128)return new Uint8Array(Ne);if(te!==(Ne[2]<<8|Ne[3]))return p(u,"wrong scanline width");if(Te=new Uint8Array(4*Ue*Le),!Te.length)return p(h,"unable to allocate buffer space");for(Ve=0,We=0,nn=4*te,be=new Uint8Array(4),nt=new Uint8Array(nn);de>0&&We<Ne.byteLength;){if(We+4>Ne.byteLength)return p(n);if(be[0]=Ne[We++],be[1]=Ne[We++],be[2]=Ne[We++],be[3]=Ne[We++],be[0]!=2||be[1]!=2||(be[2]<<8|be[3])!=te)return p(u,"bad rgbe scanline format");for(At=0;At<nn&&We<Ne.byteLength;){if(at=Ne[We++],xe=at>128,xe&&(at-=128),at===0||At+at>nn)return p(u,"bad scanline data");if(xe)for(Tt=Ne[We++],Yt=0;Yt<at;Yt++)nt[At++]=Tt;else nt.set(Ne.subarray(We,We+at),At),At+=at,We+=at}for(K=te,Yt=0;Yt<K;Yt++)H=0,Te[Ve]=nt[Yt+H],H+=te,Te[Ve+1]=nt[Yt+H],H+=te,Te[Ve+2]=nt[Yt+H],H+=te,Te[Ve+3]=nt[Yt+H],Ve+=4;de--}return Te},N=function(Ne,Ue,Le,Te){var Ve=Ne[Ue+3],We=Math.pow(2,Ve-128)/255;Le[Te+0]=Ne[Ue+0]*We,Le[Te+1]=Ne[Ue+1]*We,Le[Te+2]=Ne[Ue+2]*We},W=function(){var Ne=new Float32Array(1),Ue=new Int32Array(Ne.buffer);function Le(Te){Ne[0]=Te;var Ve=Ue[0],We=Ve>>16&32768,at=Ve>>12&2047,Tt=Ve>>23&255;return Tt<103?We:Tt>142?(We|=31744,We|=(Tt==255?0:1)&&Ve&8388607,We):Tt<113?(at|=2048,We|=(at>>114-Tt)+(at>>113-Tt&1),We):(We|=Tt-112<<10|at>>1,We+=at&1,We)}return function(Te,Ve,We,at){var Tt=Te[Ve+3],nt=Math.pow(2,Tt-128)/255;We[at+0]=Le(Te[Ve+0]*nt),We[at+1]=Le(Te[Ve+1]*nt),We[at+2]=Le(Te[Ve+2]*nt)}}(),V=new Uint8Array(r);V.pos=0;var B=R(V);if(i!==B){var O=B.width,pe=B.height,ge=E(V.subarray(V.pos),O,pe);if(i!==ge){switch(this.type){case Oc:var qe=ge,ft=kb,je=Oc;break;case Bs:for(var Ie=ge.length/4*3,ye=new Float32Array(Ie),$=0;$<Ie;$++)N(ge,$*4,ye,$*3);var qe=ye,ft=Mo,je=Bs;break;case Nc:for(var Ie=ge.length/4*3,tt=new Uint16Array(Ie),$=0;$<Ie;$++)W(ge,$*4,tt,$*3);var qe=tt,ft=Mo,je=Nc;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:O,height:pe,data:qe,header:B.string,gamma:B.gamma,exposure:B.exposure,format:ft,type:je}}}return null},setDataType:function(r){return this.type=r,this},load:function(r,i,n,l){function u(h,p){switch(h.type){case Oc:h.encoding=$y,h.minFilter=Et,h.magFilter=Et,h.generateMipmaps=!1,h.flipY=!0;break;case Bs:h.encoding=Fc,h.minFilter=Rn,h.magFilter=Rn,h.generateMipmaps=!1,h.flipY=!0;break;case Nc:h.encoding=Fc,h.minFilter=Rn,h.magFilter=Rn,h.generateMipmaps=!1,h.flipY=!0;break}i&&i(h,p)}return Ff.prototype.load.call(this,r,u,n,l)}});class wv extends sn.Object3D{constructor(i){super(),this.element=i,this.element.style.position="absolute",this.addEventListener("removed",function(){this.element.parentNode!==null&&this.element.parentNode.removeChild(this.element)})}}class oA{constructor(){this.domElement=document.createElement("div"),this.viewMatrix=new sn.Matrix4,this.viewProjectionMatrix=new sn.Matrix4,this.vector=new sn.Vector3,this.cache={objects:new WeakMap},this.getDistanceToSquaredA=new sn.Vector3,this.getDistanceToSquaredB=new sn.Vector3,this.domElement.style.overflow="hidden"}zOrder(i){const n=this.filterAndFlatten(i).sort((u,h)=>{const p=this.cache.objects.get(u).distanceToCameraSquared,g=this.cache.objects.get(h).distanceToCameraSquared;return p-g}),l=n.length;for(let u=0,h=n.length;u<h;u++)n[u].element.style.zIndex=String(l-u)}getDistanceToSquared(i,n){return this.getDistanceToSquaredA.setFromMatrixPosition(i.matrixWorld),this.getDistanceToSquaredB.setFromMatrixPosition(n.matrixWorld),this.getDistanceToSquaredA.distanceToSquared(this.getDistanceToSquaredB)}render(i,n){i.updateMatrixWorld(),n.parent===null&&n.updateMatrixWorld(!1),this.viewMatrix.copy(n.matrixWorldInverse),this.viewProjectionMatrix.multiplyMatrices(n.projectionMatrix,this.viewMatrix),this.renderObject(i,n),this.zOrder(i)}getSize(){return{width:this.width,height:this.height}}setSize(i,n){this.width=i,this.height=n,this.widthHalf=this.width/2,this.heightHalf=this.height/2,this.domElement.style.width=i+"px",this.domElement.style.height=n+"px"}filterAndFlatten(i){const n=[];return i.traverse(l=>{l instanceof wv&&n.push(l)}),n}renderObject(i,n){if(i instanceof wv){this.vector.setFromMatrixPosition(i.matrixWorld),this.vector.applyMatrix4(this.viewProjectionMatrix);const l=i.element,u="translate(-50%,-50%) translate("+(this.vector.x*this.widthHalf+this.widthHalf)+"px,"+(-this.vector.y*this.heightHalf+this.heightHalf)+"px)";l.style.transform=u,l.style.display=i.visible&&this.vector.z>=-1&&this.vector.z<=1?"":"none";const h={distanceToCameraSquared:this.getDistanceToSquared(n,i)};this.cache.objects.set(i,h),l.parentNode!==this.domElement&&this.domElement.appendChild(l)}for(let l=0,u=i.children.length;l<u;l++)this.renderObject(i.children[l],n)}}var Bp=null;function D_(r){if(r==null){Bp=null;return}else lA(),Bp=r}function lA(){Bp&&Bp.toggleVisibility()}class cA{constructor(i,n,l,u,h){this.overlayRef=null,this.widgetRef=null,this.visible=!1,this.id=i,this.position=n,this.normal_vector=l,this.labelObject=u,this.overlayRef=h}setWidgetRef(i){this.widgetRef=i}toggleVisibility(){!this.widgetRef||(this.visible=!this.visible,this.visible?(D_(this),this.widgetRef.style.display="grid"):(D_(null),this.widgetRef.style.display="none"))}setOpacity(i){this.labelObject.element.style.opacity=i}}let Mv;const Sv=45,uA=2,hA=.1,fA=100,O_={url:"https://devcdn.vev.design/private/IZ8anjrpLbNsil9YD4NOn6pLTsc2/ZtaWckY6KR_Astronaut.glb.glb"},dA="https://cdn.vev.design/private/Tr1z5E7fRfebmaI3Le2T8vQsHud2/c_W6ves3U_abandoned_factory_canteen_01_1k.hdr.hdr";function pA({hostRef:r,hotspots:i,hotspotColor:n,modelURL:l,posterURL:u,loader:h,enableMouseControl:p,autoRotate:g=!1,enablePan:_=!1,enableZoom:b=!1}){const{disabled:A}=Da(),{width:S,height:R}=Tr(r),E=hn(null),[N,W]=Hn(null),[V,B]=Hn(l||O_),[O,pe]=Hn(u),[ge,ye]=Hn(null),[$,Ie]=Hn(null),[tt,qe]=Hn(null),[ft,je]=Hn(null),[Ne,Ue]=Hn(null),[Le,Te]=Hn(0),[Ve,We]=Hn(!1),[at,Tt]=Hn(null),nt=hn(null),[At,nn]=Hn([]),Yt=Tr(r),K=hn(null);kn(()=>{we(),Xe()},[]),kn(()=>{Ve&&at.render(Ne,ft)},[Ve]),kn(()=>{if(!N||!i)return;H();let Y=xe();nn(Y),Xe(),at.render(Ne,ft)},[i,N,n]);function H(){for(let Y=N.children.length-1;Y>=0;Y--)N.children[Y]&&N.children[Y].name=="hotspot"&&N.remove(N.children[Y]);Xe()}function xe(){let Y=[];for(let Ge=0;Ge<i.length;Ge++){let ue=new cA(i[Ge].id,i[Ge].position,i[Ge].normal_vector,Re(N,i[Ge].position),K);if(i[Ge].widget)var He=document.getElementById(i[Ge].widget.value);He&&ue.setWidgetRef(He),te(ue,"click"),te(ue,"touchend"),Y.push(ue)}return Y}function te(Y,He){Y.labelObject.element.addEventListener(He,()=>{var Ge=ft.position.length();let ue=new sn.Vector3(Y.position.x,Y.position.y,Y.position.z).normalize().multiplyScalar(Ge);Oa.to(ft.position,1,{x:ue.x,y:ue.y,z:ue.z,onUpdate:()=>{$.update()}}),Y.toggleVisibility()})}kn(()=>{at&&(at.setSize(Yt.width,Yt.height),at.render(Ne,ft))},[Yt]),kn(()=>{if(!(A||!ge||!$))return tt&&tt.setAnimationLoop(ze),()=>{tt&&tt.setAnimationLoop(null)}},[A,tt,ge,$,At]),kn(()=>{!$||($.enabled=p,$.enablePan=_,$.enableZoom=b,$.removeEventListener("start",de),$.removeEventListener("end",be),g&&($.addEventListener("start",de),$.addEventListener("end",be)),clearTimeout(Mv),$.autoRotate=g,$.update())},[$,g,p,_,b]);const de=Sr(()=>{clearTimeout(Mv),$.autoRotate=!1},[$]),be=Sr(()=>{Mv=setTimeout(function(){$.autoRotate=!0},3e3)},[$]);kn(()=>{if(l){if(l.url==V.url)return;B(l)}else{B(O_);return}},[l]),kn(()=>{if(!Ne||!ft||!tt)return;ge&&(Q(ge),H(),We(!1),Te(0));let Y=V.url;Se(Y,Ne,N,ft,tt,$)},[V]);function Re(Y,He){var Ge=document.createElement("div");Ge.className="dot",Ge.style.backgroundColor=n||"blue",Ge.style.width="20px",Ge.style.height="20px",Ge.style.borderRadius="10px",Ge.style.cursor="pointer";var ue=new wv(Ge);return ue.position.set(He.x,He.y,He.z),ue.name="hotspot",ue.parent=ge,Y.add(ue),ue}function we(){const Y=E.current;let He=new sn.WebGLRenderer({canvas:Y,alpha:!0});He.setSize(S,R),He.toneMapping=sn.ACESFilmicToneMapping,He.toneMappingExposure=1,He.outputEncoding=sn.sRGBEncoding,He.shadowMap.type=sn.PCFShadowMap;let Ge=new sn.Scene,ue=new sn.PerspectiveCamera(Sv,uA,hA,fA);Ge.add(ue);var Je=new sn.DirectionalLight(16777215,.8);Je.position.set(0,1,0),Je.castShadow=!0,Ge.add(Je);var ct=new sn.AmbientLight(16777215,.88);ct.castShadow=!0,Ge.add(ct);var Ft=new sn.SpotLight(16777215,.25);Ft.position.set(70,50,20),Ge.add(Ft);let ut=new oA;ut.setSize(Yt.width,Yt.height),ut.domElement.style.position="absolute",ut.domElement.style.top="0",ut.domElement.style.outline="none",nt.current.appendChild(ut.domElement),Tt(ut);let me=new zf(ue,ut.domElement);me.autoRotate=g,me.enableDamping=!0,me.enableZoom=b,me.dampingFactor=.1,me.update();var it=new sn.Mesh;W(it),Ge.add(it);let Rt=V.url;Se(Rt,Ge,it,ue,He,me),qe(He),Ue(Ge),je(ue),Ie(me)}function Se(Y,He,Ge,ue,Je,ct){var Ft=new sn.PMREMGenerator(Je);Ft.compileEquirectangularShader(),new bv().setDataType(sn.UnsignedByteType).load(dA,function(ut){const me=Ft.fromEquirectangular(ut).texture;He.environment=me,ut.dispose(),Ft.dispose(),new sA().load(Y,function(it){let Rt=it.scene;Rt.castShadow=!0,Rt.receiveShadow=!0,Ge.add(Rt),ye(Rt);const mt=new sn.Box3().setFromObject(Rt),Nt=mt.getSize(new sn.Vector3),gn=mt.getCenter(new sn.Vector3);Rt.position.x=Rt.position.x-gn.x,Rt.position.y=Rt.position.y-gn.y,Rt.position.z=Rt.position.z-gn.z,Pe(Nt,gn,ue),ct.maxDistance=Nt.length()*5,ct.update(),We(!0)},function(it){let Rt=it.loaded/it.total*100;Te(Rt)},function(it){console.log("GLTF loading error: ",it)})})}function Pe(Y,He,Ge){const ue=Y.length()*.5,Je=sn.MathUtils.degToRad(Sv*.5),ct=ue/Math.tan(Je),Ft=new sn.Vector3().subVectors(Ge.position,He).multiply(new sn.Vector3(1,0,1)).normalize();Ge.position.copy(Ft.multiplyScalar(ct).add(He)),Ge.near=Y.length()/100,Ge.far=Y.length()*100,Ge.rotation.set(0,0,0);const ut=Math.max(Y.x,Y.y);Ge.position.set(0,0,Math.abs(ut/Math.sin(Sv/2))),Ge.updateProjectionMatrix(),Ge.lookAt(He.x,He.y,He.z),Xe()}function ze(){for(let Y=0;Y<At.length;Y++)Ze(At[Y],ft);$&&$.update(),at.render(Ne,ft),Xe()}function Ze(Y,He){let Ge=new sn.Vector3(Y.position.x,Y.position.y,Y.position.z),ue=new sn.Vector3(0,0,-1).applyQuaternion(He.quaternion);Ge.angleTo(ue)>Math.PI/2?Y.setOpacity("1"):Y.setOpacity("0.1")}kn(()=>{tt&&ft&&(ft.aspect=S/R,ft.updateProjectionMatrix(),tt.setSize(S,R-10),Xe())},[S,R,ge]);function Xe(){tt&&Ne&&ft&&tt.render(Ne,ft)}function Q(Y){for(var He of N.children)He===Y&&N.remove(He);Xe()}return ca.createElement(dr,null,!Ve&&ca.createElement("div",{className:"loadingWrapper"},h=="bar"||ca.createElement("div",{className:"loadingBar"},ca.createElement("div",{className:"progressFill",style:{width:`${Le}%`,backgroundColor:n||"blue"}}))),!Ve&&O&&ca.createElement("div",{className:"posterImage",style:{backgroundImage:`url(${O.url})`}}),ca.createElement("div",{ref:K,className:"overlay",style:{width:window.innerWidth,height:window.innerHeight}}),ca.createElement("div",{ref:nt,className:"modelContainer"},ca.createElement("canvas",{ref:E,id:"scene"})))}}}})});})();
